Step 1: torchdynamo start tracing forward /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:194
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:194 in forward (KGReasoning.forward)
        def forward(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:195 in forward (KGReasoning.forward)
            if self.geo == 'box':
TRACE LOAD_FAST self []
TRACE LOAD_ATTR geo [LazyVariableTracker()]
TRACE LOAD_CONST box [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 74 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:196 in forward (KGReasoning.forward)
                return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD forward_box [NNModuleVariable()]
TRACE LOAD_FAST positive_sample [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable())]
TRACE LOAD_FAST negative_sample [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_FAST subsampling_weight [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_queries_dict [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_idxs_dict [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE PRECALL 5 [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call forward_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:196 in forward (KGReasoning.forward)
            return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
                   ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object forward_box at 0x7316500, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 420>
420           0 RESUME                   0

421           2 BUILD_LIST               0
              4 BUILD_LIST               0
              6 BUILD_LIST               0
              8 STORE_FAST               8 (all_idxs)
             10 STORE_FAST               7 (all_offset_embeddings)
             12 STORE_FAST               6 (all_center_embeddings)

422          14 BUILD_LIST               0
             16 BUILD_LIST               0
             18 BUILD_LIST               0
             20 STORE_FAST              11 (all_union_idxs)
             22 STORE_FAST              10 (all_union_offset_embeddings)
             24 STORE_FAST               9 (all_union_center_embeddings)

423          26 LOAD_FAST                4 (batch_queries_dict)
             28 GET_ITER
        >>   30 EXTENDED_ARG             1
             32 FOR_ITER               262 (to 558)
             34 STORE_FAST              12 (query_structure)

424          36 LOAD_CONST               1 ('u')
             38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                0 (query_name_dict)
             50 LOAD_FAST               12 (query_structure)
             52 BINARY_SUBSCR
             62 CONTAINS_OP              0
             64 POP_JUMP_FORWARD_IF_FALSE   142 (to 350)

426          66 LOAD_FAST                0 (self)
             68 LOAD_METHOD              1 (embed_query_box)
             90 LOAD_FAST                0 (self)
             92 LOAD_METHOD              2 (transform_union_query)
            114 LOAD_FAST                4 (batch_queries_dict)
            116 LOAD_FAST               12 (query_structure)
            118 BINARY_SUBSCR

427         128 LOAD_FAST               12 (query_structure)

426         130 PRECALL                  2
            134 CALL                     2

428         144 LOAD_FAST                0 (self)
            146 LOAD_METHOD              3 (transform_union_structure)
            168 LOAD_FAST               12 (query_structure)
            170 PRECALL                  1
            174 CALL                     1

429         184 LOAD_CONST               2 (0)

426         186 PRECALL                  3
            190 CALL                     3

425         200 UNPACK_SEQUENCE          3
            204 STORE_FAST              13 (center_embedding)
            206 STORE_FAST              14 (offset_embedding)
            208 STORE_FAST              15 (_)

430         210 LOAD_FAST                9 (all_union_center_embeddings)
            212 LOAD_METHOD              4 (append)
            234 LOAD_FAST               13 (center_embedding)
            236 PRECALL                  1
            240 CALL                     1
            250 POP_TOP

431         252 LOAD_FAST               10 (all_union_offset_embeddings)
            254 LOAD_METHOD              4 (append)
            276 LOAD_FAST               14 (offset_embedding)
            278 PRECALL                  1
            282 CALL                     1
            292 POP_TOP

432         294 LOAD_FAST               11 (all_union_idxs)
            296 LOAD_METHOD              5 (extend)
            318 LOAD_FAST                5 (batch_idxs_dict)
            320 LOAD_FAST               12 (query_structure)
            322 BINARY_SUBSCR
            332 PRECALL                  1
            336 CALL                     1
            346 POP_TOP
            348 JUMP_BACKWARD          160 (to 30)

434     >>  350 LOAD_FAST                0 (self)
            352 LOAD_METHOD              1 (embed_query_box)
            374 LOAD_FAST                4 (batch_queries_dict)
            376 LOAD_FAST               12 (query_structure)
            378 BINARY_SUBSCR

435         388 LOAD_FAST               12 (query_structure)

436         390 LOAD_CONST               2 (0)

434         392 PRECALL                  3
            396 CALL                     3
            406 UNPACK_SEQUENCE          3
            410 STORE_FAST              13 (center_embedding)
            412 STORE_FAST              14 (offset_embedding)
            414 STORE_FAST              15 (_)

437         416 LOAD_FAST                6 (all_center_embeddings)
            418 LOAD_METHOD              4 (append)
            440 LOAD_FAST               13 (center_embedding)
            442 PRECALL                  1
            446 CALL                     1
            456 POP_TOP

438         458 LOAD_FAST                7 (all_offset_embeddings)
            460 LOAD_METHOD              4 (append)
            482 LOAD_FAST               14 (offset_embedding)
            484 PRECALL                  1
            488 CALL                     1
            498 POP_TOP

439         500 LOAD_FAST                8 (all_idxs)
            502 LOAD_METHOD              5 (extend)
            524 LOAD_FAST                5 (batch_idxs_dict)
            526 LOAD_FAST               12 (query_structure)
            528 BINARY_SUBSCR
            538 PRECALL                  1
            542 CALL                     1
            552 POP_TOP
            554 EXTENDED_ARG             1
            556 JUMP_BACKWARD          264 (to 30)

441     >>  558 LOAD_GLOBAL             13 (NULL + len)
            570 LOAD_FAST                6 (all_center_embeddings)
            572 PRECALL                  1
            576 CALL                     1
            586 LOAD_CONST               2 (0)
            588 COMPARE_OP               4 (>)
            594 POP_JUMP_FORWARD_IF_FALSE   101 (to 798)
            596 LOAD_GLOBAL             13 (NULL + len)
            608 LOAD_FAST                7 (all_offset_embeddings)
            610 PRECALL                  1
            614 CALL                     1
            624 LOAD_CONST               2 (0)
            626 COMPARE_OP               4 (>)
            632 POP_JUMP_FORWARD_IF_FALSE    82 (to 798)

442         634 LOAD_GLOBAL             15 (NULL + torch)
            646 LOAD_ATTR                8 (cat)
            656 LOAD_FAST                6 (all_center_embeddings)
            658 LOAD_CONST               2 (0)
            660 KW_NAMES                 3
            662 PRECALL                  2
            666 CALL                     2
            676 LOAD_METHOD              9 (unsqueeze)
            698 LOAD_CONST               4 (1)
            700 PRECALL                  1
            704 CALL                     1
            714 STORE_FAST               6 (all_center_embeddings)

443         716 LOAD_GLOBAL             15 (NULL + torch)
            728 LOAD_ATTR                8 (cat)
            738 LOAD_FAST                7 (all_offset_embeddings)
            740 LOAD_CONST               2 (0)
            742 KW_NAMES                 3
            744 PRECALL                  2
            748 CALL                     2
            758 LOAD_METHOD              9 (unsqueeze)
            780 LOAD_CONST               4 (1)
            782 PRECALL                  1
            786 CALL                     1
            796 STORE_FAST               7 (all_offset_embeddings)

444     >>  798 LOAD_GLOBAL             13 (NULL + len)
            810 LOAD_FAST                9 (all_union_center_embeddings)
            812 PRECALL                  1
            816 CALL                     1
            826 LOAD_CONST               2 (0)
            828 COMPARE_OP               4 (>)
            834 POP_JUMP_FORWARD_IF_FALSE   177 (to 1190)
            836 LOAD_GLOBAL             13 (NULL + len)
            848 LOAD_FAST               10 (all_union_offset_embeddings)
            850 PRECALL                  1
            854 CALL                     1
            864 LOAD_CONST               2 (0)
            866 COMPARE_OP               4 (>)
            872 POP_JUMP_FORWARD_IF_FALSE   158 (to 1190)

445         874 LOAD_GLOBAL             15 (NULL + torch)
            886 LOAD_ATTR                8 (cat)
            896 LOAD_FAST                9 (all_union_center_embeddings)
            898 LOAD_CONST               2 (0)
            900 KW_NAMES                 3
            902 PRECALL                  2
            906 CALL                     2
            916 LOAD_METHOD              9 (unsqueeze)
            938 LOAD_CONST               4 (1)
            940 PRECALL                  1
            944 CALL                     1
            954 STORE_FAST               9 (all_union_center_embeddings)

446         956 LOAD_GLOBAL             15 (NULL + torch)
            968 LOAD_ATTR                8 (cat)
            978 LOAD_FAST               10 (all_union_offset_embeddings)
            980 LOAD_CONST               2 (0)
            982 KW_NAMES                 3
            984 PRECALL                  2
            988 CALL                     2
            998 LOAD_METHOD              9 (unsqueeze)
           1020 LOAD_CONST               4 (1)
           1022 PRECALL                  1
           1026 CALL                     1
           1036 STORE_FAST              10 (all_union_offset_embeddings)

447        1038 LOAD_FAST                9 (all_union_center_embeddings)
           1040 LOAD_METHOD             10 (view)
           1062 LOAD_FAST                9 (all_union_center_embeddings)
           1064 LOAD_ATTR               11 (shape)
           1074 LOAD_CONST               2 (0)
           1076 BINARY_SUBSCR
           1086 LOAD_CONST               5 (2)
           1088 BINARY_OP                2 (//)
           1092 LOAD_CONST               5 (2)
           1094 LOAD_CONST               4 (1)
           1096 LOAD_CONST               6 (-1)
           1098 PRECALL                  4
           1102 CALL                     4
           1112 STORE_FAST               9 (all_union_center_embeddings)

448        1114 LOAD_FAST               10 (all_union_offset_embeddings)
           1116 LOAD_METHOD             10 (view)
           1138 LOAD_FAST               10 (all_union_offset_embeddings)
           1140 LOAD_ATTR               11 (shape)
           1150 LOAD_CONST               2 (0)
           1152 BINARY_SUBSCR
           1162 LOAD_CONST               5 (2)
           1164 BINARY_OP                2 (//)
           1168 LOAD_CONST               5 (2)
           1170 LOAD_CONST               4 (1)
           1172 LOAD_CONST               6 (-1)
           1174 PRECALL                  4
           1178 CALL                     4
           1188 STORE_FAST              10 (all_union_offset_embeddings)

450     >> 1190 LOAD_GLOBAL             25 (NULL + type)
           1202 LOAD_FAST                3 (subsampling_weight)
           1204 PRECALL                  1
           1208 CALL                     1
           1218 LOAD_GLOBAL             25 (NULL + type)
           1230 LOAD_CONST               0 (None)
           1232 PRECALL                  1
           1236 CALL                     1
           1246 COMPARE_OP               3 (!=)
           1252 POP_JUMP_FORWARD_IF_FALSE    11 (to 1276)

451        1254 LOAD_FAST                3 (subsampling_weight)
           1256 LOAD_FAST                8 (all_idxs)
           1258 LOAD_FAST               11 (all_union_idxs)
           1260 BINARY_OP                0 (+)
           1264 BINARY_SUBSCR
           1274 STORE_FAST               3 (subsampling_weight)

453     >> 1276 LOAD_GLOBAL             25 (NULL + type)
           1288 LOAD_FAST                1 (positive_sample)
           1290 PRECALL                  1
           1294 CALL                     1
           1304 LOAD_GLOBAL             25 (NULL + type)
           1316 LOAD_CONST               0 (None)
           1318 PRECALL                  1
           1322 CALL                     1
           1332 COMPARE_OP               3 (!=)
           1338 EXTENDED_ARG             1
           1340 POP_JUMP_FORWARD_IF_FALSE   366 (to 2074)

454        1342 LOAD_GLOBAL             13 (NULL + len)
           1354 LOAD_FAST                6 (all_center_embeddings)
           1356 PRECALL                  1
           1360 CALL                     1
           1370 LOAD_CONST               2 (0)
           1372 COMPARE_OP               4 (>)
           1378 POP_JUMP_FORWARD_IF_FALSE    79 (to 1538)

455        1380 LOAD_FAST                1 (positive_sample)
           1382 LOAD_FAST                8 (all_idxs)
           1384 BINARY_SUBSCR
           1394 STORE_FAST              16 (positive_sample_regular)

456        1396 LOAD_GLOBAL             15 (NULL + torch)
           1408 LOAD_ATTR               13 (index_select)
           1418 LOAD_FAST                0 (self)
           1420 LOAD_ATTR               14 (entity_embedding)
           1430 LOAD_CONST               2 (0)
           1432 LOAD_FAST               16 (positive_sample_regular)
           1434 KW_NAMES                 7
           1436 PRECALL                  3
           1440 CALL                     3
           1450 LOAD_METHOD              9 (unsqueeze)
           1472 LOAD_CONST               4 (1)
           1474 PRECALL                  1
           1478 CALL                     1
           1488 STORE_FAST              17 (positive_embedding)

457        1490 LOAD_FAST                0 (self)
           1492 LOAD_METHOD             15 (cal_logit_box)
           1514 LOAD_FAST               17 (positive_embedding)
           1516 LOAD_FAST                6 (all_center_embeddings)
           1518 LOAD_FAST                7 (all_offset_embeddings)
           1520 PRECALL                  3
           1524 CALL                     3
           1534 STORE_FAST              18 (positive_logit)
           1536 JUMP_FORWARD            49 (to 1636)

459     >> 1538 LOAD_GLOBAL             15 (NULL + torch)
           1550 LOAD_ATTR               16 (Tensor)
           1560 BUILD_LIST               0
           1562 PRECALL                  1
           1566 CALL                     1
           1576 LOAD_METHOD             17 (to)
           1598 LOAD_FAST                0 (self)
           1600 LOAD_ATTR               14 (entity_embedding)
           1610 LOAD_ATTR               18 (device)
           1620 PRECALL                  1
           1624 CALL                     1
           1634 STORE_FAST              18 (positive_logit)

461     >> 1636 LOAD_GLOBAL             13 (NULL + len)
           1648 LOAD_FAST                9 (all_union_center_embeddings)
           1650 PRECALL                  1
           1654 CALL                     1
           1664 LOAD_CONST               2 (0)
           1666 COMPARE_OP               4 (>)
           1672 POP_JUMP_FORWARD_IF_FALSE   126 (to 1926)

462        1674 LOAD_FAST                1 (positive_sample)
           1676 LOAD_FAST               11 (all_union_idxs)
           1678 BINARY_SUBSCR
           1688 STORE_FAST              19 (positive_sample_union)

463        1690 LOAD_GLOBAL             15 (NULL + torch)
           1702 LOAD_ATTR               13 (index_select)
           1712 LOAD_FAST                0 (self)
           1714 LOAD_ATTR               14 (entity_embedding)
           1724 LOAD_CONST               2 (0)
           1726 LOAD_FAST               19 (positive_sample_union)
           1728 KW_NAMES                 7
           1730 PRECALL                  3
           1734 CALL                     3
           1744 LOAD_METHOD              9 (unsqueeze)
           1766 LOAD_CONST               4 (1)
           1768 PRECALL                  1
           1772 CALL                     1
           1782 LOAD_METHOD              9 (unsqueeze)
           1804 LOAD_CONST               4 (1)
           1806 PRECALL                  1
           1810 CALL                     1
           1820 STORE_FAST              17 (positive_embedding)

464        1822 LOAD_FAST                0 (self)
           1824 LOAD_METHOD             15 (cal_logit_box)
           1846 LOAD_FAST               17 (positive_embedding)
           1848 LOAD_FAST                9 (all_union_center_embeddings)
           1850 LOAD_FAST               10 (all_union_offset_embeddings)
           1852 PRECALL                  3
           1856 CALL                     3
           1866 STORE_FAST              20 (positive_union_logit)

465        1868 LOAD_GLOBAL             15 (NULL + torch)
           1880 LOAD_ATTR               19 (max)
           1890 LOAD_FAST               20 (positive_union_logit)
           1892 LOAD_CONST               4 (1)
           1894 KW_NAMES                 3
           1896 PRECALL                  2
           1900 CALL                     2
           1910 LOAD_CONST               2 (0)
           1912 BINARY_SUBSCR
           1922 STORE_FAST              20 (positive_union_logit)
           1924 JUMP_FORWARD            49 (to 2024)

467     >> 1926 LOAD_GLOBAL             15 (NULL + torch)
           1938 LOAD_ATTR               16 (Tensor)
           1948 BUILD_LIST               0
           1950 PRECALL                  1
           1954 CALL                     1
           1964 LOAD_METHOD             17 (to)
           1986 LOAD_FAST                0 (self)
           1988 LOAD_ATTR               14 (entity_embedding)
           1998 LOAD_ATTR               18 (device)
           2008 PRECALL                  1
           2012 CALL                     1
           2022 STORE_FAST              20 (positive_union_logit)

468     >> 2024 LOAD_GLOBAL             15 (NULL + torch)
           2036 LOAD_ATTR                8 (cat)
           2046 LOAD_FAST               18 (positive_logit)
           2048 LOAD_FAST               20 (positive_union_logit)
           2050 BUILD_LIST               2
           2052 LOAD_CONST               2 (0)
           2054 KW_NAMES                 3
           2056 PRECALL                  2
           2060 CALL                     2
           2070 STORE_FAST              18 (positive_logit)
           2072 JUMP_FORWARD             2 (to 2078)

470     >> 2074 LOAD_CONST               0 (None)
           2076 STORE_FAST              18 (positive_logit)

472     >> 2078 LOAD_GLOBAL             25 (NULL + type)
           2090 LOAD_FAST                2 (negative_sample)
           2092 PRECALL                  1
           2096 CALL                     1
           2106 LOAD_GLOBAL             25 (NULL + type)
           2118 LOAD_CONST               0 (None)
           2120 PRECALL                  1
           2124 CALL                     1
           2134 COMPARE_OP               3 (!=)
           2140 EXTENDED_ARG             1
           2142 POP_JUMP_FORWARD_IF_FALSE   410 (to 2964)

473        2144 LOAD_GLOBAL             13 (NULL + len)
           2156 LOAD_FAST                6 (all_center_embeddings)
           2158 PRECALL                  1
           2162 CALL                     1
           2172 LOAD_CONST               2 (0)
           2174 COMPARE_OP               4 (>)
           2180 POP_JUMP_FORWARD_IF_FALSE   110 (to 2402)

474        2182 LOAD_FAST                2 (negative_sample)
           2184 LOAD_FAST                8 (all_idxs)
           2186 BINARY_SUBSCR
           2196 STORE_FAST              21 (negative_sample_regular)

475        2198 LOAD_FAST               21 (negative_sample_regular)
           2200 LOAD_ATTR               11 (shape)
           2210 UNPACK_SEQUENCE          2
           2214 STORE_FAST              22 (batch_size)
           2216 STORE_FAST              23 (negative_size)

476        2218 LOAD_GLOBAL             15 (NULL + torch)
           2230 LOAD_ATTR               13 (index_select)
           2240 LOAD_FAST                0 (self)
           2242 LOAD_ATTR               14 (entity_embedding)
           2252 LOAD_CONST               2 (0)
           2254 LOAD_FAST               21 (negative_sample_regular)
           2256 LOAD_METHOD             10 (view)
           2278 LOAD_CONST               6 (-1)
           2280 PRECALL                  1
           2284 CALL                     1
           2294 KW_NAMES                 7
           2296 PRECALL                  3
           2300 CALL                     3
           2310 LOAD_METHOD             10 (view)
           2332 LOAD_FAST               22 (batch_size)
           2334 LOAD_FAST               23 (negative_size)
           2336 LOAD_CONST               6 (-1)
           2338 PRECALL                  3
           2342 CALL                     3
           2352 STORE_FAST              24 (negative_embedding)

477        2354 LOAD_FAST                0 (self)
           2356 LOAD_METHOD             15 (cal_logit_box)
           2378 LOAD_FAST               24 (negative_embedding)
           2380 LOAD_FAST                6 (all_center_embeddings)
           2382 LOAD_FAST                7 (all_offset_embeddings)
           2384 PRECALL                  3
           2388 CALL                     3
           2398 STORE_FAST              25 (negative_logit)
           2400 JUMP_FORWARD            49 (to 2500)

479     >> 2402 LOAD_GLOBAL             15 (NULL + torch)
           2414 LOAD_ATTR               16 (Tensor)
           2424 BUILD_LIST               0
           2426 PRECALL                  1
           2430 CALL                     1
           2440 LOAD_METHOD             17 (to)
           2462 LOAD_FAST                0 (self)
           2464 LOAD_ATTR               14 (entity_embedding)
           2474 LOAD_ATTR               18 (device)
           2484 PRECALL                  1
           2488 CALL                     1
           2498 STORE_FAST              25 (negative_logit)

481     >> 2500 LOAD_GLOBAL             13 (NULL + len)
           2512 LOAD_FAST                9 (all_union_center_embeddings)
           2514 PRECALL                  1
           2518 CALL                     1
           2528 LOAD_CONST               2 (0)
           2530 COMPARE_OP               4 (>)
           2536 POP_JUMP_FORWARD_IF_FALSE   139 (to 2816)

482        2538 LOAD_FAST                2 (negative_sample)
           2540 LOAD_FAST               11 (all_union_idxs)
           2542 BINARY_SUBSCR
           2552 STORE_FAST              26 (negative_sample_union)

483        2554 LOAD_FAST               26 (negative_sample_union)
           2556 LOAD_ATTR               11 (shape)
           2566 UNPACK_SEQUENCE          2
           2570 STORE_FAST              22 (batch_size)
           2572 STORE_FAST              23 (negative_size)

484        2574 LOAD_GLOBAL             15 (NULL + torch)
           2586 LOAD_ATTR               13 (index_select)
           2596 LOAD_FAST                0 (self)
           2598 LOAD_ATTR               14 (entity_embedding)
           2608 LOAD_CONST               2 (0)
           2610 LOAD_FAST               26 (negative_sample_union)
           2612 LOAD_METHOD             10 (view)
           2634 LOAD_CONST               6 (-1)
           2636 PRECALL                  1
           2640 CALL                     1
           2650 KW_NAMES                 7
           2652 PRECALL                  3
           2656 CALL                     3
           2666 LOAD_METHOD             10 (view)
           2688 LOAD_FAST               22 (batch_size)
           2690 LOAD_CONST               4 (1)
           2692 LOAD_FAST               23 (negative_size)
           2694 LOAD_CONST               6 (-1)
           2696 PRECALL                  4
           2700 CALL                     4
           2710 STORE_FAST              24 (negative_embedding)

485        2712 LOAD_FAST                0 (self)
           2714 LOAD_METHOD             15 (cal_logit_box)
           2736 LOAD_FAST               24 (negative_embedding)
           2738 LOAD_FAST                9 (all_union_center_embeddings)
           2740 LOAD_FAST               10 (all_union_offset_embeddings)
           2742 PRECALL                  3
           2746 CALL                     3
           2756 STORE_FAST              27 (negative_union_logit)

486        2758 LOAD_GLOBAL             15 (NULL + torch)
           2770 LOAD_ATTR               19 (max)
           2780 LOAD_FAST               27 (negative_union_logit)
           2782 LOAD_CONST               4 (1)
           2784 KW_NAMES                 3
           2786 PRECALL                  2
           2790 CALL                     2
           2800 LOAD_CONST               2 (0)
           2802 BINARY_SUBSCR
           2812 STORE_FAST              27 (negative_union_logit)
           2814 JUMP_FORWARD            49 (to 2914)

488     >> 2816 LOAD_GLOBAL             15 (NULL + torch)
           2828 LOAD_ATTR               16 (Tensor)
           2838 BUILD_LIST               0
           2840 PRECALL                  1
           2844 CALL                     1
           2854 LOAD_METHOD             17 (to)
           2876 LOAD_FAST                0 (self)
           2878 LOAD_ATTR               14 (entity_embedding)
           2888 LOAD_ATTR               18 (device)
           2898 PRECALL                  1
           2902 CALL                     1
           2912 STORE_FAST              27 (negative_union_logit)

489     >> 2914 LOAD_GLOBAL             15 (NULL + torch)
           2926 LOAD_ATTR                8 (cat)
           2936 LOAD_FAST               25 (negative_logit)
           2938 LOAD_FAST               27 (negative_union_logit)
           2940 BUILD_LIST               2
           2942 LOAD_CONST               2 (0)
           2944 KW_NAMES                 3
           2946 PRECALL                  2
           2950 CALL                     2
           2960 STORE_FAST              25 (negative_logit)
           2962 JUMP_FORWARD             2 (to 2968)

491     >> 2964 LOAD_CONST               0 (None)
           2966 STORE_FAST              25 (negative_logit)

493     >> 2968 LOAD_FAST               18 (positive_logit)
           2970 LOAD_FAST               25 (negative_logit)
           2972 LOAD_FAST                3 (subsampling_weight)
           2974 LOAD_FAST                8 (all_idxs)
           2976 LOAD_FAST               11 (all_union_idxs)
           2978 BINARY_OP                0 (+)
           2982 BUILD_TUPLE              4
           2984 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box) (inline depth: 1)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), NNModuleVariable()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 348 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE PRECALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
                                                        ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                             query_structure,
                                                                             ^^^^^^^^^^^^^^^^
                                                                             0)
                                                                             ^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 3)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 3)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_BACKWARD 30 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 1186 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 1272 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2068 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2956 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2394 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_sample_regular = negative_sample[all_idxs]
                                          ~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_METHOD view [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE FX call view from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD view [TensorVariable()]
TRACE LOAD_FAST batch_size [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call view_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE PRECALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE inlined call cal_logit_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
                                 ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
413           0 RESUME                   0

414           2 LOAD_FAST                1 (entity_embedding)
              4 LOAD_FAST                2 (query_center_embedding)
              6 BINARY_OP               10 (-)
             10 LOAD_METHOD              0 (abs)
             32 PRECALL                  0
             36 CALL                     0
             46 STORE_FAST               4 (delta)

415          48 LOAD_GLOBAL              3 (NULL + F)
             60 LOAD_ATTR                2 (relu)
             70 LOAD_FAST                4 (delta)
             72 LOAD_FAST                3 (query_offset_embedding)
             74 BINARY_OP               10 (-)
             78 PRECALL                  1
             82 CALL                     1
             92 STORE_FAST               5 (distance_out)

416          94 LOAD_GLOBAL              7 (NULL + torch)
            106 LOAD_ATTR                4 (min)
            116 LOAD_FAST                4 (delta)
            118 LOAD_FAST                3 (query_offset_embedding)
            120 PRECALL                  2
            124 CALL                     2
            134 STORE_FAST               6 (distance_in)

417         136 LOAD_FAST                0 (self)
            138 LOAD_ATTR                5 (gamma)
            148 LOAD_GLOBAL              7 (NULL + torch)
            160 LOAD_ATTR                6 (norm)
            170 LOAD_FAST                5 (distance_out)
            172 LOAD_CONST               1 (1)
            174 LOAD_CONST               2 (-1)
            176 KW_NAMES                 3
            178 PRECALL                  3
            182 CALL                     3
            192 BINARY_OP               10 (-)
            196 LOAD_FAST                0 (self)
            198 LOAD_ATTR                7 (cen)
            208 LOAD_GLOBAL              7 (NULL + torch)
            220 LOAD_ATTR                6 (norm)
            230 LOAD_FAST                6 (distance_in)
            232 LOAD_CONST               1 (1)
            234 LOAD_CONST               2 (-1)
            236 KW_NAMES                 3
            238 PRECALL                  3
            242 CALL                     3
            252 BINARY_OP                5 (*)
            256 BINARY_OP               10 (-)
            260 STORE_FAST               7 (logit)

418         262 LOAD_FAST                7 (logit)
            264 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        delta = (entity_embedding - query_center_embedding).abs()
                 ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_METHOD abs [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE FX call abs_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        delta = (entity_embedding - query_center_embedding).abs()
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable(), TensorVariable()]
TRACE FX call sub_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_out = F.relu(delta - query_offset_embedding)
                              ~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_out = F.relu(delta - query_offset_embedding)
                       ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_in = torch.min(delta, query_offset_embedding)
                      ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                             ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                                ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                     ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2492 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2808 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [NullVariable, TorchVariable(<class 'torch.Tensor'>)]
TRACE PRECALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE CALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE FX call tensor from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~^^^^
TRACE LOAD_METHOD to [TensorVariable()]
TRACE LOAD_FAST self [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [NullVariable, GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE FX call to from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST negative_union_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable()]
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2960 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_OP 0 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object forward_box at 0x7316500, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 420>
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 196 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_0 =====
 <eval_with_key>.0 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_0 <eval_with_key>.0 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7fad600718a0>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7fad600718a0>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7facb1c64220>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7fad600718a0>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7facb1a74d60>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7facb1a74d60>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7fad600718a0>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_0 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:194
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:194 in forward (KGReasoning.forward)
        def forward(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:195 in forward (KGReasoning.forward)
            if self.geo == 'box':
TRACE LOAD_FAST self []
TRACE LOAD_ATTR geo [LazyVariableTracker()]
TRACE LOAD_CONST box [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 74 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:196 in forward (KGReasoning.forward)
                return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD forward_box [NNModuleVariable()]
TRACE LOAD_FAST positive_sample [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable())]
TRACE LOAD_FAST negative_sample [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_FAST subsampling_weight [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_queries_dict [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_idxs_dict [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE PRECALL 5 [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call forward_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:196 in forward (KGReasoning.forward)
            return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
                   ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object forward_box at 0x7316500, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 420>
420           0 RESUME                   0

421           2 BUILD_LIST               0
              4 BUILD_LIST               0
              6 BUILD_LIST               0
              8 STORE_FAST               8 (all_idxs)
             10 STORE_FAST               7 (all_offset_embeddings)
             12 STORE_FAST               6 (all_center_embeddings)

422          14 BUILD_LIST               0
             16 BUILD_LIST               0
             18 BUILD_LIST               0
             20 STORE_FAST              11 (all_union_idxs)
             22 STORE_FAST              10 (all_union_offset_embeddings)
             24 STORE_FAST               9 (all_union_center_embeddings)

423          26 LOAD_FAST                4 (batch_queries_dict)
             28 GET_ITER
        >>   30 EXTENDED_ARG             1
             32 FOR_ITER               262 (to 558)
             34 STORE_FAST              12 (query_structure)

424          36 LOAD_CONST               1 ('u')
             38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                0 (query_name_dict)
             50 LOAD_FAST               12 (query_structure)
             52 BINARY_SUBSCR
             62 CONTAINS_OP              0
             64 POP_JUMP_FORWARD_IF_FALSE   142 (to 350)

426          66 LOAD_FAST                0 (self)
             68 LOAD_METHOD              1 (embed_query_box)
             90 LOAD_FAST                0 (self)
             92 LOAD_METHOD              2 (transform_union_query)
            114 LOAD_FAST                4 (batch_queries_dict)
            116 LOAD_FAST               12 (query_structure)
            118 BINARY_SUBSCR

427         128 LOAD_FAST               12 (query_structure)

426         130 PRECALL                  2
            134 CALL                     2

428         144 LOAD_FAST                0 (self)
            146 LOAD_METHOD              3 (transform_union_structure)
            168 LOAD_FAST               12 (query_structure)
            170 PRECALL                  1
            174 CALL                     1

429         184 LOAD_CONST               2 (0)

426         186 PRECALL                  3
            190 CALL                     3

425         200 UNPACK_SEQUENCE          3
            204 STORE_FAST              13 (center_embedding)
            206 STORE_FAST              14 (offset_embedding)
            208 STORE_FAST              15 (_)

430         210 LOAD_FAST                9 (all_union_center_embeddings)
            212 LOAD_METHOD              4 (append)
            234 LOAD_FAST               13 (center_embedding)
            236 PRECALL                  1
            240 CALL                     1
            250 POP_TOP

431         252 LOAD_FAST               10 (all_union_offset_embeddings)
            254 LOAD_METHOD              4 (append)
            276 LOAD_FAST               14 (offset_embedding)
            278 PRECALL                  1
            282 CALL                     1
            292 POP_TOP

432         294 LOAD_FAST               11 (all_union_idxs)
            296 LOAD_METHOD              5 (extend)
            318 LOAD_FAST                5 (batch_idxs_dict)
            320 LOAD_FAST               12 (query_structure)
            322 BINARY_SUBSCR
            332 PRECALL                  1
            336 CALL                     1
            346 POP_TOP
            348 JUMP_BACKWARD          160 (to 30)

434     >>  350 LOAD_FAST                0 (self)
            352 LOAD_METHOD              1 (embed_query_box)
            374 LOAD_FAST                4 (batch_queries_dict)
            376 LOAD_FAST               12 (query_structure)
            378 BINARY_SUBSCR

435         388 LOAD_FAST               12 (query_structure)

436         390 LOAD_CONST               2 (0)

434         392 PRECALL                  3
            396 CALL                     3
            406 UNPACK_SEQUENCE          3
            410 STORE_FAST              13 (center_embedding)
            412 STORE_FAST              14 (offset_embedding)
            414 STORE_FAST              15 (_)

437         416 LOAD_FAST                6 (all_center_embeddings)
            418 LOAD_METHOD              4 (append)
            440 LOAD_FAST               13 (center_embedding)
            442 PRECALL                  1
            446 CALL                     1
            456 POP_TOP

438         458 LOAD_FAST                7 (all_offset_embeddings)
            460 LOAD_METHOD              4 (append)
            482 LOAD_FAST               14 (offset_embedding)
            484 PRECALL                  1
            488 CALL                     1
            498 POP_TOP

439         500 LOAD_FAST                8 (all_idxs)
            502 LOAD_METHOD              5 (extend)
            524 LOAD_FAST                5 (batch_idxs_dict)
            526 LOAD_FAST               12 (query_structure)
            528 BINARY_SUBSCR
            538 PRECALL                  1
            542 CALL                     1
            552 POP_TOP
            554 EXTENDED_ARG             1
            556 JUMP_BACKWARD          264 (to 30)

441     >>  558 LOAD_GLOBAL             13 (NULL + len)
            570 LOAD_FAST                6 (all_center_embeddings)
            572 PRECALL                  1
            576 CALL                     1
            586 LOAD_CONST               2 (0)
            588 COMPARE_OP               4 (>)
            594 POP_JUMP_FORWARD_IF_FALSE   101 (to 798)
            596 LOAD_GLOBAL             13 (NULL + len)
            608 LOAD_FAST                7 (all_offset_embeddings)
            610 PRECALL                  1
            614 CALL                     1
            624 LOAD_CONST               2 (0)
            626 COMPARE_OP               4 (>)
            632 POP_JUMP_FORWARD_IF_FALSE    82 (to 798)

442         634 LOAD_GLOBAL             15 (NULL + torch)
            646 LOAD_ATTR                8 (cat)
            656 LOAD_FAST                6 (all_center_embeddings)
            658 LOAD_CONST               2 (0)
            660 KW_NAMES                 3
            662 PRECALL                  2
            666 CALL                     2
            676 LOAD_METHOD              9 (unsqueeze)
            698 LOAD_CONST               4 (1)
            700 PRECALL                  1
            704 CALL                     1
            714 STORE_FAST               6 (all_center_embeddings)

443         716 LOAD_GLOBAL             15 (NULL + torch)
            728 LOAD_ATTR                8 (cat)
            738 LOAD_FAST                7 (all_offset_embeddings)
            740 LOAD_CONST               2 (0)
            742 KW_NAMES                 3
            744 PRECALL                  2
            748 CALL                     2
            758 LOAD_METHOD              9 (unsqueeze)
            780 LOAD_CONST               4 (1)
            782 PRECALL                  1
            786 CALL                     1
            796 STORE_FAST               7 (all_offset_embeddings)

444     >>  798 LOAD_GLOBAL             13 (NULL + len)
            810 LOAD_FAST                9 (all_union_center_embeddings)
            812 PRECALL                  1
            816 CALL                     1
            826 LOAD_CONST               2 (0)
            828 COMPARE_OP               4 (>)
            834 POP_JUMP_FORWARD_IF_FALSE   177 (to 1190)
            836 LOAD_GLOBAL             13 (NULL + len)
            848 LOAD_FAST               10 (all_union_offset_embeddings)
            850 PRECALL                  1
            854 CALL                     1
            864 LOAD_CONST               2 (0)
            866 COMPARE_OP               4 (>)
            872 POP_JUMP_FORWARD_IF_FALSE   158 (to 1190)

445         874 LOAD_GLOBAL             15 (NULL + torch)
            886 LOAD_ATTR                8 (cat)
            896 LOAD_FAST                9 (all_union_center_embeddings)
            898 LOAD_CONST               2 (0)
            900 KW_NAMES                 3
            902 PRECALL                  2
            906 CALL                     2
            916 LOAD_METHOD              9 (unsqueeze)
            938 LOAD_CONST               4 (1)
            940 PRECALL                  1
            944 CALL                     1
            954 STORE_FAST               9 (all_union_center_embeddings)

446         956 LOAD_GLOBAL             15 (NULL + torch)
            968 LOAD_ATTR                8 (cat)
            978 LOAD_FAST               10 (all_union_offset_embeddings)
            980 LOAD_CONST               2 (0)
            982 KW_NAMES                 3
            984 PRECALL                  2
            988 CALL                     2
            998 LOAD_METHOD              9 (unsqueeze)
           1020 LOAD_CONST               4 (1)
           1022 PRECALL                  1
           1026 CALL                     1
           1036 STORE_FAST              10 (all_union_offset_embeddings)

447        1038 LOAD_FAST                9 (all_union_center_embeddings)
           1040 LOAD_METHOD             10 (view)
           1062 LOAD_FAST                9 (all_union_center_embeddings)
           1064 LOAD_ATTR               11 (shape)
           1074 LOAD_CONST               2 (0)
           1076 BINARY_SUBSCR
           1086 LOAD_CONST               5 (2)
           1088 BINARY_OP                2 (//)
           1092 LOAD_CONST               5 (2)
           1094 LOAD_CONST               4 (1)
           1096 LOAD_CONST               6 (-1)
           1098 PRECALL                  4
           1102 CALL                     4
           1112 STORE_FAST               9 (all_union_center_embeddings)

448        1114 LOAD_FAST               10 (all_union_offset_embeddings)
           1116 LOAD_METHOD             10 (view)
           1138 LOAD_FAST               10 (all_union_offset_embeddings)
           1140 LOAD_ATTR               11 (shape)
           1150 LOAD_CONST               2 (0)
           1152 BINARY_SUBSCR
           1162 LOAD_CONST               5 (2)
           1164 BINARY_OP                2 (//)
           1168 LOAD_CONST               5 (2)
           1170 LOAD_CONST               4 (1)
           1172 LOAD_CONST               6 (-1)
           1174 PRECALL                  4
           1178 CALL                     4
           1188 STORE_FAST              10 (all_union_offset_embeddings)

450     >> 1190 LOAD_GLOBAL             25 (NULL + type)
           1202 LOAD_FAST                3 (subsampling_weight)
           1204 PRECALL                  1
           1208 CALL                     1
           1218 LOAD_GLOBAL             25 (NULL + type)
           1230 LOAD_CONST               0 (None)
           1232 PRECALL                  1
           1236 CALL                     1
           1246 COMPARE_OP               3 (!=)
           1252 POP_JUMP_FORWARD_IF_FALSE    11 (to 1276)

451        1254 LOAD_FAST                3 (subsampling_weight)
           1256 LOAD_FAST                8 (all_idxs)
           1258 LOAD_FAST               11 (all_union_idxs)
           1260 BINARY_OP                0 (+)
           1264 BINARY_SUBSCR
           1274 STORE_FAST               3 (subsampling_weight)

453     >> 1276 LOAD_GLOBAL             25 (NULL + type)
           1288 LOAD_FAST                1 (positive_sample)
           1290 PRECALL                  1
           1294 CALL                     1
           1304 LOAD_GLOBAL             25 (NULL + type)
           1316 LOAD_CONST               0 (None)
           1318 PRECALL                  1
           1322 CALL                     1
           1332 COMPARE_OP               3 (!=)
           1338 EXTENDED_ARG             1
           1340 POP_JUMP_FORWARD_IF_FALSE   366 (to 2074)

454        1342 LOAD_GLOBAL             13 (NULL + len)
           1354 LOAD_FAST                6 (all_center_embeddings)
           1356 PRECALL                  1
           1360 CALL                     1
           1370 LOAD_CONST               2 (0)
           1372 COMPARE_OP               4 (>)
           1378 POP_JUMP_FORWARD_IF_FALSE    79 (to 1538)

455        1380 LOAD_FAST                1 (positive_sample)
           1382 LOAD_FAST                8 (all_idxs)
           1384 BINARY_SUBSCR
           1394 STORE_FAST              16 (positive_sample_regular)

456        1396 LOAD_GLOBAL             15 (NULL + torch)
           1408 LOAD_ATTR               13 (index_select)
           1418 LOAD_FAST                0 (self)
           1420 LOAD_ATTR               14 (entity_embedding)
           1430 LOAD_CONST               2 (0)
           1432 LOAD_FAST               16 (positive_sample_regular)
           1434 KW_NAMES                 7
           1436 PRECALL                  3
           1440 CALL                     3
           1450 LOAD_METHOD              9 (unsqueeze)
           1472 LOAD_CONST               4 (1)
           1474 PRECALL                  1
           1478 CALL                     1
           1488 STORE_FAST              17 (positive_embedding)

457        1490 LOAD_FAST                0 (self)
           1492 LOAD_METHOD             15 (cal_logit_box)
           1514 LOAD_FAST               17 (positive_embedding)
           1516 LOAD_FAST                6 (all_center_embeddings)
           1518 LOAD_FAST                7 (all_offset_embeddings)
           1520 PRECALL                  3
           1524 CALL                     3
           1534 STORE_FAST              18 (positive_logit)
           1536 JUMP_FORWARD            49 (to 1636)

459     >> 1538 LOAD_GLOBAL             15 (NULL + torch)
           1550 LOAD_ATTR               16 (Tensor)
           1560 BUILD_LIST               0
           1562 PRECALL                  1
           1566 CALL                     1
           1576 LOAD_METHOD             17 (to)
           1598 LOAD_FAST                0 (self)
           1600 LOAD_ATTR               14 (entity_embedding)
           1610 LOAD_ATTR               18 (device)
           1620 PRECALL                  1
           1624 CALL                     1
           1634 STORE_FAST              18 (positive_logit)

461     >> 1636 LOAD_GLOBAL             13 (NULL + len)
           1648 LOAD_FAST                9 (all_union_center_embeddings)
           1650 PRECALL                  1
           1654 CALL                     1
           1664 LOAD_CONST               2 (0)
           1666 COMPARE_OP               4 (>)
           1672 POP_JUMP_FORWARD_IF_FALSE   126 (to 1926)

462        1674 LOAD_FAST                1 (positive_sample)
           1676 LOAD_FAST               11 (all_union_idxs)
           1678 BINARY_SUBSCR
           1688 STORE_FAST              19 (positive_sample_union)

463        1690 LOAD_GLOBAL             15 (NULL + torch)
           1702 LOAD_ATTR               13 (index_select)
           1712 LOAD_FAST                0 (self)
           1714 LOAD_ATTR               14 (entity_embedding)
           1724 LOAD_CONST               2 (0)
           1726 LOAD_FAST               19 (positive_sample_union)
           1728 KW_NAMES                 7
           1730 PRECALL                  3
           1734 CALL                     3
           1744 LOAD_METHOD              9 (unsqueeze)
           1766 LOAD_CONST               4 (1)
           1768 PRECALL                  1
           1772 CALL                     1
           1782 LOAD_METHOD              9 (unsqueeze)
           1804 LOAD_CONST               4 (1)
           1806 PRECALL                  1
           1810 CALL                     1
           1820 STORE_FAST              17 (positive_embedding)

464        1822 LOAD_FAST                0 (self)
           1824 LOAD_METHOD             15 (cal_logit_box)
           1846 LOAD_FAST               17 (positive_embedding)
           1848 LOAD_FAST                9 (all_union_center_embeddings)
           1850 LOAD_FAST               10 (all_union_offset_embeddings)
           1852 PRECALL                  3
           1856 CALL                     3
           1866 STORE_FAST              20 (positive_union_logit)

465        1868 LOAD_GLOBAL             15 (NULL + torch)
           1880 LOAD_ATTR               19 (max)
           1890 LOAD_FAST               20 (positive_union_logit)
           1892 LOAD_CONST               4 (1)
           1894 KW_NAMES                 3
           1896 PRECALL                  2
           1900 CALL                     2
           1910 LOAD_CONST               2 (0)
           1912 BINARY_SUBSCR
           1922 STORE_FAST              20 (positive_union_logit)
           1924 JUMP_FORWARD            49 (to 2024)

467     >> 1926 LOAD_GLOBAL             15 (NULL + torch)
           1938 LOAD_ATTR               16 (Tensor)
           1948 BUILD_LIST               0
           1950 PRECALL                  1
           1954 CALL                     1
           1964 LOAD_METHOD             17 (to)
           1986 LOAD_FAST                0 (self)
           1988 LOAD_ATTR               14 (entity_embedding)
           1998 LOAD_ATTR               18 (device)
           2008 PRECALL                  1
           2012 CALL                     1
           2022 STORE_FAST              20 (positive_union_logit)

468     >> 2024 LOAD_GLOBAL             15 (NULL + torch)
           2036 LOAD_ATTR                8 (cat)
           2046 LOAD_FAST               18 (positive_logit)
           2048 LOAD_FAST               20 (positive_union_logit)
           2050 BUILD_LIST               2
           2052 LOAD_CONST               2 (0)
           2054 KW_NAMES                 3
           2056 PRECALL                  2
           2060 CALL                     2
           2070 STORE_FAST              18 (positive_logit)
           2072 JUMP_FORWARD             2 (to 2078)

470     >> 2074 LOAD_CONST               0 (None)
           2076 STORE_FAST              18 (positive_logit)

472     >> 2078 LOAD_GLOBAL             25 (NULL + type)
           2090 LOAD_FAST                2 (negative_sample)
           2092 PRECALL                  1
           2096 CALL                     1
           2106 LOAD_GLOBAL             25 (NULL + type)
           2118 LOAD_CONST               0 (None)
           2120 PRECALL                  1
           2124 CALL                     1
           2134 COMPARE_OP               3 (!=)
           2140 EXTENDED_ARG             1
           2142 POP_JUMP_FORWARD_IF_FALSE   410 (to 2964)

473        2144 LOAD_GLOBAL             13 (NULL + len)
           2156 LOAD_FAST                6 (all_center_embeddings)
           2158 PRECALL                  1
           2162 CALL                     1
           2172 LOAD_CONST               2 (0)
           2174 COMPARE_OP               4 (>)
           2180 POP_JUMP_FORWARD_IF_FALSE   110 (to 2402)

474        2182 LOAD_FAST                2 (negative_sample)
           2184 LOAD_FAST                8 (all_idxs)
           2186 BINARY_SUBSCR
           2196 STORE_FAST              21 (negative_sample_regular)

475        2198 LOAD_FAST               21 (negative_sample_regular)
           2200 LOAD_ATTR               11 (shape)
           2210 UNPACK_SEQUENCE          2
           2214 STORE_FAST              22 (batch_size)
           2216 STORE_FAST              23 (negative_size)

476        2218 LOAD_GLOBAL             15 (NULL + torch)
           2230 LOAD_ATTR               13 (index_select)
           2240 LOAD_FAST                0 (self)
           2242 LOAD_ATTR               14 (entity_embedding)
           2252 LOAD_CONST               2 (0)
           2254 LOAD_FAST               21 (negative_sample_regular)
           2256 LOAD_METHOD             10 (view)
           2278 LOAD_CONST               6 (-1)
           2280 PRECALL                  1
           2284 CALL                     1
           2294 KW_NAMES                 7
           2296 PRECALL                  3
           2300 CALL                     3
           2310 LOAD_METHOD             10 (view)
           2332 LOAD_FAST               22 (batch_size)
           2334 LOAD_FAST               23 (negative_size)
           2336 LOAD_CONST               6 (-1)
           2338 PRECALL                  3
           2342 CALL                     3
           2352 STORE_FAST              24 (negative_embedding)

477        2354 LOAD_FAST                0 (self)
           2356 LOAD_METHOD             15 (cal_logit_box)
           2378 LOAD_FAST               24 (negative_embedding)
           2380 LOAD_FAST                6 (all_center_embeddings)
           2382 LOAD_FAST                7 (all_offset_embeddings)
           2384 PRECALL                  3
           2388 CALL                     3
           2398 STORE_FAST              25 (negative_logit)
           2400 JUMP_FORWARD            49 (to 2500)

479     >> 2402 LOAD_GLOBAL             15 (NULL + torch)
           2414 LOAD_ATTR               16 (Tensor)
           2424 BUILD_LIST               0
           2426 PRECALL                  1
           2430 CALL                     1
           2440 LOAD_METHOD             17 (to)
           2462 LOAD_FAST                0 (self)
           2464 LOAD_ATTR               14 (entity_embedding)
           2474 LOAD_ATTR               18 (device)
           2484 PRECALL                  1
           2488 CALL                     1
           2498 STORE_FAST              25 (negative_logit)

481     >> 2500 LOAD_GLOBAL             13 (NULL + len)
           2512 LOAD_FAST                9 (all_union_center_embeddings)
           2514 PRECALL                  1
           2518 CALL                     1
           2528 LOAD_CONST               2 (0)
           2530 COMPARE_OP               4 (>)
           2536 POP_JUMP_FORWARD_IF_FALSE   139 (to 2816)

482        2538 LOAD_FAST                2 (negative_sample)
           2540 LOAD_FAST               11 (all_union_idxs)
           2542 BINARY_SUBSCR
           2552 STORE_FAST              26 (negative_sample_union)

483        2554 LOAD_FAST               26 (negative_sample_union)
           2556 LOAD_ATTR               11 (shape)
           2566 UNPACK_SEQUENCE          2
           2570 STORE_FAST              22 (batch_size)
           2572 STORE_FAST              23 (negative_size)

484        2574 LOAD_GLOBAL             15 (NULL + torch)
           2586 LOAD_ATTR               13 (index_select)
           2596 LOAD_FAST                0 (self)
           2598 LOAD_ATTR               14 (entity_embedding)
           2608 LOAD_CONST               2 (0)
           2610 LOAD_FAST               26 (negative_sample_union)
           2612 LOAD_METHOD             10 (view)
           2634 LOAD_CONST               6 (-1)
           2636 PRECALL                  1
           2640 CALL                     1
           2650 KW_NAMES                 7
           2652 PRECALL                  3
           2656 CALL                     3
           2666 LOAD_METHOD             10 (view)
           2688 LOAD_FAST               22 (batch_size)
           2690 LOAD_CONST               4 (1)
           2692 LOAD_FAST               23 (negative_size)
           2694 LOAD_CONST               6 (-1)
           2696 PRECALL                  4
           2700 CALL                     4
           2710 STORE_FAST              24 (negative_embedding)

485        2712 LOAD_FAST                0 (self)
           2714 LOAD_METHOD             15 (cal_logit_box)
           2736 LOAD_FAST               24 (negative_embedding)
           2738 LOAD_FAST                9 (all_union_center_embeddings)
           2740 LOAD_FAST               10 (all_union_offset_embeddings)
           2742 PRECALL                  3
           2746 CALL                     3
           2756 STORE_FAST              27 (negative_union_logit)

486        2758 LOAD_GLOBAL             15 (NULL + torch)
           2770 LOAD_ATTR               19 (max)
           2780 LOAD_FAST               27 (negative_union_logit)
           2782 LOAD_CONST               4 (1)
           2784 KW_NAMES                 3
           2786 PRECALL                  2
           2790 CALL                     2
           2800 LOAD_CONST               2 (0)
           2802 BINARY_SUBSCR
           2812 STORE_FAST              27 (negative_union_logit)
           2814 JUMP_FORWARD            49 (to 2914)

488     >> 2816 LOAD_GLOBAL             15 (NULL + torch)
           2828 LOAD_ATTR               16 (Tensor)
           2838 BUILD_LIST               0
           2840 PRECALL                  1
           2844 CALL                     1
           2854 LOAD_METHOD             17 (to)
           2876 LOAD_FAST                0 (self)
           2878 LOAD_ATTR               14 (entity_embedding)
           2888 LOAD_ATTR               18 (device)
           2898 PRECALL                  1
           2902 CALL                     1
           2912 STORE_FAST              27 (negative_union_logit)

489     >> 2914 LOAD_GLOBAL             15 (NULL + torch)
           2926 LOAD_ATTR                8 (cat)
           2936 LOAD_FAST               25 (negative_logit)
           2938 LOAD_FAST               27 (negative_union_logit)
           2940 BUILD_LIST               2
           2942 LOAD_CONST               2 (0)
           2944 KW_NAMES                 3
           2946 PRECALL                  2
           2950 CALL                     2
           2960 STORE_FAST              25 (negative_logit)
           2962 JUMP_FORWARD             2 (to 2968)

491     >> 2964 LOAD_CONST               0 (None)
           2966 STORE_FAST              25 (negative_logit)

493     >> 2968 LOAD_FAST               18 (positive_logit)
           2970 LOAD_FAST               25 (negative_logit)
           2972 LOAD_FAST                3 (subsampling_weight)
           2974 LOAD_FAST                8 (all_idxs)
           2976 LOAD_FAST               11 (all_union_idxs)
           2978 BINARY_OP                0 (+)
           2982 BUILD_TUPLE              4
           2984 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box) (inline depth: 1)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), NNModuleVariable()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 348 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE PRECALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
                                                        ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                             query_structure,
                                                                             ^^^^^^^^^^^^^^^^
                                                                             0)
                                                                             ^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 3)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 3)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_BACKWARD 30 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 1186 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 1272 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2068 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2956 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2394 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_sample_regular = negative_sample[all_idxs]
                                          ~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_METHOD view [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE FX call view from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD view [TensorVariable()]
TRACE LOAD_FAST batch_size [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call view_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE PRECALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE inlined call cal_logit_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
                                 ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
413           0 RESUME                   0

414           2 LOAD_FAST                1 (entity_embedding)
              4 LOAD_FAST                2 (query_center_embedding)
              6 BINARY_OP               10 (-)
             10 LOAD_METHOD              0 (abs)
             32 PRECALL                  0
             36 CALL                     0
             46 STORE_FAST               4 (delta)

415          48 LOAD_GLOBAL              3 (NULL + F)
             60 LOAD_ATTR                2 (relu)
             70 LOAD_FAST                4 (delta)
             72 LOAD_FAST                3 (query_offset_embedding)
             74 BINARY_OP               10 (-)
             78 PRECALL                  1
             82 CALL                     1
             92 STORE_FAST               5 (distance_out)

416          94 LOAD_GLOBAL              7 (NULL + torch)
            106 LOAD_ATTR                4 (min)
            116 LOAD_FAST                4 (delta)
            118 LOAD_FAST                3 (query_offset_embedding)
            120 PRECALL                  2
            124 CALL                     2
            134 STORE_FAST               6 (distance_in)

417         136 LOAD_FAST                0 (self)
            138 LOAD_ATTR                5 (gamma)
            148 LOAD_GLOBAL              7 (NULL + torch)
            160 LOAD_ATTR                6 (norm)
            170 LOAD_FAST                5 (distance_out)
            172 LOAD_CONST               1 (1)
            174 LOAD_CONST               2 (-1)
            176 KW_NAMES                 3
            178 PRECALL                  3
            182 CALL                     3
            192 BINARY_OP               10 (-)
            196 LOAD_FAST                0 (self)
            198 LOAD_ATTR                7 (cen)
            208 LOAD_GLOBAL              7 (NULL + torch)
            220 LOAD_ATTR                6 (norm)
            230 LOAD_FAST                6 (distance_in)
            232 LOAD_CONST               1 (1)
            234 LOAD_CONST               2 (-1)
            236 KW_NAMES                 3
            238 PRECALL                  3
            242 CALL                     3
            252 BINARY_OP                5 (*)
            256 BINARY_OP               10 (-)
            260 STORE_FAST               7 (logit)

418         262 LOAD_FAST                7 (logit)
            264 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        delta = (entity_embedding - query_center_embedding).abs()
                 ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_METHOD abs [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE FX call abs_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        delta = (entity_embedding - query_center_embedding).abs()
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable(), TensorVariable()]
TRACE FX call sub_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_out = F.relu(delta - query_offset_embedding)
                              ~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_out = F.relu(delta - query_offset_embedding)
                       ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_in = torch.min(delta, query_offset_embedding)
                      ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                             ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                                ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                     ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2492 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2808 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [NullVariable, TorchVariable(<class 'torch.Tensor'>)]
TRACE PRECALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE CALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE FX call tensor from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~^^^^
TRACE LOAD_METHOD to [TensorVariable()]
TRACE LOAD_FAST self [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [NullVariable, GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE FX call to from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST negative_union_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable()]
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2960 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_OP 0 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object forward_box at 0x7316500, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 420>
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 196 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_1 =====
 <eval_with_key>.45 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_1 <eval_with_key>.45 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7fad600718a0>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7fad600718a0>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7facb1c64220>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7fad600718a0>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7facb1a74d60>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7facb1a74d60>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7fad600718a0>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_1 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:194
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:194 in forward (KGReasoning.forward)
        def forward(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:195 in forward (KGReasoning.forward)
            if self.geo == 'box':
TRACE LOAD_FAST self []
TRACE LOAD_ATTR geo [LazyVariableTracker()]
TRACE LOAD_CONST box [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 74 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:196 in forward (KGReasoning.forward)
                return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD forward_box [NNModuleVariable()]
TRACE LOAD_FAST positive_sample [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable())]
TRACE LOAD_FAST negative_sample [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_FAST subsampling_weight [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_queries_dict [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_idxs_dict [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE PRECALL 5 [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call forward_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:196 in forward (KGReasoning.forward)
            return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
                   ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object forward_box at 0x7316500, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 420>
420           0 RESUME                   0

421           2 BUILD_LIST               0
              4 BUILD_LIST               0
              6 BUILD_LIST               0
              8 STORE_FAST               8 (all_idxs)
             10 STORE_FAST               7 (all_offset_embeddings)
             12 STORE_FAST               6 (all_center_embeddings)

422          14 BUILD_LIST               0
             16 BUILD_LIST               0
             18 BUILD_LIST               0
             20 STORE_FAST              11 (all_union_idxs)
             22 STORE_FAST              10 (all_union_offset_embeddings)
             24 STORE_FAST               9 (all_union_center_embeddings)

423          26 LOAD_FAST                4 (batch_queries_dict)
             28 GET_ITER
        >>   30 EXTENDED_ARG             1
             32 FOR_ITER               262 (to 558)
             34 STORE_FAST              12 (query_structure)

424          36 LOAD_CONST               1 ('u')
             38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                0 (query_name_dict)
             50 LOAD_FAST               12 (query_structure)
             52 BINARY_SUBSCR
             62 CONTAINS_OP              0
             64 POP_JUMP_FORWARD_IF_FALSE   142 (to 350)

426          66 LOAD_FAST                0 (self)
             68 LOAD_METHOD              1 (embed_query_box)
             90 LOAD_FAST                0 (self)
             92 LOAD_METHOD              2 (transform_union_query)
            114 LOAD_FAST                4 (batch_queries_dict)
            116 LOAD_FAST               12 (query_structure)
            118 BINARY_SUBSCR

427         128 LOAD_FAST               12 (query_structure)

426         130 PRECALL                  2
            134 CALL                     2

428         144 LOAD_FAST                0 (self)
            146 LOAD_METHOD              3 (transform_union_structure)
            168 LOAD_FAST               12 (query_structure)
            170 PRECALL                  1
            174 CALL                     1

429         184 LOAD_CONST               2 (0)

426         186 PRECALL                  3
            190 CALL                     3

425         200 UNPACK_SEQUENCE          3
            204 STORE_FAST              13 (center_embedding)
            206 STORE_FAST              14 (offset_embedding)
            208 STORE_FAST              15 (_)

430         210 LOAD_FAST                9 (all_union_center_embeddings)
            212 LOAD_METHOD              4 (append)
            234 LOAD_FAST               13 (center_embedding)
            236 PRECALL                  1
            240 CALL                     1
            250 POP_TOP

431         252 LOAD_FAST               10 (all_union_offset_embeddings)
            254 LOAD_METHOD              4 (append)
            276 LOAD_FAST               14 (offset_embedding)
            278 PRECALL                  1
            282 CALL                     1
            292 POP_TOP

432         294 LOAD_FAST               11 (all_union_idxs)
            296 LOAD_METHOD              5 (extend)
            318 LOAD_FAST                5 (batch_idxs_dict)
            320 LOAD_FAST               12 (query_structure)
            322 BINARY_SUBSCR
            332 PRECALL                  1
            336 CALL                     1
            346 POP_TOP
            348 JUMP_BACKWARD          160 (to 30)

434     >>  350 LOAD_FAST                0 (self)
            352 LOAD_METHOD              1 (embed_query_box)
            374 LOAD_FAST                4 (batch_queries_dict)
            376 LOAD_FAST               12 (query_structure)
            378 BINARY_SUBSCR

435         388 LOAD_FAST               12 (query_structure)

436         390 LOAD_CONST               2 (0)

434         392 PRECALL                  3
            396 CALL                     3
            406 UNPACK_SEQUENCE          3
            410 STORE_FAST              13 (center_embedding)
            412 STORE_FAST              14 (offset_embedding)
            414 STORE_FAST              15 (_)

437         416 LOAD_FAST                6 (all_center_embeddings)
            418 LOAD_METHOD              4 (append)
            440 LOAD_FAST               13 (center_embedding)
            442 PRECALL                  1
            446 CALL                     1
            456 POP_TOP

438         458 LOAD_FAST                7 (all_offset_embeddings)
            460 LOAD_METHOD              4 (append)
            482 LOAD_FAST               14 (offset_embedding)
            484 PRECALL                  1
            488 CALL                     1
            498 POP_TOP

439         500 LOAD_FAST                8 (all_idxs)
            502 LOAD_METHOD              5 (extend)
            524 LOAD_FAST                5 (batch_idxs_dict)
            526 LOAD_FAST               12 (query_structure)
            528 BINARY_SUBSCR
            538 PRECALL                  1
            542 CALL                     1
            552 POP_TOP
            554 EXTENDED_ARG             1
            556 JUMP_BACKWARD          264 (to 30)

441     >>  558 LOAD_GLOBAL             13 (NULL + len)
            570 LOAD_FAST                6 (all_center_embeddings)
            572 PRECALL                  1
            576 CALL                     1
            586 LOAD_CONST               2 (0)
            588 COMPARE_OP               4 (>)
            594 POP_JUMP_FORWARD_IF_FALSE   101 (to 798)
            596 LOAD_GLOBAL             13 (NULL + len)
            608 LOAD_FAST                7 (all_offset_embeddings)
            610 PRECALL                  1
            614 CALL                     1
            624 LOAD_CONST               2 (0)
            626 COMPARE_OP               4 (>)
            632 POP_JUMP_FORWARD_IF_FALSE    82 (to 798)

442         634 LOAD_GLOBAL             15 (NULL + torch)
            646 LOAD_ATTR                8 (cat)
            656 LOAD_FAST                6 (all_center_embeddings)
            658 LOAD_CONST               2 (0)
            660 KW_NAMES                 3
            662 PRECALL                  2
            666 CALL                     2
            676 LOAD_METHOD              9 (unsqueeze)
            698 LOAD_CONST               4 (1)
            700 PRECALL                  1
            704 CALL                     1
            714 STORE_FAST               6 (all_center_embeddings)

443         716 LOAD_GLOBAL             15 (NULL + torch)
            728 LOAD_ATTR                8 (cat)
            738 LOAD_FAST                7 (all_offset_embeddings)
            740 LOAD_CONST               2 (0)
            742 KW_NAMES                 3
            744 PRECALL                  2
            748 CALL                     2
            758 LOAD_METHOD              9 (unsqueeze)
            780 LOAD_CONST               4 (1)
            782 PRECALL                  1
            786 CALL                     1
            796 STORE_FAST               7 (all_offset_embeddings)

444     >>  798 LOAD_GLOBAL             13 (NULL + len)
            810 LOAD_FAST                9 (all_union_center_embeddings)
            812 PRECALL                  1
            816 CALL                     1
            826 LOAD_CONST               2 (0)
            828 COMPARE_OP               4 (>)
            834 POP_JUMP_FORWARD_IF_FALSE   177 (to 1190)
            836 LOAD_GLOBAL             13 (NULL + len)
            848 LOAD_FAST               10 (all_union_offset_embeddings)
            850 PRECALL                  1
            854 CALL                     1
            864 LOAD_CONST               2 (0)
            866 COMPARE_OP               4 (>)
            872 POP_JUMP_FORWARD_IF_FALSE   158 (to 1190)

445         874 LOAD_GLOBAL             15 (NULL + torch)
            886 LOAD_ATTR                8 (cat)
            896 LOAD_FAST                9 (all_union_center_embeddings)
            898 LOAD_CONST               2 (0)
            900 KW_NAMES                 3
            902 PRECALL                  2
            906 CALL                     2
            916 LOAD_METHOD              9 (unsqueeze)
            938 LOAD_CONST               4 (1)
            940 PRECALL                  1
            944 CALL                     1
            954 STORE_FAST               9 (all_union_center_embeddings)

446         956 LOAD_GLOBAL             15 (NULL + torch)
            968 LOAD_ATTR                8 (cat)
            978 LOAD_FAST               10 (all_union_offset_embeddings)
            980 LOAD_CONST               2 (0)
            982 KW_NAMES                 3
            984 PRECALL                  2
            988 CALL                     2
            998 LOAD_METHOD              9 (unsqueeze)
           1020 LOAD_CONST               4 (1)
           1022 PRECALL                  1
           1026 CALL                     1
           1036 STORE_FAST              10 (all_union_offset_embeddings)

447        1038 LOAD_FAST                9 (all_union_center_embeddings)
           1040 LOAD_METHOD             10 (view)
           1062 LOAD_FAST                9 (all_union_center_embeddings)
           1064 LOAD_ATTR               11 (shape)
           1074 LOAD_CONST               2 (0)
           1076 BINARY_SUBSCR
           1086 LOAD_CONST               5 (2)
           1088 BINARY_OP                2 (//)
           1092 LOAD_CONST               5 (2)
           1094 LOAD_CONST               4 (1)
           1096 LOAD_CONST               6 (-1)
           1098 PRECALL                  4
           1102 CALL                     4
           1112 STORE_FAST               9 (all_union_center_embeddings)

448        1114 LOAD_FAST               10 (all_union_offset_embeddings)
           1116 LOAD_METHOD             10 (view)
           1138 LOAD_FAST               10 (all_union_offset_embeddings)
           1140 LOAD_ATTR               11 (shape)
           1150 LOAD_CONST               2 (0)
           1152 BINARY_SUBSCR
           1162 LOAD_CONST               5 (2)
           1164 BINARY_OP                2 (//)
           1168 LOAD_CONST               5 (2)
           1170 LOAD_CONST               4 (1)
           1172 LOAD_CONST               6 (-1)
           1174 PRECALL                  4
           1178 CALL                     4
           1188 STORE_FAST              10 (all_union_offset_embeddings)

450     >> 1190 LOAD_GLOBAL             25 (NULL + type)
           1202 LOAD_FAST                3 (subsampling_weight)
           1204 PRECALL                  1
           1208 CALL                     1
           1218 LOAD_GLOBAL             25 (NULL + type)
           1230 LOAD_CONST               0 (None)
           1232 PRECALL                  1
           1236 CALL                     1
           1246 COMPARE_OP               3 (!=)
           1252 POP_JUMP_FORWARD_IF_FALSE    11 (to 1276)

451        1254 LOAD_FAST                3 (subsampling_weight)
           1256 LOAD_FAST                8 (all_idxs)
           1258 LOAD_FAST               11 (all_union_idxs)
           1260 BINARY_OP                0 (+)
           1264 BINARY_SUBSCR
           1274 STORE_FAST               3 (subsampling_weight)

453     >> 1276 LOAD_GLOBAL             25 (NULL + type)
           1288 LOAD_FAST                1 (positive_sample)
           1290 PRECALL                  1
           1294 CALL                     1
           1304 LOAD_GLOBAL             25 (NULL + type)
           1316 LOAD_CONST               0 (None)
           1318 PRECALL                  1
           1322 CALL                     1
           1332 COMPARE_OP               3 (!=)
           1338 EXTENDED_ARG             1
           1340 POP_JUMP_FORWARD_IF_FALSE   366 (to 2074)

454        1342 LOAD_GLOBAL             13 (NULL + len)
           1354 LOAD_FAST                6 (all_center_embeddings)
           1356 PRECALL                  1
           1360 CALL                     1
           1370 LOAD_CONST               2 (0)
           1372 COMPARE_OP               4 (>)
           1378 POP_JUMP_FORWARD_IF_FALSE    79 (to 1538)

455        1380 LOAD_FAST                1 (positive_sample)
           1382 LOAD_FAST                8 (all_idxs)
           1384 BINARY_SUBSCR
           1394 STORE_FAST              16 (positive_sample_regular)

456        1396 LOAD_GLOBAL             15 (NULL + torch)
           1408 LOAD_ATTR               13 (index_select)
           1418 LOAD_FAST                0 (self)
           1420 LOAD_ATTR               14 (entity_embedding)
           1430 LOAD_CONST               2 (0)
           1432 LOAD_FAST               16 (positive_sample_regular)
           1434 KW_NAMES                 7
           1436 PRECALL                  3
           1440 CALL                     3
           1450 LOAD_METHOD              9 (unsqueeze)
           1472 LOAD_CONST               4 (1)
           1474 PRECALL                  1
           1478 CALL                     1
           1488 STORE_FAST              17 (positive_embedding)

457        1490 LOAD_FAST                0 (self)
           1492 LOAD_METHOD             15 (cal_logit_box)
           1514 LOAD_FAST               17 (positive_embedding)
           1516 LOAD_FAST                6 (all_center_embeddings)
           1518 LOAD_FAST                7 (all_offset_embeddings)
           1520 PRECALL                  3
           1524 CALL                     3
           1534 STORE_FAST              18 (positive_logit)
           1536 JUMP_FORWARD            49 (to 1636)

459     >> 1538 LOAD_GLOBAL             15 (NULL + torch)
           1550 LOAD_ATTR               16 (Tensor)
           1560 BUILD_LIST               0
           1562 PRECALL                  1
           1566 CALL                     1
           1576 LOAD_METHOD             17 (to)
           1598 LOAD_FAST                0 (self)
           1600 LOAD_ATTR               14 (entity_embedding)
           1610 LOAD_ATTR               18 (device)
           1620 PRECALL                  1
           1624 CALL                     1
           1634 STORE_FAST              18 (positive_logit)

461     >> 1636 LOAD_GLOBAL             13 (NULL + len)
           1648 LOAD_FAST                9 (all_union_center_embeddings)
           1650 PRECALL                  1
           1654 CALL                     1
           1664 LOAD_CONST               2 (0)
           1666 COMPARE_OP               4 (>)
           1672 POP_JUMP_FORWARD_IF_FALSE   126 (to 1926)

462        1674 LOAD_FAST                1 (positive_sample)
           1676 LOAD_FAST               11 (all_union_idxs)
           1678 BINARY_SUBSCR
           1688 STORE_FAST              19 (positive_sample_union)

463        1690 LOAD_GLOBAL             15 (NULL + torch)
           1702 LOAD_ATTR               13 (index_select)
           1712 LOAD_FAST                0 (self)
           1714 LOAD_ATTR               14 (entity_embedding)
           1724 LOAD_CONST               2 (0)
           1726 LOAD_FAST               19 (positive_sample_union)
           1728 KW_NAMES                 7
           1730 PRECALL                  3
           1734 CALL                     3
           1744 LOAD_METHOD              9 (unsqueeze)
           1766 LOAD_CONST               4 (1)
           1768 PRECALL                  1
           1772 CALL                     1
           1782 LOAD_METHOD              9 (unsqueeze)
           1804 LOAD_CONST               4 (1)
           1806 PRECALL                  1
           1810 CALL                     1
           1820 STORE_FAST              17 (positive_embedding)

464        1822 LOAD_FAST                0 (self)
           1824 LOAD_METHOD             15 (cal_logit_box)
           1846 LOAD_FAST               17 (positive_embedding)
           1848 LOAD_FAST                9 (all_union_center_embeddings)
           1850 LOAD_FAST               10 (all_union_offset_embeddings)
           1852 PRECALL                  3
           1856 CALL                     3
           1866 STORE_FAST              20 (positive_union_logit)

465        1868 LOAD_GLOBAL             15 (NULL + torch)
           1880 LOAD_ATTR               19 (max)
           1890 LOAD_FAST               20 (positive_union_logit)
           1892 LOAD_CONST               4 (1)
           1894 KW_NAMES                 3
           1896 PRECALL                  2
           1900 CALL                     2
           1910 LOAD_CONST               2 (0)
           1912 BINARY_SUBSCR
           1922 STORE_FAST              20 (positive_union_logit)
           1924 JUMP_FORWARD            49 (to 2024)

467     >> 1926 LOAD_GLOBAL             15 (NULL + torch)
           1938 LOAD_ATTR               16 (Tensor)
           1948 BUILD_LIST               0
           1950 PRECALL                  1
           1954 CALL                     1
           1964 LOAD_METHOD             17 (to)
           1986 LOAD_FAST                0 (self)
           1988 LOAD_ATTR               14 (entity_embedding)
           1998 LOAD_ATTR               18 (device)
           2008 PRECALL                  1
           2012 CALL                     1
           2022 STORE_FAST              20 (positive_union_logit)

468     >> 2024 LOAD_GLOBAL             15 (NULL + torch)
           2036 LOAD_ATTR                8 (cat)
           2046 LOAD_FAST               18 (positive_logit)
           2048 LOAD_FAST               20 (positive_union_logit)
           2050 BUILD_LIST               2
           2052 LOAD_CONST               2 (0)
           2054 KW_NAMES                 3
           2056 PRECALL                  2
           2060 CALL                     2
           2070 STORE_FAST              18 (positive_logit)
           2072 JUMP_FORWARD             2 (to 2078)

470     >> 2074 LOAD_CONST               0 (None)
           2076 STORE_FAST              18 (positive_logit)

472     >> 2078 LOAD_GLOBAL             25 (NULL + type)
           2090 LOAD_FAST                2 (negative_sample)
           2092 PRECALL                  1
           2096 CALL                     1
           2106 LOAD_GLOBAL             25 (NULL + type)
           2118 LOAD_CONST               0 (None)
           2120 PRECALL                  1
           2124 CALL                     1
           2134 COMPARE_OP               3 (!=)
           2140 EXTENDED_ARG             1
           2142 POP_JUMP_FORWARD_IF_FALSE   410 (to 2964)

473        2144 LOAD_GLOBAL             13 (NULL + len)
           2156 LOAD_FAST                6 (all_center_embeddings)
           2158 PRECALL                  1
           2162 CALL                     1
           2172 LOAD_CONST               2 (0)
           2174 COMPARE_OP               4 (>)
           2180 POP_JUMP_FORWARD_IF_FALSE   110 (to 2402)

474        2182 LOAD_FAST                2 (negative_sample)
           2184 LOAD_FAST                8 (all_idxs)
           2186 BINARY_SUBSCR
           2196 STORE_FAST              21 (negative_sample_regular)

475        2198 LOAD_FAST               21 (negative_sample_regular)
           2200 LOAD_ATTR               11 (shape)
           2210 UNPACK_SEQUENCE          2
           2214 STORE_FAST              22 (batch_size)
           2216 STORE_FAST              23 (negative_size)

476        2218 LOAD_GLOBAL             15 (NULL + torch)
           2230 LOAD_ATTR               13 (index_select)
           2240 LOAD_FAST                0 (self)
           2242 LOAD_ATTR               14 (entity_embedding)
           2252 LOAD_CONST               2 (0)
           2254 LOAD_FAST               21 (negative_sample_regular)
           2256 LOAD_METHOD             10 (view)
           2278 LOAD_CONST               6 (-1)
           2280 PRECALL                  1
           2284 CALL                     1
           2294 KW_NAMES                 7
           2296 PRECALL                  3
           2300 CALL                     3
           2310 LOAD_METHOD             10 (view)
           2332 LOAD_FAST               22 (batch_size)
           2334 LOAD_FAST               23 (negative_size)
           2336 LOAD_CONST               6 (-1)
           2338 PRECALL                  3
           2342 CALL                     3
           2352 STORE_FAST              24 (negative_embedding)

477        2354 LOAD_FAST                0 (self)
           2356 LOAD_METHOD             15 (cal_logit_box)
           2378 LOAD_FAST               24 (negative_embedding)
           2380 LOAD_FAST                6 (all_center_embeddings)
           2382 LOAD_FAST                7 (all_offset_embeddings)
           2384 PRECALL                  3
           2388 CALL                     3
           2398 STORE_FAST              25 (negative_logit)
           2400 JUMP_FORWARD            49 (to 2500)

479     >> 2402 LOAD_GLOBAL             15 (NULL + torch)
           2414 LOAD_ATTR               16 (Tensor)
           2424 BUILD_LIST               0
           2426 PRECALL                  1
           2430 CALL                     1
           2440 LOAD_METHOD             17 (to)
           2462 LOAD_FAST                0 (self)
           2464 LOAD_ATTR               14 (entity_embedding)
           2474 LOAD_ATTR               18 (device)
           2484 PRECALL                  1
           2488 CALL                     1
           2498 STORE_FAST              25 (negative_logit)

481     >> 2500 LOAD_GLOBAL             13 (NULL + len)
           2512 LOAD_FAST                9 (all_union_center_embeddings)
           2514 PRECALL                  1
           2518 CALL                     1
           2528 LOAD_CONST               2 (0)
           2530 COMPARE_OP               4 (>)
           2536 POP_JUMP_FORWARD_IF_FALSE   139 (to 2816)

482        2538 LOAD_FAST                2 (negative_sample)
           2540 LOAD_FAST               11 (all_union_idxs)
           2542 BINARY_SUBSCR
           2552 STORE_FAST              26 (negative_sample_union)

483        2554 LOAD_FAST               26 (negative_sample_union)
           2556 LOAD_ATTR               11 (shape)
           2566 UNPACK_SEQUENCE          2
           2570 STORE_FAST              22 (batch_size)
           2572 STORE_FAST              23 (negative_size)

484        2574 LOAD_GLOBAL             15 (NULL + torch)
           2586 LOAD_ATTR               13 (index_select)
           2596 LOAD_FAST                0 (self)
           2598 LOAD_ATTR               14 (entity_embedding)
           2608 LOAD_CONST               2 (0)
           2610 LOAD_FAST               26 (negative_sample_union)
           2612 LOAD_METHOD             10 (view)
           2634 LOAD_CONST               6 (-1)
           2636 PRECALL                  1
           2640 CALL                     1
           2650 KW_NAMES                 7
           2652 PRECALL                  3
           2656 CALL                     3
           2666 LOAD_METHOD             10 (view)
           2688 LOAD_FAST               22 (batch_size)
           2690 LOAD_CONST               4 (1)
           2692 LOAD_FAST               23 (negative_size)
           2694 LOAD_CONST               6 (-1)
           2696 PRECALL                  4
           2700 CALL                     4
           2710 STORE_FAST              24 (negative_embedding)

485        2712 LOAD_FAST                0 (self)
           2714 LOAD_METHOD             15 (cal_logit_box)
           2736 LOAD_FAST               24 (negative_embedding)
           2738 LOAD_FAST                9 (all_union_center_embeddings)
           2740 LOAD_FAST               10 (all_union_offset_embeddings)
           2742 PRECALL                  3
           2746 CALL                     3
           2756 STORE_FAST              27 (negative_union_logit)

486        2758 LOAD_GLOBAL             15 (NULL + torch)
           2770 LOAD_ATTR               19 (max)
           2780 LOAD_FAST               27 (negative_union_logit)
           2782 LOAD_CONST               4 (1)
           2784 KW_NAMES                 3
           2786 PRECALL                  2
           2790 CALL                     2
           2800 LOAD_CONST               2 (0)
           2802 BINARY_SUBSCR
           2812 STORE_FAST              27 (negative_union_logit)
           2814 JUMP_FORWARD            49 (to 2914)

488     >> 2816 LOAD_GLOBAL             15 (NULL + torch)
           2828 LOAD_ATTR               16 (Tensor)
           2838 BUILD_LIST               0
           2840 PRECALL                  1
           2844 CALL                     1
           2854 LOAD_METHOD             17 (to)
           2876 LOAD_FAST                0 (self)
           2878 LOAD_ATTR               14 (entity_embedding)
           2888 LOAD_ATTR               18 (device)
           2898 PRECALL                  1
           2902 CALL                     1
           2912 STORE_FAST              27 (negative_union_logit)

489     >> 2914 LOAD_GLOBAL             15 (NULL + torch)
           2926 LOAD_ATTR                8 (cat)
           2936 LOAD_FAST               25 (negative_logit)
           2938 LOAD_FAST               27 (negative_union_logit)
           2940 BUILD_LIST               2
           2942 LOAD_CONST               2 (0)
           2944 KW_NAMES                 3
           2946 PRECALL                  2
           2950 CALL                     2
           2960 STORE_FAST              25 (negative_logit)
           2962 JUMP_FORWARD             2 (to 2968)

491     >> 2964 LOAD_CONST               0 (None)
           2966 STORE_FAST              25 (negative_logit)

493     >> 2968 LOAD_FAST               18 (positive_logit)
           2970 LOAD_FAST               25 (negative_logit)
           2972 LOAD_FAST                3 (subsampling_weight)
           2974 LOAD_FAST                8 (all_idxs)
           2976 LOAD_FAST               11 (all_union_idxs)
           2978 BINARY_OP                0 (+)
           2982 BUILD_TUPLE              4
           2984 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box) (inline depth: 1)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), NNModuleVariable()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 348 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE PRECALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
                                                        ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                             query_structure,
                                                                             ^^^^^^^^^^^^^^^^
                                                                             0)
                                                                             ^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 3)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 3)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_BACKWARD 30 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 1186 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 1272 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2068 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2956 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2394 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_sample_regular = negative_sample[all_idxs]
                                          ~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_METHOD view [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE FX call view from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD view [TensorVariable()]
TRACE LOAD_FAST batch_size [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call view_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE PRECALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE inlined call cal_logit_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
                                 ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
413           0 RESUME                   0

414           2 LOAD_FAST                1 (entity_embedding)
              4 LOAD_FAST                2 (query_center_embedding)
              6 BINARY_OP               10 (-)
             10 LOAD_METHOD              0 (abs)
             32 PRECALL                  0
             36 CALL                     0
             46 STORE_FAST               4 (delta)

415          48 LOAD_GLOBAL              3 (NULL + F)
             60 LOAD_ATTR                2 (relu)
             70 LOAD_FAST                4 (delta)
             72 LOAD_FAST                3 (query_offset_embedding)
             74 BINARY_OP               10 (-)
             78 PRECALL                  1
             82 CALL                     1
             92 STORE_FAST               5 (distance_out)

416          94 LOAD_GLOBAL              7 (NULL + torch)
            106 LOAD_ATTR                4 (min)
            116 LOAD_FAST                4 (delta)
            118 LOAD_FAST                3 (query_offset_embedding)
            120 PRECALL                  2
            124 CALL                     2
            134 STORE_FAST               6 (distance_in)

417         136 LOAD_FAST                0 (self)
            138 LOAD_ATTR                5 (gamma)
            148 LOAD_GLOBAL              7 (NULL + torch)
            160 LOAD_ATTR                6 (norm)
            170 LOAD_FAST                5 (distance_out)
            172 LOAD_CONST               1 (1)
            174 LOAD_CONST               2 (-1)
            176 KW_NAMES                 3
            178 PRECALL                  3
            182 CALL                     3
            192 BINARY_OP               10 (-)
            196 LOAD_FAST                0 (self)
            198 LOAD_ATTR                7 (cen)
            208 LOAD_GLOBAL              7 (NULL + torch)
            220 LOAD_ATTR                6 (norm)
            230 LOAD_FAST                6 (distance_in)
            232 LOAD_CONST               1 (1)
            234 LOAD_CONST               2 (-1)
            236 KW_NAMES                 3
            238 PRECALL                  3
            242 CALL                     3
            252 BINARY_OP                5 (*)
            256 BINARY_OP               10 (-)
            260 STORE_FAST               7 (logit)

418         262 LOAD_FAST                7 (logit)
            264 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        delta = (entity_embedding - query_center_embedding).abs()
                 ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_METHOD abs [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE FX call abs_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        delta = (entity_embedding - query_center_embedding).abs()
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable(), TensorVariable()]
TRACE FX call sub_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_out = F.relu(delta - query_offset_embedding)
                              ~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_out = F.relu(delta - query_offset_embedding)
                       ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_in = torch.min(delta, query_offset_embedding)
                      ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                             ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                                ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                     ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2492 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2808 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [NullVariable, TorchVariable(<class 'torch.Tensor'>)]
TRACE PRECALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE CALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE FX call tensor from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~^^^^
TRACE LOAD_METHOD to [TensorVariable()]
TRACE LOAD_FAST self [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [NullVariable, GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE FX call to from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST negative_union_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable()]
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2960 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_OP 0 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object forward_box at 0x7316500, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 420>
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 196 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_2 =====
 <eval_with_key>.61 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_2 <eval_with_key>.61 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7fad600718a0>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7fad600718a0>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7facb1c64220>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7fad600718a0>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7facb1a74d60>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7facb1a74d60>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7fad600718a0>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_2 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:194
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:194 in forward (KGReasoning.forward)
        def forward(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:195 in forward (KGReasoning.forward)
            if self.geo == 'box':
TRACE LOAD_FAST self []
TRACE LOAD_ATTR geo [LazyVariableTracker()]
TRACE LOAD_CONST box [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 74 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:196 in forward (KGReasoning.forward)
                return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD forward_box [NNModuleVariable()]
TRACE LOAD_FAST positive_sample [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable())]
TRACE LOAD_FAST negative_sample [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_FAST subsampling_weight [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_queries_dict [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_idxs_dict [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE PRECALL 5 [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call forward_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:196 in forward (KGReasoning.forward)
            return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
                   ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object forward_box at 0x7316500, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 420>
420           0 RESUME                   0

421           2 BUILD_LIST               0
              4 BUILD_LIST               0
              6 BUILD_LIST               0
              8 STORE_FAST               8 (all_idxs)
             10 STORE_FAST               7 (all_offset_embeddings)
             12 STORE_FAST               6 (all_center_embeddings)

422          14 BUILD_LIST               0
             16 BUILD_LIST               0
             18 BUILD_LIST               0
             20 STORE_FAST              11 (all_union_idxs)
             22 STORE_FAST              10 (all_union_offset_embeddings)
             24 STORE_FAST               9 (all_union_center_embeddings)

423          26 LOAD_FAST                4 (batch_queries_dict)
             28 GET_ITER
        >>   30 EXTENDED_ARG             1
             32 FOR_ITER               262 (to 558)
             34 STORE_FAST              12 (query_structure)

424          36 LOAD_CONST               1 ('u')
             38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                0 (query_name_dict)
             50 LOAD_FAST               12 (query_structure)
             52 BINARY_SUBSCR
             62 CONTAINS_OP              0
             64 POP_JUMP_FORWARD_IF_FALSE   142 (to 350)

426          66 LOAD_FAST                0 (self)
             68 LOAD_METHOD              1 (embed_query_box)
             90 LOAD_FAST                0 (self)
             92 LOAD_METHOD              2 (transform_union_query)
            114 LOAD_FAST                4 (batch_queries_dict)
            116 LOAD_FAST               12 (query_structure)
            118 BINARY_SUBSCR

427         128 LOAD_FAST               12 (query_structure)

426         130 PRECALL                  2
            134 CALL                     2

428         144 LOAD_FAST                0 (self)
            146 LOAD_METHOD              3 (transform_union_structure)
            168 LOAD_FAST               12 (query_structure)
            170 PRECALL                  1
            174 CALL                     1

429         184 LOAD_CONST               2 (0)

426         186 PRECALL                  3
            190 CALL                     3

425         200 UNPACK_SEQUENCE          3
            204 STORE_FAST              13 (center_embedding)
            206 STORE_FAST              14 (offset_embedding)
            208 STORE_FAST              15 (_)

430         210 LOAD_FAST                9 (all_union_center_embeddings)
            212 LOAD_METHOD              4 (append)
            234 LOAD_FAST               13 (center_embedding)
            236 PRECALL                  1
            240 CALL                     1
            250 POP_TOP

431         252 LOAD_FAST               10 (all_union_offset_embeddings)
            254 LOAD_METHOD              4 (append)
            276 LOAD_FAST               14 (offset_embedding)
            278 PRECALL                  1
            282 CALL                     1
            292 POP_TOP

432         294 LOAD_FAST               11 (all_union_idxs)
            296 LOAD_METHOD              5 (extend)
            318 LOAD_FAST                5 (batch_idxs_dict)
            320 LOAD_FAST               12 (query_structure)
            322 BINARY_SUBSCR
            332 PRECALL                  1
            336 CALL                     1
            346 POP_TOP
            348 JUMP_BACKWARD          160 (to 30)

434     >>  350 LOAD_FAST                0 (self)
            352 LOAD_METHOD              1 (embed_query_box)
            374 LOAD_FAST                4 (batch_queries_dict)
            376 LOAD_FAST               12 (query_structure)
            378 BINARY_SUBSCR

435         388 LOAD_FAST               12 (query_structure)

436         390 LOAD_CONST               2 (0)

434         392 PRECALL                  3
            396 CALL                     3
            406 UNPACK_SEQUENCE          3
            410 STORE_FAST              13 (center_embedding)
            412 STORE_FAST              14 (offset_embedding)
            414 STORE_FAST              15 (_)

437         416 LOAD_FAST                6 (all_center_embeddings)
            418 LOAD_METHOD              4 (append)
            440 LOAD_FAST               13 (center_embedding)
            442 PRECALL                  1
            446 CALL                     1
            456 POP_TOP

438         458 LOAD_FAST                7 (all_offset_embeddings)
            460 LOAD_METHOD              4 (append)
            482 LOAD_FAST               14 (offset_embedding)
            484 PRECALL                  1
            488 CALL                     1
            498 POP_TOP

439         500 LOAD_FAST                8 (all_idxs)
            502 LOAD_METHOD              5 (extend)
            524 LOAD_FAST                5 (batch_idxs_dict)
            526 LOAD_FAST               12 (query_structure)
            528 BINARY_SUBSCR
            538 PRECALL                  1
            542 CALL                     1
            552 POP_TOP
            554 EXTENDED_ARG             1
            556 JUMP_BACKWARD          264 (to 30)

441     >>  558 LOAD_GLOBAL             13 (NULL + len)
            570 LOAD_FAST                6 (all_center_embeddings)
            572 PRECALL                  1
            576 CALL                     1
            586 LOAD_CONST               2 (0)
            588 COMPARE_OP               4 (>)
            594 POP_JUMP_FORWARD_IF_FALSE   101 (to 798)
            596 LOAD_GLOBAL             13 (NULL + len)
            608 LOAD_FAST                7 (all_offset_embeddings)
            610 PRECALL                  1
            614 CALL                     1
            624 LOAD_CONST               2 (0)
            626 COMPARE_OP               4 (>)
            632 POP_JUMP_FORWARD_IF_FALSE    82 (to 798)

442         634 LOAD_GLOBAL             15 (NULL + torch)
            646 LOAD_ATTR                8 (cat)
            656 LOAD_FAST                6 (all_center_embeddings)
            658 LOAD_CONST               2 (0)
            660 KW_NAMES                 3
            662 PRECALL                  2
            666 CALL                     2
            676 LOAD_METHOD              9 (unsqueeze)
            698 LOAD_CONST               4 (1)
            700 PRECALL                  1
            704 CALL                     1
            714 STORE_FAST               6 (all_center_embeddings)

443         716 LOAD_GLOBAL             15 (NULL + torch)
            728 LOAD_ATTR                8 (cat)
            738 LOAD_FAST                7 (all_offset_embeddings)
            740 LOAD_CONST               2 (0)
            742 KW_NAMES                 3
            744 PRECALL                  2
            748 CALL                     2
            758 LOAD_METHOD              9 (unsqueeze)
            780 LOAD_CONST               4 (1)
            782 PRECALL                  1
            786 CALL                     1
            796 STORE_FAST               7 (all_offset_embeddings)

444     >>  798 LOAD_GLOBAL             13 (NULL + len)
            810 LOAD_FAST                9 (all_union_center_embeddings)
            812 PRECALL                  1
            816 CALL                     1
            826 LOAD_CONST               2 (0)
            828 COMPARE_OP               4 (>)
            834 POP_JUMP_FORWARD_IF_FALSE   177 (to 1190)
            836 LOAD_GLOBAL             13 (NULL + len)
            848 LOAD_FAST               10 (all_union_offset_embeddings)
            850 PRECALL                  1
            854 CALL                     1
            864 LOAD_CONST               2 (0)
            866 COMPARE_OP               4 (>)
            872 POP_JUMP_FORWARD_IF_FALSE   158 (to 1190)

445         874 LOAD_GLOBAL             15 (NULL + torch)
            886 LOAD_ATTR                8 (cat)
            896 LOAD_FAST                9 (all_union_center_embeddings)
            898 LOAD_CONST               2 (0)
            900 KW_NAMES                 3
            902 PRECALL                  2
            906 CALL                     2
            916 LOAD_METHOD              9 (unsqueeze)
            938 LOAD_CONST               4 (1)
            940 PRECALL                  1
            944 CALL                     1
            954 STORE_FAST               9 (all_union_center_embeddings)

446         956 LOAD_GLOBAL             15 (NULL + torch)
            968 LOAD_ATTR                8 (cat)
            978 LOAD_FAST               10 (all_union_offset_embeddings)
            980 LOAD_CONST               2 (0)
            982 KW_NAMES                 3
            984 PRECALL                  2
            988 CALL                     2
            998 LOAD_METHOD              9 (unsqueeze)
           1020 LOAD_CONST               4 (1)
           1022 PRECALL                  1
           1026 CALL                     1
           1036 STORE_FAST              10 (all_union_offset_embeddings)

447        1038 LOAD_FAST                9 (all_union_center_embeddings)
           1040 LOAD_METHOD             10 (view)
           1062 LOAD_FAST                9 (all_union_center_embeddings)
           1064 LOAD_ATTR               11 (shape)
           1074 LOAD_CONST               2 (0)
           1076 BINARY_SUBSCR
           1086 LOAD_CONST               5 (2)
           1088 BINARY_OP                2 (//)
           1092 LOAD_CONST               5 (2)
           1094 LOAD_CONST               4 (1)
           1096 LOAD_CONST               6 (-1)
           1098 PRECALL                  4
           1102 CALL                     4
           1112 STORE_FAST               9 (all_union_center_embeddings)

448        1114 LOAD_FAST               10 (all_union_offset_embeddings)
           1116 LOAD_METHOD             10 (view)
           1138 LOAD_FAST               10 (all_union_offset_embeddings)
           1140 LOAD_ATTR               11 (shape)
           1150 LOAD_CONST               2 (0)
           1152 BINARY_SUBSCR
           1162 LOAD_CONST               5 (2)
           1164 BINARY_OP                2 (//)
           1168 LOAD_CONST               5 (2)
           1170 LOAD_CONST               4 (1)
           1172 LOAD_CONST               6 (-1)
           1174 PRECALL                  4
           1178 CALL                     4
           1188 STORE_FAST              10 (all_union_offset_embeddings)

450     >> 1190 LOAD_GLOBAL             25 (NULL + type)
           1202 LOAD_FAST                3 (subsampling_weight)
           1204 PRECALL                  1
           1208 CALL                     1
           1218 LOAD_GLOBAL             25 (NULL + type)
           1230 LOAD_CONST               0 (None)
           1232 PRECALL                  1
           1236 CALL                     1
           1246 COMPARE_OP               3 (!=)
           1252 POP_JUMP_FORWARD_IF_FALSE    11 (to 1276)

451        1254 LOAD_FAST                3 (subsampling_weight)
           1256 LOAD_FAST                8 (all_idxs)
           1258 LOAD_FAST               11 (all_union_idxs)
           1260 BINARY_OP                0 (+)
           1264 BINARY_SUBSCR
           1274 STORE_FAST               3 (subsampling_weight)

453     >> 1276 LOAD_GLOBAL             25 (NULL + type)
           1288 LOAD_FAST                1 (positive_sample)
           1290 PRECALL                  1
           1294 CALL                     1
           1304 LOAD_GLOBAL             25 (NULL + type)
           1316 LOAD_CONST               0 (None)
           1318 PRECALL                  1
           1322 CALL                     1
           1332 COMPARE_OP               3 (!=)
           1338 EXTENDED_ARG             1
           1340 POP_JUMP_FORWARD_IF_FALSE   366 (to 2074)

454        1342 LOAD_GLOBAL             13 (NULL + len)
           1354 LOAD_FAST                6 (all_center_embeddings)
           1356 PRECALL                  1
           1360 CALL                     1
           1370 LOAD_CONST               2 (0)
           1372 COMPARE_OP               4 (>)
           1378 POP_JUMP_FORWARD_IF_FALSE    79 (to 1538)

455        1380 LOAD_FAST                1 (positive_sample)
           1382 LOAD_FAST                8 (all_idxs)
           1384 BINARY_SUBSCR
           1394 STORE_FAST              16 (positive_sample_regular)

456        1396 LOAD_GLOBAL             15 (NULL + torch)
           1408 LOAD_ATTR               13 (index_select)
           1418 LOAD_FAST                0 (self)
           1420 LOAD_ATTR               14 (entity_embedding)
           1430 LOAD_CONST               2 (0)
           1432 LOAD_FAST               16 (positive_sample_regular)
           1434 KW_NAMES                 7
           1436 PRECALL                  3
           1440 CALL                     3
           1450 LOAD_METHOD              9 (unsqueeze)
           1472 LOAD_CONST               4 (1)
           1474 PRECALL                  1
           1478 CALL                     1
           1488 STORE_FAST              17 (positive_embedding)

457        1490 LOAD_FAST                0 (self)
           1492 LOAD_METHOD             15 (cal_logit_box)
           1514 LOAD_FAST               17 (positive_embedding)
           1516 LOAD_FAST                6 (all_center_embeddings)
           1518 LOAD_FAST                7 (all_offset_embeddings)
           1520 PRECALL                  3
           1524 CALL                     3
           1534 STORE_FAST              18 (positive_logit)
           1536 JUMP_FORWARD            49 (to 1636)

459     >> 1538 LOAD_GLOBAL             15 (NULL + torch)
           1550 LOAD_ATTR               16 (Tensor)
           1560 BUILD_LIST               0
           1562 PRECALL                  1
           1566 CALL                     1
           1576 LOAD_METHOD             17 (to)
           1598 LOAD_FAST                0 (self)
           1600 LOAD_ATTR               14 (entity_embedding)
           1610 LOAD_ATTR               18 (device)
           1620 PRECALL                  1
           1624 CALL                     1
           1634 STORE_FAST              18 (positive_logit)

461     >> 1636 LOAD_GLOBAL             13 (NULL + len)
           1648 LOAD_FAST                9 (all_union_center_embeddings)
           1650 PRECALL                  1
           1654 CALL                     1
           1664 LOAD_CONST               2 (0)
           1666 COMPARE_OP               4 (>)
           1672 POP_JUMP_FORWARD_IF_FALSE   126 (to 1926)

462        1674 LOAD_FAST                1 (positive_sample)
           1676 LOAD_FAST               11 (all_union_idxs)
           1678 BINARY_SUBSCR
           1688 STORE_FAST              19 (positive_sample_union)

463        1690 LOAD_GLOBAL             15 (NULL + torch)
           1702 LOAD_ATTR               13 (index_select)
           1712 LOAD_FAST                0 (self)
           1714 LOAD_ATTR               14 (entity_embedding)
           1724 LOAD_CONST               2 (0)
           1726 LOAD_FAST               19 (positive_sample_union)
           1728 KW_NAMES                 7
           1730 PRECALL                  3
           1734 CALL                     3
           1744 LOAD_METHOD              9 (unsqueeze)
           1766 LOAD_CONST               4 (1)
           1768 PRECALL                  1
           1772 CALL                     1
           1782 LOAD_METHOD              9 (unsqueeze)
           1804 LOAD_CONST               4 (1)
           1806 PRECALL                  1
           1810 CALL                     1
           1820 STORE_FAST              17 (positive_embedding)

464        1822 LOAD_FAST                0 (self)
           1824 LOAD_METHOD             15 (cal_logit_box)
           1846 LOAD_FAST               17 (positive_embedding)
           1848 LOAD_FAST                9 (all_union_center_embeddings)
           1850 LOAD_FAST               10 (all_union_offset_embeddings)
           1852 PRECALL                  3
           1856 CALL                     3
           1866 STORE_FAST              20 (positive_union_logit)

465        1868 LOAD_GLOBAL             15 (NULL + torch)
           1880 LOAD_ATTR               19 (max)
           1890 LOAD_FAST               20 (positive_union_logit)
           1892 LOAD_CONST               4 (1)
           1894 KW_NAMES                 3
           1896 PRECALL                  2
           1900 CALL                     2
           1910 LOAD_CONST               2 (0)
           1912 BINARY_SUBSCR
           1922 STORE_FAST              20 (positive_union_logit)
           1924 JUMP_FORWARD            49 (to 2024)

467     >> 1926 LOAD_GLOBAL             15 (NULL + torch)
           1938 LOAD_ATTR               16 (Tensor)
           1948 BUILD_LIST               0
           1950 PRECALL                  1
           1954 CALL                     1
           1964 LOAD_METHOD             17 (to)
           1986 LOAD_FAST                0 (self)
           1988 LOAD_ATTR               14 (entity_embedding)
           1998 LOAD_ATTR               18 (device)
           2008 PRECALL                  1
           2012 CALL                     1
           2022 STORE_FAST              20 (positive_union_logit)

468     >> 2024 LOAD_GLOBAL             15 (NULL + torch)
           2036 LOAD_ATTR                8 (cat)
           2046 LOAD_FAST               18 (positive_logit)
           2048 LOAD_FAST               20 (positive_union_logit)
           2050 BUILD_LIST               2
           2052 LOAD_CONST               2 (0)
           2054 KW_NAMES                 3
           2056 PRECALL                  2
           2060 CALL                     2
           2070 STORE_FAST              18 (positive_logit)
           2072 JUMP_FORWARD             2 (to 2078)

470     >> 2074 LOAD_CONST               0 (None)
           2076 STORE_FAST              18 (positive_logit)

472     >> 2078 LOAD_GLOBAL             25 (NULL + type)
           2090 LOAD_FAST                2 (negative_sample)
           2092 PRECALL                  1
           2096 CALL                     1
           2106 LOAD_GLOBAL             25 (NULL + type)
           2118 LOAD_CONST               0 (None)
           2120 PRECALL                  1
           2124 CALL                     1
           2134 COMPARE_OP               3 (!=)
           2140 EXTENDED_ARG             1
           2142 POP_JUMP_FORWARD_IF_FALSE   410 (to 2964)

473        2144 LOAD_GLOBAL             13 (NULL + len)
           2156 LOAD_FAST                6 (all_center_embeddings)
           2158 PRECALL                  1
           2162 CALL                     1
           2172 LOAD_CONST               2 (0)
           2174 COMPARE_OP               4 (>)
           2180 POP_JUMP_FORWARD_IF_FALSE   110 (to 2402)

474        2182 LOAD_FAST                2 (negative_sample)
           2184 LOAD_FAST                8 (all_idxs)
           2186 BINARY_SUBSCR
           2196 STORE_FAST              21 (negative_sample_regular)

475        2198 LOAD_FAST               21 (negative_sample_regular)
           2200 LOAD_ATTR               11 (shape)
           2210 UNPACK_SEQUENCE          2
           2214 STORE_FAST              22 (batch_size)
           2216 STORE_FAST              23 (negative_size)

476        2218 LOAD_GLOBAL             15 (NULL + torch)
           2230 LOAD_ATTR               13 (index_select)
           2240 LOAD_FAST                0 (self)
           2242 LOAD_ATTR               14 (entity_embedding)
           2252 LOAD_CONST               2 (0)
           2254 LOAD_FAST               21 (negative_sample_regular)
           2256 LOAD_METHOD             10 (view)
           2278 LOAD_CONST               6 (-1)
           2280 PRECALL                  1
           2284 CALL                     1
           2294 KW_NAMES                 7
           2296 PRECALL                  3
           2300 CALL                     3
           2310 LOAD_METHOD             10 (view)
           2332 LOAD_FAST               22 (batch_size)
           2334 LOAD_FAST               23 (negative_size)
           2336 LOAD_CONST               6 (-1)
           2338 PRECALL                  3
           2342 CALL                     3
           2352 STORE_FAST              24 (negative_embedding)

477        2354 LOAD_FAST                0 (self)
           2356 LOAD_METHOD             15 (cal_logit_box)
           2378 LOAD_FAST               24 (negative_embedding)
           2380 LOAD_FAST                6 (all_center_embeddings)
           2382 LOAD_FAST                7 (all_offset_embeddings)
           2384 PRECALL                  3
           2388 CALL                     3
           2398 STORE_FAST              25 (negative_logit)
           2400 JUMP_FORWARD            49 (to 2500)

479     >> 2402 LOAD_GLOBAL             15 (NULL + torch)
           2414 LOAD_ATTR               16 (Tensor)
           2424 BUILD_LIST               0
           2426 PRECALL                  1
           2430 CALL                     1
           2440 LOAD_METHOD             17 (to)
           2462 LOAD_FAST                0 (self)
           2464 LOAD_ATTR               14 (entity_embedding)
           2474 LOAD_ATTR               18 (device)
           2484 PRECALL                  1
           2488 CALL                     1
           2498 STORE_FAST              25 (negative_logit)

481     >> 2500 LOAD_GLOBAL             13 (NULL + len)
           2512 LOAD_FAST                9 (all_union_center_embeddings)
           2514 PRECALL                  1
           2518 CALL                     1
           2528 LOAD_CONST               2 (0)
           2530 COMPARE_OP               4 (>)
           2536 POP_JUMP_FORWARD_IF_FALSE   139 (to 2816)

482        2538 LOAD_FAST                2 (negative_sample)
           2540 LOAD_FAST               11 (all_union_idxs)
           2542 BINARY_SUBSCR
           2552 STORE_FAST              26 (negative_sample_union)

483        2554 LOAD_FAST               26 (negative_sample_union)
           2556 LOAD_ATTR               11 (shape)
           2566 UNPACK_SEQUENCE          2
           2570 STORE_FAST              22 (batch_size)
           2572 STORE_FAST              23 (negative_size)

484        2574 LOAD_GLOBAL             15 (NULL + torch)
           2586 LOAD_ATTR               13 (index_select)
           2596 LOAD_FAST                0 (self)
           2598 LOAD_ATTR               14 (entity_embedding)
           2608 LOAD_CONST               2 (0)
           2610 LOAD_FAST               26 (negative_sample_union)
           2612 LOAD_METHOD             10 (view)
           2634 LOAD_CONST               6 (-1)
           2636 PRECALL                  1
           2640 CALL                     1
           2650 KW_NAMES                 7
           2652 PRECALL                  3
           2656 CALL                     3
           2666 LOAD_METHOD             10 (view)
           2688 LOAD_FAST               22 (batch_size)
           2690 LOAD_CONST               4 (1)
           2692 LOAD_FAST               23 (negative_size)
           2694 LOAD_CONST               6 (-1)
           2696 PRECALL                  4
           2700 CALL                     4
           2710 STORE_FAST              24 (negative_embedding)

485        2712 LOAD_FAST                0 (self)
           2714 LOAD_METHOD             15 (cal_logit_box)
           2736 LOAD_FAST               24 (negative_embedding)
           2738 LOAD_FAST                9 (all_union_center_embeddings)
           2740 LOAD_FAST               10 (all_union_offset_embeddings)
           2742 PRECALL                  3
           2746 CALL                     3
           2756 STORE_FAST              27 (negative_union_logit)

486        2758 LOAD_GLOBAL             15 (NULL + torch)
           2770 LOAD_ATTR               19 (max)
           2780 LOAD_FAST               27 (negative_union_logit)
           2782 LOAD_CONST               4 (1)
           2784 KW_NAMES                 3
           2786 PRECALL                  2
           2790 CALL                     2
           2800 LOAD_CONST               2 (0)
           2802 BINARY_SUBSCR
           2812 STORE_FAST              27 (negative_union_logit)
           2814 JUMP_FORWARD            49 (to 2914)

488     >> 2816 LOAD_GLOBAL             15 (NULL + torch)
           2828 LOAD_ATTR               16 (Tensor)
           2838 BUILD_LIST               0
           2840 PRECALL                  1
           2844 CALL                     1
           2854 LOAD_METHOD             17 (to)
           2876 LOAD_FAST                0 (self)
           2878 LOAD_ATTR               14 (entity_embedding)
           2888 LOAD_ATTR               18 (device)
           2898 PRECALL                  1
           2902 CALL                     1
           2912 STORE_FAST              27 (negative_union_logit)

489     >> 2914 LOAD_GLOBAL             15 (NULL + torch)
           2926 LOAD_ATTR                8 (cat)
           2936 LOAD_FAST               25 (negative_logit)
           2938 LOAD_FAST               27 (negative_union_logit)
           2940 BUILD_LIST               2
           2942 LOAD_CONST               2 (0)
           2944 KW_NAMES                 3
           2946 PRECALL                  2
           2950 CALL                     2
           2960 STORE_FAST              25 (negative_logit)
           2962 JUMP_FORWARD             2 (to 2968)

491     >> 2964 LOAD_CONST               0 (None)
           2966 STORE_FAST              25 (negative_logit)

493     >> 2968 LOAD_FAST               18 (positive_logit)
           2970 LOAD_FAST               25 (negative_logit)
           2972 LOAD_FAST                3 (subsampling_weight)
           2974 LOAD_FAST                8 (all_idxs)
           2976 LOAD_FAST               11 (all_union_idxs)
           2978 BINARY_OP                0 (+)
           2982 BUILD_TUPLE              4
           2984 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box) (inline depth: 1)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), NNModuleVariable()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 348 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE PRECALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
                                                        ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                             query_structure,
                                                                             ^^^^^^^^^^^^^^^^
                                                                             0)
                                                                             ^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 3)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 3)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_BACKWARD 30 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 1186 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 1272 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2068 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2956 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2394 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_sample_regular = negative_sample[all_idxs]
                                          ~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_METHOD view [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE FX call view from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD view [TensorVariable()]
TRACE LOAD_FAST batch_size [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call view_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE PRECALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE inlined call cal_logit_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
                                 ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
413           0 RESUME                   0

414           2 LOAD_FAST                1 (entity_embedding)
              4 LOAD_FAST                2 (query_center_embedding)
              6 BINARY_OP               10 (-)
             10 LOAD_METHOD              0 (abs)
             32 PRECALL                  0
             36 CALL                     0
             46 STORE_FAST               4 (delta)

415          48 LOAD_GLOBAL              3 (NULL + F)
             60 LOAD_ATTR                2 (relu)
             70 LOAD_FAST                4 (delta)
             72 LOAD_FAST                3 (query_offset_embedding)
             74 BINARY_OP               10 (-)
             78 PRECALL                  1
             82 CALL                     1
             92 STORE_FAST               5 (distance_out)

416          94 LOAD_GLOBAL              7 (NULL + torch)
            106 LOAD_ATTR                4 (min)
            116 LOAD_FAST                4 (delta)
            118 LOAD_FAST                3 (query_offset_embedding)
            120 PRECALL                  2
            124 CALL                     2
            134 STORE_FAST               6 (distance_in)

417         136 LOAD_FAST                0 (self)
            138 LOAD_ATTR                5 (gamma)
            148 LOAD_GLOBAL              7 (NULL + torch)
            160 LOAD_ATTR                6 (norm)
            170 LOAD_FAST                5 (distance_out)
            172 LOAD_CONST               1 (1)
            174 LOAD_CONST               2 (-1)
            176 KW_NAMES                 3
            178 PRECALL                  3
            182 CALL                     3
            192 BINARY_OP               10 (-)
            196 LOAD_FAST                0 (self)
            198 LOAD_ATTR                7 (cen)
            208 LOAD_GLOBAL              7 (NULL + torch)
            220 LOAD_ATTR                6 (norm)
            230 LOAD_FAST                6 (distance_in)
            232 LOAD_CONST               1 (1)
            234 LOAD_CONST               2 (-1)
            236 KW_NAMES                 3
            238 PRECALL                  3
            242 CALL                     3
            252 BINARY_OP                5 (*)
            256 BINARY_OP               10 (-)
            260 STORE_FAST               7 (logit)

418         262 LOAD_FAST                7 (logit)
            264 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        delta = (entity_embedding - query_center_embedding).abs()
                 ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_METHOD abs [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE FX call abs_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        delta = (entity_embedding - query_center_embedding).abs()
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable(), TensorVariable()]
TRACE FX call sub_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_out = F.relu(delta - query_offset_embedding)
                              ~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_out = F.relu(delta - query_offset_embedding)
                       ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_in = torch.min(delta, query_offset_embedding)
                      ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                             ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                                ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                     ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2492 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2808 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [NullVariable, TorchVariable(<class 'torch.Tensor'>)]
TRACE PRECALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE CALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE FX call tensor from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~^^^^
TRACE LOAD_METHOD to [TensorVariable()]
TRACE LOAD_FAST self [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [NullVariable, GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE FX call to from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST negative_union_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable()]
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2960 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_OP 0 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object forward_box at 0x7316500, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 420>
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 196 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_3 =====
 <eval_with_key>.77 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_3 <eval_with_key>.77 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7fad600718a0>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7fad600718a0>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7facb1c64220>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7fad600718a0>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7facb1a74d60>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7facb1a74d60>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7fad600718a0>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_3 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:194
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:194 in forward (KGReasoning.forward)
        def forward(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:195 in forward (KGReasoning.forward)
            if self.geo == 'box':
TRACE LOAD_FAST self []
TRACE LOAD_ATTR geo [LazyVariableTracker()]
TRACE LOAD_CONST box [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 74 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:196 in forward (KGReasoning.forward)
                return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD forward_box [NNModuleVariable()]
TRACE LOAD_FAST positive_sample [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable())]
TRACE LOAD_FAST negative_sample [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_FAST subsampling_weight [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_queries_dict [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_idxs_dict [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE PRECALL 5 [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call forward_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:196 in forward (KGReasoning.forward)
            return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
                   ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object forward_box at 0x7316500, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 420>
420           0 RESUME                   0

421           2 BUILD_LIST               0
              4 BUILD_LIST               0
              6 BUILD_LIST               0
              8 STORE_FAST               8 (all_idxs)
             10 STORE_FAST               7 (all_offset_embeddings)
             12 STORE_FAST               6 (all_center_embeddings)

422          14 BUILD_LIST               0
             16 BUILD_LIST               0
             18 BUILD_LIST               0
             20 STORE_FAST              11 (all_union_idxs)
             22 STORE_FAST              10 (all_union_offset_embeddings)
             24 STORE_FAST               9 (all_union_center_embeddings)

423          26 LOAD_FAST                4 (batch_queries_dict)
             28 GET_ITER
        >>   30 EXTENDED_ARG             1
             32 FOR_ITER               262 (to 558)
             34 STORE_FAST              12 (query_structure)

424          36 LOAD_CONST               1 ('u')
             38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                0 (query_name_dict)
             50 LOAD_FAST               12 (query_structure)
             52 BINARY_SUBSCR
             62 CONTAINS_OP              0
             64 POP_JUMP_FORWARD_IF_FALSE   142 (to 350)

426          66 LOAD_FAST                0 (self)
             68 LOAD_METHOD              1 (embed_query_box)
             90 LOAD_FAST                0 (self)
             92 LOAD_METHOD              2 (transform_union_query)
            114 LOAD_FAST                4 (batch_queries_dict)
            116 LOAD_FAST               12 (query_structure)
            118 BINARY_SUBSCR

427         128 LOAD_FAST               12 (query_structure)

426         130 PRECALL                  2
            134 CALL                     2

428         144 LOAD_FAST                0 (self)
            146 LOAD_METHOD              3 (transform_union_structure)
            168 LOAD_FAST               12 (query_structure)
            170 PRECALL                  1
            174 CALL                     1

429         184 LOAD_CONST               2 (0)

426         186 PRECALL                  3
            190 CALL                     3

425         200 UNPACK_SEQUENCE          3
            204 STORE_FAST              13 (center_embedding)
            206 STORE_FAST              14 (offset_embedding)
            208 STORE_FAST              15 (_)

430         210 LOAD_FAST                9 (all_union_center_embeddings)
            212 LOAD_METHOD              4 (append)
            234 LOAD_FAST               13 (center_embedding)
            236 PRECALL                  1
            240 CALL                     1
            250 POP_TOP

431         252 LOAD_FAST               10 (all_union_offset_embeddings)
            254 LOAD_METHOD              4 (append)
            276 LOAD_FAST               14 (offset_embedding)
            278 PRECALL                  1
            282 CALL                     1
            292 POP_TOP

432         294 LOAD_FAST               11 (all_union_idxs)
            296 LOAD_METHOD              5 (extend)
            318 LOAD_FAST                5 (batch_idxs_dict)
            320 LOAD_FAST               12 (query_structure)
            322 BINARY_SUBSCR
            332 PRECALL                  1
            336 CALL                     1
            346 POP_TOP
            348 JUMP_BACKWARD          160 (to 30)

434     >>  350 LOAD_FAST                0 (self)
            352 LOAD_METHOD              1 (embed_query_box)
            374 LOAD_FAST                4 (batch_queries_dict)
            376 LOAD_FAST               12 (query_structure)
            378 BINARY_SUBSCR

435         388 LOAD_FAST               12 (query_structure)

436         390 LOAD_CONST               2 (0)

434         392 PRECALL                  3
            396 CALL                     3
            406 UNPACK_SEQUENCE          3
            410 STORE_FAST              13 (center_embedding)
            412 STORE_FAST              14 (offset_embedding)
            414 STORE_FAST              15 (_)

437         416 LOAD_FAST                6 (all_center_embeddings)
            418 LOAD_METHOD              4 (append)
            440 LOAD_FAST               13 (center_embedding)
            442 PRECALL                  1
            446 CALL                     1
            456 POP_TOP

438         458 LOAD_FAST                7 (all_offset_embeddings)
            460 LOAD_METHOD              4 (append)
            482 LOAD_FAST               14 (offset_embedding)
            484 PRECALL                  1
            488 CALL                     1
            498 POP_TOP

439         500 LOAD_FAST                8 (all_idxs)
            502 LOAD_METHOD              5 (extend)
            524 LOAD_FAST                5 (batch_idxs_dict)
            526 LOAD_FAST               12 (query_structure)
            528 BINARY_SUBSCR
            538 PRECALL                  1
            542 CALL                     1
            552 POP_TOP
            554 EXTENDED_ARG             1
            556 JUMP_BACKWARD          264 (to 30)

441     >>  558 LOAD_GLOBAL             13 (NULL + len)
            570 LOAD_FAST                6 (all_center_embeddings)
            572 PRECALL                  1
            576 CALL                     1
            586 LOAD_CONST               2 (0)
            588 COMPARE_OP               4 (>)
            594 POP_JUMP_FORWARD_IF_FALSE   101 (to 798)
            596 LOAD_GLOBAL             13 (NULL + len)
            608 LOAD_FAST                7 (all_offset_embeddings)
            610 PRECALL                  1
            614 CALL                     1
            624 LOAD_CONST               2 (0)
            626 COMPARE_OP               4 (>)
            632 POP_JUMP_FORWARD_IF_FALSE    82 (to 798)

442         634 LOAD_GLOBAL             15 (NULL + torch)
            646 LOAD_ATTR                8 (cat)
            656 LOAD_FAST                6 (all_center_embeddings)
            658 LOAD_CONST               2 (0)
            660 KW_NAMES                 3
            662 PRECALL                  2
            666 CALL                     2
            676 LOAD_METHOD              9 (unsqueeze)
            698 LOAD_CONST               4 (1)
            700 PRECALL                  1
            704 CALL                     1
            714 STORE_FAST               6 (all_center_embeddings)

443         716 LOAD_GLOBAL             15 (NULL + torch)
            728 LOAD_ATTR                8 (cat)
            738 LOAD_FAST                7 (all_offset_embeddings)
            740 LOAD_CONST               2 (0)
            742 KW_NAMES                 3
            744 PRECALL                  2
            748 CALL                     2
            758 LOAD_METHOD              9 (unsqueeze)
            780 LOAD_CONST               4 (1)
            782 PRECALL                  1
            786 CALL                     1
            796 STORE_FAST               7 (all_offset_embeddings)

444     >>  798 LOAD_GLOBAL             13 (NULL + len)
            810 LOAD_FAST                9 (all_union_center_embeddings)
            812 PRECALL                  1
            816 CALL                     1
            826 LOAD_CONST               2 (0)
            828 COMPARE_OP               4 (>)
            834 POP_JUMP_FORWARD_IF_FALSE   177 (to 1190)
            836 LOAD_GLOBAL             13 (NULL + len)
            848 LOAD_FAST               10 (all_union_offset_embeddings)
            850 PRECALL                  1
            854 CALL                     1
            864 LOAD_CONST               2 (0)
            866 COMPARE_OP               4 (>)
            872 POP_JUMP_FORWARD_IF_FALSE   158 (to 1190)

445         874 LOAD_GLOBAL             15 (NULL + torch)
            886 LOAD_ATTR                8 (cat)
            896 LOAD_FAST                9 (all_union_center_embeddings)
            898 LOAD_CONST               2 (0)
            900 KW_NAMES                 3
            902 PRECALL                  2
            906 CALL                     2
            916 LOAD_METHOD              9 (unsqueeze)
            938 LOAD_CONST               4 (1)
            940 PRECALL                  1
            944 CALL                     1
            954 STORE_FAST               9 (all_union_center_embeddings)

446         956 LOAD_GLOBAL             15 (NULL + torch)
            968 LOAD_ATTR                8 (cat)
            978 LOAD_FAST               10 (all_union_offset_embeddings)
            980 LOAD_CONST               2 (0)
            982 KW_NAMES                 3
            984 PRECALL                  2
            988 CALL                     2
            998 LOAD_METHOD              9 (unsqueeze)
           1020 LOAD_CONST               4 (1)
           1022 PRECALL                  1
           1026 CALL                     1
           1036 STORE_FAST              10 (all_union_offset_embeddings)

447        1038 LOAD_FAST                9 (all_union_center_embeddings)
           1040 LOAD_METHOD             10 (view)
           1062 LOAD_FAST                9 (all_union_center_embeddings)
           1064 LOAD_ATTR               11 (shape)
           1074 LOAD_CONST               2 (0)
           1076 BINARY_SUBSCR
           1086 LOAD_CONST               5 (2)
           1088 BINARY_OP                2 (//)
           1092 LOAD_CONST               5 (2)
           1094 LOAD_CONST               4 (1)
           1096 LOAD_CONST               6 (-1)
           1098 PRECALL                  4
           1102 CALL                     4
           1112 STORE_FAST               9 (all_union_center_embeddings)

448        1114 LOAD_FAST               10 (all_union_offset_embeddings)
           1116 LOAD_METHOD             10 (view)
           1138 LOAD_FAST               10 (all_union_offset_embeddings)
           1140 LOAD_ATTR               11 (shape)
           1150 LOAD_CONST               2 (0)
           1152 BINARY_SUBSCR
           1162 LOAD_CONST               5 (2)
           1164 BINARY_OP                2 (//)
           1168 LOAD_CONST               5 (2)
           1170 LOAD_CONST               4 (1)
           1172 LOAD_CONST               6 (-1)
           1174 PRECALL                  4
           1178 CALL                     4
           1188 STORE_FAST              10 (all_union_offset_embeddings)

450     >> 1190 LOAD_GLOBAL             25 (NULL + type)
           1202 LOAD_FAST                3 (subsampling_weight)
           1204 PRECALL                  1
           1208 CALL                     1
           1218 LOAD_GLOBAL             25 (NULL + type)
           1230 LOAD_CONST               0 (None)
           1232 PRECALL                  1
           1236 CALL                     1
           1246 COMPARE_OP               3 (!=)
           1252 POP_JUMP_FORWARD_IF_FALSE    11 (to 1276)

451        1254 LOAD_FAST                3 (subsampling_weight)
           1256 LOAD_FAST                8 (all_idxs)
           1258 LOAD_FAST               11 (all_union_idxs)
           1260 BINARY_OP                0 (+)
           1264 BINARY_SUBSCR
           1274 STORE_FAST               3 (subsampling_weight)

453     >> 1276 LOAD_GLOBAL             25 (NULL + type)
           1288 LOAD_FAST                1 (positive_sample)
           1290 PRECALL                  1
           1294 CALL                     1
           1304 LOAD_GLOBAL             25 (NULL + type)
           1316 LOAD_CONST               0 (None)
           1318 PRECALL                  1
           1322 CALL                     1
           1332 COMPARE_OP               3 (!=)
           1338 EXTENDED_ARG             1
           1340 POP_JUMP_FORWARD_IF_FALSE   366 (to 2074)

454        1342 LOAD_GLOBAL             13 (NULL + len)
           1354 LOAD_FAST                6 (all_center_embeddings)
           1356 PRECALL                  1
           1360 CALL                     1
           1370 LOAD_CONST               2 (0)
           1372 COMPARE_OP               4 (>)
           1378 POP_JUMP_FORWARD_IF_FALSE    79 (to 1538)

455        1380 LOAD_FAST                1 (positive_sample)
           1382 LOAD_FAST                8 (all_idxs)
           1384 BINARY_SUBSCR
           1394 STORE_FAST              16 (positive_sample_regular)

456        1396 LOAD_GLOBAL             15 (NULL + torch)
           1408 LOAD_ATTR               13 (index_select)
           1418 LOAD_FAST                0 (self)
           1420 LOAD_ATTR               14 (entity_embedding)
           1430 LOAD_CONST               2 (0)
           1432 LOAD_FAST               16 (positive_sample_regular)
           1434 KW_NAMES                 7
           1436 PRECALL                  3
           1440 CALL                     3
           1450 LOAD_METHOD              9 (unsqueeze)
           1472 LOAD_CONST               4 (1)
           1474 PRECALL                  1
           1478 CALL                     1
           1488 STORE_FAST              17 (positive_embedding)

457        1490 LOAD_FAST                0 (self)
           1492 LOAD_METHOD             15 (cal_logit_box)
           1514 LOAD_FAST               17 (positive_embedding)
           1516 LOAD_FAST                6 (all_center_embeddings)
           1518 LOAD_FAST                7 (all_offset_embeddings)
           1520 PRECALL                  3
           1524 CALL                     3
           1534 STORE_FAST              18 (positive_logit)
           1536 JUMP_FORWARD            49 (to 1636)

459     >> 1538 LOAD_GLOBAL             15 (NULL + torch)
           1550 LOAD_ATTR               16 (Tensor)
           1560 BUILD_LIST               0
           1562 PRECALL                  1
           1566 CALL                     1
           1576 LOAD_METHOD             17 (to)
           1598 LOAD_FAST                0 (self)
           1600 LOAD_ATTR               14 (entity_embedding)
           1610 LOAD_ATTR               18 (device)
           1620 PRECALL                  1
           1624 CALL                     1
           1634 STORE_FAST              18 (positive_logit)

461     >> 1636 LOAD_GLOBAL             13 (NULL + len)
           1648 LOAD_FAST                9 (all_union_center_embeddings)
           1650 PRECALL                  1
           1654 CALL                     1
           1664 LOAD_CONST               2 (0)
           1666 COMPARE_OP               4 (>)
           1672 POP_JUMP_FORWARD_IF_FALSE   126 (to 1926)

462        1674 LOAD_FAST                1 (positive_sample)
           1676 LOAD_FAST               11 (all_union_idxs)
           1678 BINARY_SUBSCR
           1688 STORE_FAST              19 (positive_sample_union)

463        1690 LOAD_GLOBAL             15 (NULL + torch)
           1702 LOAD_ATTR               13 (index_select)
           1712 LOAD_FAST                0 (self)
           1714 LOAD_ATTR               14 (entity_embedding)
           1724 LOAD_CONST               2 (0)
           1726 LOAD_FAST               19 (positive_sample_union)
           1728 KW_NAMES                 7
           1730 PRECALL                  3
           1734 CALL                     3
           1744 LOAD_METHOD              9 (unsqueeze)
           1766 LOAD_CONST               4 (1)
           1768 PRECALL                  1
           1772 CALL                     1
           1782 LOAD_METHOD              9 (unsqueeze)
           1804 LOAD_CONST               4 (1)
           1806 PRECALL                  1
           1810 CALL                     1
           1820 STORE_FAST              17 (positive_embedding)

464        1822 LOAD_FAST                0 (self)
           1824 LOAD_METHOD             15 (cal_logit_box)
           1846 LOAD_FAST               17 (positive_embedding)
           1848 LOAD_FAST                9 (all_union_center_embeddings)
           1850 LOAD_FAST               10 (all_union_offset_embeddings)
           1852 PRECALL                  3
           1856 CALL                     3
           1866 STORE_FAST              20 (positive_union_logit)

465        1868 LOAD_GLOBAL             15 (NULL + torch)
           1880 LOAD_ATTR               19 (max)
           1890 LOAD_FAST               20 (positive_union_logit)
           1892 LOAD_CONST               4 (1)
           1894 KW_NAMES                 3
           1896 PRECALL                  2
           1900 CALL                     2
           1910 LOAD_CONST               2 (0)
           1912 BINARY_SUBSCR
           1922 STORE_FAST              20 (positive_union_logit)
           1924 JUMP_FORWARD            49 (to 2024)

467     >> 1926 LOAD_GLOBAL             15 (NULL + torch)
           1938 LOAD_ATTR               16 (Tensor)
           1948 BUILD_LIST               0
           1950 PRECALL                  1
           1954 CALL                     1
           1964 LOAD_METHOD             17 (to)
           1986 LOAD_FAST                0 (self)
           1988 LOAD_ATTR               14 (entity_embedding)
           1998 LOAD_ATTR               18 (device)
           2008 PRECALL                  1
           2012 CALL                     1
           2022 STORE_FAST              20 (positive_union_logit)

468     >> 2024 LOAD_GLOBAL             15 (NULL + torch)
           2036 LOAD_ATTR                8 (cat)
           2046 LOAD_FAST               18 (positive_logit)
           2048 LOAD_FAST               20 (positive_union_logit)
           2050 BUILD_LIST               2
           2052 LOAD_CONST               2 (0)
           2054 KW_NAMES                 3
           2056 PRECALL                  2
           2060 CALL                     2
           2070 STORE_FAST              18 (positive_logit)
           2072 JUMP_FORWARD             2 (to 2078)

470     >> 2074 LOAD_CONST               0 (None)
           2076 STORE_FAST              18 (positive_logit)

472     >> 2078 LOAD_GLOBAL             25 (NULL + type)
           2090 LOAD_FAST                2 (negative_sample)
           2092 PRECALL                  1
           2096 CALL                     1
           2106 LOAD_GLOBAL             25 (NULL + type)
           2118 LOAD_CONST               0 (None)
           2120 PRECALL                  1
           2124 CALL                     1
           2134 COMPARE_OP               3 (!=)
           2140 EXTENDED_ARG             1
           2142 POP_JUMP_FORWARD_IF_FALSE   410 (to 2964)

473        2144 LOAD_GLOBAL             13 (NULL + len)
           2156 LOAD_FAST                6 (all_center_embeddings)
           2158 PRECALL                  1
           2162 CALL                     1
           2172 LOAD_CONST               2 (0)
           2174 COMPARE_OP               4 (>)
           2180 POP_JUMP_FORWARD_IF_FALSE   110 (to 2402)

474        2182 LOAD_FAST                2 (negative_sample)
           2184 LOAD_FAST                8 (all_idxs)
           2186 BINARY_SUBSCR
           2196 STORE_FAST              21 (negative_sample_regular)

475        2198 LOAD_FAST               21 (negative_sample_regular)
           2200 LOAD_ATTR               11 (shape)
           2210 UNPACK_SEQUENCE          2
           2214 STORE_FAST              22 (batch_size)
           2216 STORE_FAST              23 (negative_size)

476        2218 LOAD_GLOBAL             15 (NULL + torch)
           2230 LOAD_ATTR               13 (index_select)
           2240 LOAD_FAST                0 (self)
           2242 LOAD_ATTR               14 (entity_embedding)
           2252 LOAD_CONST               2 (0)
           2254 LOAD_FAST               21 (negative_sample_regular)
           2256 LOAD_METHOD             10 (view)
           2278 LOAD_CONST               6 (-1)
           2280 PRECALL                  1
           2284 CALL                     1
           2294 KW_NAMES                 7
           2296 PRECALL                  3
           2300 CALL                     3
           2310 LOAD_METHOD             10 (view)
           2332 LOAD_FAST               22 (batch_size)
           2334 LOAD_FAST               23 (negative_size)
           2336 LOAD_CONST               6 (-1)
           2338 PRECALL                  3
           2342 CALL                     3
           2352 STORE_FAST              24 (negative_embedding)

477        2354 LOAD_FAST                0 (self)
           2356 LOAD_METHOD             15 (cal_logit_box)
           2378 LOAD_FAST               24 (negative_embedding)
           2380 LOAD_FAST                6 (all_center_embeddings)
           2382 LOAD_FAST                7 (all_offset_embeddings)
           2384 PRECALL                  3
           2388 CALL                     3
           2398 STORE_FAST              25 (negative_logit)
           2400 JUMP_FORWARD            49 (to 2500)

479     >> 2402 LOAD_GLOBAL             15 (NULL + torch)
           2414 LOAD_ATTR               16 (Tensor)
           2424 BUILD_LIST               0
           2426 PRECALL                  1
           2430 CALL                     1
           2440 LOAD_METHOD             17 (to)
           2462 LOAD_FAST                0 (self)
           2464 LOAD_ATTR               14 (entity_embedding)
           2474 LOAD_ATTR               18 (device)
           2484 PRECALL                  1
           2488 CALL                     1
           2498 STORE_FAST              25 (negative_logit)

481     >> 2500 LOAD_GLOBAL             13 (NULL + len)
           2512 LOAD_FAST                9 (all_union_center_embeddings)
           2514 PRECALL                  1
           2518 CALL                     1
           2528 LOAD_CONST               2 (0)
           2530 COMPARE_OP               4 (>)
           2536 POP_JUMP_FORWARD_IF_FALSE   139 (to 2816)

482        2538 LOAD_FAST                2 (negative_sample)
           2540 LOAD_FAST               11 (all_union_idxs)
           2542 BINARY_SUBSCR
           2552 STORE_FAST              26 (negative_sample_union)

483        2554 LOAD_FAST               26 (negative_sample_union)
           2556 LOAD_ATTR               11 (shape)
           2566 UNPACK_SEQUENCE          2
           2570 STORE_FAST              22 (batch_size)
           2572 STORE_FAST              23 (negative_size)

484        2574 LOAD_GLOBAL             15 (NULL + torch)
           2586 LOAD_ATTR               13 (index_select)
           2596 LOAD_FAST                0 (self)
           2598 LOAD_ATTR               14 (entity_embedding)
           2608 LOAD_CONST               2 (0)
           2610 LOAD_FAST               26 (negative_sample_union)
           2612 LOAD_METHOD             10 (view)
           2634 LOAD_CONST               6 (-1)
           2636 PRECALL                  1
           2640 CALL                     1
           2650 KW_NAMES                 7
           2652 PRECALL                  3
           2656 CALL                     3
           2666 LOAD_METHOD             10 (view)
           2688 LOAD_FAST               22 (batch_size)
           2690 LOAD_CONST               4 (1)
           2692 LOAD_FAST               23 (negative_size)
           2694 LOAD_CONST               6 (-1)
           2696 PRECALL                  4
           2700 CALL                     4
           2710 STORE_FAST              24 (negative_embedding)

485        2712 LOAD_FAST                0 (self)
           2714 LOAD_METHOD             15 (cal_logit_box)
           2736 LOAD_FAST               24 (negative_embedding)
           2738 LOAD_FAST                9 (all_union_center_embeddings)
           2740 LOAD_FAST               10 (all_union_offset_embeddings)
           2742 PRECALL                  3
           2746 CALL                     3
           2756 STORE_FAST              27 (negative_union_logit)

486        2758 LOAD_GLOBAL             15 (NULL + torch)
           2770 LOAD_ATTR               19 (max)
           2780 LOAD_FAST               27 (negative_union_logit)
           2782 LOAD_CONST               4 (1)
           2784 KW_NAMES                 3
           2786 PRECALL                  2
           2790 CALL                     2
           2800 LOAD_CONST               2 (0)
           2802 BINARY_SUBSCR
           2812 STORE_FAST              27 (negative_union_logit)
           2814 JUMP_FORWARD            49 (to 2914)

488     >> 2816 LOAD_GLOBAL             15 (NULL + torch)
           2828 LOAD_ATTR               16 (Tensor)
           2838 BUILD_LIST               0
           2840 PRECALL                  1
           2844 CALL                     1
           2854 LOAD_METHOD             17 (to)
           2876 LOAD_FAST                0 (self)
           2878 LOAD_ATTR               14 (entity_embedding)
           2888 LOAD_ATTR               18 (device)
           2898 PRECALL                  1
           2902 CALL                     1
           2912 STORE_FAST              27 (negative_union_logit)

489     >> 2914 LOAD_GLOBAL             15 (NULL + torch)
           2926 LOAD_ATTR                8 (cat)
           2936 LOAD_FAST               25 (negative_logit)
           2938 LOAD_FAST               27 (negative_union_logit)
           2940 BUILD_LIST               2
           2942 LOAD_CONST               2 (0)
           2944 KW_NAMES                 3
           2946 PRECALL                  2
           2950 CALL                     2
           2960 STORE_FAST              25 (negative_logit)
           2962 JUMP_FORWARD             2 (to 2968)

491     >> 2964 LOAD_CONST               0 (None)
           2966 STORE_FAST              25 (negative_logit)

493     >> 2968 LOAD_FAST               18 (positive_logit)
           2970 LOAD_FAST               25 (negative_logit)
           2972 LOAD_FAST                3 (subsampling_weight)
           2974 LOAD_FAST                8 (all_idxs)
           2976 LOAD_FAST               11 (all_union_idxs)
           2978 BINARY_OP                0 (+)
           2982 BUILD_TUPLE              4
           2984 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box) (inline depth: 1)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), NNModuleVariable()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 348 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE PRECALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
                                                        ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                             query_structure,
                                                                             ^^^^^^^^^^^^^^^^
                                                                             0)
                                                                             ^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 3)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 3)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_BACKWARD 30 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 1186 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 1272 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2068 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2956 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2394 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_sample_regular = negative_sample[all_idxs]
                                          ~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_METHOD view [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE FX call view from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD view [TensorVariable()]
TRACE LOAD_FAST batch_size [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call view_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE PRECALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE inlined call cal_logit_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
                                 ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
413           0 RESUME                   0

414           2 LOAD_FAST                1 (entity_embedding)
              4 LOAD_FAST                2 (query_center_embedding)
              6 BINARY_OP               10 (-)
             10 LOAD_METHOD              0 (abs)
             32 PRECALL                  0
             36 CALL                     0
             46 STORE_FAST               4 (delta)

415          48 LOAD_GLOBAL              3 (NULL + F)
             60 LOAD_ATTR                2 (relu)
             70 LOAD_FAST                4 (delta)
             72 LOAD_FAST                3 (query_offset_embedding)
             74 BINARY_OP               10 (-)
             78 PRECALL                  1
             82 CALL                     1
             92 STORE_FAST               5 (distance_out)

416          94 LOAD_GLOBAL              7 (NULL + torch)
            106 LOAD_ATTR                4 (min)
            116 LOAD_FAST                4 (delta)
            118 LOAD_FAST                3 (query_offset_embedding)
            120 PRECALL                  2
            124 CALL                     2
            134 STORE_FAST               6 (distance_in)

417         136 LOAD_FAST                0 (self)
            138 LOAD_ATTR                5 (gamma)
            148 LOAD_GLOBAL              7 (NULL + torch)
            160 LOAD_ATTR                6 (norm)
            170 LOAD_FAST                5 (distance_out)
            172 LOAD_CONST               1 (1)
            174 LOAD_CONST               2 (-1)
            176 KW_NAMES                 3
            178 PRECALL                  3
            182 CALL                     3
            192 BINARY_OP               10 (-)
            196 LOAD_FAST                0 (self)
            198 LOAD_ATTR                7 (cen)
            208 LOAD_GLOBAL              7 (NULL + torch)
            220 LOAD_ATTR                6 (norm)
            230 LOAD_FAST                6 (distance_in)
            232 LOAD_CONST               1 (1)
            234 LOAD_CONST               2 (-1)
            236 KW_NAMES                 3
            238 PRECALL                  3
            242 CALL                     3
            252 BINARY_OP                5 (*)
            256 BINARY_OP               10 (-)
            260 STORE_FAST               7 (logit)

418         262 LOAD_FAST                7 (logit)
            264 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        delta = (entity_embedding - query_center_embedding).abs()
                 ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_METHOD abs [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE FX call abs_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        delta = (entity_embedding - query_center_embedding).abs()
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable(), TensorVariable()]
TRACE FX call sub_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_out = F.relu(delta - query_offset_embedding)
                              ~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_out = F.relu(delta - query_offset_embedding)
                       ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_in = torch.min(delta, query_offset_embedding)
                      ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                             ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                                ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                     ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2492 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2808 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [NullVariable, TorchVariable(<class 'torch.Tensor'>)]
TRACE PRECALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE CALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE FX call tensor from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~^^^^
TRACE LOAD_METHOD to [TensorVariable()]
TRACE LOAD_FAST self [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [NullVariable, GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE FX call to from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST negative_union_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable()]
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2960 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_OP 0 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object forward_box at 0x7316500, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 420>
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 196 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_4 =====
 <eval_with_key>.93 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_4 <eval_with_key>.93 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7fad600718a0>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7fad600718a0>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7facb1c64220>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7fad600718a0>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7facb1a74d60>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7facb1a74d60>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7fad600718a0>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_4 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:194
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:194 in forward (KGReasoning.forward)
        def forward(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:195 in forward (KGReasoning.forward)
            if self.geo == 'box':
TRACE LOAD_FAST self []
TRACE LOAD_ATTR geo [LazyVariableTracker()]
TRACE LOAD_CONST box [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 74 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:196 in forward (KGReasoning.forward)
                return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD forward_box [NNModuleVariable()]
TRACE LOAD_FAST positive_sample [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable())]
TRACE LOAD_FAST negative_sample [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_FAST subsampling_weight [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_queries_dict [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_idxs_dict [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE PRECALL 5 [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call forward_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:196 in forward (KGReasoning.forward)
            return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
                   ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object forward_box at 0x7316500, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 420>
420           0 RESUME                   0

421           2 BUILD_LIST               0
              4 BUILD_LIST               0
              6 BUILD_LIST               0
              8 STORE_FAST               8 (all_idxs)
             10 STORE_FAST               7 (all_offset_embeddings)
             12 STORE_FAST               6 (all_center_embeddings)

422          14 BUILD_LIST               0
             16 BUILD_LIST               0
             18 BUILD_LIST               0
             20 STORE_FAST              11 (all_union_idxs)
             22 STORE_FAST              10 (all_union_offset_embeddings)
             24 STORE_FAST               9 (all_union_center_embeddings)

423          26 LOAD_FAST                4 (batch_queries_dict)
             28 GET_ITER
        >>   30 EXTENDED_ARG             1
             32 FOR_ITER               262 (to 558)
             34 STORE_FAST              12 (query_structure)

424          36 LOAD_CONST               1 ('u')
             38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                0 (query_name_dict)
             50 LOAD_FAST               12 (query_structure)
             52 BINARY_SUBSCR
             62 CONTAINS_OP              0
             64 POP_JUMP_FORWARD_IF_FALSE   142 (to 350)

426          66 LOAD_FAST                0 (self)
             68 LOAD_METHOD              1 (embed_query_box)
             90 LOAD_FAST                0 (self)
             92 LOAD_METHOD              2 (transform_union_query)
            114 LOAD_FAST                4 (batch_queries_dict)
            116 LOAD_FAST               12 (query_structure)
            118 BINARY_SUBSCR

427         128 LOAD_FAST               12 (query_structure)

426         130 PRECALL                  2
            134 CALL                     2

428         144 LOAD_FAST                0 (self)
            146 LOAD_METHOD              3 (transform_union_structure)
            168 LOAD_FAST               12 (query_structure)
            170 PRECALL                  1
            174 CALL                     1

429         184 LOAD_CONST               2 (0)

426         186 PRECALL                  3
            190 CALL                     3

425         200 UNPACK_SEQUENCE          3
            204 STORE_FAST              13 (center_embedding)
            206 STORE_FAST              14 (offset_embedding)
            208 STORE_FAST              15 (_)

430         210 LOAD_FAST                9 (all_union_center_embeddings)
            212 LOAD_METHOD              4 (append)
            234 LOAD_FAST               13 (center_embedding)
            236 PRECALL                  1
            240 CALL                     1
            250 POP_TOP

431         252 LOAD_FAST               10 (all_union_offset_embeddings)
            254 LOAD_METHOD              4 (append)
            276 LOAD_FAST               14 (offset_embedding)
            278 PRECALL                  1
            282 CALL                     1
            292 POP_TOP

432         294 LOAD_FAST               11 (all_union_idxs)
            296 LOAD_METHOD              5 (extend)
            318 LOAD_FAST                5 (batch_idxs_dict)
            320 LOAD_FAST               12 (query_structure)
            322 BINARY_SUBSCR
            332 PRECALL                  1
            336 CALL                     1
            346 POP_TOP
            348 JUMP_BACKWARD          160 (to 30)

434     >>  350 LOAD_FAST                0 (self)
            352 LOAD_METHOD              1 (embed_query_box)
            374 LOAD_FAST                4 (batch_queries_dict)
            376 LOAD_FAST               12 (query_structure)
            378 BINARY_SUBSCR

435         388 LOAD_FAST               12 (query_structure)

436         390 LOAD_CONST               2 (0)

434         392 PRECALL                  3
            396 CALL                     3
            406 UNPACK_SEQUENCE          3
            410 STORE_FAST              13 (center_embedding)
            412 STORE_FAST              14 (offset_embedding)
            414 STORE_FAST              15 (_)

437         416 LOAD_FAST                6 (all_center_embeddings)
            418 LOAD_METHOD              4 (append)
            440 LOAD_FAST               13 (center_embedding)
            442 PRECALL                  1
            446 CALL                     1
            456 POP_TOP

438         458 LOAD_FAST                7 (all_offset_embeddings)
            460 LOAD_METHOD              4 (append)
            482 LOAD_FAST               14 (offset_embedding)
            484 PRECALL                  1
            488 CALL                     1
            498 POP_TOP

439         500 LOAD_FAST                8 (all_idxs)
            502 LOAD_METHOD              5 (extend)
            524 LOAD_FAST                5 (batch_idxs_dict)
            526 LOAD_FAST               12 (query_structure)
            528 BINARY_SUBSCR
            538 PRECALL                  1
            542 CALL                     1
            552 POP_TOP
            554 EXTENDED_ARG             1
            556 JUMP_BACKWARD          264 (to 30)

441     >>  558 LOAD_GLOBAL             13 (NULL + len)
            570 LOAD_FAST                6 (all_center_embeddings)
            572 PRECALL                  1
            576 CALL                     1
            586 LOAD_CONST               2 (0)
            588 COMPARE_OP               4 (>)
            594 POP_JUMP_FORWARD_IF_FALSE   101 (to 798)
            596 LOAD_GLOBAL             13 (NULL + len)
            608 LOAD_FAST                7 (all_offset_embeddings)
            610 PRECALL                  1
            614 CALL                     1
            624 LOAD_CONST               2 (0)
            626 COMPARE_OP               4 (>)
            632 POP_JUMP_FORWARD_IF_FALSE    82 (to 798)

442         634 LOAD_GLOBAL             15 (NULL + torch)
            646 LOAD_ATTR                8 (cat)
            656 LOAD_FAST                6 (all_center_embeddings)
            658 LOAD_CONST               2 (0)
            660 KW_NAMES                 3
            662 PRECALL                  2
            666 CALL                     2
            676 LOAD_METHOD              9 (unsqueeze)
            698 LOAD_CONST               4 (1)
            700 PRECALL                  1
            704 CALL                     1
            714 STORE_FAST               6 (all_center_embeddings)

443         716 LOAD_GLOBAL             15 (NULL + torch)
            728 LOAD_ATTR                8 (cat)
            738 LOAD_FAST                7 (all_offset_embeddings)
            740 LOAD_CONST               2 (0)
            742 KW_NAMES                 3
            744 PRECALL                  2
            748 CALL                     2
            758 LOAD_METHOD              9 (unsqueeze)
            780 LOAD_CONST               4 (1)
            782 PRECALL                  1
            786 CALL                     1
            796 STORE_FAST               7 (all_offset_embeddings)

444     >>  798 LOAD_GLOBAL             13 (NULL + len)
            810 LOAD_FAST                9 (all_union_center_embeddings)
            812 PRECALL                  1
            816 CALL                     1
            826 LOAD_CONST               2 (0)
            828 COMPARE_OP               4 (>)
            834 POP_JUMP_FORWARD_IF_FALSE   177 (to 1190)
            836 LOAD_GLOBAL             13 (NULL + len)
            848 LOAD_FAST               10 (all_union_offset_embeddings)
            850 PRECALL                  1
            854 CALL                     1
            864 LOAD_CONST               2 (0)
            866 COMPARE_OP               4 (>)
            872 POP_JUMP_FORWARD_IF_FALSE   158 (to 1190)

445         874 LOAD_GLOBAL             15 (NULL + torch)
            886 LOAD_ATTR                8 (cat)
            896 LOAD_FAST                9 (all_union_center_embeddings)
            898 LOAD_CONST               2 (0)
            900 KW_NAMES                 3
            902 PRECALL                  2
            906 CALL                     2
            916 LOAD_METHOD              9 (unsqueeze)
            938 LOAD_CONST               4 (1)
            940 PRECALL                  1
            944 CALL                     1
            954 STORE_FAST               9 (all_union_center_embeddings)

446         956 LOAD_GLOBAL             15 (NULL + torch)
            968 LOAD_ATTR                8 (cat)
            978 LOAD_FAST               10 (all_union_offset_embeddings)
            980 LOAD_CONST               2 (0)
            982 KW_NAMES                 3
            984 PRECALL                  2
            988 CALL                     2
            998 LOAD_METHOD              9 (unsqueeze)
           1020 LOAD_CONST               4 (1)
           1022 PRECALL                  1
           1026 CALL                     1
           1036 STORE_FAST              10 (all_union_offset_embeddings)

447        1038 LOAD_FAST                9 (all_union_center_embeddings)
           1040 LOAD_METHOD             10 (view)
           1062 LOAD_FAST                9 (all_union_center_embeddings)
           1064 LOAD_ATTR               11 (shape)
           1074 LOAD_CONST               2 (0)
           1076 BINARY_SUBSCR
           1086 LOAD_CONST               5 (2)
           1088 BINARY_OP                2 (//)
           1092 LOAD_CONST               5 (2)
           1094 LOAD_CONST               4 (1)
           1096 LOAD_CONST               6 (-1)
           1098 PRECALL                  4
           1102 CALL                     4
           1112 STORE_FAST               9 (all_union_center_embeddings)

448        1114 LOAD_FAST               10 (all_union_offset_embeddings)
           1116 LOAD_METHOD             10 (view)
           1138 LOAD_FAST               10 (all_union_offset_embeddings)
           1140 LOAD_ATTR               11 (shape)
           1150 LOAD_CONST               2 (0)
           1152 BINARY_SUBSCR
           1162 LOAD_CONST               5 (2)
           1164 BINARY_OP                2 (//)
           1168 LOAD_CONST               5 (2)
           1170 LOAD_CONST               4 (1)
           1172 LOAD_CONST               6 (-1)
           1174 PRECALL                  4
           1178 CALL                     4
           1188 STORE_FAST              10 (all_union_offset_embeddings)

450     >> 1190 LOAD_GLOBAL             25 (NULL + type)
           1202 LOAD_FAST                3 (subsampling_weight)
           1204 PRECALL                  1
           1208 CALL                     1
           1218 LOAD_GLOBAL             25 (NULL + type)
           1230 LOAD_CONST               0 (None)
           1232 PRECALL                  1
           1236 CALL                     1
           1246 COMPARE_OP               3 (!=)
           1252 POP_JUMP_FORWARD_IF_FALSE    11 (to 1276)

451        1254 LOAD_FAST                3 (subsampling_weight)
           1256 LOAD_FAST                8 (all_idxs)
           1258 LOAD_FAST               11 (all_union_idxs)
           1260 BINARY_OP                0 (+)
           1264 BINARY_SUBSCR
           1274 STORE_FAST               3 (subsampling_weight)

453     >> 1276 LOAD_GLOBAL             25 (NULL + type)
           1288 LOAD_FAST                1 (positive_sample)
           1290 PRECALL                  1
           1294 CALL                     1
           1304 LOAD_GLOBAL             25 (NULL + type)
           1316 LOAD_CONST               0 (None)
           1318 PRECALL                  1
           1322 CALL                     1
           1332 COMPARE_OP               3 (!=)
           1338 EXTENDED_ARG             1
           1340 POP_JUMP_FORWARD_IF_FALSE   366 (to 2074)

454        1342 LOAD_GLOBAL             13 (NULL + len)
           1354 LOAD_FAST                6 (all_center_embeddings)
           1356 PRECALL                  1
           1360 CALL                     1
           1370 LOAD_CONST               2 (0)
           1372 COMPARE_OP               4 (>)
           1378 POP_JUMP_FORWARD_IF_FALSE    79 (to 1538)

455        1380 LOAD_FAST                1 (positive_sample)
           1382 LOAD_FAST                8 (all_idxs)
           1384 BINARY_SUBSCR
           1394 STORE_FAST              16 (positive_sample_regular)

456        1396 LOAD_GLOBAL             15 (NULL + torch)
           1408 LOAD_ATTR               13 (index_select)
           1418 LOAD_FAST                0 (self)
           1420 LOAD_ATTR               14 (entity_embedding)
           1430 LOAD_CONST               2 (0)
           1432 LOAD_FAST               16 (positive_sample_regular)
           1434 KW_NAMES                 7
           1436 PRECALL                  3
           1440 CALL                     3
           1450 LOAD_METHOD              9 (unsqueeze)
           1472 LOAD_CONST               4 (1)
           1474 PRECALL                  1
           1478 CALL                     1
           1488 STORE_FAST              17 (positive_embedding)

457        1490 LOAD_FAST                0 (self)
           1492 LOAD_METHOD             15 (cal_logit_box)
           1514 LOAD_FAST               17 (positive_embedding)
           1516 LOAD_FAST                6 (all_center_embeddings)
           1518 LOAD_FAST                7 (all_offset_embeddings)
           1520 PRECALL                  3
           1524 CALL                     3
           1534 STORE_FAST              18 (positive_logit)
           1536 JUMP_FORWARD            49 (to 1636)

459     >> 1538 LOAD_GLOBAL             15 (NULL + torch)
           1550 LOAD_ATTR               16 (Tensor)
           1560 BUILD_LIST               0
           1562 PRECALL                  1
           1566 CALL                     1
           1576 LOAD_METHOD             17 (to)
           1598 LOAD_FAST                0 (self)
           1600 LOAD_ATTR               14 (entity_embedding)
           1610 LOAD_ATTR               18 (device)
           1620 PRECALL                  1
           1624 CALL                     1
           1634 STORE_FAST              18 (positive_logit)

461     >> 1636 LOAD_GLOBAL             13 (NULL + len)
           1648 LOAD_FAST                9 (all_union_center_embeddings)
           1650 PRECALL                  1
           1654 CALL                     1
           1664 LOAD_CONST               2 (0)
           1666 COMPARE_OP               4 (>)
           1672 POP_JUMP_FORWARD_IF_FALSE   126 (to 1926)

462        1674 LOAD_FAST                1 (positive_sample)
           1676 LOAD_FAST               11 (all_union_idxs)
           1678 BINARY_SUBSCR
           1688 STORE_FAST              19 (positive_sample_union)

463        1690 LOAD_GLOBAL             15 (NULL + torch)
           1702 LOAD_ATTR               13 (index_select)
           1712 LOAD_FAST                0 (self)
           1714 LOAD_ATTR               14 (entity_embedding)
           1724 LOAD_CONST               2 (0)
           1726 LOAD_FAST               19 (positive_sample_union)
           1728 KW_NAMES                 7
           1730 PRECALL                  3
           1734 CALL                     3
           1744 LOAD_METHOD              9 (unsqueeze)
           1766 LOAD_CONST               4 (1)
           1768 PRECALL                  1
           1772 CALL                     1
           1782 LOAD_METHOD              9 (unsqueeze)
           1804 LOAD_CONST               4 (1)
           1806 PRECALL                  1
           1810 CALL                     1
           1820 STORE_FAST              17 (positive_embedding)

464        1822 LOAD_FAST                0 (self)
           1824 LOAD_METHOD             15 (cal_logit_box)
           1846 LOAD_FAST               17 (positive_embedding)
           1848 LOAD_FAST                9 (all_union_center_embeddings)
           1850 LOAD_FAST               10 (all_union_offset_embeddings)
           1852 PRECALL                  3
           1856 CALL                     3
           1866 STORE_FAST              20 (positive_union_logit)

465        1868 LOAD_GLOBAL             15 (NULL + torch)
           1880 LOAD_ATTR               19 (max)
           1890 LOAD_FAST               20 (positive_union_logit)
           1892 LOAD_CONST               4 (1)
           1894 KW_NAMES                 3
           1896 PRECALL                  2
           1900 CALL                     2
           1910 LOAD_CONST               2 (0)
           1912 BINARY_SUBSCR
           1922 STORE_FAST              20 (positive_union_logit)
           1924 JUMP_FORWARD            49 (to 2024)

467     >> 1926 LOAD_GLOBAL             15 (NULL + torch)
           1938 LOAD_ATTR               16 (Tensor)
           1948 BUILD_LIST               0
           1950 PRECALL                  1
           1954 CALL                     1
           1964 LOAD_METHOD             17 (to)
           1986 LOAD_FAST                0 (self)
           1988 LOAD_ATTR               14 (entity_embedding)
           1998 LOAD_ATTR               18 (device)
           2008 PRECALL                  1
           2012 CALL                     1
           2022 STORE_FAST              20 (positive_union_logit)

468     >> 2024 LOAD_GLOBAL             15 (NULL + torch)
           2036 LOAD_ATTR                8 (cat)
           2046 LOAD_FAST               18 (positive_logit)
           2048 LOAD_FAST               20 (positive_union_logit)
           2050 BUILD_LIST               2
           2052 LOAD_CONST               2 (0)
           2054 KW_NAMES                 3
           2056 PRECALL                  2
           2060 CALL                     2
           2070 STORE_FAST              18 (positive_logit)
           2072 JUMP_FORWARD             2 (to 2078)

470     >> 2074 LOAD_CONST               0 (None)
           2076 STORE_FAST              18 (positive_logit)

472     >> 2078 LOAD_GLOBAL             25 (NULL + type)
           2090 LOAD_FAST                2 (negative_sample)
           2092 PRECALL                  1
           2096 CALL                     1
           2106 LOAD_GLOBAL             25 (NULL + type)
           2118 LOAD_CONST               0 (None)
           2120 PRECALL                  1
           2124 CALL                     1
           2134 COMPARE_OP               3 (!=)
           2140 EXTENDED_ARG             1
           2142 POP_JUMP_FORWARD_IF_FALSE   410 (to 2964)

473        2144 LOAD_GLOBAL             13 (NULL + len)
           2156 LOAD_FAST                6 (all_center_embeddings)
           2158 PRECALL                  1
           2162 CALL                     1
           2172 LOAD_CONST               2 (0)
           2174 COMPARE_OP               4 (>)
           2180 POP_JUMP_FORWARD_IF_FALSE   110 (to 2402)

474        2182 LOAD_FAST                2 (negative_sample)
           2184 LOAD_FAST                8 (all_idxs)
           2186 BINARY_SUBSCR
           2196 STORE_FAST              21 (negative_sample_regular)

475        2198 LOAD_FAST               21 (negative_sample_regular)
           2200 LOAD_ATTR               11 (shape)
           2210 UNPACK_SEQUENCE          2
           2214 STORE_FAST              22 (batch_size)
           2216 STORE_FAST              23 (negative_size)

476        2218 LOAD_GLOBAL             15 (NULL + torch)
           2230 LOAD_ATTR               13 (index_select)
           2240 LOAD_FAST                0 (self)
           2242 LOAD_ATTR               14 (entity_embedding)
           2252 LOAD_CONST               2 (0)
           2254 LOAD_FAST               21 (negative_sample_regular)
           2256 LOAD_METHOD             10 (view)
           2278 LOAD_CONST               6 (-1)
           2280 PRECALL                  1
           2284 CALL                     1
           2294 KW_NAMES                 7
           2296 PRECALL                  3
           2300 CALL                     3
           2310 LOAD_METHOD             10 (view)
           2332 LOAD_FAST               22 (batch_size)
           2334 LOAD_FAST               23 (negative_size)
           2336 LOAD_CONST               6 (-1)
           2338 PRECALL                  3
           2342 CALL                     3
           2352 STORE_FAST              24 (negative_embedding)

477        2354 LOAD_FAST                0 (self)
           2356 LOAD_METHOD             15 (cal_logit_box)
           2378 LOAD_FAST               24 (negative_embedding)
           2380 LOAD_FAST                6 (all_center_embeddings)
           2382 LOAD_FAST                7 (all_offset_embeddings)
           2384 PRECALL                  3
           2388 CALL                     3
           2398 STORE_FAST              25 (negative_logit)
           2400 JUMP_FORWARD            49 (to 2500)

479     >> 2402 LOAD_GLOBAL             15 (NULL + torch)
           2414 LOAD_ATTR               16 (Tensor)
           2424 BUILD_LIST               0
           2426 PRECALL                  1
           2430 CALL                     1
           2440 LOAD_METHOD             17 (to)
           2462 LOAD_FAST                0 (self)
           2464 LOAD_ATTR               14 (entity_embedding)
           2474 LOAD_ATTR               18 (device)
           2484 PRECALL                  1
           2488 CALL                     1
           2498 STORE_FAST              25 (negative_logit)

481     >> 2500 LOAD_GLOBAL             13 (NULL + len)
           2512 LOAD_FAST                9 (all_union_center_embeddings)
           2514 PRECALL                  1
           2518 CALL                     1
           2528 LOAD_CONST               2 (0)
           2530 COMPARE_OP               4 (>)
           2536 POP_JUMP_FORWARD_IF_FALSE   139 (to 2816)

482        2538 LOAD_FAST                2 (negative_sample)
           2540 LOAD_FAST               11 (all_union_idxs)
           2542 BINARY_SUBSCR
           2552 STORE_FAST              26 (negative_sample_union)

483        2554 LOAD_FAST               26 (negative_sample_union)
           2556 LOAD_ATTR               11 (shape)
           2566 UNPACK_SEQUENCE          2
           2570 STORE_FAST              22 (batch_size)
           2572 STORE_FAST              23 (negative_size)

484        2574 LOAD_GLOBAL             15 (NULL + torch)
           2586 LOAD_ATTR               13 (index_select)
           2596 LOAD_FAST                0 (self)
           2598 LOAD_ATTR               14 (entity_embedding)
           2608 LOAD_CONST               2 (0)
           2610 LOAD_FAST               26 (negative_sample_union)
           2612 LOAD_METHOD             10 (view)
           2634 LOAD_CONST               6 (-1)
           2636 PRECALL                  1
           2640 CALL                     1
           2650 KW_NAMES                 7
           2652 PRECALL                  3
           2656 CALL                     3
           2666 LOAD_METHOD             10 (view)
           2688 LOAD_FAST               22 (batch_size)
           2690 LOAD_CONST               4 (1)
           2692 LOAD_FAST               23 (negative_size)
           2694 LOAD_CONST               6 (-1)
           2696 PRECALL                  4
           2700 CALL                     4
           2710 STORE_FAST              24 (negative_embedding)

485        2712 LOAD_FAST                0 (self)
           2714 LOAD_METHOD             15 (cal_logit_box)
           2736 LOAD_FAST               24 (negative_embedding)
           2738 LOAD_FAST                9 (all_union_center_embeddings)
           2740 LOAD_FAST               10 (all_union_offset_embeddings)
           2742 PRECALL                  3
           2746 CALL                     3
           2756 STORE_FAST              27 (negative_union_logit)

486        2758 LOAD_GLOBAL             15 (NULL + torch)
           2770 LOAD_ATTR               19 (max)
           2780 LOAD_FAST               27 (negative_union_logit)
           2782 LOAD_CONST               4 (1)
           2784 KW_NAMES                 3
           2786 PRECALL                  2
           2790 CALL                     2
           2800 LOAD_CONST               2 (0)
           2802 BINARY_SUBSCR
           2812 STORE_FAST              27 (negative_union_logit)
           2814 JUMP_FORWARD            49 (to 2914)

488     >> 2816 LOAD_GLOBAL             15 (NULL + torch)
           2828 LOAD_ATTR               16 (Tensor)
           2838 BUILD_LIST               0
           2840 PRECALL                  1
           2844 CALL                     1
           2854 LOAD_METHOD             17 (to)
           2876 LOAD_FAST                0 (self)
           2878 LOAD_ATTR               14 (entity_embedding)
           2888 LOAD_ATTR               18 (device)
           2898 PRECALL                  1
           2902 CALL                     1
           2912 STORE_FAST              27 (negative_union_logit)

489     >> 2914 LOAD_GLOBAL             15 (NULL + torch)
           2926 LOAD_ATTR                8 (cat)
           2936 LOAD_FAST               25 (negative_logit)
           2938 LOAD_FAST               27 (negative_union_logit)
           2940 BUILD_LIST               2
           2942 LOAD_CONST               2 (0)
           2944 KW_NAMES                 3
           2946 PRECALL                  2
           2950 CALL                     2
           2960 STORE_FAST              25 (negative_logit)
           2962 JUMP_FORWARD             2 (to 2968)

491     >> 2964 LOAD_CONST               0 (None)
           2966 STORE_FAST              25 (negative_logit)

493     >> 2968 LOAD_FAST               18 (positive_logit)
           2970 LOAD_FAST               25 (negative_logit)
           2972 LOAD_FAST                3 (subsampling_weight)
           2974 LOAD_FAST                8 (all_idxs)
           2976 LOAD_FAST               11 (all_union_idxs)
           2978 BINARY_OP                0 (+)
           2982 BUILD_TUPLE              4
           2984 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box) (inline depth: 1)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), NNModuleVariable()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 348 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE PRECALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
                                                        ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                             query_structure,
                                                                             ^^^^^^^^^^^^^^^^
                                                                             0)
                                                                             ^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 3)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 3)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_BACKWARD 30 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 1186 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 1272 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2068 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2956 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2394 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_sample_regular = negative_sample[all_idxs]
                                          ~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_METHOD view [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE FX call view from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD view [TensorVariable()]
TRACE LOAD_FAST batch_size [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call view_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE PRECALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE inlined call cal_logit_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
                                 ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
413           0 RESUME                   0

414           2 LOAD_FAST                1 (entity_embedding)
              4 LOAD_FAST                2 (query_center_embedding)
              6 BINARY_OP               10 (-)
             10 LOAD_METHOD              0 (abs)
             32 PRECALL                  0
             36 CALL                     0
             46 STORE_FAST               4 (delta)

415          48 LOAD_GLOBAL              3 (NULL + F)
             60 LOAD_ATTR                2 (relu)
             70 LOAD_FAST                4 (delta)
             72 LOAD_FAST                3 (query_offset_embedding)
             74 BINARY_OP               10 (-)
             78 PRECALL                  1
             82 CALL                     1
             92 STORE_FAST               5 (distance_out)

416          94 LOAD_GLOBAL              7 (NULL + torch)
            106 LOAD_ATTR                4 (min)
            116 LOAD_FAST                4 (delta)
            118 LOAD_FAST                3 (query_offset_embedding)
            120 PRECALL                  2
            124 CALL                     2
            134 STORE_FAST               6 (distance_in)

417         136 LOAD_FAST                0 (self)
            138 LOAD_ATTR                5 (gamma)
            148 LOAD_GLOBAL              7 (NULL + torch)
            160 LOAD_ATTR                6 (norm)
            170 LOAD_FAST                5 (distance_out)
            172 LOAD_CONST               1 (1)
            174 LOAD_CONST               2 (-1)
            176 KW_NAMES                 3
            178 PRECALL                  3
            182 CALL                     3
            192 BINARY_OP               10 (-)
            196 LOAD_FAST                0 (self)
            198 LOAD_ATTR                7 (cen)
            208 LOAD_GLOBAL              7 (NULL + torch)
            220 LOAD_ATTR                6 (norm)
            230 LOAD_FAST                6 (distance_in)
            232 LOAD_CONST               1 (1)
            234 LOAD_CONST               2 (-1)
            236 KW_NAMES                 3
            238 PRECALL                  3
            242 CALL                     3
            252 BINARY_OP                5 (*)
            256 BINARY_OP               10 (-)
            260 STORE_FAST               7 (logit)

418         262 LOAD_FAST                7 (logit)
            264 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        delta = (entity_embedding - query_center_embedding).abs()
                 ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_METHOD abs [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE FX call abs_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        delta = (entity_embedding - query_center_embedding).abs()
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable(), TensorVariable()]
TRACE FX call sub_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_out = F.relu(delta - query_offset_embedding)
                              ~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_out = F.relu(delta - query_offset_embedding)
                       ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_in = torch.min(delta, query_offset_embedding)
                      ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                             ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                                ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                     ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2492 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2808 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [NullVariable, TorchVariable(<class 'torch.Tensor'>)]
TRACE PRECALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE CALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE FX call tensor from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~^^^^
TRACE LOAD_METHOD to [TensorVariable()]
TRACE LOAD_FAST self [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [NullVariable, GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE FX call to from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST negative_union_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable()]
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2960 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_OP 0 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object forward_box at 0x7316500, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 420>
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 196 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_5 =====
 <eval_with_key>.109 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_5 <eval_with_key>.109 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7fad600718a0>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7fad600718a0>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7facb1c64220>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7fad600718a0>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7facb1a74d60>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7facb1a74d60>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7fad600718a0>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_5 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:194
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:194 in forward (KGReasoning.forward)
        def forward(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:195 in forward (KGReasoning.forward)
            if self.geo == 'box':
TRACE LOAD_FAST self []
TRACE LOAD_ATTR geo [LazyVariableTracker()]
TRACE LOAD_CONST box [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 74 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:196 in forward (KGReasoning.forward)
                return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD forward_box [NNModuleVariable()]
TRACE LOAD_FAST positive_sample [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable())]
TRACE LOAD_FAST negative_sample [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_FAST subsampling_weight [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_queries_dict [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_idxs_dict [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE PRECALL 5 [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call forward_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:196 in forward (KGReasoning.forward)
            return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
                   ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object forward_box at 0x7316500, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 420>
420           0 RESUME                   0

421           2 BUILD_LIST               0
              4 BUILD_LIST               0
              6 BUILD_LIST               0
              8 STORE_FAST               8 (all_idxs)
             10 STORE_FAST               7 (all_offset_embeddings)
             12 STORE_FAST               6 (all_center_embeddings)

422          14 BUILD_LIST               0
             16 BUILD_LIST               0
             18 BUILD_LIST               0
             20 STORE_FAST              11 (all_union_idxs)
             22 STORE_FAST              10 (all_union_offset_embeddings)
             24 STORE_FAST               9 (all_union_center_embeddings)

423          26 LOAD_FAST                4 (batch_queries_dict)
             28 GET_ITER
        >>   30 EXTENDED_ARG             1
             32 FOR_ITER               262 (to 558)
             34 STORE_FAST              12 (query_structure)

424          36 LOAD_CONST               1 ('u')
             38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                0 (query_name_dict)
             50 LOAD_FAST               12 (query_structure)
             52 BINARY_SUBSCR
             62 CONTAINS_OP              0
             64 POP_JUMP_FORWARD_IF_FALSE   142 (to 350)

426          66 LOAD_FAST                0 (self)
             68 LOAD_METHOD              1 (embed_query_box)
             90 LOAD_FAST                0 (self)
             92 LOAD_METHOD              2 (transform_union_query)
            114 LOAD_FAST                4 (batch_queries_dict)
            116 LOAD_FAST               12 (query_structure)
            118 BINARY_SUBSCR

427         128 LOAD_FAST               12 (query_structure)

426         130 PRECALL                  2
            134 CALL                     2

428         144 LOAD_FAST                0 (self)
            146 LOAD_METHOD              3 (transform_union_structure)
            168 LOAD_FAST               12 (query_structure)
            170 PRECALL                  1
            174 CALL                     1

429         184 LOAD_CONST               2 (0)

426         186 PRECALL                  3
            190 CALL                     3

425         200 UNPACK_SEQUENCE          3
            204 STORE_FAST              13 (center_embedding)
            206 STORE_FAST              14 (offset_embedding)
            208 STORE_FAST              15 (_)

430         210 LOAD_FAST                9 (all_union_center_embeddings)
            212 LOAD_METHOD              4 (append)
            234 LOAD_FAST               13 (center_embedding)
            236 PRECALL                  1
            240 CALL                     1
            250 POP_TOP

431         252 LOAD_FAST               10 (all_union_offset_embeddings)
            254 LOAD_METHOD              4 (append)
            276 LOAD_FAST               14 (offset_embedding)
            278 PRECALL                  1
            282 CALL                     1
            292 POP_TOP

432         294 LOAD_FAST               11 (all_union_idxs)
            296 LOAD_METHOD              5 (extend)
            318 LOAD_FAST                5 (batch_idxs_dict)
            320 LOAD_FAST               12 (query_structure)
            322 BINARY_SUBSCR
            332 PRECALL                  1
            336 CALL                     1
            346 POP_TOP
            348 JUMP_BACKWARD          160 (to 30)

434     >>  350 LOAD_FAST                0 (self)
            352 LOAD_METHOD              1 (embed_query_box)
            374 LOAD_FAST                4 (batch_queries_dict)
            376 LOAD_FAST               12 (query_structure)
            378 BINARY_SUBSCR

435         388 LOAD_FAST               12 (query_structure)

436         390 LOAD_CONST               2 (0)

434         392 PRECALL                  3
            396 CALL                     3
            406 UNPACK_SEQUENCE          3
            410 STORE_FAST              13 (center_embedding)
            412 STORE_FAST              14 (offset_embedding)
            414 STORE_FAST              15 (_)

437         416 LOAD_FAST                6 (all_center_embeddings)
            418 LOAD_METHOD              4 (append)
            440 LOAD_FAST               13 (center_embedding)
            442 PRECALL                  1
            446 CALL                     1
            456 POP_TOP

438         458 LOAD_FAST                7 (all_offset_embeddings)
            460 LOAD_METHOD              4 (append)
            482 LOAD_FAST               14 (offset_embedding)
            484 PRECALL                  1
            488 CALL                     1
            498 POP_TOP

439         500 LOAD_FAST                8 (all_idxs)
            502 LOAD_METHOD              5 (extend)
            524 LOAD_FAST                5 (batch_idxs_dict)
            526 LOAD_FAST               12 (query_structure)
            528 BINARY_SUBSCR
            538 PRECALL                  1
            542 CALL                     1
            552 POP_TOP
            554 EXTENDED_ARG             1
            556 JUMP_BACKWARD          264 (to 30)

441     >>  558 LOAD_GLOBAL             13 (NULL + len)
            570 LOAD_FAST                6 (all_center_embeddings)
            572 PRECALL                  1
            576 CALL                     1
            586 LOAD_CONST               2 (0)
            588 COMPARE_OP               4 (>)
            594 POP_JUMP_FORWARD_IF_FALSE   101 (to 798)
            596 LOAD_GLOBAL             13 (NULL + len)
            608 LOAD_FAST                7 (all_offset_embeddings)
            610 PRECALL                  1
            614 CALL                     1
            624 LOAD_CONST               2 (0)
            626 COMPARE_OP               4 (>)
            632 POP_JUMP_FORWARD_IF_FALSE    82 (to 798)

442         634 LOAD_GLOBAL             15 (NULL + torch)
            646 LOAD_ATTR                8 (cat)
            656 LOAD_FAST                6 (all_center_embeddings)
            658 LOAD_CONST               2 (0)
            660 KW_NAMES                 3
            662 PRECALL                  2
            666 CALL                     2
            676 LOAD_METHOD              9 (unsqueeze)
            698 LOAD_CONST               4 (1)
            700 PRECALL                  1
            704 CALL                     1
            714 STORE_FAST               6 (all_center_embeddings)

443         716 LOAD_GLOBAL             15 (NULL + torch)
            728 LOAD_ATTR                8 (cat)
            738 LOAD_FAST                7 (all_offset_embeddings)
            740 LOAD_CONST               2 (0)
            742 KW_NAMES                 3
            744 PRECALL                  2
            748 CALL                     2
            758 LOAD_METHOD              9 (unsqueeze)
            780 LOAD_CONST               4 (1)
            782 PRECALL                  1
            786 CALL                     1
            796 STORE_FAST               7 (all_offset_embeddings)

444     >>  798 LOAD_GLOBAL             13 (NULL + len)
            810 LOAD_FAST                9 (all_union_center_embeddings)
            812 PRECALL                  1
            816 CALL                     1
            826 LOAD_CONST               2 (0)
            828 COMPARE_OP               4 (>)
            834 POP_JUMP_FORWARD_IF_FALSE   177 (to 1190)
            836 LOAD_GLOBAL             13 (NULL + len)
            848 LOAD_FAST               10 (all_union_offset_embeddings)
            850 PRECALL                  1
            854 CALL                     1
            864 LOAD_CONST               2 (0)
            866 COMPARE_OP               4 (>)
            872 POP_JUMP_FORWARD_IF_FALSE   158 (to 1190)

445         874 LOAD_GLOBAL             15 (NULL + torch)
            886 LOAD_ATTR                8 (cat)
            896 LOAD_FAST                9 (all_union_center_embeddings)
            898 LOAD_CONST               2 (0)
            900 KW_NAMES                 3
            902 PRECALL                  2
            906 CALL                     2
            916 LOAD_METHOD              9 (unsqueeze)
            938 LOAD_CONST               4 (1)
            940 PRECALL                  1
            944 CALL                     1
            954 STORE_FAST               9 (all_union_center_embeddings)

446         956 LOAD_GLOBAL             15 (NULL + torch)
            968 LOAD_ATTR                8 (cat)
            978 LOAD_FAST               10 (all_union_offset_embeddings)
            980 LOAD_CONST               2 (0)
            982 KW_NAMES                 3
            984 PRECALL                  2
            988 CALL                     2
            998 LOAD_METHOD              9 (unsqueeze)
           1020 LOAD_CONST               4 (1)
           1022 PRECALL                  1
           1026 CALL                     1
           1036 STORE_FAST              10 (all_union_offset_embeddings)

447        1038 LOAD_FAST                9 (all_union_center_embeddings)
           1040 LOAD_METHOD             10 (view)
           1062 LOAD_FAST                9 (all_union_center_embeddings)
           1064 LOAD_ATTR               11 (shape)
           1074 LOAD_CONST               2 (0)
           1076 BINARY_SUBSCR
           1086 LOAD_CONST               5 (2)
           1088 BINARY_OP                2 (//)
           1092 LOAD_CONST               5 (2)
           1094 LOAD_CONST               4 (1)
           1096 LOAD_CONST               6 (-1)
           1098 PRECALL                  4
           1102 CALL                     4
           1112 STORE_FAST               9 (all_union_center_embeddings)

448        1114 LOAD_FAST               10 (all_union_offset_embeddings)
           1116 LOAD_METHOD             10 (view)
           1138 LOAD_FAST               10 (all_union_offset_embeddings)
           1140 LOAD_ATTR               11 (shape)
           1150 LOAD_CONST               2 (0)
           1152 BINARY_SUBSCR
           1162 LOAD_CONST               5 (2)
           1164 BINARY_OP                2 (//)
           1168 LOAD_CONST               5 (2)
           1170 LOAD_CONST               4 (1)
           1172 LOAD_CONST               6 (-1)
           1174 PRECALL                  4
           1178 CALL                     4
           1188 STORE_FAST              10 (all_union_offset_embeddings)

450     >> 1190 LOAD_GLOBAL             25 (NULL + type)
           1202 LOAD_FAST                3 (subsampling_weight)
           1204 PRECALL                  1
           1208 CALL                     1
           1218 LOAD_GLOBAL             25 (NULL + type)
           1230 LOAD_CONST               0 (None)
           1232 PRECALL                  1
           1236 CALL                     1
           1246 COMPARE_OP               3 (!=)
           1252 POP_JUMP_FORWARD_IF_FALSE    11 (to 1276)

451        1254 LOAD_FAST                3 (subsampling_weight)
           1256 LOAD_FAST                8 (all_idxs)
           1258 LOAD_FAST               11 (all_union_idxs)
           1260 BINARY_OP                0 (+)
           1264 BINARY_SUBSCR
           1274 STORE_FAST               3 (subsampling_weight)

453     >> 1276 LOAD_GLOBAL             25 (NULL + type)
           1288 LOAD_FAST                1 (positive_sample)
           1290 PRECALL                  1
           1294 CALL                     1
           1304 LOAD_GLOBAL             25 (NULL + type)
           1316 LOAD_CONST               0 (None)
           1318 PRECALL                  1
           1322 CALL                     1
           1332 COMPARE_OP               3 (!=)
           1338 EXTENDED_ARG             1
           1340 POP_JUMP_FORWARD_IF_FALSE   366 (to 2074)

454        1342 LOAD_GLOBAL             13 (NULL + len)
           1354 LOAD_FAST                6 (all_center_embeddings)
           1356 PRECALL                  1
           1360 CALL                     1
           1370 LOAD_CONST               2 (0)
           1372 COMPARE_OP               4 (>)
           1378 POP_JUMP_FORWARD_IF_FALSE    79 (to 1538)

455        1380 LOAD_FAST                1 (positive_sample)
           1382 LOAD_FAST                8 (all_idxs)
           1384 BINARY_SUBSCR
           1394 STORE_FAST              16 (positive_sample_regular)

456        1396 LOAD_GLOBAL             15 (NULL + torch)
           1408 LOAD_ATTR               13 (index_select)
           1418 LOAD_FAST                0 (self)
           1420 LOAD_ATTR               14 (entity_embedding)
           1430 LOAD_CONST               2 (0)
           1432 LOAD_FAST               16 (positive_sample_regular)
           1434 KW_NAMES                 7
           1436 PRECALL                  3
           1440 CALL                     3
           1450 LOAD_METHOD              9 (unsqueeze)
           1472 LOAD_CONST               4 (1)
           1474 PRECALL                  1
           1478 CALL                     1
           1488 STORE_FAST              17 (positive_embedding)

457        1490 LOAD_FAST                0 (self)
           1492 LOAD_METHOD             15 (cal_logit_box)
           1514 LOAD_FAST               17 (positive_embedding)
           1516 LOAD_FAST                6 (all_center_embeddings)
           1518 LOAD_FAST                7 (all_offset_embeddings)
           1520 PRECALL                  3
           1524 CALL                     3
           1534 STORE_FAST              18 (positive_logit)
           1536 JUMP_FORWARD            49 (to 1636)

459     >> 1538 LOAD_GLOBAL             15 (NULL + torch)
           1550 LOAD_ATTR               16 (Tensor)
           1560 BUILD_LIST               0
           1562 PRECALL                  1
           1566 CALL                     1
           1576 LOAD_METHOD             17 (to)
           1598 LOAD_FAST                0 (self)
           1600 LOAD_ATTR               14 (entity_embedding)
           1610 LOAD_ATTR               18 (device)
           1620 PRECALL                  1
           1624 CALL                     1
           1634 STORE_FAST              18 (positive_logit)

461     >> 1636 LOAD_GLOBAL             13 (NULL + len)
           1648 LOAD_FAST                9 (all_union_center_embeddings)
           1650 PRECALL                  1
           1654 CALL                     1
           1664 LOAD_CONST               2 (0)
           1666 COMPARE_OP               4 (>)
           1672 POP_JUMP_FORWARD_IF_FALSE   126 (to 1926)

462        1674 LOAD_FAST                1 (positive_sample)
           1676 LOAD_FAST               11 (all_union_idxs)
           1678 BINARY_SUBSCR
           1688 STORE_FAST              19 (positive_sample_union)

463        1690 LOAD_GLOBAL             15 (NULL + torch)
           1702 LOAD_ATTR               13 (index_select)
           1712 LOAD_FAST                0 (self)
           1714 LOAD_ATTR               14 (entity_embedding)
           1724 LOAD_CONST               2 (0)
           1726 LOAD_FAST               19 (positive_sample_union)
           1728 KW_NAMES                 7
           1730 PRECALL                  3
           1734 CALL                     3
           1744 LOAD_METHOD              9 (unsqueeze)
           1766 LOAD_CONST               4 (1)
           1768 PRECALL                  1
           1772 CALL                     1
           1782 LOAD_METHOD              9 (unsqueeze)
           1804 LOAD_CONST               4 (1)
           1806 PRECALL                  1
           1810 CALL                     1
           1820 STORE_FAST              17 (positive_embedding)

464        1822 LOAD_FAST                0 (self)
           1824 LOAD_METHOD             15 (cal_logit_box)
           1846 LOAD_FAST               17 (positive_embedding)
           1848 LOAD_FAST                9 (all_union_center_embeddings)
           1850 LOAD_FAST               10 (all_union_offset_embeddings)
           1852 PRECALL                  3
           1856 CALL                     3
           1866 STORE_FAST              20 (positive_union_logit)

465        1868 LOAD_GLOBAL             15 (NULL + torch)
           1880 LOAD_ATTR               19 (max)
           1890 LOAD_FAST               20 (positive_union_logit)
           1892 LOAD_CONST               4 (1)
           1894 KW_NAMES                 3
           1896 PRECALL                  2
           1900 CALL                     2
           1910 LOAD_CONST               2 (0)
           1912 BINARY_SUBSCR
           1922 STORE_FAST              20 (positive_union_logit)
           1924 JUMP_FORWARD            49 (to 2024)

467     >> 1926 LOAD_GLOBAL             15 (NULL + torch)
           1938 LOAD_ATTR               16 (Tensor)
           1948 BUILD_LIST               0
           1950 PRECALL                  1
           1954 CALL                     1
           1964 LOAD_METHOD             17 (to)
           1986 LOAD_FAST                0 (self)
           1988 LOAD_ATTR               14 (entity_embedding)
           1998 LOAD_ATTR               18 (device)
           2008 PRECALL                  1
           2012 CALL                     1
           2022 STORE_FAST              20 (positive_union_logit)

468     >> 2024 LOAD_GLOBAL             15 (NULL + torch)
           2036 LOAD_ATTR                8 (cat)
           2046 LOAD_FAST               18 (positive_logit)
           2048 LOAD_FAST               20 (positive_union_logit)
           2050 BUILD_LIST               2
           2052 LOAD_CONST               2 (0)
           2054 KW_NAMES                 3
           2056 PRECALL                  2
           2060 CALL                     2
           2070 STORE_FAST              18 (positive_logit)
           2072 JUMP_FORWARD             2 (to 2078)

470     >> 2074 LOAD_CONST               0 (None)
           2076 STORE_FAST              18 (positive_logit)

472     >> 2078 LOAD_GLOBAL             25 (NULL + type)
           2090 LOAD_FAST                2 (negative_sample)
           2092 PRECALL                  1
           2096 CALL                     1
           2106 LOAD_GLOBAL             25 (NULL + type)
           2118 LOAD_CONST               0 (None)
           2120 PRECALL                  1
           2124 CALL                     1
           2134 COMPARE_OP               3 (!=)
           2140 EXTENDED_ARG             1
           2142 POP_JUMP_FORWARD_IF_FALSE   410 (to 2964)

473        2144 LOAD_GLOBAL             13 (NULL + len)
           2156 LOAD_FAST                6 (all_center_embeddings)
           2158 PRECALL                  1
           2162 CALL                     1
           2172 LOAD_CONST               2 (0)
           2174 COMPARE_OP               4 (>)
           2180 POP_JUMP_FORWARD_IF_FALSE   110 (to 2402)

474        2182 LOAD_FAST                2 (negative_sample)
           2184 LOAD_FAST                8 (all_idxs)
           2186 BINARY_SUBSCR
           2196 STORE_FAST              21 (negative_sample_regular)

475        2198 LOAD_FAST               21 (negative_sample_regular)
           2200 LOAD_ATTR               11 (shape)
           2210 UNPACK_SEQUENCE          2
           2214 STORE_FAST              22 (batch_size)
           2216 STORE_FAST              23 (negative_size)

476        2218 LOAD_GLOBAL             15 (NULL + torch)
           2230 LOAD_ATTR               13 (index_select)
           2240 LOAD_FAST                0 (self)
           2242 LOAD_ATTR               14 (entity_embedding)
           2252 LOAD_CONST               2 (0)
           2254 LOAD_FAST               21 (negative_sample_regular)
           2256 LOAD_METHOD             10 (view)
           2278 LOAD_CONST               6 (-1)
           2280 PRECALL                  1
           2284 CALL                     1
           2294 KW_NAMES                 7
           2296 PRECALL                  3
           2300 CALL                     3
           2310 LOAD_METHOD             10 (view)
           2332 LOAD_FAST               22 (batch_size)
           2334 LOAD_FAST               23 (negative_size)
           2336 LOAD_CONST               6 (-1)
           2338 PRECALL                  3
           2342 CALL                     3
           2352 STORE_FAST              24 (negative_embedding)

477        2354 LOAD_FAST                0 (self)
           2356 LOAD_METHOD             15 (cal_logit_box)
           2378 LOAD_FAST               24 (negative_embedding)
           2380 LOAD_FAST                6 (all_center_embeddings)
           2382 LOAD_FAST                7 (all_offset_embeddings)
           2384 PRECALL                  3
           2388 CALL                     3
           2398 STORE_FAST              25 (negative_logit)
           2400 JUMP_FORWARD            49 (to 2500)

479     >> 2402 LOAD_GLOBAL             15 (NULL + torch)
           2414 LOAD_ATTR               16 (Tensor)
           2424 BUILD_LIST               0
           2426 PRECALL                  1
           2430 CALL                     1
           2440 LOAD_METHOD             17 (to)
           2462 LOAD_FAST                0 (self)
           2464 LOAD_ATTR               14 (entity_embedding)
           2474 LOAD_ATTR               18 (device)
           2484 PRECALL                  1
           2488 CALL                     1
           2498 STORE_FAST              25 (negative_logit)

481     >> 2500 LOAD_GLOBAL             13 (NULL + len)
           2512 LOAD_FAST                9 (all_union_center_embeddings)
           2514 PRECALL                  1
           2518 CALL                     1
           2528 LOAD_CONST               2 (0)
           2530 COMPARE_OP               4 (>)
           2536 POP_JUMP_FORWARD_IF_FALSE   139 (to 2816)

482        2538 LOAD_FAST                2 (negative_sample)
           2540 LOAD_FAST               11 (all_union_idxs)
           2542 BINARY_SUBSCR
           2552 STORE_FAST              26 (negative_sample_union)

483        2554 LOAD_FAST               26 (negative_sample_union)
           2556 LOAD_ATTR               11 (shape)
           2566 UNPACK_SEQUENCE          2
           2570 STORE_FAST              22 (batch_size)
           2572 STORE_FAST              23 (negative_size)

484        2574 LOAD_GLOBAL             15 (NULL + torch)
           2586 LOAD_ATTR               13 (index_select)
           2596 LOAD_FAST                0 (self)
           2598 LOAD_ATTR               14 (entity_embedding)
           2608 LOAD_CONST               2 (0)
           2610 LOAD_FAST               26 (negative_sample_union)
           2612 LOAD_METHOD             10 (view)
           2634 LOAD_CONST               6 (-1)
           2636 PRECALL                  1
           2640 CALL                     1
           2650 KW_NAMES                 7
           2652 PRECALL                  3
           2656 CALL                     3
           2666 LOAD_METHOD             10 (view)
           2688 LOAD_FAST               22 (batch_size)
           2690 LOAD_CONST               4 (1)
           2692 LOAD_FAST               23 (negative_size)
           2694 LOAD_CONST               6 (-1)
           2696 PRECALL                  4
           2700 CALL                     4
           2710 STORE_FAST              24 (negative_embedding)

485        2712 LOAD_FAST                0 (self)
           2714 LOAD_METHOD             15 (cal_logit_box)
           2736 LOAD_FAST               24 (negative_embedding)
           2738 LOAD_FAST                9 (all_union_center_embeddings)
           2740 LOAD_FAST               10 (all_union_offset_embeddings)
           2742 PRECALL                  3
           2746 CALL                     3
           2756 STORE_FAST              27 (negative_union_logit)

486        2758 LOAD_GLOBAL             15 (NULL + torch)
           2770 LOAD_ATTR               19 (max)
           2780 LOAD_FAST               27 (negative_union_logit)
           2782 LOAD_CONST               4 (1)
           2784 KW_NAMES                 3
           2786 PRECALL                  2
           2790 CALL                     2
           2800 LOAD_CONST               2 (0)
           2802 BINARY_SUBSCR
           2812 STORE_FAST              27 (negative_union_logit)
           2814 JUMP_FORWARD            49 (to 2914)

488     >> 2816 LOAD_GLOBAL             15 (NULL + torch)
           2828 LOAD_ATTR               16 (Tensor)
           2838 BUILD_LIST               0
           2840 PRECALL                  1
           2844 CALL                     1
           2854 LOAD_METHOD             17 (to)
           2876 LOAD_FAST                0 (self)
           2878 LOAD_ATTR               14 (entity_embedding)
           2888 LOAD_ATTR               18 (device)
           2898 PRECALL                  1
           2902 CALL                     1
           2912 STORE_FAST              27 (negative_union_logit)

489     >> 2914 LOAD_GLOBAL             15 (NULL + torch)
           2926 LOAD_ATTR                8 (cat)
           2936 LOAD_FAST               25 (negative_logit)
           2938 LOAD_FAST               27 (negative_union_logit)
           2940 BUILD_LIST               2
           2942 LOAD_CONST               2 (0)
           2944 KW_NAMES                 3
           2946 PRECALL                  2
           2950 CALL                     2
           2960 STORE_FAST              25 (negative_logit)
           2962 JUMP_FORWARD             2 (to 2968)

491     >> 2964 LOAD_CONST               0 (None)
           2966 STORE_FAST              25 (negative_logit)

493     >> 2968 LOAD_FAST               18 (positive_logit)
           2970 LOAD_FAST               25 (negative_logit)
           2972 LOAD_FAST                3 (subsampling_weight)
           2974 LOAD_FAST                8 (all_idxs)
           2976 LOAD_FAST               11 (all_union_idxs)
           2978 BINARY_OP                0 (+)
           2982 BUILD_TUPLE              4
           2984 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box) (inline depth: 1)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), NNModuleVariable()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 348 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE PRECALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
                                                        ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                             query_structure,
                                                                             ^^^^^^^^^^^^^^^^
                                                                             0)
                                                                             ^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 3)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 3)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_BACKWARD 30 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 1186 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 1272 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2068 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2956 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2394 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_sample_regular = negative_sample[all_idxs]
                                          ~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_METHOD view [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE FX call view from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD view [TensorVariable()]
TRACE LOAD_FAST batch_size [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call view_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE PRECALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE inlined call cal_logit_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
                                 ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
413           0 RESUME                   0

414           2 LOAD_FAST                1 (entity_embedding)
              4 LOAD_FAST                2 (query_center_embedding)
              6 BINARY_OP               10 (-)
             10 LOAD_METHOD              0 (abs)
             32 PRECALL                  0
             36 CALL                     0
             46 STORE_FAST               4 (delta)

415          48 LOAD_GLOBAL              3 (NULL + F)
             60 LOAD_ATTR                2 (relu)
             70 LOAD_FAST                4 (delta)
             72 LOAD_FAST                3 (query_offset_embedding)
             74 BINARY_OP               10 (-)
             78 PRECALL                  1
             82 CALL                     1
             92 STORE_FAST               5 (distance_out)

416          94 LOAD_GLOBAL              7 (NULL + torch)
            106 LOAD_ATTR                4 (min)
            116 LOAD_FAST                4 (delta)
            118 LOAD_FAST                3 (query_offset_embedding)
            120 PRECALL                  2
            124 CALL                     2
            134 STORE_FAST               6 (distance_in)

417         136 LOAD_FAST                0 (self)
            138 LOAD_ATTR                5 (gamma)
            148 LOAD_GLOBAL              7 (NULL + torch)
            160 LOAD_ATTR                6 (norm)
            170 LOAD_FAST                5 (distance_out)
            172 LOAD_CONST               1 (1)
            174 LOAD_CONST               2 (-1)
            176 KW_NAMES                 3
            178 PRECALL                  3
            182 CALL                     3
            192 BINARY_OP               10 (-)
            196 LOAD_FAST                0 (self)
            198 LOAD_ATTR                7 (cen)
            208 LOAD_GLOBAL              7 (NULL + torch)
            220 LOAD_ATTR                6 (norm)
            230 LOAD_FAST                6 (distance_in)
            232 LOAD_CONST               1 (1)
            234 LOAD_CONST               2 (-1)
            236 KW_NAMES                 3
            238 PRECALL                  3
            242 CALL                     3
            252 BINARY_OP                5 (*)
            256 BINARY_OP               10 (-)
            260 STORE_FAST               7 (logit)

418         262 LOAD_FAST                7 (logit)
            264 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        delta = (entity_embedding - query_center_embedding).abs()
                 ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_METHOD abs [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE FX call abs_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        delta = (entity_embedding - query_center_embedding).abs()
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable(), TensorVariable()]
TRACE FX call sub_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_out = F.relu(delta - query_offset_embedding)
                              ~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_out = F.relu(delta - query_offset_embedding)
                       ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_in = torch.min(delta, query_offset_embedding)
                      ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                             ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                                ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                     ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2492 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2808 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [NullVariable, TorchVariable(<class 'torch.Tensor'>)]
TRACE PRECALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE CALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE FX call tensor from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~^^^^
TRACE LOAD_METHOD to [TensorVariable()]
TRACE LOAD_FAST self [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [NullVariable, GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE FX call to from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST negative_union_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable()]
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2960 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_OP 0 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object forward_box at 0x7316500, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 420>
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 196 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_6 =====
 <eval_with_key>.125 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_6 <eval_with_key>.125 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7fad600718a0>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7fad600718a0>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7facb1c64220>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7fad600718a0>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7facb1a74d60>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7facb1a74d60>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7fad600718a0>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_6 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:194
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:194 in forward (KGReasoning.forward)
        def forward(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:195 in forward (KGReasoning.forward)
            if self.geo == 'box':
TRACE LOAD_FAST self []
TRACE LOAD_ATTR geo [LazyVariableTracker()]
TRACE LOAD_CONST box [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 74 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:196 in forward (KGReasoning.forward)
                return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD forward_box [NNModuleVariable()]
TRACE LOAD_FAST positive_sample [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable())]
TRACE LOAD_FAST negative_sample [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_FAST subsampling_weight [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_queries_dict [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE LOAD_FAST batch_idxs_dict [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE PRECALL 5 [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE CALL 5 [NullVariable, UserMethodVariable(<function KGReasoning.forward_box at 0x7facb05736a0>, NNModuleVariable()), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker(), LazyVariableTracker()]
TRACE inlined call forward_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:196 in forward (KGReasoning.forward)
            return self.forward_box(positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict)
                   ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object forward_box at 0x7316500, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 420>
420           0 RESUME                   0

421           2 BUILD_LIST               0
              4 BUILD_LIST               0
              6 BUILD_LIST               0
              8 STORE_FAST               8 (all_idxs)
             10 STORE_FAST               7 (all_offset_embeddings)
             12 STORE_FAST               6 (all_center_embeddings)

422          14 BUILD_LIST               0
             16 BUILD_LIST               0
             18 BUILD_LIST               0
             20 STORE_FAST              11 (all_union_idxs)
             22 STORE_FAST              10 (all_union_offset_embeddings)
             24 STORE_FAST               9 (all_union_center_embeddings)

423          26 LOAD_FAST                4 (batch_queries_dict)
             28 GET_ITER
        >>   30 EXTENDED_ARG             1
             32 FOR_ITER               262 (to 558)
             34 STORE_FAST              12 (query_structure)

424          36 LOAD_CONST               1 ('u')
             38 LOAD_FAST                0 (self)
             40 LOAD_ATTR                0 (query_name_dict)
             50 LOAD_FAST               12 (query_structure)
             52 BINARY_SUBSCR
             62 CONTAINS_OP              0
             64 POP_JUMP_FORWARD_IF_FALSE   142 (to 350)

426          66 LOAD_FAST                0 (self)
             68 LOAD_METHOD              1 (embed_query_box)
             90 LOAD_FAST                0 (self)
             92 LOAD_METHOD              2 (transform_union_query)
            114 LOAD_FAST                4 (batch_queries_dict)
            116 LOAD_FAST               12 (query_structure)
            118 BINARY_SUBSCR

427         128 LOAD_FAST               12 (query_structure)

426         130 PRECALL                  2
            134 CALL                     2

428         144 LOAD_FAST                0 (self)
            146 LOAD_METHOD              3 (transform_union_structure)
            168 LOAD_FAST               12 (query_structure)
            170 PRECALL                  1
            174 CALL                     1

429         184 LOAD_CONST               2 (0)

426         186 PRECALL                  3
            190 CALL                     3

425         200 UNPACK_SEQUENCE          3
            204 STORE_FAST              13 (center_embedding)
            206 STORE_FAST              14 (offset_embedding)
            208 STORE_FAST              15 (_)

430         210 LOAD_FAST                9 (all_union_center_embeddings)
            212 LOAD_METHOD              4 (append)
            234 LOAD_FAST               13 (center_embedding)
            236 PRECALL                  1
            240 CALL                     1
            250 POP_TOP

431         252 LOAD_FAST               10 (all_union_offset_embeddings)
            254 LOAD_METHOD              4 (append)
            276 LOAD_FAST               14 (offset_embedding)
            278 PRECALL                  1
            282 CALL                     1
            292 POP_TOP

432         294 LOAD_FAST               11 (all_union_idxs)
            296 LOAD_METHOD              5 (extend)
            318 LOAD_FAST                5 (batch_idxs_dict)
            320 LOAD_FAST               12 (query_structure)
            322 BINARY_SUBSCR
            332 PRECALL                  1
            336 CALL                     1
            346 POP_TOP
            348 JUMP_BACKWARD          160 (to 30)

434     >>  350 LOAD_FAST                0 (self)
            352 LOAD_METHOD              1 (embed_query_box)
            374 LOAD_FAST                4 (batch_queries_dict)
            376 LOAD_FAST               12 (query_structure)
            378 BINARY_SUBSCR

435         388 LOAD_FAST               12 (query_structure)

436         390 LOAD_CONST               2 (0)

434         392 PRECALL                  3
            396 CALL                     3
            406 UNPACK_SEQUENCE          3
            410 STORE_FAST              13 (center_embedding)
            412 STORE_FAST              14 (offset_embedding)
            414 STORE_FAST              15 (_)

437         416 LOAD_FAST                6 (all_center_embeddings)
            418 LOAD_METHOD              4 (append)
            440 LOAD_FAST               13 (center_embedding)
            442 PRECALL                  1
            446 CALL                     1
            456 POP_TOP

438         458 LOAD_FAST                7 (all_offset_embeddings)
            460 LOAD_METHOD              4 (append)
            482 LOAD_FAST               14 (offset_embedding)
            484 PRECALL                  1
            488 CALL                     1
            498 POP_TOP

439         500 LOAD_FAST                8 (all_idxs)
            502 LOAD_METHOD              5 (extend)
            524 LOAD_FAST                5 (batch_idxs_dict)
            526 LOAD_FAST               12 (query_structure)
            528 BINARY_SUBSCR
            538 PRECALL                  1
            542 CALL                     1
            552 POP_TOP
            554 EXTENDED_ARG             1
            556 JUMP_BACKWARD          264 (to 30)

441     >>  558 LOAD_GLOBAL             13 (NULL + len)
            570 LOAD_FAST                6 (all_center_embeddings)
            572 PRECALL                  1
            576 CALL                     1
            586 LOAD_CONST               2 (0)
            588 COMPARE_OP               4 (>)
            594 POP_JUMP_FORWARD_IF_FALSE   101 (to 798)
            596 LOAD_GLOBAL             13 (NULL + len)
            608 LOAD_FAST                7 (all_offset_embeddings)
            610 PRECALL                  1
            614 CALL                     1
            624 LOAD_CONST               2 (0)
            626 COMPARE_OP               4 (>)
            632 POP_JUMP_FORWARD_IF_FALSE    82 (to 798)

442         634 LOAD_GLOBAL             15 (NULL + torch)
            646 LOAD_ATTR                8 (cat)
            656 LOAD_FAST                6 (all_center_embeddings)
            658 LOAD_CONST               2 (0)
            660 KW_NAMES                 3
            662 PRECALL                  2
            666 CALL                     2
            676 LOAD_METHOD              9 (unsqueeze)
            698 LOAD_CONST               4 (1)
            700 PRECALL                  1
            704 CALL                     1
            714 STORE_FAST               6 (all_center_embeddings)

443         716 LOAD_GLOBAL             15 (NULL + torch)
            728 LOAD_ATTR                8 (cat)
            738 LOAD_FAST                7 (all_offset_embeddings)
            740 LOAD_CONST               2 (0)
            742 KW_NAMES                 3
            744 PRECALL                  2
            748 CALL                     2
            758 LOAD_METHOD              9 (unsqueeze)
            780 LOAD_CONST               4 (1)
            782 PRECALL                  1
            786 CALL                     1
            796 STORE_FAST               7 (all_offset_embeddings)

444     >>  798 LOAD_GLOBAL             13 (NULL + len)
            810 LOAD_FAST                9 (all_union_center_embeddings)
            812 PRECALL                  1
            816 CALL                     1
            826 LOAD_CONST               2 (0)
            828 COMPARE_OP               4 (>)
            834 POP_JUMP_FORWARD_IF_FALSE   177 (to 1190)
            836 LOAD_GLOBAL             13 (NULL + len)
            848 LOAD_FAST               10 (all_union_offset_embeddings)
            850 PRECALL                  1
            854 CALL                     1
            864 LOAD_CONST               2 (0)
            866 COMPARE_OP               4 (>)
            872 POP_JUMP_FORWARD_IF_FALSE   158 (to 1190)

445         874 LOAD_GLOBAL             15 (NULL + torch)
            886 LOAD_ATTR                8 (cat)
            896 LOAD_FAST                9 (all_union_center_embeddings)
            898 LOAD_CONST               2 (0)
            900 KW_NAMES                 3
            902 PRECALL                  2
            906 CALL                     2
            916 LOAD_METHOD              9 (unsqueeze)
            938 LOAD_CONST               4 (1)
            940 PRECALL                  1
            944 CALL                     1
            954 STORE_FAST               9 (all_union_center_embeddings)

446         956 LOAD_GLOBAL             15 (NULL + torch)
            968 LOAD_ATTR                8 (cat)
            978 LOAD_FAST               10 (all_union_offset_embeddings)
            980 LOAD_CONST               2 (0)
            982 KW_NAMES                 3
            984 PRECALL                  2
            988 CALL                     2
            998 LOAD_METHOD              9 (unsqueeze)
           1020 LOAD_CONST               4 (1)
           1022 PRECALL                  1
           1026 CALL                     1
           1036 STORE_FAST              10 (all_union_offset_embeddings)

447        1038 LOAD_FAST                9 (all_union_center_embeddings)
           1040 LOAD_METHOD             10 (view)
           1062 LOAD_FAST                9 (all_union_center_embeddings)
           1064 LOAD_ATTR               11 (shape)
           1074 LOAD_CONST               2 (0)
           1076 BINARY_SUBSCR
           1086 LOAD_CONST               5 (2)
           1088 BINARY_OP                2 (//)
           1092 LOAD_CONST               5 (2)
           1094 LOAD_CONST               4 (1)
           1096 LOAD_CONST               6 (-1)
           1098 PRECALL                  4
           1102 CALL                     4
           1112 STORE_FAST               9 (all_union_center_embeddings)

448        1114 LOAD_FAST               10 (all_union_offset_embeddings)
           1116 LOAD_METHOD             10 (view)
           1138 LOAD_FAST               10 (all_union_offset_embeddings)
           1140 LOAD_ATTR               11 (shape)
           1150 LOAD_CONST               2 (0)
           1152 BINARY_SUBSCR
           1162 LOAD_CONST               5 (2)
           1164 BINARY_OP                2 (//)
           1168 LOAD_CONST               5 (2)
           1170 LOAD_CONST               4 (1)
           1172 LOAD_CONST               6 (-1)
           1174 PRECALL                  4
           1178 CALL                     4
           1188 STORE_FAST              10 (all_union_offset_embeddings)

450     >> 1190 LOAD_GLOBAL             25 (NULL + type)
           1202 LOAD_FAST                3 (subsampling_weight)
           1204 PRECALL                  1
           1208 CALL                     1
           1218 LOAD_GLOBAL             25 (NULL + type)
           1230 LOAD_CONST               0 (None)
           1232 PRECALL                  1
           1236 CALL                     1
           1246 COMPARE_OP               3 (!=)
           1252 POP_JUMP_FORWARD_IF_FALSE    11 (to 1276)

451        1254 LOAD_FAST                3 (subsampling_weight)
           1256 LOAD_FAST                8 (all_idxs)
           1258 LOAD_FAST               11 (all_union_idxs)
           1260 BINARY_OP                0 (+)
           1264 BINARY_SUBSCR
           1274 STORE_FAST               3 (subsampling_weight)

453     >> 1276 LOAD_GLOBAL             25 (NULL + type)
           1288 LOAD_FAST                1 (positive_sample)
           1290 PRECALL                  1
           1294 CALL                     1
           1304 LOAD_GLOBAL             25 (NULL + type)
           1316 LOAD_CONST               0 (None)
           1318 PRECALL                  1
           1322 CALL                     1
           1332 COMPARE_OP               3 (!=)
           1338 EXTENDED_ARG             1
           1340 POP_JUMP_FORWARD_IF_FALSE   366 (to 2074)

454        1342 LOAD_GLOBAL             13 (NULL + len)
           1354 LOAD_FAST                6 (all_center_embeddings)
           1356 PRECALL                  1
           1360 CALL                     1
           1370 LOAD_CONST               2 (0)
           1372 COMPARE_OP               4 (>)
           1378 POP_JUMP_FORWARD_IF_FALSE    79 (to 1538)

455        1380 LOAD_FAST                1 (positive_sample)
           1382 LOAD_FAST                8 (all_idxs)
           1384 BINARY_SUBSCR
           1394 STORE_FAST              16 (positive_sample_regular)

456        1396 LOAD_GLOBAL             15 (NULL + torch)
           1408 LOAD_ATTR               13 (index_select)
           1418 LOAD_FAST                0 (self)
           1420 LOAD_ATTR               14 (entity_embedding)
           1430 LOAD_CONST               2 (0)
           1432 LOAD_FAST               16 (positive_sample_regular)
           1434 KW_NAMES                 7
           1436 PRECALL                  3
           1440 CALL                     3
           1450 LOAD_METHOD              9 (unsqueeze)
           1472 LOAD_CONST               4 (1)
           1474 PRECALL                  1
           1478 CALL                     1
           1488 STORE_FAST              17 (positive_embedding)

457        1490 LOAD_FAST                0 (self)
           1492 LOAD_METHOD             15 (cal_logit_box)
           1514 LOAD_FAST               17 (positive_embedding)
           1516 LOAD_FAST                6 (all_center_embeddings)
           1518 LOAD_FAST                7 (all_offset_embeddings)
           1520 PRECALL                  3
           1524 CALL                     3
           1534 STORE_FAST              18 (positive_logit)
           1536 JUMP_FORWARD            49 (to 1636)

459     >> 1538 LOAD_GLOBAL             15 (NULL + torch)
           1550 LOAD_ATTR               16 (Tensor)
           1560 BUILD_LIST               0
           1562 PRECALL                  1
           1566 CALL                     1
           1576 LOAD_METHOD             17 (to)
           1598 LOAD_FAST                0 (self)
           1600 LOAD_ATTR               14 (entity_embedding)
           1610 LOAD_ATTR               18 (device)
           1620 PRECALL                  1
           1624 CALL                     1
           1634 STORE_FAST              18 (positive_logit)

461     >> 1636 LOAD_GLOBAL             13 (NULL + len)
           1648 LOAD_FAST                9 (all_union_center_embeddings)
           1650 PRECALL                  1
           1654 CALL                     1
           1664 LOAD_CONST               2 (0)
           1666 COMPARE_OP               4 (>)
           1672 POP_JUMP_FORWARD_IF_FALSE   126 (to 1926)

462        1674 LOAD_FAST                1 (positive_sample)
           1676 LOAD_FAST               11 (all_union_idxs)
           1678 BINARY_SUBSCR
           1688 STORE_FAST              19 (positive_sample_union)

463        1690 LOAD_GLOBAL             15 (NULL + torch)
           1702 LOAD_ATTR               13 (index_select)
           1712 LOAD_FAST                0 (self)
           1714 LOAD_ATTR               14 (entity_embedding)
           1724 LOAD_CONST               2 (0)
           1726 LOAD_FAST               19 (positive_sample_union)
           1728 KW_NAMES                 7
           1730 PRECALL                  3
           1734 CALL                     3
           1744 LOAD_METHOD              9 (unsqueeze)
           1766 LOAD_CONST               4 (1)
           1768 PRECALL                  1
           1772 CALL                     1
           1782 LOAD_METHOD              9 (unsqueeze)
           1804 LOAD_CONST               4 (1)
           1806 PRECALL                  1
           1810 CALL                     1
           1820 STORE_FAST              17 (positive_embedding)

464        1822 LOAD_FAST                0 (self)
           1824 LOAD_METHOD             15 (cal_logit_box)
           1846 LOAD_FAST               17 (positive_embedding)
           1848 LOAD_FAST                9 (all_union_center_embeddings)
           1850 LOAD_FAST               10 (all_union_offset_embeddings)
           1852 PRECALL                  3
           1856 CALL                     3
           1866 STORE_FAST              20 (positive_union_logit)

465        1868 LOAD_GLOBAL             15 (NULL + torch)
           1880 LOAD_ATTR               19 (max)
           1890 LOAD_FAST               20 (positive_union_logit)
           1892 LOAD_CONST               4 (1)
           1894 KW_NAMES                 3
           1896 PRECALL                  2
           1900 CALL                     2
           1910 LOAD_CONST               2 (0)
           1912 BINARY_SUBSCR
           1922 STORE_FAST              20 (positive_union_logit)
           1924 JUMP_FORWARD            49 (to 2024)

467     >> 1926 LOAD_GLOBAL             15 (NULL + torch)
           1938 LOAD_ATTR               16 (Tensor)
           1948 BUILD_LIST               0
           1950 PRECALL                  1
           1954 CALL                     1
           1964 LOAD_METHOD             17 (to)
           1986 LOAD_FAST                0 (self)
           1988 LOAD_ATTR               14 (entity_embedding)
           1998 LOAD_ATTR               18 (device)
           2008 PRECALL                  1
           2012 CALL                     1
           2022 STORE_FAST              20 (positive_union_logit)

468     >> 2024 LOAD_GLOBAL             15 (NULL + torch)
           2036 LOAD_ATTR                8 (cat)
           2046 LOAD_FAST               18 (positive_logit)
           2048 LOAD_FAST               20 (positive_union_logit)
           2050 BUILD_LIST               2
           2052 LOAD_CONST               2 (0)
           2054 KW_NAMES                 3
           2056 PRECALL                  2
           2060 CALL                     2
           2070 STORE_FAST              18 (positive_logit)
           2072 JUMP_FORWARD             2 (to 2078)

470     >> 2074 LOAD_CONST               0 (None)
           2076 STORE_FAST              18 (positive_logit)

472     >> 2078 LOAD_GLOBAL             25 (NULL + type)
           2090 LOAD_FAST                2 (negative_sample)
           2092 PRECALL                  1
           2096 CALL                     1
           2106 LOAD_GLOBAL             25 (NULL + type)
           2118 LOAD_CONST               0 (None)
           2120 PRECALL                  1
           2124 CALL                     1
           2134 COMPARE_OP               3 (!=)
           2140 EXTENDED_ARG             1
           2142 POP_JUMP_FORWARD_IF_FALSE   410 (to 2964)

473        2144 LOAD_GLOBAL             13 (NULL + len)
           2156 LOAD_FAST                6 (all_center_embeddings)
           2158 PRECALL                  1
           2162 CALL                     1
           2172 LOAD_CONST               2 (0)
           2174 COMPARE_OP               4 (>)
           2180 POP_JUMP_FORWARD_IF_FALSE   110 (to 2402)

474        2182 LOAD_FAST                2 (negative_sample)
           2184 LOAD_FAST                8 (all_idxs)
           2186 BINARY_SUBSCR
           2196 STORE_FAST              21 (negative_sample_regular)

475        2198 LOAD_FAST               21 (negative_sample_regular)
           2200 LOAD_ATTR               11 (shape)
           2210 UNPACK_SEQUENCE          2
           2214 STORE_FAST              22 (batch_size)
           2216 STORE_FAST              23 (negative_size)

476        2218 LOAD_GLOBAL             15 (NULL + torch)
           2230 LOAD_ATTR               13 (index_select)
           2240 LOAD_FAST                0 (self)
           2242 LOAD_ATTR               14 (entity_embedding)
           2252 LOAD_CONST               2 (0)
           2254 LOAD_FAST               21 (negative_sample_regular)
           2256 LOAD_METHOD             10 (view)
           2278 LOAD_CONST               6 (-1)
           2280 PRECALL                  1
           2284 CALL                     1
           2294 KW_NAMES                 7
           2296 PRECALL                  3
           2300 CALL                     3
           2310 LOAD_METHOD             10 (view)
           2332 LOAD_FAST               22 (batch_size)
           2334 LOAD_FAST               23 (negative_size)
           2336 LOAD_CONST               6 (-1)
           2338 PRECALL                  3
           2342 CALL                     3
           2352 STORE_FAST              24 (negative_embedding)

477        2354 LOAD_FAST                0 (self)
           2356 LOAD_METHOD             15 (cal_logit_box)
           2378 LOAD_FAST               24 (negative_embedding)
           2380 LOAD_FAST                6 (all_center_embeddings)
           2382 LOAD_FAST                7 (all_offset_embeddings)
           2384 PRECALL                  3
           2388 CALL                     3
           2398 STORE_FAST              25 (negative_logit)
           2400 JUMP_FORWARD            49 (to 2500)

479     >> 2402 LOAD_GLOBAL             15 (NULL + torch)
           2414 LOAD_ATTR               16 (Tensor)
           2424 BUILD_LIST               0
           2426 PRECALL                  1
           2430 CALL                     1
           2440 LOAD_METHOD             17 (to)
           2462 LOAD_FAST                0 (self)
           2464 LOAD_ATTR               14 (entity_embedding)
           2474 LOAD_ATTR               18 (device)
           2484 PRECALL                  1
           2488 CALL                     1
           2498 STORE_FAST              25 (negative_logit)

481     >> 2500 LOAD_GLOBAL             13 (NULL + len)
           2512 LOAD_FAST                9 (all_union_center_embeddings)
           2514 PRECALL                  1
           2518 CALL                     1
           2528 LOAD_CONST               2 (0)
           2530 COMPARE_OP               4 (>)
           2536 POP_JUMP_FORWARD_IF_FALSE   139 (to 2816)

482        2538 LOAD_FAST                2 (negative_sample)
           2540 LOAD_FAST               11 (all_union_idxs)
           2542 BINARY_SUBSCR
           2552 STORE_FAST              26 (negative_sample_union)

483        2554 LOAD_FAST               26 (negative_sample_union)
           2556 LOAD_ATTR               11 (shape)
           2566 UNPACK_SEQUENCE          2
           2570 STORE_FAST              22 (batch_size)
           2572 STORE_FAST              23 (negative_size)

484        2574 LOAD_GLOBAL             15 (NULL + torch)
           2586 LOAD_ATTR               13 (index_select)
           2596 LOAD_FAST                0 (self)
           2598 LOAD_ATTR               14 (entity_embedding)
           2608 LOAD_CONST               2 (0)
           2610 LOAD_FAST               26 (negative_sample_union)
           2612 LOAD_METHOD             10 (view)
           2634 LOAD_CONST               6 (-1)
           2636 PRECALL                  1
           2640 CALL                     1
           2650 KW_NAMES                 7
           2652 PRECALL                  3
           2656 CALL                     3
           2666 LOAD_METHOD             10 (view)
           2688 LOAD_FAST               22 (batch_size)
           2690 LOAD_CONST               4 (1)
           2692 LOAD_FAST               23 (negative_size)
           2694 LOAD_CONST               6 (-1)
           2696 PRECALL                  4
           2700 CALL                     4
           2710 STORE_FAST              24 (negative_embedding)

485        2712 LOAD_FAST                0 (self)
           2714 LOAD_METHOD             15 (cal_logit_box)
           2736 LOAD_FAST               24 (negative_embedding)
           2738 LOAD_FAST                9 (all_union_center_embeddings)
           2740 LOAD_FAST               10 (all_union_offset_embeddings)
           2742 PRECALL                  3
           2746 CALL                     3
           2756 STORE_FAST              27 (negative_union_logit)

486        2758 LOAD_GLOBAL             15 (NULL + torch)
           2770 LOAD_ATTR               19 (max)
           2780 LOAD_FAST               27 (negative_union_logit)
           2782 LOAD_CONST               4 (1)
           2784 KW_NAMES                 3
           2786 PRECALL                  2
           2790 CALL                     2
           2800 LOAD_CONST               2 (0)
           2802 BINARY_SUBSCR
           2812 STORE_FAST              27 (negative_union_logit)
           2814 JUMP_FORWARD            49 (to 2914)

488     >> 2816 LOAD_GLOBAL             15 (NULL + torch)
           2828 LOAD_ATTR               16 (Tensor)
           2838 BUILD_LIST               0
           2840 PRECALL                  1
           2844 CALL                     1
           2854 LOAD_METHOD             17 (to)
           2876 LOAD_FAST                0 (self)
           2878 LOAD_ATTR               14 (entity_embedding)
           2888 LOAD_ATTR               18 (device)
           2898 PRECALL                  1
           2902 CALL                     1
           2912 STORE_FAST              27 (negative_union_logit)

489     >> 2914 LOAD_GLOBAL             15 (NULL + torch)
           2926 LOAD_ATTR                8 (cat)
           2936 LOAD_FAST               25 (negative_logit)
           2938 LOAD_FAST               27 (negative_union_logit)
           2940 BUILD_LIST               2
           2942 LOAD_CONST               2 (0)
           2944 KW_NAMES                 3
           2946 PRECALL                  2
           2950 CALL                     2
           2960 STORE_FAST              25 (negative_logit)
           2962 JUMP_FORWARD             2 (to 2968)

491     >> 2964 LOAD_CONST               0 (None)
           2966 STORE_FAST              25 (negative_logit)

493     >> 2968 LOAD_FAST               18 (positive_logit)
           2970 LOAD_FAST               25 (negative_logit)
           2972 LOAD_FAST                3 (subsampling_weight)
           2974 LOAD_FAST                8 (all_idxs)
           2976 LOAD_FAST               11 (all_union_idxs)
           2978 BINARY_OP                0 (+)
           2982 BUILD_TUPLE              4
           2984 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box) (inline depth: 1)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), NNModuleVariable()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 348 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE PRECALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
                                                        ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                             query_structure,
                                                                             ^^^^^^^^^^^^^^^^
                                                                             0)
                                                                             ^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 3)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 3)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_BACKWARD 30 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 1186 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 1272 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2068 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2956 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2394 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_sample_regular = negative_sample[all_idxs]
                                          ~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_METHOD view [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE FX call view from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD view [TensorVariable()]
TRACE LOAD_FAST batch_size [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call view_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE PRECALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE inlined call cal_logit_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
                                 ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
413           0 RESUME                   0

414           2 LOAD_FAST                1 (entity_embedding)
              4 LOAD_FAST                2 (query_center_embedding)
              6 BINARY_OP               10 (-)
             10 LOAD_METHOD              0 (abs)
             32 PRECALL                  0
             36 CALL                     0
             46 STORE_FAST               4 (delta)

415          48 LOAD_GLOBAL              3 (NULL + F)
             60 LOAD_ATTR                2 (relu)
             70 LOAD_FAST                4 (delta)
             72 LOAD_FAST                3 (query_offset_embedding)
             74 BINARY_OP               10 (-)
             78 PRECALL                  1
             82 CALL                     1
             92 STORE_FAST               5 (distance_out)

416          94 LOAD_GLOBAL              7 (NULL + torch)
            106 LOAD_ATTR                4 (min)
            116 LOAD_FAST                4 (delta)
            118 LOAD_FAST                3 (query_offset_embedding)
            120 PRECALL                  2
            124 CALL                     2
            134 STORE_FAST               6 (distance_in)

417         136 LOAD_FAST                0 (self)
            138 LOAD_ATTR                5 (gamma)
            148 LOAD_GLOBAL              7 (NULL + torch)
            160 LOAD_ATTR                6 (norm)
            170 LOAD_FAST                5 (distance_out)
            172 LOAD_CONST               1 (1)
            174 LOAD_CONST               2 (-1)
            176 KW_NAMES                 3
            178 PRECALL                  3
            182 CALL                     3
            192 BINARY_OP               10 (-)
            196 LOAD_FAST                0 (self)
            198 LOAD_ATTR                7 (cen)
            208 LOAD_GLOBAL              7 (NULL + torch)
            220 LOAD_ATTR                6 (norm)
            230 LOAD_FAST                6 (distance_in)
            232 LOAD_CONST               1 (1)
            234 LOAD_CONST               2 (-1)
            236 KW_NAMES                 3
            238 PRECALL                  3
            242 CALL                     3
            252 BINARY_OP                5 (*)
            256 BINARY_OP               10 (-)
            260 STORE_FAST               7 (logit)

418         262 LOAD_FAST                7 (logit)
            264 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        delta = (entity_embedding - query_center_embedding).abs()
                 ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_METHOD abs [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE FX call abs_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        delta = (entity_embedding - query_center_embedding).abs()
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable(), TensorVariable()]
TRACE FX call sub_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_out = F.relu(delta - query_offset_embedding)
                              ~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_out = F.relu(delta - query_offset_embedding)
                       ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        distance_in = torch.min(delta, query_offset_embedding)
                      ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                             ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                                ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                     ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 2)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2492 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2808 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [NullVariable, TorchVariable(<class 'torch.Tensor'>)]
TRACE PRECALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE CALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE FX call tensor from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~^^^^
TRACE LOAD_METHOD to [TensorVariable()]
TRACE LOAD_FAST self [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [NullVariable, GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE FX call to from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST negative_union_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable()]
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2960 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box) (inline depth: 1)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_OP 0 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object forward_box at 0x7316500, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 420>
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 196 in forward>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_7 =====
 <eval_with_key>.141 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_7 <eval_with_key>.141 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7fad600718a0>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7fad600718a0>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7facb1c64220>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7fad600718a0>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7facb1a74d60>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7facb1a74d60>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7fad600718a0>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_7 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward_box /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), LazyVariableTracker()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 348 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE PRECALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
                                                        ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                             query_structure,
                                                                             ^^^^^^^^^^^^^^^^
                                                                             0)
                                                                             ^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_BACKWARD 30 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 1186 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 1272 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2068 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2956 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2394 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                negative_sample_regular = negative_sample[all_idxs]
                                          ~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_METHOD view [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE FX call view from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD view [TensorVariable()]
TRACE LOAD_FAST batch_size [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call view_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE PRECALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE inlined call cal_logit_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
                                 ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
413           0 RESUME                   0

414           2 LOAD_FAST                1 (entity_embedding)
              4 LOAD_FAST                2 (query_center_embedding)
              6 BINARY_OP               10 (-)
             10 LOAD_METHOD              0 (abs)
             32 PRECALL                  0
             36 CALL                     0
             46 STORE_FAST               4 (delta)

415          48 LOAD_GLOBAL              3 (NULL + F)
             60 LOAD_ATTR                2 (relu)
             70 LOAD_FAST                4 (delta)
             72 LOAD_FAST                3 (query_offset_embedding)
             74 BINARY_OP               10 (-)
             78 PRECALL                  1
             82 CALL                     1
             92 STORE_FAST               5 (distance_out)

416          94 LOAD_GLOBAL              7 (NULL + torch)
            106 LOAD_ATTR                4 (min)
            116 LOAD_FAST                4 (delta)
            118 LOAD_FAST                3 (query_offset_embedding)
            120 PRECALL                  2
            124 CALL                     2
            134 STORE_FAST               6 (distance_in)

417         136 LOAD_FAST                0 (self)
            138 LOAD_ATTR                5 (gamma)
            148 LOAD_GLOBAL              7 (NULL + torch)
            160 LOAD_ATTR                6 (norm)
            170 LOAD_FAST                5 (distance_out)
            172 LOAD_CONST               1 (1)
            174 LOAD_CONST               2 (-1)
            176 KW_NAMES                 3
            178 PRECALL                  3
            182 CALL                     3
            192 BINARY_OP               10 (-)
            196 LOAD_FAST                0 (self)
            198 LOAD_ATTR                7 (cen)
            208 LOAD_GLOBAL              7 (NULL + torch)
            220 LOAD_ATTR                6 (norm)
            230 LOAD_FAST                6 (distance_in)
            232 LOAD_CONST               1 (1)
            234 LOAD_CONST               2 (-1)
            236 KW_NAMES                 3
            238 PRECALL                  3
            242 CALL                     3
            252 BINARY_OP                5 (*)
            256 BINARY_OP               10 (-)
            260 STORE_FAST               7 (logit)

418         262 LOAD_FAST                7 (logit)
            264 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        delta = (entity_embedding - query_center_embedding).abs()
                 ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_METHOD abs [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE FX call abs_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        delta = (entity_embedding - query_center_embedding).abs()
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable(), TensorVariable()]
TRACE FX call sub_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_out = F.relu(delta - query_offset_embedding)
                              ~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_out = F.relu(delta - query_offset_embedding)
                       ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_in = torch.min(delta, query_offset_embedding)
                      ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                             ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                                ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                     ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2492 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2808 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [NullVariable, TorchVariable(<class 'torch.Tensor'>)]
TRACE PRECALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE CALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE FX call tensor from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~^^^^
TRACE LOAD_METHOD to [TensorVariable()]
TRACE LOAD_FAST self [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [NullVariable, GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE FX call to from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST negative_union_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable()]
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
            negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2960 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_OP 0 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 493 in forward_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_8 =====
 <eval_with_key>.157 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_8 <eval_with_key>.157 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7fad600718a0>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7fad600718a0>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7facb1c64220>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7fad600718a0>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7facb1a74d60>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7facb1a74d60>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7fad600718a0>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_8 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward_box /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), LazyVariableTracker()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 348 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE PRECALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
                                                        ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                             query_structure,
                                                                             ^^^^^^^^^^^^^^^^
                                                                             0)
                                                                             ^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_BACKWARD 30 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 1186 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 1272 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2068 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2956 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2394 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                negative_sample_regular = negative_sample[all_idxs]
                                          ~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_METHOD view [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE FX call view from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD view [TensorVariable()]
TRACE LOAD_FAST batch_size [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call view_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE PRECALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE inlined call cal_logit_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
                                 ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
413           0 RESUME                   0

414           2 LOAD_FAST                1 (entity_embedding)
              4 LOAD_FAST                2 (query_center_embedding)
              6 BINARY_OP               10 (-)
             10 LOAD_METHOD              0 (abs)
             32 PRECALL                  0
             36 CALL                     0
             46 STORE_FAST               4 (delta)

415          48 LOAD_GLOBAL              3 (NULL + F)
             60 LOAD_ATTR                2 (relu)
             70 LOAD_FAST                4 (delta)
             72 LOAD_FAST                3 (query_offset_embedding)
             74 BINARY_OP               10 (-)
             78 PRECALL                  1
             82 CALL                     1
             92 STORE_FAST               5 (distance_out)

416          94 LOAD_GLOBAL              7 (NULL + torch)
            106 LOAD_ATTR                4 (min)
            116 LOAD_FAST                4 (delta)
            118 LOAD_FAST                3 (query_offset_embedding)
            120 PRECALL                  2
            124 CALL                     2
            134 STORE_FAST               6 (distance_in)

417         136 LOAD_FAST                0 (self)
            138 LOAD_ATTR                5 (gamma)
            148 LOAD_GLOBAL              7 (NULL + torch)
            160 LOAD_ATTR                6 (norm)
            170 LOAD_FAST                5 (distance_out)
            172 LOAD_CONST               1 (1)
            174 LOAD_CONST               2 (-1)
            176 KW_NAMES                 3
            178 PRECALL                  3
            182 CALL                     3
            192 BINARY_OP               10 (-)
            196 LOAD_FAST                0 (self)
            198 LOAD_ATTR                7 (cen)
            208 LOAD_GLOBAL              7 (NULL + torch)
            220 LOAD_ATTR                6 (norm)
            230 LOAD_FAST                6 (distance_in)
            232 LOAD_CONST               1 (1)
            234 LOAD_CONST               2 (-1)
            236 KW_NAMES                 3
            238 PRECALL                  3
            242 CALL                     3
            252 BINARY_OP                5 (*)
            256 BINARY_OP               10 (-)
            260 STORE_FAST               7 (logit)

418         262 LOAD_FAST                7 (logit)
            264 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        delta = (entity_embedding - query_center_embedding).abs()
                 ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_METHOD abs [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE FX call abs_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        delta = (entity_embedding - query_center_embedding).abs()
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable(), TensorVariable()]
TRACE FX call sub_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_out = F.relu(delta - query_offset_embedding)
                              ~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_out = F.relu(delta - query_offset_embedding)
                       ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_in = torch.min(delta, query_offset_embedding)
                      ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                             ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                                ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                     ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2492 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2808 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [NullVariable, TorchVariable(<class 'torch.Tensor'>)]
TRACE PRECALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE CALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE FX call tensor from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~^^^^
TRACE LOAD_METHOD to [TensorVariable()]
TRACE LOAD_FAST self [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [NullVariable, GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE FX call to from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST negative_union_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable()]
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
            negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2960 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_OP 0 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 493 in forward_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_9 =====
 <eval_with_key>.173 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_9 <eval_with_key>.173 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7fad600718a0>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7fad600718a0>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7facb1c64220>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7fad600718a0>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7facb1a74d60>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7facb1a74d60>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7fad600718a0>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_9 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward_box /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), LazyVariableTracker()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 348 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE PRECALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
                                                        ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                             query_structure,
                                                                             ^^^^^^^^^^^^^^^^
                                                                             0)
                                                                             ^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_BACKWARD 30 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 1186 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 1272 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2068 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2956 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2394 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                negative_sample_regular = negative_sample[all_idxs]
                                          ~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_METHOD view [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE FX call view from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD view [TensorVariable()]
TRACE LOAD_FAST batch_size [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call view_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE PRECALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE inlined call cal_logit_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
                                 ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
413           0 RESUME                   0

414           2 LOAD_FAST                1 (entity_embedding)
              4 LOAD_FAST                2 (query_center_embedding)
              6 BINARY_OP               10 (-)
             10 LOAD_METHOD              0 (abs)
             32 PRECALL                  0
             36 CALL                     0
             46 STORE_FAST               4 (delta)

415          48 LOAD_GLOBAL              3 (NULL + F)
             60 LOAD_ATTR                2 (relu)
             70 LOAD_FAST                4 (delta)
             72 LOAD_FAST                3 (query_offset_embedding)
             74 BINARY_OP               10 (-)
             78 PRECALL                  1
             82 CALL                     1
             92 STORE_FAST               5 (distance_out)

416          94 LOAD_GLOBAL              7 (NULL + torch)
            106 LOAD_ATTR                4 (min)
            116 LOAD_FAST                4 (delta)
            118 LOAD_FAST                3 (query_offset_embedding)
            120 PRECALL                  2
            124 CALL                     2
            134 STORE_FAST               6 (distance_in)

417         136 LOAD_FAST                0 (self)
            138 LOAD_ATTR                5 (gamma)
            148 LOAD_GLOBAL              7 (NULL + torch)
            160 LOAD_ATTR                6 (norm)
            170 LOAD_FAST                5 (distance_out)
            172 LOAD_CONST               1 (1)
            174 LOAD_CONST               2 (-1)
            176 KW_NAMES                 3
            178 PRECALL                  3
            182 CALL                     3
            192 BINARY_OP               10 (-)
            196 LOAD_FAST                0 (self)
            198 LOAD_ATTR                7 (cen)
            208 LOAD_GLOBAL              7 (NULL + torch)
            220 LOAD_ATTR                6 (norm)
            230 LOAD_FAST                6 (distance_in)
            232 LOAD_CONST               1 (1)
            234 LOAD_CONST               2 (-1)
            236 KW_NAMES                 3
            238 PRECALL                  3
            242 CALL                     3
            252 BINARY_OP                5 (*)
            256 BINARY_OP               10 (-)
            260 STORE_FAST               7 (logit)

418         262 LOAD_FAST                7 (logit)
            264 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        delta = (entity_embedding - query_center_embedding).abs()
                 ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_METHOD abs [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE FX call abs_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        delta = (entity_embedding - query_center_embedding).abs()
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable(), TensorVariable()]
TRACE FX call sub_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_out = F.relu(delta - query_offset_embedding)
                              ~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_out = F.relu(delta - query_offset_embedding)
                       ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_in = torch.min(delta, query_offset_embedding)
                      ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                             ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                                ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                     ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2492 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2808 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [NullVariable, TorchVariable(<class 'torch.Tensor'>)]
TRACE PRECALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE CALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE FX call tensor from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~^^^^
TRACE LOAD_METHOD to [TensorVariable()]
TRACE LOAD_FAST self [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [NullVariable, GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE FX call to from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST negative_union_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable()]
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
            negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2960 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_OP 0 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 493 in forward_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_10 =====
 <eval_with_key>.189 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_10 <eval_with_key>.189 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7fad600718a0>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7fad600718a0>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7facb1c64220>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7fad600718a0>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7facb1a74d60>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7facb1a74d60>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7fad600718a0>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_10 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward_box /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), LazyVariableTracker()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 348 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE PRECALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
                                                        ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                             query_structure,
                                                                             ^^^^^^^^^^^^^^^^
                                                                             0)
                                                                             ^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_BACKWARD 30 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 1186 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 1272 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2068 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2956 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2394 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                negative_sample_regular = negative_sample[all_idxs]
                                          ~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_METHOD view [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE FX call view from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD view [TensorVariable()]
TRACE LOAD_FAST batch_size [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call view_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE PRECALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE inlined call cal_logit_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
                                 ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
413           0 RESUME                   0

414           2 LOAD_FAST                1 (entity_embedding)
              4 LOAD_FAST                2 (query_center_embedding)
              6 BINARY_OP               10 (-)
             10 LOAD_METHOD              0 (abs)
             32 PRECALL                  0
             36 CALL                     0
             46 STORE_FAST               4 (delta)

415          48 LOAD_GLOBAL              3 (NULL + F)
             60 LOAD_ATTR                2 (relu)
             70 LOAD_FAST                4 (delta)
             72 LOAD_FAST                3 (query_offset_embedding)
             74 BINARY_OP               10 (-)
             78 PRECALL                  1
             82 CALL                     1
             92 STORE_FAST               5 (distance_out)

416          94 LOAD_GLOBAL              7 (NULL + torch)
            106 LOAD_ATTR                4 (min)
            116 LOAD_FAST                4 (delta)
            118 LOAD_FAST                3 (query_offset_embedding)
            120 PRECALL                  2
            124 CALL                     2
            134 STORE_FAST               6 (distance_in)

417         136 LOAD_FAST                0 (self)
            138 LOAD_ATTR                5 (gamma)
            148 LOAD_GLOBAL              7 (NULL + torch)
            160 LOAD_ATTR                6 (norm)
            170 LOAD_FAST                5 (distance_out)
            172 LOAD_CONST               1 (1)
            174 LOAD_CONST               2 (-1)
            176 KW_NAMES                 3
            178 PRECALL                  3
            182 CALL                     3
            192 BINARY_OP               10 (-)
            196 LOAD_FAST                0 (self)
            198 LOAD_ATTR                7 (cen)
            208 LOAD_GLOBAL              7 (NULL + torch)
            220 LOAD_ATTR                6 (norm)
            230 LOAD_FAST                6 (distance_in)
            232 LOAD_CONST               1 (1)
            234 LOAD_CONST               2 (-1)
            236 KW_NAMES                 3
            238 PRECALL                  3
            242 CALL                     3
            252 BINARY_OP                5 (*)
            256 BINARY_OP               10 (-)
            260 STORE_FAST               7 (logit)

418         262 LOAD_FAST                7 (logit)
            264 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        delta = (entity_embedding - query_center_embedding).abs()
                 ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_METHOD abs [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE FX call abs_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        delta = (entity_embedding - query_center_embedding).abs()
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable(), TensorVariable()]
TRACE FX call sub_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_out = F.relu(delta - query_offset_embedding)
                              ~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_out = F.relu(delta - query_offset_embedding)
                       ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_in = torch.min(delta, query_offset_embedding)
                      ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                             ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                                ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                     ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2492 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2808 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [NullVariable, TorchVariable(<class 'torch.Tensor'>)]
TRACE PRECALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE CALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE FX call tensor from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~^^^^
TRACE LOAD_METHOD to [TensorVariable()]
TRACE LOAD_FAST self [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [NullVariable, GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE FX call to from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST negative_union_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable()]
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
            negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2960 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_OP 0 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 493 in forward_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_11 =====
 <eval_with_key>.205 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_11 <eval_with_key>.205 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7fad600718a0>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7fad600718a0>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7facb1c64220>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7fad600718a0>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7facb1a74d60>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7facb1a74d60>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7fad600718a0>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_11 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward_box /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), LazyVariableTracker()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 348 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE PRECALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
                                                        ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                             query_structure,
                                                                             ^^^^^^^^^^^^^^^^
                                                                             0)
                                                                             ^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_BACKWARD 30 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 1186 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 1272 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2068 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2956 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2394 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                negative_sample_regular = negative_sample[all_idxs]
                                          ~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_METHOD view [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE FX call view from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD view [TensorVariable()]
TRACE LOAD_FAST batch_size [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call view_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE PRECALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE inlined call cal_logit_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
                                 ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
413           0 RESUME                   0

414           2 LOAD_FAST                1 (entity_embedding)
              4 LOAD_FAST                2 (query_center_embedding)
              6 BINARY_OP               10 (-)
             10 LOAD_METHOD              0 (abs)
             32 PRECALL                  0
             36 CALL                     0
             46 STORE_FAST               4 (delta)

415          48 LOAD_GLOBAL              3 (NULL + F)
             60 LOAD_ATTR                2 (relu)
             70 LOAD_FAST                4 (delta)
             72 LOAD_FAST                3 (query_offset_embedding)
             74 BINARY_OP               10 (-)
             78 PRECALL                  1
             82 CALL                     1
             92 STORE_FAST               5 (distance_out)

416          94 LOAD_GLOBAL              7 (NULL + torch)
            106 LOAD_ATTR                4 (min)
            116 LOAD_FAST                4 (delta)
            118 LOAD_FAST                3 (query_offset_embedding)
            120 PRECALL                  2
            124 CALL                     2
            134 STORE_FAST               6 (distance_in)

417         136 LOAD_FAST                0 (self)
            138 LOAD_ATTR                5 (gamma)
            148 LOAD_GLOBAL              7 (NULL + torch)
            160 LOAD_ATTR                6 (norm)
            170 LOAD_FAST                5 (distance_out)
            172 LOAD_CONST               1 (1)
            174 LOAD_CONST               2 (-1)
            176 KW_NAMES                 3
            178 PRECALL                  3
            182 CALL                     3
            192 BINARY_OP               10 (-)
            196 LOAD_FAST                0 (self)
            198 LOAD_ATTR                7 (cen)
            208 LOAD_GLOBAL              7 (NULL + torch)
            220 LOAD_ATTR                6 (norm)
            230 LOAD_FAST                6 (distance_in)
            232 LOAD_CONST               1 (1)
            234 LOAD_CONST               2 (-1)
            236 KW_NAMES                 3
            238 PRECALL                  3
            242 CALL                     3
            252 BINARY_OP                5 (*)
            256 BINARY_OP               10 (-)
            260 STORE_FAST               7 (logit)

418         262 LOAD_FAST                7 (logit)
            264 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        delta = (entity_embedding - query_center_embedding).abs()
                 ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_METHOD abs [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE FX call abs_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        delta = (entity_embedding - query_center_embedding).abs()
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable(), TensorVariable()]
TRACE FX call sub_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_out = F.relu(delta - query_offset_embedding)
                              ~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_out = F.relu(delta - query_offset_embedding)
                       ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_in = torch.min(delta, query_offset_embedding)
                      ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                             ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                                ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                     ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2492 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2808 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [NullVariable, TorchVariable(<class 'torch.Tensor'>)]
TRACE PRECALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE CALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE FX call tensor from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~^^^^
TRACE LOAD_METHOD to [TensorVariable()]
TRACE LOAD_FAST self [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [NullVariable, GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE FX call to from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST negative_union_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable()]
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
            negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2960 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_OP 0 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 493 in forward_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_12 =====
 <eval_with_key>.221 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_12 <eval_with_key>.221 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7fad600718a0>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7fad600718a0>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7facb1c64220>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7fad600718a0>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7facb1a74d60>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7facb1a74d60>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7fad600718a0>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_12 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward_box /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), LazyVariableTracker()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 348 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE PRECALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
                                                        ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                             query_structure,
                                                                             ^^^^^^^^^^^^^^^^
                                                                             0)
                                                                             ^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_BACKWARD 30 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 1186 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 1272 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2068 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2956 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2394 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                negative_sample_regular = negative_sample[all_idxs]
                                          ~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_METHOD view [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE FX call view from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD view [TensorVariable()]
TRACE LOAD_FAST batch_size [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call view_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE PRECALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE inlined call cal_logit_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
                                 ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
413           0 RESUME                   0

414           2 LOAD_FAST                1 (entity_embedding)
              4 LOAD_FAST                2 (query_center_embedding)
              6 BINARY_OP               10 (-)
             10 LOAD_METHOD              0 (abs)
             32 PRECALL                  0
             36 CALL                     0
             46 STORE_FAST               4 (delta)

415          48 LOAD_GLOBAL              3 (NULL + F)
             60 LOAD_ATTR                2 (relu)
             70 LOAD_FAST                4 (delta)
             72 LOAD_FAST                3 (query_offset_embedding)
             74 BINARY_OP               10 (-)
             78 PRECALL                  1
             82 CALL                     1
             92 STORE_FAST               5 (distance_out)

416          94 LOAD_GLOBAL              7 (NULL + torch)
            106 LOAD_ATTR                4 (min)
            116 LOAD_FAST                4 (delta)
            118 LOAD_FAST                3 (query_offset_embedding)
            120 PRECALL                  2
            124 CALL                     2
            134 STORE_FAST               6 (distance_in)

417         136 LOAD_FAST                0 (self)
            138 LOAD_ATTR                5 (gamma)
            148 LOAD_GLOBAL              7 (NULL + torch)
            160 LOAD_ATTR                6 (norm)
            170 LOAD_FAST                5 (distance_out)
            172 LOAD_CONST               1 (1)
            174 LOAD_CONST               2 (-1)
            176 KW_NAMES                 3
            178 PRECALL                  3
            182 CALL                     3
            192 BINARY_OP               10 (-)
            196 LOAD_FAST                0 (self)
            198 LOAD_ATTR                7 (cen)
            208 LOAD_GLOBAL              7 (NULL + torch)
            220 LOAD_ATTR                6 (norm)
            230 LOAD_FAST                6 (distance_in)
            232 LOAD_CONST               1 (1)
            234 LOAD_CONST               2 (-1)
            236 KW_NAMES                 3
            238 PRECALL                  3
            242 CALL                     3
            252 BINARY_OP                5 (*)
            256 BINARY_OP               10 (-)
            260 STORE_FAST               7 (logit)

418         262 LOAD_FAST                7 (logit)
            264 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        delta = (entity_embedding - query_center_embedding).abs()
                 ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_METHOD abs [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE FX call abs_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        delta = (entity_embedding - query_center_embedding).abs()
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable(), TensorVariable()]
TRACE FX call sub_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_out = F.relu(delta - query_offset_embedding)
                              ~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_out = F.relu(delta - query_offset_embedding)
                       ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_in = torch.min(delta, query_offset_embedding)
                      ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                             ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                                ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                     ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2492 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2808 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [NullVariable, TorchVariable(<class 'torch.Tensor'>)]
TRACE PRECALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE CALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE FX call tensor from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~^^^^
TRACE LOAD_METHOD to [TensorVariable()]
TRACE LOAD_FAST self [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [NullVariable, GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE FX call to from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST negative_union_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable()]
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
            negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2960 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_OP 0 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 493 in forward_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_13 =====
 <eval_with_key>.237 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_13 <eval_with_key>.237 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7fad600718a0>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7fad600718a0>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7facb1c64220>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7fad600718a0>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7facb1a74d60>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7facb1a74d60>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7fad600718a0>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_13 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward_box /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), LazyVariableTracker()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 348 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE PRECALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
                                                        ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                             query_structure,
                                                                             ^^^^^^^^^^^^^^^^
                                                                             0)
                                                                             ^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_BACKWARD 30 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 1186 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 1272 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2068 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2956 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2394 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                negative_sample_regular = negative_sample[all_idxs]
                                          ~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_METHOD view [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE FX call view from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD view [TensorVariable()]
TRACE LOAD_FAST batch_size [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call view_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE PRECALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE inlined call cal_logit_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
                                 ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
413           0 RESUME                   0

414           2 LOAD_FAST                1 (entity_embedding)
              4 LOAD_FAST                2 (query_center_embedding)
              6 BINARY_OP               10 (-)
             10 LOAD_METHOD              0 (abs)
             32 PRECALL                  0
             36 CALL                     0
             46 STORE_FAST               4 (delta)

415          48 LOAD_GLOBAL              3 (NULL + F)
             60 LOAD_ATTR                2 (relu)
             70 LOAD_FAST                4 (delta)
             72 LOAD_FAST                3 (query_offset_embedding)
             74 BINARY_OP               10 (-)
             78 PRECALL                  1
             82 CALL                     1
             92 STORE_FAST               5 (distance_out)

416          94 LOAD_GLOBAL              7 (NULL + torch)
            106 LOAD_ATTR                4 (min)
            116 LOAD_FAST                4 (delta)
            118 LOAD_FAST                3 (query_offset_embedding)
            120 PRECALL                  2
            124 CALL                     2
            134 STORE_FAST               6 (distance_in)

417         136 LOAD_FAST                0 (self)
            138 LOAD_ATTR                5 (gamma)
            148 LOAD_GLOBAL              7 (NULL + torch)
            160 LOAD_ATTR                6 (norm)
            170 LOAD_FAST                5 (distance_out)
            172 LOAD_CONST               1 (1)
            174 LOAD_CONST               2 (-1)
            176 KW_NAMES                 3
            178 PRECALL                  3
            182 CALL                     3
            192 BINARY_OP               10 (-)
            196 LOAD_FAST                0 (self)
            198 LOAD_ATTR                7 (cen)
            208 LOAD_GLOBAL              7 (NULL + torch)
            220 LOAD_ATTR                6 (norm)
            230 LOAD_FAST                6 (distance_in)
            232 LOAD_CONST               1 (1)
            234 LOAD_CONST               2 (-1)
            236 KW_NAMES                 3
            238 PRECALL                  3
            242 CALL                     3
            252 BINARY_OP                5 (*)
            256 BINARY_OP               10 (-)
            260 STORE_FAST               7 (logit)

418         262 LOAD_FAST                7 (logit)
            264 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        delta = (entity_embedding - query_center_embedding).abs()
                 ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_METHOD abs [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE FX call abs_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        delta = (entity_embedding - query_center_embedding).abs()
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable(), TensorVariable()]
TRACE FX call sub_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_out = F.relu(delta - query_offset_embedding)
                              ~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_out = F.relu(delta - query_offset_embedding)
                       ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_in = torch.min(delta, query_offset_embedding)
                      ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                             ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                                ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                     ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2492 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2808 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [NullVariable, TorchVariable(<class 'torch.Tensor'>)]
TRACE PRECALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE CALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE FX call tensor from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~^^^^
TRACE LOAD_METHOD to [TensorVariable()]
TRACE LOAD_FAST self [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [NullVariable, GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE FX call to from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST negative_union_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable()]
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
            negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2960 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_OP 0 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 493 in forward_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_14 =====
 <eval_with_key>.253 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_14 <eval_with_key>.253 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7fad600718a0>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7fad600718a0>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7facb1c64220>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7fad600718a0>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7facb1a74d60>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7facb1a74d60>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7fad600718a0>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_14 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing forward_box /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:420 in forward_box (KGReasoning.forward_box)
        def forward_box(self, positive_sample, negative_sample, subsampling_weight, batch_queries_dict, batch_idxs_dict):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:421 in forward_box (KGReasoning.forward_box)
            all_center_embeddings, all_offset_embeddings, all_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:422 in forward_box (KGReasoning.forward_box)
            all_union_center_embeddings, all_union_offset_embeddings, all_union_idxs = [], [], []
TRACE BUILD_LIST 0 []
TRACE BUILD_LIST 0 [ListVariable()]
TRACE BUILD_LIST 0 [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_idxs [ListVariable(), ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_offset_embeddings [ListVariable(), ListVariable()]
TRACE STORE_FAST all_union_center_embeddings [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE LOAD_FAST batch_queries_dict []
TRACE GET_ITER None [LazyVariableTracker()]
create_graph_input L_batch_queries_dict_e_r_ L['batch_queries_dict'][('e', ('r',))]
wrap_to_fake L['batch_queries_dict'][('e', ('r',))] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=0)]
TRACE STORE_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:424 in forward_box (KGReasoning.forward_box)
                if 'u' in self.query_name_dict[query_structure]:
TRACE LOAD_CONST u [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str)]
TRACE LOAD_ATTR query_name_dict [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), LazyVariableTracker()]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstDictVariable(), TupleVariable()]
TRACE CONTAINS_OP 0 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(str), ConstantVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 348 [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE LOAD_FAST self [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([TupleVariable()], index=1), NNModuleVariable()]
TRACE LOAD_FAST batch_queries_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), DefaultDictVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:435 in forward_box (KGReasoning.forward_box)
                                                                                 query_structure,
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:436 in forward_box (KGReasoning.forward_box)
                                                                                 0)
TRACE LOAD_CONST 0 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                    center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
TRACE PRECALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:434 in forward_box (KGReasoning.forward_box)
                center_embedding, offset_embedding, _ = self.embed_query_box(batch_queries_dict[query_structure],
                                                        ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                             query_structure,
                                                                             ^^^^^^^^^^^^^^^^
                                                                             0)
                                                                             ^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([TupleVariable()], index=1), TupleVariable()]
TRACE STORE_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST _ [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:437 in forward_box (KGReasoning.forward_box)
                    all_center_embeddings.append(center_embedding)
TRACE LOAD_FAST all_center_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST center_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:438 in forward_box (KGReasoning.forward_box)
                    all_offset_embeddings.append(offset_embedding)
TRACE LOAD_FAST all_offset_embeddings [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:439 in forward_box (KGReasoning.forward_box)
                    all_idxs.extend(batch_idxs_dict[query_structure])
TRACE LOAD_FAST all_idxs [ListIteratorVariable([TupleVariable()], index=1)]
TRACE LOAD_METHOD extend [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE LOAD_FAST batch_idxs_dict [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend)]
TRACE LOAD_FAST query_structure [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE CALL 1 [ListIteratorVariable([TupleVariable()], index=1), NullVariable, GetAttrVariable(ListVariable(), extend), ListVariable()]
TRACE POP_TOP None [ListIteratorVariable([TupleVariable()], index=1), ListVariable()]
TRACE JUMP_BACKWARD 30 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:423 in forward_box (KGReasoning.forward_box)
            for query_structure in batch_queries_dict:
TRACE FOR_ITER 554 [ListIteratorVariable([TupleVariable()], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:441 in forward_box (KGReasoning.forward_box)
            if len(all_center_embeddings) > 0 and len(all_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_offset_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 794 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
                all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_center_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442 in forward_box (KGReasoning.forward_box)
            all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_center_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
                all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD unsqueeze [TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze)]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), unsqueeze), ConstantVariable(int)]
TRACE FX call unsqueeze_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443 in forward_box (KGReasoning.forward_box)
            all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TRACE STORE_FAST all_offset_embeddings [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:444 in forward_box (KGReasoning.forward_box)
            if len(all_union_center_embeddings) > 0 and len(all_union_offset_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 1186 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:450 in forward_box (KGReasoning.forward_box)
            if type(subsampling_weight) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST subsampling_weight [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 1272 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:453 in forward_box (KGReasoning.forward_box)
            if type(positive_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST positive_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE LOAD_GLOBAL type [SkipFilesVariable()]
TRACE LOAD_CONST None [SkipFilesVariable(), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [SkipFilesVariable(), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [SkipFilesVariable(), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2068 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:470 in forward_box (KGReasoning.forward_box)
                positive_logit = None
TRACE LOAD_CONST None []
TRACE STORE_FAST positive_logit [ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:472 in forward_box (KGReasoning.forward_box)
            if type(negative_sample) != type(None):
TRACE LOAD_GLOBAL type []
TRACE LOAD_FAST negative_sample [NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
TRACE CALL 1 [NullVariable, BuiltinVariable(type), LazyVariableTracker()]
create_graph_input L_negative_sample_ L['negative_sample']
wrap_to_fake L['negative_sample'] (1, 14505) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_GLOBAL type [TorchVariable(<class 'torch.Tensor'>)]
TRACE LOAD_CONST None [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type)]
TRACE PRECALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE CALL 1 [TorchVariable(<class 'torch.Tensor'>), NullVariable, BuiltinVariable(type), ConstantVariable(NoneType)]
TRACE COMPARE_OP != [TorchVariable(<class 'torch.Tensor'>), UserDefinedClassVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 2956 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:473 in forward_box (KGReasoning.forward_box)
                if len(all_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), TensorVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2394 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                    negative_sample_regular = negative_sample[all_idxs]
TRACE LOAD_FAST negative_sample []
TRACE LOAD_FAST all_idxs [TensorVariable()]
TRACE BINARY_SUBSCR None [TensorVariable(), ListVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474 in forward_box (KGReasoning.forward_box)
                negative_sample_regular = negative_sample[all_idxs]
                                          ~~~~~~~~~~~~~~~^^^^^^^^^^
TRACE STORE_FAST negative_sample_regular [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:475 in forward_box (KGReasoning.forward_box)
                    batch_size, negative_size = negative_sample_regular.shape
TRACE LOAD_FAST negative_sample_regular []
TRACE LOAD_ATTR shape [TensorVariable()]
TRACE UNPACK_SEQUENCE 2 [SizeVariable()]
TRACE STORE_FAST batch_size [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST negative_size [ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                    negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST negative_sample_regular [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_METHOD view [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST -1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE FX call view from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_METHOD view [TensorVariable()]
TRACE LOAD_FAST batch_size [NullVariable, GetAttrVariable(TensorVariable(), view)]
TRACE LOAD_FAST negative_size [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int)]
TRACE LOAD_CONST -1 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [NullVariable, GetAttrVariable(TensorVariable(), view), ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call view_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476 in forward_box (KGReasoning.forward_box)
                negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                    negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD cal_logit_box [NNModuleVariable()]
TRACE LOAD_FAST negative_embedding [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable())]
TRACE LOAD_FAST all_center_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST all_offset_embeddings [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable()]
TRACE PRECALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE CALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.cal_logit_box at 0x7facb0573600>, NNModuleVariable()), TensorVariable(), TensorVariable(), TensorVariable()]
TRACE inlined call cal_logit_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:477 in forward_box (KGReasoning.forward_box)
                negative_logit = self.cal_logit_box(negative_embedding, all_center_embeddings, all_offset_embeddings)
                                 ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
413           0 RESUME                   0

414           2 LOAD_FAST                1 (entity_embedding)
              4 LOAD_FAST                2 (query_center_embedding)
              6 BINARY_OP               10 (-)
             10 LOAD_METHOD              0 (abs)
             32 PRECALL                  0
             36 CALL                     0
             46 STORE_FAST               4 (delta)

415          48 LOAD_GLOBAL              3 (NULL + F)
             60 LOAD_ATTR                2 (relu)
             70 LOAD_FAST                4 (delta)
             72 LOAD_FAST                3 (query_offset_embedding)
             74 BINARY_OP               10 (-)
             78 PRECALL                  1
             82 CALL                     1
             92 STORE_FAST               5 (distance_out)

416          94 LOAD_GLOBAL              7 (NULL + torch)
            106 LOAD_ATTR                4 (min)
            116 LOAD_FAST                4 (delta)
            118 LOAD_FAST                3 (query_offset_embedding)
            120 PRECALL                  2
            124 CALL                     2
            134 STORE_FAST               6 (distance_in)

417         136 LOAD_FAST                0 (self)
            138 LOAD_ATTR                5 (gamma)
            148 LOAD_GLOBAL              7 (NULL + torch)
            160 LOAD_ATTR                6 (norm)
            170 LOAD_FAST                5 (distance_out)
            172 LOAD_CONST               1 (1)
            174 LOAD_CONST               2 (-1)
            176 KW_NAMES                 3
            178 PRECALL                  3
            182 CALL                     3
            192 BINARY_OP               10 (-)
            196 LOAD_FAST                0 (self)
            198 LOAD_ATTR                7 (cen)
            208 LOAD_GLOBAL              7 (NULL + torch)
            220 LOAD_ATTR                6 (norm)
            230 LOAD_FAST                6 (distance_in)
            232 LOAD_CONST               1 (1)
            234 LOAD_CONST               2 (-1)
            236 KW_NAMES                 3
            238 PRECALL                  3
            242 CALL                     3
            252 BINARY_OP                5 (*)
            256 BINARY_OP               10 (-)
            260 STORE_FAST               7 (logit)

418         262 LOAD_FAST                7 (logit)
            264 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [TensorVariable()]
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        delta = (entity_embedding - query_center_embedding).abs()
                 ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_METHOD abs [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE FX call abs_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        delta = (entity_embedding - query_center_embedding).abs()
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable(), TensorVariable()]
TRACE FX call sub_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_out = F.relu(delta - query_offset_embedding)
                              ~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_out = F.relu(delta - query_offset_embedding)
                       ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        distance_in = torch.min(delta, query_offset_embedding)
                      ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [NNModuleVariable()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                             ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                                ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                     ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box) (inline depth: 1)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object cal_logit_box at 0x7facb0adcb10, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 413>
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2492 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:481 in forward_box (KGReasoning.forward_box)
                if len(all_union_center_embeddings) > 0:
TRACE LOAD_GLOBAL len []
TRACE LOAD_FAST all_union_center_embeddings [NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(len), ListVariable()]
TRACE LOAD_CONST 0 [ConstantVariable(int)]
TRACE COMPARE_OP > [ConstantVariable(int), ConstantVariable(int)]
TRACE POP_JUMP_FORWARD_IF_FALSE 2808 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                    negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR Tensor [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE BUILD_LIST 0 [NullVariable, TorchVariable(<class 'torch.Tensor'>)]
TRACE PRECALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE CALL 1 [NullVariable, TorchVariable(<class 'torch.Tensor'>), ListVariable()]
TRACE FX call tensor from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~^^^^
TRACE LOAD_METHOD to [TensorVariable()]
TRACE LOAD_FAST self [NullVariable, GetAttrVariable(TensorVariable(), to)]
TRACE LOAD_ATTR entity_embedding [NullVariable, GetAttrVariable(TensorVariable(), to), NNModuleVariable()]
TRACE LOAD_ATTR device [NullVariable, GetAttrVariable(TensorVariable(), to), TensorVariable()]
TRACE PRECALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE CALL 1 [NullVariable, GetAttrVariable(TensorVariable(), to), ConstantVariable(device)]
TRACE FX call to from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488 in forward_box (KGReasoning.forward_box)
                negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
                                       ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_union_logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
                negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST negative_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST negative_union_logit [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable()]
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489 in forward_box (KGReasoning.forward_box)
            negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST negative_logit [TensorVariable()]
TRACE JUMP_FORWARD 2960 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:493 in forward_box (KGReasoning.forward_box)
            return positive_logit, negative_logit, subsampling_weight, all_idxs+all_union_idxs
TRACE LOAD_FAST positive_logit []
TRACE LOAD_FAST negative_logit [ConstantVariable(NoneType)]
TRACE LOAD_FAST subsampling_weight [ConstantVariable(NoneType), TensorVariable()]
TRACE LOAD_FAST all_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable()]
TRACE LOAD_FAST all_union_idxs [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE BINARY_OP 0 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable(), ListVariable()]
TRACE BUILD_TUPLE 4 [ConstantVariable(NoneType), TensorVariable(), ConstantVariable(), ListVariable()]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing forward_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 493 in forward_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_15 =====
 <eval_with_key>.269 class GraphModule(torch.nn.Module):
    def forward(self, L_batch_queries_dict_e_r_ : torch.Tensor, L_negative_sample_ : torch.Tensor):
        l_batch_queries_dict_e_r_ = L_batch_queries_dict_e_r_
        l_negative_sample_ = L_negative_sample_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_batch_queries_dict_e_r_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_batch_queries_dict_e_r_[(slice(None, None, None), 1)];  l_batch_queries_dict_e_r_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  center_embedding = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:442, code: all_center_embeddings = torch.cat(all_center_embeddings, dim=0).unsqueeze(1)
        cat = torch.cat([center_embedding], dim = 0);  center_embedding = None
        all_center_embeddings = cat.unsqueeze(1);  cat = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:443, code: all_offset_embeddings = torch.cat(all_offset_embeddings, dim=0).unsqueeze(1)
        cat_1 = torch.cat([offset_embedding_2], dim = 0);  offset_embedding_2 = None
        all_offset_embeddings = cat_1.unsqueeze(1);  cat_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:474, code: negative_sample_regular = negative_sample[all_idxs]
        negative_sample_regular = l_negative_sample_[[0]];  l_negative_sample_ = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:476, code: negative_embedding = torch.index_select(self.entity_embedding, dim=0, index=negative_sample_regular.view(-1)).view(batch_size, negative_size, -1)
        view = negative_sample_regular.view(-1);  negative_sample_regular = None
        index_select_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = view);  l__self___entity_embedding = view = None
        negative_embedding = index_select_3.view(1, 14505, -1);  index_select_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = negative_embedding - all_center_embeddings;  negative_embedding = all_center_embeddings = None
        delta = sub.abs();  sub = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - all_offset_embeddings
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, all_offset_embeddings);  delta = all_offset_embeddings = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        negative_logit = sub_2 - mul;  sub_2 = mul = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:488, code: negative_union_logit = torch.Tensor([]).to(self.entity_embedding.device)
        tensor = torch.Tensor([])
        negative_union_logit = tensor.to(device(type='cuda', index=0));  tensor = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:489, code: negative_logit = torch.cat([negative_logit, negative_union_logit], dim=0)
        negative_logit_1 = torch.cat([negative_logit, negative_union_logit], dim = 0);  negative_logit = negative_union_logit = None
        return (negative_logit_1,)
        

TRACED GRAPH
 __compiled_fn_15 <eval_with_key>.269 opcode         name                          target                                                           args                                                       kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------  ------------------------------
placeholder    l_batch_queries_dict_e_r_     L_batch_queries_dict_e_r_                                        ()                                                         {}
placeholder    l_negative_sample_            L_negative_sample_                                               ()                                                         {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                         {}
call_function  getitem                       <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                               {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                              {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                         {}
call_function  getitem_1                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)                            {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                         {}
call_function  getitem_2                     <built-in function getitem>                                      (l_batch_queries_dict_e_r_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                              {'dim': 0, 'index': getitem_2}
call_function  center_embedding              <built-in function iadd>                                         (embedding, r_embedding)                                   {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                     {}
call_function  cat                           <built-in method cat of type object at 0x7fad600718a0>           ([center_embedding],)                                      {'dim': 0}
call_method    all_center_embeddings         unsqueeze                                                        (cat, 1)                                                   {}
call_function  cat_1                         <built-in method cat of type object at 0x7fad600718a0>           ([offset_embedding_2],)                                    {'dim': 0}
call_method    all_offset_embeddings         unsqueeze                                                        (cat_1, 1)                                                 {}
call_function  negative_sample_regular       <built-in function getitem>                                      (l_negative_sample_, [0])                                  {}
call_method    view                          view                                                             (negative_sample_regular, -1)                              {}
call_function  index_select_3                <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                              {'dim': 0, 'index': view}
call_method    negative_embedding            view                                                             (index_select_3, 1, 14505, -1)                             {}
call_function  sub                           <built-in function sub>                                          (negative_embedding, all_center_embeddings)                {}
call_method    delta                         abs                                                              (sub,)                                                     {}
call_function  sub_1                         <built-in function sub>                                          (delta, all_offset_embeddings)                             {}
call_function  distance_out                  <function relu at 0x7facb1c64220>                                (sub_1,)                                                   {}
call_function  distance_in                   <built-in method min of type object at 0x7fad600718a0>           (delta, all_offset_embeddings)                             {}
get_attr       l__self___gamma               L__self___gamma                                                  ()                                                         {}
call_function  norm                          <function norm at 0x7facb1a74d60>                                (distance_out,)                                            {'p': 1, 'dim': -1}
call_function  sub_2                         <built-in function sub>                                          (l__self___gamma, norm)                                    {}
call_function  norm_1                        <function norm at 0x7facb1a74d60>                                (distance_in,)                                             {'p': 1, 'dim': -1}
call_function  mul                           <built-in function mul>                                          (0.02, norm_1)                                             {}
call_function  negative_logit                <built-in function sub>                                          (sub_2, mul)                                               {}
call_function  tensor                        <class 'torch.Tensor'>                                           ([],)                                                      {}
call_method    negative_union_logit          to                                                               (tensor, device(type='cuda', index=0))                     {}
call_function  negative_logit_1              <built-in method cat of type object at 0x7fad600718a0>           ([negative_logit, negative_union_logit],)                  {'dim': 0}
output         output                        output                                                           ((negative_logit_1,),)                                     {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_15 =====
l_batch_queries_dict_e_r_: (1, 2)
l_negative_sample_: (1, 14505)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
center_embedding: (1, 400)
offset_embedding_2: (1, 400)
cat: (1, 400)
all_center_embeddings: (1, 1, 400)
cat_1: (1, 400)
all_offset_embeddings: (1, 1, 400)
negative_sample_regular: (1, 14505)
view: (14505,)
index_select_3: (14505, 400)
negative_embedding: (1, 14505, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
negative_logit: (1, 14505)
tensor: (0,)
negative_union_logit: (0,)
negative_logit_1: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing embed_query_box /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [LazyVariableTracker()]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), LazyVariableTracker()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), SliceVariable(), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), TupleVariable()]
create_graph_input L_queries_ L['queries']
wrap_to_fake L['queries'] (1, 2) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable()]
TRACE BINARY_OP 13 [ConstantVariable(), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 1)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 1)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing embed_query_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 241 in embed_query_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_16 =====
 <eval_with_key>.285 class GraphModule(torch.nn.Module):
    def forward(self, L_queries_ : torch.Tensor):
        l_queries_ = L_queries_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_queries_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  l__self___entity_embedding = getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_queries_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_queries_[(slice(None, None, None), 1)];  l_queries_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  embedding_1 = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_1 = offset_embedding;  offset_embedding = r_offset_embedding = None
        return (embedding_1, offset_embedding_1)
        

TRACED GRAPH
 __compiled_fn_16 <eval_with_key>.285 opcode         name                          target                                                           args                                        kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ------------------------------------------  ------------------------------
placeholder    l_queries_                    L_queries_                                                       ()                                          {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                          {}
call_function  getitem                       <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)               {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                               {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                          {}
call_function  getitem_1                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)             {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                          {}
call_function  getitem_2                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)               {'dim': 0, 'index': getitem_2}
call_function  embedding_1                   <built-in function iadd>                                         (embedding, r_embedding)                    {}
call_function  offset_embedding_1            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)      {}
output         output                        output                                                           ((embedding_1, offset_embedding_1),)        {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_16 =====
l_queries_: (1, 2)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
embedding_1: (1, 400)
offset_embedding_1: (1, 400)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing cal_logit_box /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:413
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [LazyVariableTracker()]
TRACE BINARY_OP 10 [LazyVariableTracker(), LazyVariableTracker()]
create_graph_input L_entity_embedding_ L['entity_embedding']
wrap_to_fake L['entity_embedding'] (1, 14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None, None]
create_graph_input L_query_center_embedding_ L['query_center_embedding']
wrap_to_fake L['query_center_embedding'] (1, 1, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None, None]
TRACE FX call sub from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box)
        delta = (entity_embedding - query_center_embedding).abs()
                 ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_METHOD abs [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE FX call abs_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box)
        delta = (entity_embedding - query_center_embedding).abs()
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable(), LazyVariableTracker()]
create_graph_input L_query_offset_embedding_ L['query_offset_embedding']
wrap_to_fake L['query_offset_embedding'] (1, 1, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None, None]
TRACE FX call sub_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box)
        distance_out = F.relu(delta - query_offset_embedding)
                              ~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box)
        distance_out = F.relu(delta - query_offset_embedding)
                       ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box)
        distance_in = torch.min(delta, query_offset_embedding)
                      ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [LazyVariableTracker()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                             ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                                ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                     ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing cal_logit_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 418 in cal_logit_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_17 =====
 <eval_with_key>.296 class GraphModule(torch.nn.Module):
    def forward(self, L_entity_embedding_ : torch.Tensor, L_query_center_embedding_ : torch.Tensor, L_query_offset_embedding_ : torch.Tensor):
        l_entity_embedding_ = L_entity_embedding_
        l_query_center_embedding_ = L_query_center_embedding_
        l_query_offset_embedding_ = L_query_offset_embedding_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = l_entity_embedding_ - l_query_center_embedding_;  l_entity_embedding_ = l_query_center_embedding_ = None
        delta = sub.abs();  sub = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - l_query_offset_embedding_
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, l_query_offset_embedding_);  delta = l_query_offset_embedding_ = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        logit = sub_2 - mul;  sub_2 = mul = None
        return (logit,)
        

TRACED GRAPH
 __compiled_fn_17 <eval_with_key>.296 opcode         name                       target                                                  args                                              kwargs
-------------  -------------------------  ------------------------------------------------------  ------------------------------------------------  -------------------
placeholder    l_entity_embedding_        L_entity_embedding_                                     ()                                                {}
placeholder    l_query_center_embedding_  L_query_center_embedding_                               ()                                                {}
placeholder    l_query_offset_embedding_  L_query_offset_embedding_                               ()                                                {}
call_function  sub                        <built-in function sub>                                 (l_entity_embedding_, l_query_center_embedding_)  {}
call_method    delta                      abs                                                     (sub,)                                            {}
call_function  sub_1                      <built-in function sub>                                 (delta, l_query_offset_embedding_)                {}
call_function  distance_out               <function relu at 0x7facb1c64220>                       (sub_1,)                                          {}
call_function  distance_in                <built-in method min of type object at 0x7fad600718a0>  (delta, l_query_offset_embedding_)                {}
get_attr       l__self___gamma            L__self___gamma                                         ()                                                {}
call_function  norm                       <function norm at 0x7facb1a74d60>                       (distance_out,)                                   {'p': 1, 'dim': -1}
call_function  sub_2                      <built-in function sub>                                 (l__self___gamma, norm)                           {}
call_function  norm_1                     <function norm at 0x7facb1a74d60>                       (distance_in,)                                    {'p': 1, 'dim': -1}
call_function  mul                        <built-in function mul>                                 (0.02, norm_1)                                    {}
call_function  logit                      <built-in function sub>                                 (sub_2, mul)                                      {}
output         output                     output                                                  ((logit,),)                                       {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_17 =====
l_entity_embedding_: (1, 14505, 400)
l_query_center_embedding_: (1, 1, 400)
l_query_offset_embedding_: (1, 1, 400)
sub: (1, 14505, 400)
delta: (1, 14505, 400)
sub_1: (1, 14505, 400)
distance_out: (1, 14505, 400)
distance_in: (1, 14505, 400)
l__self___gamma: (1,)
norm: (1, 14505)
sub_2: (1, 14505)
norm_1: (1, 14505)
mul: (1, 14505)
logit: (1, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing embed_query_box /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [LazyVariableTracker()]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=1)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=2), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=2)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=2), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=2), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=2), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=2)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=2)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), LazyVariableTracker()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), SliceVariable(), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), TupleVariable()]
create_graph_input L_queries_ L['queries']
automatic dynamic L['queries'] size(1) 3 != 2
wrap_to_fake L['queries'] (1, 3) [<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>] [None, RelaxedUnspecConstraint(warn_only=True)]
bind_symint s0 L['queries'].size()[1]
create_graph_input s0 L['queries'].size()[1]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable()]
TRACE BINARY_OP 13 [ConstantVariable(), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 1)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 1)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_4 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_4 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable(), TensorVariable()]
TRACE FX call iadd_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 1)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 1)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable(), TensorVariable()]
TRACE FX call iadd_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing embed_query_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 241 in embed_query_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_18 =====
 <eval_with_key>.309 class GraphModule(torch.nn.Module):
    def forward(self, s0 : torch.SymInt, L_queries_ : torch.Tensor):
        l_queries_ = L_queries_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_queries_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  l__self___entity_embedding = getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_queries_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_queries_[(slice(None, None, None), 1)]
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  embedding_1 = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_1 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        getitem_3 = l_queries_[(slice(None, None, None), 2)]
        r_embedding_1 = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_3);  l__self___relation_embedding = getitem_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        getitem_4 = l_queries_[(slice(None, None, None), 2)];  l_queries_ = None
        r_offset_embedding_1 = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_4);  l__self___offset_embedding = getitem_4 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding_1 += r_embedding_1;  embedding_2 = embedding_1;  embedding_1 = r_embedding_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding_1 += r_offset_embedding_1;  offset_embedding_2 = offset_embedding_1;  offset_embedding_1 = r_offset_embedding_1 = None
        return (embedding_2, offset_embedding_2)
        

TRACED GRAPH
 __compiled_fn_18 <eval_with_key>.309 opcode         name                          target                                                           args                                        kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ------------------------------------------  ------------------------------
placeholder    s0                            s0                                                               ()                                          {}
placeholder    l_queries_                    L_queries_                                                       ()                                          {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                          {}
call_function  getitem                       <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)               {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                               {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                          {}
call_function  getitem_1                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)             {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                          {}
call_function  getitem_2                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)               {'dim': 0, 'index': getitem_2}
call_function  embedding_1                   <built-in function iadd>                                         (embedding, r_embedding)                    {}
call_function  offset_embedding_1            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)      {}
call_function  getitem_3                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 2))  {}
call_function  r_embedding_1                 <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)             {'dim': 0, 'index': getitem_3}
call_function  getitem_4                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 2))  {}
call_function  r_offset_embedding_1          <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)               {'dim': 0, 'index': getitem_4}
call_function  embedding_2                   <built-in function iadd>                                         (embedding_1, r_embedding_1)                {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding_1, r_offset_embedding_1)  {}
output         output                        output                                                           ((embedding_2, offset_embedding_2),)        {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_18 =====
l_queries_: (1, s0)
l_queries_ (concrete): (1, 3)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
embedding_1: (1, 400)
offset_embedding_1: (1, 400)
getitem_3: (1,)
r_embedding_1: (1, 400)
getitem_4: (1,)
r_offset_embedding_1: (1, 400)
embedding_2: (1, 400)
offset_embedding_2: (1, 400)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing embed_query_box /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [LazyVariableTracker()]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=1)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=2), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=2)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=2), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=2), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=2), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=2)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=2)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=3), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=3)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=3), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=3), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=3), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=3)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str), ConstantVariable(str)], index=3)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), LazyVariableTracker()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), SliceVariable(), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), TupleVariable()]
create_graph_input L_queries_ L['queries']
wrap_to_fake L['queries'] (1, 4) [<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>] [None, RelaxedUnspecConstraint(warn_only=True)]
bind_symint s0 L['queries'].size()[1]
create_graph_input s0 L['queries'].size()[1]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable()]
TRACE BINARY_OP 13 [ConstantVariable(), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 1)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 1)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_4 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_4 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable(), TensorVariable()]
TRACE FX call iadd_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 1)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 1)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable(), TensorVariable()]
TRACE FX call iadd_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_5 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_5 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_6 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_6 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), TensorVariable(), TensorVariable()]
TRACE FX call iadd_4 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 1)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 1)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), TensorVariable(), TensorVariable()]
TRACE FX call iadd_5 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing embed_query_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 241 in embed_query_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_19 =====
 <eval_with_key>.320 class GraphModule(torch.nn.Module):
    def forward(self, s0 : torch.SymInt, L_queries_ : torch.Tensor):
        l_queries_ = L_queries_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_queries_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  l__self___entity_embedding = getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_queries_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_queries_[(slice(None, None, None), 1)]
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  embedding_1 = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_1 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        getitem_3 = l_queries_[(slice(None, None, None), 2)]
        r_embedding_1 = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_3);  getitem_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        getitem_4 = l_queries_[(slice(None, None, None), 2)]
        r_offset_embedding_1 = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_4);  getitem_4 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding_1 += r_embedding_1;  embedding_2 = embedding_1;  embedding_1 = r_embedding_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding_1 += r_offset_embedding_1;  offset_embedding_2 = offset_embedding_1;  offset_embedding_1 = r_offset_embedding_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        getitem_5 = l_queries_[(slice(None, None, None), 3)]
        r_embedding_2 = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_5);  l__self___relation_embedding = getitem_5 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        getitem_6 = l_queries_[(slice(None, None, None), 3)];  l_queries_ = None
        r_offset_embedding_2 = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_6);  l__self___offset_embedding = getitem_6 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding_2 += r_embedding_2;  embedding_3 = embedding_2;  embedding_2 = r_embedding_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding_2 += r_offset_embedding_2;  offset_embedding_3 = offset_embedding_2;  offset_embedding_2 = r_offset_embedding_2 = None
        return (embedding_3, offset_embedding_3)
        

TRACED GRAPH
 __compiled_fn_19 <eval_with_key>.320 opcode         name                          target                                                           args                                        kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ------------------------------------------  ------------------------------
placeholder    s0                            s0                                                               ()                                          {}
placeholder    l_queries_                    L_queries_                                                       ()                                          {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                          {}
call_function  getitem                       <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)               {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                               {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                          {}
call_function  getitem_1                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)             {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                          {}
call_function  getitem_2                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)               {'dim': 0, 'index': getitem_2}
call_function  embedding_1                   <built-in function iadd>                                         (embedding, r_embedding)                    {}
call_function  offset_embedding_1            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)      {}
call_function  getitem_3                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 2))  {}
call_function  r_embedding_1                 <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)             {'dim': 0, 'index': getitem_3}
call_function  getitem_4                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 2))  {}
call_function  r_offset_embedding_1          <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)               {'dim': 0, 'index': getitem_4}
call_function  embedding_2                   <built-in function iadd>                                         (embedding_1, r_embedding_1)                {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding_1, r_offset_embedding_1)  {}
call_function  getitem_5                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 3))  {}
call_function  r_embedding_2                 <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)             {'dim': 0, 'index': getitem_5}
call_function  getitem_6                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 3))  {}
call_function  r_offset_embedding_2          <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)               {'dim': 0, 'index': getitem_6}
call_function  embedding_3                   <built-in function iadd>                                         (embedding_2, r_embedding_2)                {}
call_function  offset_embedding_3            <built-in function iadd>                                         (offset_embedding_2, r_offset_embedding_2)  {}
output         output                        output                                                           ((embedding_3, offset_embedding_3),)        {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_19 =====
l_queries_: (1, s0)
l_queries_ (concrete): (1, 4)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
embedding_1: (1, 400)
offset_embedding_1: (1, 400)
getitem_3: (1,)
r_embedding_1: (1, 400)
getitem_4: (1,)
r_offset_embedding_1: (1, 400)
embedding_2: (1, 400)
offset_embedding_2: (1, 400)
getitem_5: (1,)
r_embedding_2: (1, 400)
getitem_6: (1,)
r_offset_embedding_2: (1, 400)
embedding_3: (1, 400)
offset_embedding_3: (1, 400)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing embed_query_box /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [LazyVariableTracker()]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:210 in embed_query_box (KGReasoning.embed_query_box)
                    all_relation_flag = False
TRACE LOAD_CONST False [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1)]
TRACE STORE_FAST all_relation_flag [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:211 in embed_query_box (KGReasoning.embed_query_box)
                    break
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1)]
TRACE JUMP_FORWARD 44 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:232 in embed_query_box (KGReasoning.embed_query_box)
                embedding_list = []
TRACE BUILD_LIST 0 []
TRACE STORE_FAST embedding_list [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:233 in embed_query_box (KGReasoning.embed_query_box)
                offset_embedding_list = []
TRACE BUILD_LIST 0 []
TRACE STORE_FAST offset_embedding_list [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:234 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure)):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 930 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:235 in embed_query_box (KGReasoning.embed_query_box)
                    embedding, offset_embedding, idx = self.embed_query_box(queries, query_structure[i], idx)
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), LazyVariableTracker()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable(), LazyVariableTracker()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable(), LazyVariableTracker()]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:235 in embed_query_box (KGReasoning.embed_query_box)
                embedding, offset_embedding, idx = self.embed_query_box(queries, query_structure[i], idx)
                                                   ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), SliceVariable(), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), TupleVariable()]
create_graph_input L_queries_ L['queries']
wrap_to_fake L['queries'] (1, 4) [<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>] [None, RelaxedUnspecConstraint(warn_only=True)]
bind_symint s0 L['queries'].size()[1]
create_graph_input s0 L['queries'].size()[1]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable()]
TRACE BINARY_OP 13 [ConstantVariable(), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TupleVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:236 in embed_query_box (KGReasoning.embed_query_box)
                    embedding_list.append(embedding)
TRACE LOAD_FAST embedding_list [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ListVariable()]
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:237 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding_list.append(offset_embedding)
TRACE LOAD_FAST offset_embedding_list [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(NoneType)]
TRACE JUMP_BACKWARD 774 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:234 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure)):
TRACE FOR_ITER 930 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:235 in embed_query_box (KGReasoning.embed_query_box)
                    embedding, offset_embedding, idx = self.embed_query_box(queries, query_structure[i], idx)
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NNModuleVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:235 in embed_query_box (KGReasoning.embed_query_box)
                embedding, offset_embedding, idx = self.embed_query_box(queries, query_structure[i], idx)
                                                   ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_4 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_4 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_5 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_5 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TupleVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:236 in embed_query_box (KGReasoning.embed_query_box)
                    embedding_list.append(embedding)
TRACE LOAD_FAST embedding_list [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_METHOD append [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ListVariable()]
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:237 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding_list.append(offset_embedding)
TRACE LOAD_FAST offset_embedding_list [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_METHOD append [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(NoneType)]
TRACE JUMP_BACKWARD 774 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:234 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure)):
TRACE FOR_ITER 930 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:238 in embed_query_box (KGReasoning.embed_query_box)
                embedding = self.center_net(torch.stack(embedding_list))
TRACE LOAD_FAST self []
TRACE LOAD_METHOD center_net [NNModuleVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, NNModuleVariable()]
TRACE LOAD_ATTR stack [NullVariable, NNModuleVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding_list [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>), ListVariable()]
TRACE CALL 1 [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>), ListVariable()]
TRACE FX call stack from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:238 in embed_query_box (KGReasoning.embed_query_box)
            embedding = self.center_net(torch.stack(embedding_list))
                                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^
TRACE PRECALL 1 [NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, NNModuleVariable(), TensorVariable()]
TRACE inlined call _call_impl from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:238 in embed_query_box (KGReasoning.embed_query_box)
            embedding = self.center_net(torch.stack(embedding_list))
                        ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object _call_impl at 0x60bf410, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1513>
1513           0 RESUME                   0

1514           2 LOAD_GLOBAL              0 (torch)
              14 LOAD_ATTR                1 (_C)
              24 LOAD_METHOD              2 (_get_tracing_state)
              46 PRECALL                  0
              50 CALL                     0
              60 POP_JUMP_FORWARD_IF_FALSE     7 (to 76)
              62 LOAD_FAST                0 (self)
              64 LOAD_ATTR                3 (_slow_forward)
              74 JUMP_FORWARD             6 (to 88)
         >>   76 LOAD_FAST                0 (self)
              78 LOAD_ATTR                4 (forward)
         >>   88 STORE_FAST               3 (forward_call)

1517          90 LOAD_FAST                0 (self)
              92 LOAD_ATTR                5 (_backward_hooks)
             102 POP_JUMP_FORWARD_IF_TRUE    57 (to 218)
             104 LOAD_FAST                0 (self)
             106 LOAD_ATTR                6 (_backward_pre_hooks)
             116 POP_JUMP_FORWARD_IF_TRUE    50 (to 218)
             118 LOAD_FAST                0 (self)
             120 LOAD_ATTR                7 (_forward_hooks)
             130 POP_JUMP_FORWARD_IF_TRUE    43 (to 218)
             132 LOAD_FAST                0 (self)
             134 LOAD_ATTR                8 (_forward_pre_hooks)
             144 POP_JUMP_FORWARD_IF_TRUE    36 (to 218)

1518         146 LOAD_GLOBAL             18 (_global_backward_pre_hooks)

1517         158 POP_JUMP_FORWARD_IF_TRUE    29 (to 218)

1518         160 LOAD_GLOBAL             20 (_global_backward_hooks)

1517         172 POP_JUMP_FORWARD_IF_TRUE    22 (to 218)

1519         174 LOAD_GLOBAL             22 (_global_forward_hooks)

1517         186 POP_JUMP_FORWARD_IF_TRUE    15 (to 218)

1519         188 LOAD_GLOBAL             24 (_global_forward_pre_hooks)

1517         200 POP_JUMP_FORWARD_IF_TRUE     8 (to 218)

1520         202 PUSH_NULL
             204 LOAD_FAST                3 (forward_call)
             206 LOAD_FAST                1 (args)
             208 BUILD_MAP                0
             210 LOAD_FAST                2 (kwargs)
             212 DICT_MERGE               1
             214 CALL_FUNCTION_EX         1
             216 RETURN_VALUE

1522     >>  218 NOP

1523         220 LOAD_CONST               0 (None)
             222 STORE_FAST               4 (result)

1524         224 LOAD_GLOBAL             27 (NULL + set)
             236 PRECALL                  0
             240 CALL                     0
             250 STORE_FAST               5 (called_always_called_hooks)

1526         252 BUILD_LIST               0
             254 BUILD_LIST               0
             256 STORE_FAST               7 (non_full_backward_hooks)
             258 STORE_FAST               6 (full_backward_hooks)

1527         260 BUILD_LIST               0
             262 STORE_FAST               8 (backward_pre_hooks)

1528         264 LOAD_FAST                0 (self)
             266 LOAD_ATTR                6 (_backward_pre_hooks)
             276 POP_JUMP_FORWARD_IF_TRUE     7 (to 292)
             278 LOAD_GLOBAL             18 (_global_backward_pre_hooks)
             290 POP_JUMP_FORWARD_IF_FALSE    20 (to 332)

1529     >>  292 LOAD_FAST                0 (self)
             294 LOAD_METHOD             14 (_get_backward_pre_hooks)
             316 PRECALL                  0
             320 CALL                     0
             330 STORE_FAST               8 (backward_pre_hooks)

1531     >>  332 LOAD_FAST                0 (self)
             334 LOAD_ATTR                5 (_backward_hooks)
             344 POP_JUMP_FORWARD_IF_TRUE     7 (to 360)
             346 LOAD_GLOBAL             20 (_global_backward_hooks)
             358 POP_JUMP_FORWARD_IF_FALSE    23 (to 406)

1532     >>  360 LOAD_FAST                0 (self)
             362 LOAD_METHOD             15 (_get_backward_hooks)
             384 PRECALL                  0
             388 CALL                     0
             398 UNPACK_SEQUENCE          2
             402 STORE_FAST               6 (full_backward_hooks)
             404 STORE_FAST               7 (non_full_backward_hooks)

1534     >>  406 LOAD_GLOBAL             24 (_global_forward_pre_hooks)
             418 POP_JUMP_FORWARD_IF_TRUE     7 (to 434)
             420 LOAD_FAST                0 (self)
             422 LOAD_ATTR                8 (_forward_pre_hooks)
             432 POP_JUMP_FORWARD_IF_FALSE   189 (to 812)

1535     >>  434 BUILD_LIST               0

1536         436 LOAD_GLOBAL             24 (_global_forward_pre_hooks)
             448 LOAD_METHOD             16 (items)
             470 PRECALL                  0
             474 CALL                     0

1535         484 LIST_EXTEND              1

1537         486 LOAD_FAST                0 (self)
             488 LOAD_ATTR                8 (_forward_pre_hooks)
             498 LOAD_METHOD             16 (items)
             520 PRECALL                  0
             524 CALL                     0

1535         534 LIST_EXTEND              1
             536 LIST_TO_TUPLE
             538 GET_ITER
         >>  540 FOR_ITER               135 (to 812)
             542 UNPACK_SEQUENCE          2
             546 STORE_FAST               9 (hook_id)
             548 STORE_FAST              10 (hook)

1539         550 LOAD_FAST                9 (hook_id)
             552 LOAD_FAST                0 (self)
             554 LOAD_ATTR               17 (_forward_pre_hooks_with_kwargs)
             564 CONTAINS_OP              0
             566 POP_JUMP_FORWARD_IF_FALSE    81 (to 730)

1540         568 PUSH_NULL
             570 LOAD_FAST               10 (hook)
             572 LOAD_FAST                0 (self)
             574 LOAD_FAST                1 (args)
             576 LOAD_FAST                2 (kwargs)
             578 PRECALL                  3
             582 CALL                     3
             592 STORE_FAST              11 (args_kwargs_result)

1541         594 LOAD_FAST               11 (args_kwargs_result)
             596 POP_JUMP_FORWARD_IF_NONE    65 (to 728)

1542         598 LOAD_GLOBAL             37 (NULL + isinstance)
             610 LOAD_FAST               11 (args_kwargs_result)
             612 LOAD_GLOBAL             38 (tuple)
             624 PRECALL                  2
             628 CALL                     2
             638 POP_JUMP_FORWARD_IF_FALSE    25 (to 690)
             640 LOAD_GLOBAL             41 (NULL + len)
             652 LOAD_FAST               11 (args_kwargs_result)
             654 PRECALL                  1
             658 CALL                     1
             668 LOAD_CONST               1 (2)
             670 COMPARE_OP               2 (==)
             676 POP_JUMP_FORWARD_IF_FALSE     6 (to 690)

1543         678 LOAD_FAST               11 (args_kwargs_result)
             680 UNPACK_SEQUENCE          2
             684 STORE_FAST               1 (args)
             686 STORE_FAST               2 (kwargs)
             688 JUMP_BACKWARD           75 (to 540)

1545     >>  690 LOAD_GLOBAL             43 (NULL + RuntimeError)

1546         702 LOAD_CONST               2 ('forward pre-hook must return None or a tuple of (new_args, new_kwargs), but got ')

1547         704 LOAD_FAST               11 (args_kwargs_result)

1546         706 FORMAT_VALUE             0
             708 LOAD_CONST               3 ('.')
             710 BUILD_STRING             3

1545         712 PRECALL                  1
             716 CALL                     1
             726 RAISE_VARARGS            1

1541     >>  728 JUMP_BACKWARD           95 (to 540)

1550     >>  730 PUSH_NULL
             732 LOAD_FAST               10 (hook)
             734 LOAD_FAST                0 (self)
             736 LOAD_FAST                1 (args)
             738 PRECALL                  2
             742 CALL                     2
             752 STORE_FAST              12 (args_result)

1551         754 LOAD_FAST               12 (args_result)
             756 POP_JUMP_FORWARD_IF_NONE    26 (to 810)

1552         758 LOAD_GLOBAL             37 (NULL + isinstance)
             770 LOAD_FAST               12 (args_result)
             772 LOAD_GLOBAL             38 (tuple)
             784 PRECALL                  2
             788 CALL                     2
             798 POP_JUMP_FORWARD_IF_TRUE     3 (to 806)

1553         800 LOAD_FAST               12 (args_result)
             802 BUILD_TUPLE              1
             804 STORE_FAST              12 (args_result)

1554     >>  806 LOAD_FAST               12 (args_result)
             808 STORE_FAST               1 (args)
         >>  810 JUMP_BACKWARD          136 (to 540)

1556     >>  812 LOAD_CONST               0 (None)
             814 STORE_FAST              13 (bw_hook)

1557         816 LOAD_FAST                6 (full_backward_hooks)
             818 POP_JUMP_FORWARD_IF_TRUE     2 (to 824)
             820 LOAD_FAST                8 (backward_pre_hooks)
             822 POP_JUMP_FORWARD_IF_FALSE    43 (to 910)

1558     >>  824 LOAD_GLOBAL             45 (NULL + hooks)
             836 LOAD_ATTR               23 (BackwardHook)
             846 LOAD_FAST                0 (self)
             848 LOAD_FAST                6 (full_backward_hooks)
             850 LOAD_FAST                8 (backward_pre_hooks)
             852 PRECALL                  3
             856 CALL                     3
             866 STORE_FAST              13 (bw_hook)

1559         868 LOAD_FAST               13 (bw_hook)
             870 LOAD_METHOD             24 (setup_input_hook)
             892 LOAD_FAST                1 (args)
             894 PRECALL                  1
             898 CALL                     1
             908 STORE_FAST               1 (args)

1561     >>  910 PUSH_NULL
             912 LOAD_FAST                3 (forward_call)
             914 LOAD_FAST                1 (args)
             916 BUILD_MAP                0
             918 LOAD_FAST                2 (kwargs)
             920 DICT_MERGE               1
             922 CALL_FUNCTION_EX         1
             924 STORE_FAST               4 (result)

1562         926 LOAD_GLOBAL             22 (_global_forward_hooks)
             938 POP_JUMP_FORWARD_IF_TRUE     7 (to 954)
             940 LOAD_FAST                0 (self)
             942 LOAD_ATTR                7 (_forward_hooks)
             952 POP_JUMP_FORWARD_IF_FALSE   139 (to 1232)

1563     >>  954 BUILD_LIST               0

1564         956 LOAD_GLOBAL             22 (_global_forward_hooks)
             968 LOAD_METHOD             16 (items)
             990 PRECALL                  0
             994 CALL                     0

1563        1004 LIST_EXTEND              1

1565        1006 LOAD_FAST                0 (self)
            1008 LOAD_ATTR                7 (_forward_hooks)
            1018 LOAD_METHOD             16 (items)
            1040 PRECALL                  0
            1044 CALL                     0

1563        1054 LIST_EXTEND              1
            1056 LIST_TO_TUPLE
            1058 GET_ITER
         >> 1060 FOR_ITER                85 (to 1232)
            1062 UNPACK_SEQUENCE          2
            1066 STORE_FAST               9 (hook_id)
            1068 STORE_FAST              10 (hook)

1568        1070 LOAD_FAST                9 (hook_id)
            1072 LOAD_FAST                0 (self)
            1074 LOAD_ATTR               25 (_forward_hooks_always_called)
            1084 CONTAINS_OP              0
            1086 POP_JUMP_FORWARD_IF_TRUE     9 (to 1106)
            1088 LOAD_FAST                9 (hook_id)
            1090 LOAD_GLOBAL             52 (_global_forward_hooks_always_called)
            1102 CONTAINS_OP              0
            1104 POP_JUMP_FORWARD_IF_FALSE    21 (to 1148)

1569     >> 1106 LOAD_FAST                5 (called_always_called_hooks)
            1108 LOAD_METHOD             27 (add)
            1130 LOAD_FAST                9 (hook_id)
            1132 PRECALL                  1
            1136 CALL                     1
            1146 POP_TOP

1571     >> 1148 LOAD_FAST                9 (hook_id)
            1150 LOAD_FAST                0 (self)
            1152 LOAD_ATTR               28 (_forward_hooks_with_kwargs)
            1162 CONTAINS_OP              0
            1164 POP_JUMP_FORWARD_IF_FALSE    15 (to 1196)

1572        1166 PUSH_NULL
            1168 LOAD_FAST               10 (hook)
            1170 LOAD_FAST                0 (self)
            1172 LOAD_FAST                1 (args)
            1174 LOAD_FAST                2 (kwargs)
            1176 LOAD_FAST                4 (result)
            1178 PRECALL                  4
            1182 CALL                     4
            1192 STORE_FAST              14 (hook_result)
            1194 JUMP_FORWARD            13 (to 1222)

1574     >> 1196 PUSH_NULL
            1198 LOAD_FAST               10 (hook)
            1200 LOAD_FAST                0 (self)
            1202 LOAD_FAST                1 (args)
            1204 LOAD_FAST                4 (result)
            1206 PRECALL                  3
            1210 CALL                     3
            1220 STORE_FAST              14 (hook_result)

1576     >> 1222 LOAD_FAST               14 (hook_result)
            1224 POP_JUMP_FORWARD_IF_NONE     2 (to 1230)

1577        1226 LOAD_FAST               14 (hook_result)
            1228 STORE_FAST               4 (result)
         >> 1230 JUMP_BACKWARD           86 (to 1060)

1579     >> 1232 LOAD_FAST               13 (bw_hook)
            1234 POP_JUMP_FORWARD_IF_FALSE    90 (to 1416)

1580        1236 LOAD_GLOBAL             37 (NULL + isinstance)
            1248 LOAD_FAST                4 (result)
            1250 LOAD_GLOBAL              0 (torch)
            1262 LOAD_ATTR               29 (Tensor)
            1272 LOAD_GLOBAL             38 (tuple)
            1284 BUILD_TUPLE              2
            1286 PRECALL                  2
            1290 CALL                     2
            1300 POP_JUMP_FORWARD_IF_TRUE    36 (to 1374)

1581        1302 LOAD_GLOBAL             61 (NULL + warnings)
            1314 LOAD_ATTR               31 (warn)
            1324 LOAD_CONST               4 ('For backward hooks to be called, module output should be a Tensor or a tuple of Tensors but received ')

1583        1326 LOAD_GLOBAL             65 (NULL + type)
            1338 LOAD_FAST                4 (result)
            1340 PRECALL                  1
            1344 CALL                     1

1581        1354 FORMAT_VALUE             0
            1356 BUILD_STRING             2
            1358 PRECALL                  1
            1362 CALL                     1
            1372 POP_TOP

1584     >> 1374 LOAD_FAST               13 (bw_hook)
            1376 LOAD_METHOD             33 (setup_output_hook)
            1398 LOAD_FAST                4 (result)
            1400 PRECALL                  1
            1404 CALL                     1
            1414 STORE_FAST               4 (result)

1587     >> 1416 LOAD_FAST                7 (non_full_backward_hooks)
            1418 POP_JUMP_FORWARD_IF_FALSE   199 (to 1818)

1588        1420 LOAD_FAST                4 (result)
            1422 STORE_FAST              15 (var)

1589        1424 LOAD_GLOBAL             37 (NULL + isinstance)
            1436 LOAD_FAST               15 (var)
            1438 LOAD_GLOBAL              0 (torch)
            1450 LOAD_ATTR               29 (Tensor)
            1460 PRECALL                  2
            1464 CALL                     2
            1474 POP_JUMP_FORWARD_IF_TRUE    99 (to 1674)

1590     >> 1476 LOAD_GLOBAL             37 (NULL + isinstance)
            1488 LOAD_FAST               15 (var)
            1490 LOAD_GLOBAL             68 (dict)
            1502 PRECALL                  2
            1506 CALL                     2
            1516 POP_JUMP_FORWARD_IF_FALSE    44 (to 1606)

1591        1518 LOAD_GLOBAL             71 (NULL + next)
            1530 LOAD_CONST               5 (<code object <genexpr> at 0x7facf67909c0, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1591>)
            1532 MAKE_FUNCTION            0
            1534 LOAD_FAST               15 (var)
            1536 LOAD_METHOD             36 (values)
            1558 PRECALL                  0
            1562 CALL                     0
            1572 GET_ITER
            1574 PRECALL                  0
            1578 CALL                     0
            1588 PRECALL                  1
            1592 CALL                     1
            1602 STORE_FAST              15 (var)
            1604 JUMP_FORWARD             8 (to 1622)

1593     >> 1606 LOAD_FAST               15 (var)
            1608 LOAD_CONST               6 (0)
            1610 BINARY_SUBSCR
            1620 STORE_FAST              15 (var)

1589     >> 1622 LOAD_GLOBAL             37 (NULL + isinstance)
            1634 LOAD_FAST               15 (var)
            1636 LOAD_GLOBAL              0 (torch)
            1648 LOAD_ATTR               29 (Tensor)
            1658 PRECALL                  2
            1662 CALL                     2
            1672 POP_JUMP_BACKWARD_IF_FALSE    99 (to 1476)

1594     >> 1674 LOAD_FAST               15 (var)
            1676 LOAD_ATTR               37 (grad_fn)
            1686 STORE_FAST              16 (grad_fn)

1595        1688 LOAD_FAST               16 (grad_fn)
            1690 POP_JUMP_FORWARD_IF_NONE    63 (to 1818)

1596        1692 LOAD_FAST                7 (non_full_backward_hooks)
            1694 GET_ITER
         >> 1696 FOR_ITER                37 (to 1772)
            1698 STORE_FAST              10 (hook)

1597        1700 LOAD_FAST               16 (grad_fn)
            1702 LOAD_METHOD             38 (register_hook)
            1724 LOAD_GLOBAL             79 (NULL + _WrappedHook)
            1736 LOAD_FAST               10 (hook)
            1738 LOAD_FAST                0 (self)
            1740 PRECALL                  2
            1744 CALL                     2
            1754 PRECALL                  1
            1758 CALL                     1
            1768 POP_TOP
            1770 JUMP_BACKWARD           38 (to 1696)

1598     >> 1772 LOAD_FAST                0 (self)
            1774 LOAD_METHOD             40 (_maybe_warn_non_full_backward_hook)
            1796 LOAD_FAST                1 (args)
            1798 LOAD_FAST                4 (result)
            1800 LOAD_FAST               16 (grad_fn)
            1802 PRECALL                  3
            1806 CALL                     3
            1816 POP_TOP

1600     >> 1818 LOAD_FAST                4 (result)
            1820 RETURN_VALUE
         >> 1822 PUSH_EXC_INFO

1602        1824 LOAD_GLOBAL             82 (Exception)
            1836 CHECK_EXC_MATCH
            1838 EXTENDED_ARG             1
            1840 POP_JUMP_FORWARD_IF_FALSE   270 (to 2382)
            1842 POP_TOP

1606        1844 LOAD_GLOBAL             22 (_global_forward_hooks)
            1856 LOAD_METHOD             16 (items)
            1878 PRECALL                  0
            1882 CALL                     0
            1892 GET_ITER
         >> 1894 FOR_ITER                96 (to 2088)
            1896 UNPACK_SEQUENCE          2
            1900 STORE_FAST               9 (hook_id)
            1902 STORE_FAST              10 (hook)

1607        1904 LOAD_FAST                9 (hook_id)
            1906 LOAD_GLOBAL             52 (_global_forward_hooks_always_called)
            1918 CONTAINS_OP              0
            1920 POP_JUMP_FORWARD_IF_FALSE    82 (to 2086)
            1922 LOAD_FAST                9 (hook_id)
            1924 LOAD_FAST                5 (called_always_called_hooks)
            1926 CONTAINS_OP              1
            1928 POP_JUMP_FORWARD_IF_FALSE    78 (to 2086)

1608        1930 NOP

1609        1932 PUSH_NULL
            1934 LOAD_FAST               10 (hook)
            1936 LOAD_FAST                0 (self)
            1938 LOAD_FAST                1 (args)
            1940 LOAD_FAST                4 (result)
            1942 PRECALL                  3
            1946 CALL                     3
            1956 STORE_FAST              14 (hook_result)

1610        1958 LOAD_FAST               14 (hook_result)
            1960 POP_JUMP_FORWARD_IF_NONE     2 (to 1966)

1611        1962 LOAD_FAST               14 (hook_result)
            1964 STORE_FAST               4 (result)
         >> 1966 JUMP_BACKWARD           37 (to 1894)
         >> 1968 PUSH_EXC_INFO

1612        1970 LOAD_GLOBAL             82 (Exception)
            1982 CHECK_EXC_MATCH
            1984 POP_JUMP_FORWARD_IF_FALSE    46 (to 2078)
            1986 STORE_FAST              17 (e)

1613        1988 LOAD_GLOBAL             61 (NULL + warnings)
            2000 LOAD_ATTR               31 (warn)
            2010 LOAD_CONST               7 ('global module forward hook with ``always_call=True`` raised an exception that was silenced as another error was raised in forward: ')

1614        2012 LOAD_GLOBAL             85 (NULL + str)
            2024 LOAD_FAST               17 (e)
            2026 PRECALL                  1
            2030 CALL                     1

1613        2040 FORMAT_VALUE             0
            2042 BUILD_STRING             2
            2044 PRECALL                  1
            2048 CALL                     1
            2058 POP_TOP

1615        2060 POP_EXCEPT
            2062 LOAD_CONST               0 (None)
            2064 STORE_FAST              17 (e)
            2066 DELETE_FAST             17 (e)
            2068 JUMP_BACKWARD           88 (to 1894)
         >> 2070 LOAD_CONST               0 (None)
            2072 STORE_FAST              17 (e)
            2074 DELETE_FAST             17 (e)
            2076 RERAISE                  1

1612     >> 2078 RERAISE                  0
         >> 2080 COPY                     3
            2082 POP_EXCEPT
            2084 RERAISE                  1
         >> 2086 JUMP_BACKWARD           97 (to 1894)

1617     >> 2088 LOAD_FAST                0 (self)
            2090 LOAD_ATTR                7 (_forward_hooks)
            2100 LOAD_METHOD             16 (items)
            2122 PRECALL                  0
            2126 CALL                     0
            2136 GET_ITER
         >> 2138 FOR_ITER               120 (to 2380)
            2140 UNPACK_SEQUENCE          2
            2144 STORE_FAST               9 (hook_id)
            2146 STORE_FAST              10 (hook)

1618        2148 LOAD_FAST                9 (hook_id)
            2150 LOAD_FAST                0 (self)
            2152 LOAD_ATTR               25 (_forward_hooks_always_called)
            2162 CONTAINS_OP              0
            2164 POP_JUMP_FORWARD_IF_FALSE   106 (to 2378)
            2166 LOAD_FAST                9 (hook_id)
            2168 LOAD_FAST                5 (called_always_called_hooks)
            2170 CONTAINS_OP              1
            2172 POP_JUMP_FORWARD_IF_FALSE   102 (to 2378)

1619        2174 NOP

1620        2176 LOAD_FAST                9 (hook_id)
            2178 LOAD_FAST                0 (self)
            2180 LOAD_ATTR               28 (_forward_hooks_with_kwargs)
            2190 CONTAINS_OP              0
            2192 POP_JUMP_FORWARD_IF_FALSE    15 (to 2224)

1621        2194 PUSH_NULL
            2196 LOAD_FAST               10 (hook)
            2198 LOAD_FAST                0 (self)
            2200 LOAD_FAST                1 (args)
            2202 LOAD_FAST                2 (kwargs)
            2204 LOAD_FAST                4 (result)
            2206 PRECALL                  4
            2210 CALL                     4
            2220 STORE_FAST              14 (hook_result)
            2222 JUMP_FORWARD            13 (to 2250)

1623     >> 2224 PUSH_NULL
            2226 LOAD_FAST               10 (hook)
            2228 LOAD_FAST                0 (self)
            2230 LOAD_FAST                1 (args)
            2232 LOAD_FAST                4 (result)
            2234 PRECALL                  3
            2238 CALL                     3
            2248 STORE_FAST              14 (hook_result)

1624     >> 2250 LOAD_FAST               14 (hook_result)
            2252 POP_JUMP_FORWARD_IF_NONE     2 (to 2258)

1625        2254 LOAD_FAST               14 (hook_result)
            2256 STORE_FAST               4 (result)
         >> 2258 JUMP_BACKWARD           61 (to 2138)
         >> 2260 PUSH_EXC_INFO

1626        2262 LOAD_GLOBAL             82 (Exception)
            2274 CHECK_EXC_MATCH
            2276 POP_JUMP_FORWARD_IF_FALSE    46 (to 2370)
            2278 STORE_FAST              17 (e)

1627        2280 LOAD_GLOBAL             61 (NULL + warnings)
            2292 LOAD_ATTR               31 (warn)
            2302 LOAD_CONST               8 ('module forward hook with ``always_call=True`` raised an exception that was silenced as another error was raised in forward: ')

1628        2304 LOAD_GLOBAL             85 (NULL + str)
            2316 LOAD_FAST               17 (e)
            2318 PRECALL                  1
            2322 CALL                     1

1627        2332 FORMAT_VALUE             0
            2334 BUILD_STRING             2
            2336 PRECALL                  1
            2340 CALL                     1
            2350 POP_TOP

1629        2352 POP_EXCEPT
            2354 LOAD_CONST               0 (None)
            2356 STORE_FAST              17 (e)
            2358 DELETE_FAST             17 (e)
            2360 JUMP_BACKWARD          112 (to 2138)
         >> 2362 LOAD_CONST               0 (None)
            2364 STORE_FAST              17 (e)
            2366 DELETE_FAST             17 (e)
            2368 RERAISE                  1

1626     >> 2370 RERAISE                  0
         >> 2372 COPY                     3
            2374 POP_EXCEPT
            2376 RERAISE                  1
         >> 2378 JUMP_BACKWARD          121 (to 2138)

1631     >> 2380 RAISE_VARARGS            0

1602     >> 2382 RERAISE                  0
         >> 2384 COPY                     3
            2386 POP_EXCEPT
            2388 RERAISE                  1
ExceptionTable:
  220 to 1818 -> 1822 [0]
  1822 to 1928 -> 2384 [1] lasti
  1932 to 1964 -> 1968 [2]
  1966 to 1966 -> 2384 [1] lasti
  1968 to 1986 -> 2080 [3] lasti
  1988 to 2058 -> 2070 [3] lasti
  2060 to 2068 -> 2384 [1] lasti
  2070 to 2078 -> 2080 [3] lasti
  2080 to 2172 -> 2384 [1] lasti
  2176 to 2256 -> 2260 [2]
  2258 to 2258 -> 2384 [1] lasti
  2260 to 2278 -> 2372 [3] lasti
  2280 to 2350 -> 2362 [3] lasti
  2352 to 2360 -> 2384 [1] lasti
  2362 to 2370 -> 2372 [3] lasti
  2372 to 2382 -> 2384 [1] lasti
, inlined according skipfiles.MOD_INLINELIST
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1513 in _call_impl (Module._call_impl) (inline depth: 1)
        def _call_impl(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1514 in _call_impl (Module._call_impl) (inline depth: 1)
            forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR _C [TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_METHOD _get_tracing_state [TorchVariable(<module 'torch._C' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/_C.cpython-311-x86_64-linux-gnu.so'>)]
TRACE PRECALL 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method _get_tracing_state of PyCapsule object at 0x7fad61054bd0>)]
TRACE CALL 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method _get_tracing_state of PyCapsule object at 0x7fad61054bd0>)]
TRACE POP_JUMP_FORWARD_IF_FALSE 76 [ConstantVariable(NoneType)]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR forward [NNModuleVariable()]
TRACE STORE_FAST forward_call [UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable())]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _backward_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _backward_pre_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _forward_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _forward_pre_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1518 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_backward_pre_hooks or _global_backward_hooks
TRACE LOAD_GLOBAL _global_backward_pre_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1518 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_backward_pre_hooks or _global_backward_hooks
TRACE LOAD_GLOBAL _global_backward_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1519 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_forward_hooks or _global_forward_pre_hooks):
TRACE LOAD_GLOBAL _global_forward_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1519 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_forward_hooks or _global_forward_pre_hooks):
TRACE LOAD_GLOBAL _global_forward_pre_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1520 in _call_impl (Module._call_impl) (inline depth: 1)
                return forward_call(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST forward_call [NullVariable]
TRACE LOAD_FAST args [NullVariable, UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable())]
TRACE BUILD_MAP 0 [NullVariable, UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable()), TupleVariable()]
TRACE LOAD_FAST kwargs [NullVariable, UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable()), TupleVariable(), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable()), TupleVariable(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable()), TupleVariable(), ConstDictVariable()]
TRACE inlined call forward from /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1520 in _call_impl (Module._call_impl) (inline depth: 1)
            return forward_call(*args, **kwargs)
                   ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object forward at 0x7facb06ca420, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 56>
 56           0 RESUME                   0

 57           2 LOAD_GLOBAL              1 (NULL + F)
             14 LOAD_ATTR                1 (relu)
             24 LOAD_FAST                0 (self)
             26 LOAD_METHOD              2 (layer1)
             48 LOAD_FAST                1 (embeddings)
             50 PRECALL                  1
             54 CALL                     1
             64 PRECALL                  1
             68 CALL                     1
             78 STORE_FAST               2 (layer1_act)

 58          80 LOAD_GLOBAL              1 (NULL + F)
             92 LOAD_ATTR                3 (softmax)
            102 LOAD_FAST                0 (self)
            104 LOAD_METHOD              4 (layer2)
            126 LOAD_FAST                2 (layer1_act)
            128 PRECALL                  1
            132 CALL                     1
            142 LOAD_CONST               1 (0)
            144 KW_NAMES                 2
            146 PRECALL                  2
            150 CALL                     2
            160 STORE_FAST               3 (attention)

 59         162 LOAD_GLOBAL             11 (NULL + torch)
            174 LOAD_ATTR                6 (sum)
            184 LOAD_FAST                3 (attention)
            186 LOAD_FAST                1 (embeddings)
            188 BINARY_OP                5 (*)
            192 LOAD_CONST               1 (0)
            194 KW_NAMES                 2
            196 PRECALL                  2
            200 CALL                     2
            210 STORE_FAST               4 (embedding)

 61         212 LOAD_FAST                4 (embedding)
            214 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:56 in forward (CenterIntersection.forward) (inline depth: 2)
        def forward(self, embeddings):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:57 in forward (CenterIntersection.forward) (inline depth: 2)
            layer1_act = F.relu(self.layer1(embeddings)) # (num_conj, dim)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_METHOD layer1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NNModuleVariable()]
TRACE LOAD_FAST embeddings [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable()]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE FX call l__self___center_net_layer1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:57 in forward (CenterIntersection.forward) (inline depth: 2)
        layer1_act = F.relu(self.layer1(embeddings)) # (num_conj, dim)
                            ~~~~~~~~~~~^^^^^^^^^^^^
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:57 in forward (CenterIntersection.forward) (inline depth: 2)
        layer1_act = F.relu(self.layer1(embeddings)) # (num_conj, dim)
                     ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST layer1_act [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:58 in forward (CenterIntersection.forward) (inline depth: 2)
            attention = F.softmax(self.layer2(layer1_act), dim=0) # (num_conj, dim)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR softmax [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>)]
TRACE LOAD_METHOD layer2 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), NNModuleVariable()]
TRACE LOAD_FAST layer1_act [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), NullVariable, NNModuleVariable()]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE FX call l__self___center_net_layer2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:58 in forward (CenterIntersection.forward) (inline depth: 2)
        attention = F.softmax(self.layer2(layer1_act), dim=0) # (num_conj, dim)
                              ~~~~~~~~~~~^^^^^^^^^^^^
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), TensorVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), TensorVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), TensorVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), TensorVariable(), ConstantVariable(int)]
TRACE FX call softmax from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:58 in forward (CenterIntersection.forward) (inline depth: 2)
        attention = F.softmax(self.layer2(layer1_act), dim=0) # (num_conj, dim)
                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST attention [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:59 in forward (CenterIntersection.forward) (inline depth: 2)
            embedding = torch.sum(attention * embeddings, dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR sum [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST attention [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable()]
TRACE BINARY_OP 5 [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:59 in forward (CenterIntersection.forward) (inline depth: 2)
        embedding = torch.sum(attention * embeddings, dim=0)
                              ~~~~~~~~~~^~~~~~~~~~~~
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE FX call sum_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:59 in forward (CenterIntersection.forward) (inline depth: 2)
        embedding = torch.sum(attention * embeddings, dim=0)
                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:61 in forward (CenterIntersection.forward) (inline depth: 2)
            return embedding
TRACE LOAD_FAST embedding []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward at 0x7facb06ca420, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 56>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object _call_impl at 0x60bf410, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1513>
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:239 in embed_query_box (KGReasoning.embed_query_box)
                offset_embedding = self.offset_net(torch.stack(offset_embedding_list))
TRACE LOAD_FAST self []
TRACE LOAD_METHOD offset_net [NNModuleVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, NNModuleVariable()]
TRACE LOAD_ATTR stack [NullVariable, NNModuleVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST offset_embedding_list [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>), ListVariable()]
TRACE CALL 1 [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>), ListVariable()]
TRACE FX call stack_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:239 in embed_query_box (KGReasoning.embed_query_box)
            offset_embedding = self.offset_net(torch.stack(offset_embedding_list))
                                               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE PRECALL 1 [NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, NNModuleVariable(), TensorVariable()]
TRACE inlined call _call_impl from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:239 in embed_query_box (KGReasoning.embed_query_box)
            offset_embedding = self.offset_net(torch.stack(offset_embedding_list))
                               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object _call_impl at 0x60bf410, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1513>
1513           0 RESUME                   0

1514           2 LOAD_GLOBAL              0 (torch)
              14 LOAD_ATTR                1 (_C)
              24 LOAD_METHOD              2 (_get_tracing_state)
              46 PRECALL                  0
              50 CALL                     0
              60 POP_JUMP_FORWARD_IF_FALSE     7 (to 76)
              62 LOAD_FAST                0 (self)
              64 LOAD_ATTR                3 (_slow_forward)
              74 JUMP_FORWARD             6 (to 88)
         >>   76 LOAD_FAST                0 (self)
              78 LOAD_ATTR                4 (forward)
         >>   88 STORE_FAST               3 (forward_call)

1517          90 LOAD_FAST                0 (self)
              92 LOAD_ATTR                5 (_backward_hooks)
             102 POP_JUMP_FORWARD_IF_TRUE    57 (to 218)
             104 LOAD_FAST                0 (self)
             106 LOAD_ATTR                6 (_backward_pre_hooks)
             116 POP_JUMP_FORWARD_IF_TRUE    50 (to 218)
             118 LOAD_FAST                0 (self)
             120 LOAD_ATTR                7 (_forward_hooks)
             130 POP_JUMP_FORWARD_IF_TRUE    43 (to 218)
             132 LOAD_FAST                0 (self)
             134 LOAD_ATTR                8 (_forward_pre_hooks)
             144 POP_JUMP_FORWARD_IF_TRUE    36 (to 218)

1518         146 LOAD_GLOBAL             18 (_global_backward_pre_hooks)

1517         158 POP_JUMP_FORWARD_IF_TRUE    29 (to 218)

1518         160 LOAD_GLOBAL             20 (_global_backward_hooks)

1517         172 POP_JUMP_FORWARD_IF_TRUE    22 (to 218)

1519         174 LOAD_GLOBAL             22 (_global_forward_hooks)

1517         186 POP_JUMP_FORWARD_IF_TRUE    15 (to 218)

1519         188 LOAD_GLOBAL             24 (_global_forward_pre_hooks)

1517         200 POP_JUMP_FORWARD_IF_TRUE     8 (to 218)

1520         202 PUSH_NULL
             204 LOAD_FAST                3 (forward_call)
             206 LOAD_FAST                1 (args)
             208 BUILD_MAP                0
             210 LOAD_FAST                2 (kwargs)
             212 DICT_MERGE               1
             214 CALL_FUNCTION_EX         1
             216 RETURN_VALUE

1522     >>  218 NOP

1523         220 LOAD_CONST               0 (None)
             222 STORE_FAST               4 (result)

1524         224 LOAD_GLOBAL             27 (NULL + set)
             236 PRECALL                  0
             240 CALL                     0
             250 STORE_FAST               5 (called_always_called_hooks)

1526         252 BUILD_LIST               0
             254 BUILD_LIST               0
             256 STORE_FAST               7 (non_full_backward_hooks)
             258 STORE_FAST               6 (full_backward_hooks)

1527         260 BUILD_LIST               0
             262 STORE_FAST               8 (backward_pre_hooks)

1528         264 LOAD_FAST                0 (self)
             266 LOAD_ATTR                6 (_backward_pre_hooks)
             276 POP_JUMP_FORWARD_IF_TRUE     7 (to 292)
             278 LOAD_GLOBAL             18 (_global_backward_pre_hooks)
             290 POP_JUMP_FORWARD_IF_FALSE    20 (to 332)

1529     >>  292 LOAD_FAST                0 (self)
             294 LOAD_METHOD             14 (_get_backward_pre_hooks)
             316 PRECALL                  0
             320 CALL                     0
             330 STORE_FAST               8 (backward_pre_hooks)

1531     >>  332 LOAD_FAST                0 (self)
             334 LOAD_ATTR                5 (_backward_hooks)
             344 POP_JUMP_FORWARD_IF_TRUE     7 (to 360)
             346 LOAD_GLOBAL             20 (_global_backward_hooks)
             358 POP_JUMP_FORWARD_IF_FALSE    23 (to 406)

1532     >>  360 LOAD_FAST                0 (self)
             362 LOAD_METHOD             15 (_get_backward_hooks)
             384 PRECALL                  0
             388 CALL                     0
             398 UNPACK_SEQUENCE          2
             402 STORE_FAST               6 (full_backward_hooks)
             404 STORE_FAST               7 (non_full_backward_hooks)

1534     >>  406 LOAD_GLOBAL             24 (_global_forward_pre_hooks)
             418 POP_JUMP_FORWARD_IF_TRUE     7 (to 434)
             420 LOAD_FAST                0 (self)
             422 LOAD_ATTR                8 (_forward_pre_hooks)
             432 POP_JUMP_FORWARD_IF_FALSE   189 (to 812)

1535     >>  434 BUILD_LIST               0

1536         436 LOAD_GLOBAL             24 (_global_forward_pre_hooks)
             448 LOAD_METHOD             16 (items)
             470 PRECALL                  0
             474 CALL                     0

1535         484 LIST_EXTEND              1

1537         486 LOAD_FAST                0 (self)
             488 LOAD_ATTR                8 (_forward_pre_hooks)
             498 LOAD_METHOD             16 (items)
             520 PRECALL                  0
             524 CALL                     0

1535         534 LIST_EXTEND              1
             536 LIST_TO_TUPLE
             538 GET_ITER
         >>  540 FOR_ITER               135 (to 812)
             542 UNPACK_SEQUENCE          2
             546 STORE_FAST               9 (hook_id)
             548 STORE_FAST              10 (hook)

1539         550 LOAD_FAST                9 (hook_id)
             552 LOAD_FAST                0 (self)
             554 LOAD_ATTR               17 (_forward_pre_hooks_with_kwargs)
             564 CONTAINS_OP              0
             566 POP_JUMP_FORWARD_IF_FALSE    81 (to 730)

1540         568 PUSH_NULL
             570 LOAD_FAST               10 (hook)
             572 LOAD_FAST                0 (self)
             574 LOAD_FAST                1 (args)
             576 LOAD_FAST                2 (kwargs)
             578 PRECALL                  3
             582 CALL                     3
             592 STORE_FAST              11 (args_kwargs_result)

1541         594 LOAD_FAST               11 (args_kwargs_result)
             596 POP_JUMP_FORWARD_IF_NONE    65 (to 728)

1542         598 LOAD_GLOBAL             37 (NULL + isinstance)
             610 LOAD_FAST               11 (args_kwargs_result)
             612 LOAD_GLOBAL             38 (tuple)
             624 PRECALL                  2
             628 CALL                     2
             638 POP_JUMP_FORWARD_IF_FALSE    25 (to 690)
             640 LOAD_GLOBAL             41 (NULL + len)
             652 LOAD_FAST               11 (args_kwargs_result)
             654 PRECALL                  1
             658 CALL                     1
             668 LOAD_CONST               1 (2)
             670 COMPARE_OP               2 (==)
             676 POP_JUMP_FORWARD_IF_FALSE     6 (to 690)

1543         678 LOAD_FAST               11 (args_kwargs_result)
             680 UNPACK_SEQUENCE          2
             684 STORE_FAST               1 (args)
             686 STORE_FAST               2 (kwargs)
             688 JUMP_BACKWARD           75 (to 540)

1545     >>  690 LOAD_GLOBAL             43 (NULL + RuntimeError)

1546         702 LOAD_CONST               2 ('forward pre-hook must return None or a tuple of (new_args, new_kwargs), but got ')

1547         704 LOAD_FAST               11 (args_kwargs_result)

1546         706 FORMAT_VALUE             0
             708 LOAD_CONST               3 ('.')
             710 BUILD_STRING             3

1545         712 PRECALL                  1
             716 CALL                     1
             726 RAISE_VARARGS            1

1541     >>  728 JUMP_BACKWARD           95 (to 540)

1550     >>  730 PUSH_NULL
             732 LOAD_FAST               10 (hook)
             734 LOAD_FAST                0 (self)
             736 LOAD_FAST                1 (args)
             738 PRECALL                  2
             742 CALL                     2
             752 STORE_FAST              12 (args_result)

1551         754 LOAD_FAST               12 (args_result)
             756 POP_JUMP_FORWARD_IF_NONE    26 (to 810)

1552         758 LOAD_GLOBAL             37 (NULL + isinstance)
             770 LOAD_FAST               12 (args_result)
             772 LOAD_GLOBAL             38 (tuple)
             784 PRECALL                  2
             788 CALL                     2
             798 POP_JUMP_FORWARD_IF_TRUE     3 (to 806)

1553         800 LOAD_FAST               12 (args_result)
             802 BUILD_TUPLE              1
             804 STORE_FAST              12 (args_result)

1554     >>  806 LOAD_FAST               12 (args_result)
             808 STORE_FAST               1 (args)
         >>  810 JUMP_BACKWARD          136 (to 540)

1556     >>  812 LOAD_CONST               0 (None)
             814 STORE_FAST              13 (bw_hook)

1557         816 LOAD_FAST                6 (full_backward_hooks)
             818 POP_JUMP_FORWARD_IF_TRUE     2 (to 824)
             820 LOAD_FAST                8 (backward_pre_hooks)
             822 POP_JUMP_FORWARD_IF_FALSE    43 (to 910)

1558     >>  824 LOAD_GLOBAL             45 (NULL + hooks)
             836 LOAD_ATTR               23 (BackwardHook)
             846 LOAD_FAST                0 (self)
             848 LOAD_FAST                6 (full_backward_hooks)
             850 LOAD_FAST                8 (backward_pre_hooks)
             852 PRECALL                  3
             856 CALL                     3
             866 STORE_FAST              13 (bw_hook)

1559         868 LOAD_FAST               13 (bw_hook)
             870 LOAD_METHOD             24 (setup_input_hook)
             892 LOAD_FAST                1 (args)
             894 PRECALL                  1
             898 CALL                     1
             908 STORE_FAST               1 (args)

1561     >>  910 PUSH_NULL
             912 LOAD_FAST                3 (forward_call)
             914 LOAD_FAST                1 (args)
             916 BUILD_MAP                0
             918 LOAD_FAST                2 (kwargs)
             920 DICT_MERGE               1
             922 CALL_FUNCTION_EX         1
             924 STORE_FAST               4 (result)

1562         926 LOAD_GLOBAL             22 (_global_forward_hooks)
             938 POP_JUMP_FORWARD_IF_TRUE     7 (to 954)
             940 LOAD_FAST                0 (self)
             942 LOAD_ATTR                7 (_forward_hooks)
             952 POP_JUMP_FORWARD_IF_FALSE   139 (to 1232)

1563     >>  954 BUILD_LIST               0

1564         956 LOAD_GLOBAL             22 (_global_forward_hooks)
             968 LOAD_METHOD             16 (items)
             990 PRECALL                  0
             994 CALL                     0

1563        1004 LIST_EXTEND              1

1565        1006 LOAD_FAST                0 (self)
            1008 LOAD_ATTR                7 (_forward_hooks)
            1018 LOAD_METHOD             16 (items)
            1040 PRECALL                  0
            1044 CALL                     0

1563        1054 LIST_EXTEND              1
            1056 LIST_TO_TUPLE
            1058 GET_ITER
         >> 1060 FOR_ITER                85 (to 1232)
            1062 UNPACK_SEQUENCE          2
            1066 STORE_FAST               9 (hook_id)
            1068 STORE_FAST              10 (hook)

1568        1070 LOAD_FAST                9 (hook_id)
            1072 LOAD_FAST                0 (self)
            1074 LOAD_ATTR               25 (_forward_hooks_always_called)
            1084 CONTAINS_OP              0
            1086 POP_JUMP_FORWARD_IF_TRUE     9 (to 1106)
            1088 LOAD_FAST                9 (hook_id)
            1090 LOAD_GLOBAL             52 (_global_forward_hooks_always_called)
            1102 CONTAINS_OP              0
            1104 POP_JUMP_FORWARD_IF_FALSE    21 (to 1148)

1569     >> 1106 LOAD_FAST                5 (called_always_called_hooks)
            1108 LOAD_METHOD             27 (add)
            1130 LOAD_FAST                9 (hook_id)
            1132 PRECALL                  1
            1136 CALL                     1
            1146 POP_TOP

1571     >> 1148 LOAD_FAST                9 (hook_id)
            1150 LOAD_FAST                0 (self)
            1152 LOAD_ATTR               28 (_forward_hooks_with_kwargs)
            1162 CONTAINS_OP              0
            1164 POP_JUMP_FORWARD_IF_FALSE    15 (to 1196)

1572        1166 PUSH_NULL
            1168 LOAD_FAST               10 (hook)
            1170 LOAD_FAST                0 (self)
            1172 LOAD_FAST                1 (args)
            1174 LOAD_FAST                2 (kwargs)
            1176 LOAD_FAST                4 (result)
            1178 PRECALL                  4
            1182 CALL                     4
            1192 STORE_FAST              14 (hook_result)
            1194 JUMP_FORWARD            13 (to 1222)

1574     >> 1196 PUSH_NULL
            1198 LOAD_FAST               10 (hook)
            1200 LOAD_FAST                0 (self)
            1202 LOAD_FAST                1 (args)
            1204 LOAD_FAST                4 (result)
            1206 PRECALL                  3
            1210 CALL                     3
            1220 STORE_FAST              14 (hook_result)

1576     >> 1222 LOAD_FAST               14 (hook_result)
            1224 POP_JUMP_FORWARD_IF_NONE     2 (to 1230)

1577        1226 LOAD_FAST               14 (hook_result)
            1228 STORE_FAST               4 (result)
         >> 1230 JUMP_BACKWARD           86 (to 1060)

1579     >> 1232 LOAD_FAST               13 (bw_hook)
            1234 POP_JUMP_FORWARD_IF_FALSE    90 (to 1416)

1580        1236 LOAD_GLOBAL             37 (NULL + isinstance)
            1248 LOAD_FAST                4 (result)
            1250 LOAD_GLOBAL              0 (torch)
            1262 LOAD_ATTR               29 (Tensor)
            1272 LOAD_GLOBAL             38 (tuple)
            1284 BUILD_TUPLE              2
            1286 PRECALL                  2
            1290 CALL                     2
            1300 POP_JUMP_FORWARD_IF_TRUE    36 (to 1374)

1581        1302 LOAD_GLOBAL             61 (NULL + warnings)
            1314 LOAD_ATTR               31 (warn)
            1324 LOAD_CONST               4 ('For backward hooks to be called, module output should be a Tensor or a tuple of Tensors but received ')

1583        1326 LOAD_GLOBAL             65 (NULL + type)
            1338 LOAD_FAST                4 (result)
            1340 PRECALL                  1
            1344 CALL                     1

1581        1354 FORMAT_VALUE             0
            1356 BUILD_STRING             2
            1358 PRECALL                  1
            1362 CALL                     1
            1372 POP_TOP

1584     >> 1374 LOAD_FAST               13 (bw_hook)
            1376 LOAD_METHOD             33 (setup_output_hook)
            1398 LOAD_FAST                4 (result)
            1400 PRECALL                  1
            1404 CALL                     1
            1414 STORE_FAST               4 (result)

1587     >> 1416 LOAD_FAST                7 (non_full_backward_hooks)
            1418 POP_JUMP_FORWARD_IF_FALSE   199 (to 1818)

1588        1420 LOAD_FAST                4 (result)
            1422 STORE_FAST              15 (var)

1589        1424 LOAD_GLOBAL             37 (NULL + isinstance)
            1436 LOAD_FAST               15 (var)
            1438 LOAD_GLOBAL              0 (torch)
            1450 LOAD_ATTR               29 (Tensor)
            1460 PRECALL                  2
            1464 CALL                     2
            1474 POP_JUMP_FORWARD_IF_TRUE    99 (to 1674)

1590     >> 1476 LOAD_GLOBAL             37 (NULL + isinstance)
            1488 LOAD_FAST               15 (var)
            1490 LOAD_GLOBAL             68 (dict)
            1502 PRECALL                  2
            1506 CALL                     2
            1516 POP_JUMP_FORWARD_IF_FALSE    44 (to 1606)

1591        1518 LOAD_GLOBAL             71 (NULL + next)
            1530 LOAD_CONST               5 (<code object <genexpr> at 0x7facf67909c0, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1591>)
            1532 MAKE_FUNCTION            0
            1534 LOAD_FAST               15 (var)
            1536 LOAD_METHOD             36 (values)
            1558 PRECALL                  0
            1562 CALL                     0
            1572 GET_ITER
            1574 PRECALL                  0
            1578 CALL                     0
            1588 PRECALL                  1
            1592 CALL                     1
            1602 STORE_FAST              15 (var)
            1604 JUMP_FORWARD             8 (to 1622)

1593     >> 1606 LOAD_FAST               15 (var)
            1608 LOAD_CONST               6 (0)
            1610 BINARY_SUBSCR
            1620 STORE_FAST              15 (var)

1589     >> 1622 LOAD_GLOBAL             37 (NULL + isinstance)
            1634 LOAD_FAST               15 (var)
            1636 LOAD_GLOBAL              0 (torch)
            1648 LOAD_ATTR               29 (Tensor)
            1658 PRECALL                  2
            1662 CALL                     2
            1672 POP_JUMP_BACKWARD_IF_FALSE    99 (to 1476)

1594     >> 1674 LOAD_FAST               15 (var)
            1676 LOAD_ATTR               37 (grad_fn)
            1686 STORE_FAST              16 (grad_fn)

1595        1688 LOAD_FAST               16 (grad_fn)
            1690 POP_JUMP_FORWARD_IF_NONE    63 (to 1818)

1596        1692 LOAD_FAST                7 (non_full_backward_hooks)
            1694 GET_ITER
         >> 1696 FOR_ITER                37 (to 1772)
            1698 STORE_FAST              10 (hook)

1597        1700 LOAD_FAST               16 (grad_fn)
            1702 LOAD_METHOD             38 (register_hook)
            1724 LOAD_GLOBAL             79 (NULL + _WrappedHook)
            1736 LOAD_FAST               10 (hook)
            1738 LOAD_FAST                0 (self)
            1740 PRECALL                  2
            1744 CALL                     2
            1754 PRECALL                  1
            1758 CALL                     1
            1768 POP_TOP
            1770 JUMP_BACKWARD           38 (to 1696)

1598     >> 1772 LOAD_FAST                0 (self)
            1774 LOAD_METHOD             40 (_maybe_warn_non_full_backward_hook)
            1796 LOAD_FAST                1 (args)
            1798 LOAD_FAST                4 (result)
            1800 LOAD_FAST               16 (grad_fn)
            1802 PRECALL                  3
            1806 CALL                     3
            1816 POP_TOP

1600     >> 1818 LOAD_FAST                4 (result)
            1820 RETURN_VALUE
         >> 1822 PUSH_EXC_INFO

1602        1824 LOAD_GLOBAL             82 (Exception)
            1836 CHECK_EXC_MATCH
            1838 EXTENDED_ARG             1
            1840 POP_JUMP_FORWARD_IF_FALSE   270 (to 2382)
            1842 POP_TOP

1606        1844 LOAD_GLOBAL             22 (_global_forward_hooks)
            1856 LOAD_METHOD             16 (items)
            1878 PRECALL                  0
            1882 CALL                     0
            1892 GET_ITER
         >> 1894 FOR_ITER                96 (to 2088)
            1896 UNPACK_SEQUENCE          2
            1900 STORE_FAST               9 (hook_id)
            1902 STORE_FAST              10 (hook)

1607        1904 LOAD_FAST                9 (hook_id)
            1906 LOAD_GLOBAL             52 (_global_forward_hooks_always_called)
            1918 CONTAINS_OP              0
            1920 POP_JUMP_FORWARD_IF_FALSE    82 (to 2086)
            1922 LOAD_FAST                9 (hook_id)
            1924 LOAD_FAST                5 (called_always_called_hooks)
            1926 CONTAINS_OP              1
            1928 POP_JUMP_FORWARD_IF_FALSE    78 (to 2086)

1608        1930 NOP

1609        1932 PUSH_NULL
            1934 LOAD_FAST               10 (hook)
            1936 LOAD_FAST                0 (self)
            1938 LOAD_FAST                1 (args)
            1940 LOAD_FAST                4 (result)
            1942 PRECALL                  3
            1946 CALL                     3
            1956 STORE_FAST              14 (hook_result)

1610        1958 LOAD_FAST               14 (hook_result)
            1960 POP_JUMP_FORWARD_IF_NONE     2 (to 1966)

1611        1962 LOAD_FAST               14 (hook_result)
            1964 STORE_FAST               4 (result)
         >> 1966 JUMP_BACKWARD           37 (to 1894)
         >> 1968 PUSH_EXC_INFO

1612        1970 LOAD_GLOBAL             82 (Exception)
            1982 CHECK_EXC_MATCH
            1984 POP_JUMP_FORWARD_IF_FALSE    46 (to 2078)
            1986 STORE_FAST              17 (e)

1613        1988 LOAD_GLOBAL             61 (NULL + warnings)
            2000 LOAD_ATTR               31 (warn)
            2010 LOAD_CONST               7 ('global module forward hook with ``always_call=True`` raised an exception that was silenced as another error was raised in forward: ')

1614        2012 LOAD_GLOBAL             85 (NULL + str)
            2024 LOAD_FAST               17 (e)
            2026 PRECALL                  1
            2030 CALL                     1

1613        2040 FORMAT_VALUE             0
            2042 BUILD_STRING             2
            2044 PRECALL                  1
            2048 CALL                     1
            2058 POP_TOP

1615        2060 POP_EXCEPT
            2062 LOAD_CONST               0 (None)
            2064 STORE_FAST              17 (e)
            2066 DELETE_FAST             17 (e)
            2068 JUMP_BACKWARD           88 (to 1894)
         >> 2070 LOAD_CONST               0 (None)
            2072 STORE_FAST              17 (e)
            2074 DELETE_FAST             17 (e)
            2076 RERAISE                  1

1612     >> 2078 RERAISE                  0
         >> 2080 COPY                     3
            2082 POP_EXCEPT
            2084 RERAISE                  1
         >> 2086 JUMP_BACKWARD           97 (to 1894)

1617     >> 2088 LOAD_FAST                0 (self)
            2090 LOAD_ATTR                7 (_forward_hooks)
            2100 LOAD_METHOD             16 (items)
            2122 PRECALL                  0
            2126 CALL                     0
            2136 GET_ITER
         >> 2138 FOR_ITER               120 (to 2380)
            2140 UNPACK_SEQUENCE          2
            2144 STORE_FAST               9 (hook_id)
            2146 STORE_FAST              10 (hook)

1618        2148 LOAD_FAST                9 (hook_id)
            2150 LOAD_FAST                0 (self)
            2152 LOAD_ATTR               25 (_forward_hooks_always_called)
            2162 CONTAINS_OP              0
            2164 POP_JUMP_FORWARD_IF_FALSE   106 (to 2378)
            2166 LOAD_FAST                9 (hook_id)
            2168 LOAD_FAST                5 (called_always_called_hooks)
            2170 CONTAINS_OP              1
            2172 POP_JUMP_FORWARD_IF_FALSE   102 (to 2378)

1619        2174 NOP

1620        2176 LOAD_FAST                9 (hook_id)
            2178 LOAD_FAST                0 (self)
            2180 LOAD_ATTR               28 (_forward_hooks_with_kwargs)
            2190 CONTAINS_OP              0
            2192 POP_JUMP_FORWARD_IF_FALSE    15 (to 2224)

1621        2194 PUSH_NULL
            2196 LOAD_FAST               10 (hook)
            2198 LOAD_FAST                0 (self)
            2200 LOAD_FAST                1 (args)
            2202 LOAD_FAST                2 (kwargs)
            2204 LOAD_FAST                4 (result)
            2206 PRECALL                  4
            2210 CALL                     4
            2220 STORE_FAST              14 (hook_result)
            2222 JUMP_FORWARD            13 (to 2250)

1623     >> 2224 PUSH_NULL
            2226 LOAD_FAST               10 (hook)
            2228 LOAD_FAST                0 (self)
            2230 LOAD_FAST                1 (args)
            2232 LOAD_FAST                4 (result)
            2234 PRECALL                  3
            2238 CALL                     3
            2248 STORE_FAST              14 (hook_result)

1624     >> 2250 LOAD_FAST               14 (hook_result)
            2252 POP_JUMP_FORWARD_IF_NONE     2 (to 2258)

1625        2254 LOAD_FAST               14 (hook_result)
            2256 STORE_FAST               4 (result)
         >> 2258 JUMP_BACKWARD           61 (to 2138)
         >> 2260 PUSH_EXC_INFO

1626        2262 LOAD_GLOBAL             82 (Exception)
            2274 CHECK_EXC_MATCH
            2276 POP_JUMP_FORWARD_IF_FALSE    46 (to 2370)
            2278 STORE_FAST              17 (e)

1627        2280 LOAD_GLOBAL             61 (NULL + warnings)
            2292 LOAD_ATTR               31 (warn)
            2302 LOAD_CONST               8 ('module forward hook with ``always_call=True`` raised an exception that was silenced as another error was raised in forward: ')

1628        2304 LOAD_GLOBAL             85 (NULL + str)
            2316 LOAD_FAST               17 (e)
            2318 PRECALL                  1
            2322 CALL                     1

1627        2332 FORMAT_VALUE             0
            2334 BUILD_STRING             2
            2336 PRECALL                  1
            2340 CALL                     1
            2350 POP_TOP

1629        2352 POP_EXCEPT
            2354 LOAD_CONST               0 (None)
            2356 STORE_FAST              17 (e)
            2358 DELETE_FAST             17 (e)
            2360 JUMP_BACKWARD          112 (to 2138)
         >> 2362 LOAD_CONST               0 (None)
            2364 STORE_FAST              17 (e)
            2366 DELETE_FAST             17 (e)
            2368 RERAISE                  1

1626     >> 2370 RERAISE                  0
         >> 2372 COPY                     3
            2374 POP_EXCEPT
            2376 RERAISE                  1
         >> 2378 JUMP_BACKWARD          121 (to 2138)

1631     >> 2380 RAISE_VARARGS            0

1602     >> 2382 RERAISE                  0
         >> 2384 COPY                     3
            2386 POP_EXCEPT
            2388 RERAISE                  1
ExceptionTable:
  220 to 1818 -> 1822 [0]
  1822 to 1928 -> 2384 [1] lasti
  1932 to 1964 -> 1968 [2]
  1966 to 1966 -> 2384 [1] lasti
  1968 to 1986 -> 2080 [3] lasti
  1988 to 2058 -> 2070 [3] lasti
  2060 to 2068 -> 2384 [1] lasti
  2070 to 2078 -> 2080 [3] lasti
  2080 to 2172 -> 2384 [1] lasti
  2176 to 2256 -> 2260 [2]
  2258 to 2258 -> 2384 [1] lasti
  2260 to 2278 -> 2372 [3] lasti
  2280 to 2350 -> 2362 [3] lasti
  2352 to 2360 -> 2384 [1] lasti
  2362 to 2370 -> 2372 [3] lasti
  2372 to 2382 -> 2384 [1] lasti
, inlined according skipfiles.MOD_INLINELIST
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1513 in _call_impl (Module._call_impl) (inline depth: 1)
        def _call_impl(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1514 in _call_impl (Module._call_impl) (inline depth: 1)
            forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR _C [TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_METHOD _get_tracing_state [TorchVariable(<module 'torch._C' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/_C.cpython-311-x86_64-linux-gnu.so'>)]
TRACE PRECALL 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method _get_tracing_state of PyCapsule object at 0x7fad61054bd0>)]
TRACE CALL 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method _get_tracing_state of PyCapsule object at 0x7fad61054bd0>)]
TRACE POP_JUMP_FORWARD_IF_FALSE 76 [ConstantVariable(NoneType)]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR forward [NNModuleVariable()]
TRACE STORE_FAST forward_call [UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable())]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _backward_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _backward_pre_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _forward_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _forward_pre_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1518 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_backward_pre_hooks or _global_backward_hooks
TRACE LOAD_GLOBAL _global_backward_pre_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1518 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_backward_pre_hooks or _global_backward_hooks
TRACE LOAD_GLOBAL _global_backward_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1519 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_forward_hooks or _global_forward_pre_hooks):
TRACE LOAD_GLOBAL _global_forward_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1519 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_forward_hooks or _global_forward_pre_hooks):
TRACE LOAD_GLOBAL _global_forward_pre_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1520 in _call_impl (Module._call_impl) (inline depth: 1)
                return forward_call(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST forward_call [NullVariable]
TRACE LOAD_FAST args [NullVariable, UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable())]
TRACE BUILD_MAP 0 [NullVariable, UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable()), TupleVariable()]
TRACE LOAD_FAST kwargs [NullVariable, UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable()), TupleVariable(), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable()), TupleVariable(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable()), TupleVariable(), ConstDictVariable()]
TRACE inlined call forward from /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1520 in _call_impl (Module._call_impl) (inline depth: 1)
            return forward_call(*args, **kwargs)
                   ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object forward at 0x7facb0a9d8b0, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 37>
 37           0 RESUME                   0

 38           2 LOAD_GLOBAL              1 (NULL + F)
             14 LOAD_ATTR                1 (relu)
             24 LOAD_FAST                0 (self)
             26 LOAD_METHOD              2 (layer1)
             48 LOAD_FAST                1 (embeddings)
             50 PRECALL                  1
             54 CALL                     1
             64 PRECALL                  1
             68 CALL                     1
             78 STORE_FAST               2 (layer1_act)

 39          80 LOAD_GLOBAL              7 (NULL + torch)
             92 LOAD_ATTR                4 (mean)
            102 LOAD_FAST                2 (layer1_act)
            104 LOAD_CONST               1 (0)
            106 KW_NAMES                 2
            108 PRECALL                  2
            112 CALL                     2
            122 STORE_FAST               3 (layer1_mean)

 40         124 LOAD_GLOBAL              7 (NULL + torch)
            136 LOAD_ATTR                5 (sigmoid)
            146 LOAD_FAST                0 (self)
            148 LOAD_METHOD              6 (layer2)
            170 LOAD_FAST                3 (layer1_mean)
            172 PRECALL                  1
            176 CALL                     1
            186 PRECALL                  1
            190 CALL                     1
            200 STORE_FAST               4 (gate)

 41         202 LOAD_GLOBAL              7 (NULL + torch)
            214 LOAD_ATTR                7 (min)
            224 LOAD_FAST                1 (embeddings)
            226 LOAD_CONST               1 (0)
            228 KW_NAMES                 2
            230 PRECALL                  2
            234 CALL                     2
            244 UNPACK_SEQUENCE          2
            248 STORE_FAST               5 (offset)
            250 STORE_FAST               6 (_)

 43         252 LOAD_FAST                5 (offset)
            254 LOAD_FAST                4 (gate)
            256 BINARY_OP                5 (*)
            260 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:37 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        def forward(self, embeddings):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:38 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
            layer1_act = F.relu(self.layer1(embeddings))
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_METHOD layer1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NNModuleVariable()]
TRACE LOAD_FAST embeddings [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable()]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE FX call l__self___offset_net_layer1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:38 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        layer1_act = F.relu(self.layer1(embeddings))
                            ~~~~~~~~~~~^^^^^^^^^^^^
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:38 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        layer1_act = F.relu(self.layer1(embeddings))
                     ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST layer1_act [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:39 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
            layer1_mean = torch.mean(layer1_act, dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR mean [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST layer1_act [NullVariable, TorchInGraphFunctionVariable(<built-in method mean of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method mean of type object at 0x7fad600718a0>), TensorVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method mean of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method mean of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method mean of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE FX call mean from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:39 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        layer1_mean = torch.mean(layer1_act, dim=0)
                      ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST layer1_mean [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:40 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
            gate = torch.sigmoid(self.layer2(layer1_mean))
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR sigmoid [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>)]
TRACE LOAD_METHOD layer2 [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_FAST layer1_mean [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), NullVariable, NNModuleVariable()]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE FX call l__self___offset_net_layer2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:40 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        gate = torch.sigmoid(self.layer2(layer1_mean))
                             ~~~~~~~~~~~^^^^^^^^^^^^^
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call sigmoid from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:40 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        gate = torch.sigmoid(self.layer2(layer1_mean))
               ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST gate [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:41 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
            offset, _ = torch.min(embeddings, dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:41 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        offset, _ = torch.min(embeddings, dim=0)
                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 2 [NamedTupleVariable()]
TRACE STORE_FAST offset [TensorVariable(), TensorVariable()]
TRACE STORE_FAST _ [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:43 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
            return offset * gate
TRACE LOAD_FAST offset []
TRACE LOAD_FAST gate [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:43 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        return offset * gate
               ~~~~~~~^~~~~~
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward at 0x7facb0a9d8b0, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 37>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object _call_impl at 0x60bf410, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1513>
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing embed_query_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 241 in embed_query_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_20 =====
 <eval_with_key>.331 class GraphModule(torch.nn.Module):
    def forward(self, s0 : torch.SymInt, L_queries_ : torch.Tensor):
        l_queries_ = L_queries_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_queries_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_queries_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_queries_[(slice(None, None, None), 1)]
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  embedding_2 = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        getitem_3 = l_queries_[(slice(None, None, None), 2)]
        embedding_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem_3);  l__self___entity_embedding = getitem_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like_1 = torch.zeros_like(embedding_3)
        offset_embedding_3 = zeros_like_1.cuda();  zeros_like_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        getitem_4 = l_queries_[(slice(None, None, None), 3)]
        r_embedding_1 = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_4);  l__self___relation_embedding = getitem_4 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        getitem_5 = l_queries_[(slice(None, None, None), 3)];  l_queries_ = None
        r_offset_embedding_1 = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_5);  l__self___offset_embedding = getitem_5 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding_3 += r_embedding_1;  embedding_5 = embedding_3;  embedding_3 = r_embedding_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding_3 += r_offset_embedding_1;  offset_embedding_5 = offset_embedding_3;  offset_embedding_3 = r_offset_embedding_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:238, code: embedding = self.center_net(torch.stack(embedding_list))
        stack = torch.stack([embedding_2, embedding_5]);  embedding_2 = embedding_5 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:57, code: layer1_act = F.relu(self.layer1(embeddings)) # (num_conj, dim)
        l__self___center_net_layer1 = self.L__self___center_net_layer1(stack)
        layer1_act = torch.nn.functional.relu(l__self___center_net_layer1);  l__self___center_net_layer1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:58, code: attention = F.softmax(self.layer2(layer1_act), dim=0) # (num_conj, dim)
        l__self___center_net_layer2 = self.L__self___center_net_layer2(layer1_act);  layer1_act = None
        attention = torch.nn.functional.softmax(l__self___center_net_layer2, dim = 0);  l__self___center_net_layer2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:59, code: embedding = torch.sum(attention * embeddings, dim=0)
        mul = attention * stack;  attention = stack = None
        embedding_7 = torch.sum(mul, dim = 0);  mul = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:239, code: offset_embedding = self.offset_net(torch.stack(offset_embedding_list))
        stack_1 = torch.stack([offset_embedding_2, offset_embedding_5]);  offset_embedding_2 = offset_embedding_5 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:38, code: layer1_act = F.relu(self.layer1(embeddings))
        l__self___offset_net_layer1 = self.L__self___offset_net_layer1(stack_1)
        layer1_act_1 = torch.nn.functional.relu(l__self___offset_net_layer1);  l__self___offset_net_layer1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:39, code: layer1_mean = torch.mean(layer1_act, dim=0)
        layer1_mean = torch.mean(layer1_act_1, dim = 0);  layer1_act_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:40, code: gate = torch.sigmoid(self.layer2(layer1_mean))
        l__self___offset_net_layer2 = self.L__self___offset_net_layer2(layer1_mean);  layer1_mean = None
        gate = torch.sigmoid(l__self___offset_net_layer2);  l__self___offset_net_layer2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:41, code: offset, _ = torch.min(embeddings, dim=0)
        min_1 = torch.min(stack_1, dim = 0);  stack_1 = None
        offset = min_1[0];  min_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:43, code: return offset * gate
        offset_embedding_6 = offset * gate;  offset = gate = None
        return (embedding_7, offset_embedding_6)
        

TRACED GRAPH
 __compiled_fn_20 <eval_with_key>.331 opcode         name                          target                                                           args                                         kwargs
-------------  ----------------------------  ---------------------------------------------------------------  -------------------------------------------  ------------------------------
placeholder    s0                            s0                                                               ()                                           {}
placeholder    l_queries_                    L_queries_                                                       ()                                           {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                           {}
call_function  getitem                       <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 0))   {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                 {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                           {}
call_function  getitem_1                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 1))   {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)              {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                           {}
call_function  getitem_2                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 1))   {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                {'dim': 0, 'index': getitem_2}
call_function  embedding_2                   <built-in function iadd>                                         (embedding, r_embedding)                     {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)       {}
call_function  getitem_3                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 2))   {}
call_function  embedding_3                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                {'dim': 0, 'index': getitem_3}
call_function  zeros_like_1                  <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding_3,)                               {}
call_method    offset_embedding_3            cuda                                                             (zeros_like_1,)                              {}
call_function  getitem_4                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 3))   {}
call_function  r_embedding_1                 <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)              {'dim': 0, 'index': getitem_4}
call_function  getitem_5                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 3))   {}
call_function  r_offset_embedding_1          <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                {'dim': 0, 'index': getitem_5}
call_function  embedding_5                   <built-in function iadd>                                         (embedding_3, r_embedding_1)                 {}
call_function  offset_embedding_5            <built-in function iadd>                                         (offset_embedding_3, r_offset_embedding_1)   {}
call_function  stack                         <built-in method stack of type object at 0x7fad600718a0>         ([embedding_2, embedding_5],)                {}
call_module    l__self___center_net_layer1   L__self___center_net_layer1                                      (stack,)                                     {}
call_function  layer1_act                    <function relu at 0x7facb1c64220>                                (l__self___center_net_layer1,)               {}
call_module    l__self___center_net_layer2   L__self___center_net_layer2                                      (layer1_act,)                                {}
call_function  attention                     <function softmax at 0x7facb1c64a40>                             (l__self___center_net_layer2,)               {'dim': 0}
call_function  mul                           <built-in function mul>                                          (attention, stack)                           {}
call_function  embedding_7                   <built-in method sum of type object at 0x7fad600718a0>           (mul,)                                       {'dim': 0}
call_function  stack_1                       <built-in method stack of type object at 0x7fad600718a0>         ([offset_embedding_2, offset_embedding_5],)  {}
call_module    l__self___offset_net_layer1   L__self___offset_net_layer1                                      (stack_1,)                                   {}
call_function  layer1_act_1                  <function relu at 0x7facb1c64220>                                (l__self___offset_net_layer1,)               {}
call_function  layer1_mean                   <built-in method mean of type object at 0x7fad600718a0>          (layer1_act_1,)                              {'dim': 0}
call_module    l__self___offset_net_layer2   L__self___offset_net_layer2                                      (layer1_mean,)                               {}
call_function  gate                          <built-in method sigmoid of type object at 0x7fad600718a0>       (l__self___offset_net_layer2,)               {}
call_function  min_1                         <built-in method min of type object at 0x7fad600718a0>           (stack_1,)                                   {'dim': 0}
call_function  offset                        <built-in function getitem>                                      (min_1, 0)                                   {}
call_function  offset_embedding_6            <built-in function mul>                                          (offset, gate)                               {}
output         output                        output                                                           ((embedding_7, offset_embedding_6),)         {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_20 =====
l_queries_: (1, s0)
l_queries_ (concrete): (1, 4)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
embedding_2: (1, 400)
offset_embedding_2: (1, 400)
getitem_3: (1,)
embedding_3: (1, 400)
zeros_like_1: (1, 400)
offset_embedding_3: (1, 400)
getitem_4: (1,)
r_embedding_1: (1, 400)
getitem_5: (1,)
r_offset_embedding_1: (1, 400)
embedding_5: (1, 400)
offset_embedding_5: (1, 400)
stack: (2, 1, 400)
l__self___center_net_layer1: (2, 1, 400)
layer1_act: (2, 1, 400)
l__self___center_net_layer2: (2, 1, 400)
attention: (2, 1, 400)
mul: (2, 1, 400)
embedding_7: (1, 400)
stack_1: (2, 1, 400)
l__self___offset_net_layer1: (2, 1, 400)
layer1_act_1: (2, 1, 400)
layer1_mean: (1, 400)
l__self___offset_net_layer2: (1, 400)
gate: (1, 400)
offset: (1, 400)
offset_embedding_6: (1, 400)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing embed_query_box /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [LazyVariableTracker()]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:210 in embed_query_box (KGReasoning.embed_query_box)
                    all_relation_flag = False
TRACE LOAD_CONST False [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1)]
TRACE STORE_FAST all_relation_flag [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:211 in embed_query_box (KGReasoning.embed_query_box)
                    break
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1)]
TRACE JUMP_FORWARD 44 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:232 in embed_query_box (KGReasoning.embed_query_box)
                embedding_list = []
TRACE BUILD_LIST 0 []
TRACE STORE_FAST embedding_list [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:233 in embed_query_box (KGReasoning.embed_query_box)
                offset_embedding_list = []
TRACE BUILD_LIST 0 []
TRACE STORE_FAST offset_embedding_list [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:234 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure)):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 930 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:235 in embed_query_box (KGReasoning.embed_query_box)
                    embedding, offset_embedding, idx = self.embed_query_box(queries, query_structure[i], idx)
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), LazyVariableTracker()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable(), LazyVariableTracker()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable(), LazyVariableTracker()]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:235 in embed_query_box (KGReasoning.embed_query_box)
                embedding, offset_embedding, idx = self.embed_query_box(queries, query_structure[i], idx)
                                                   ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), SliceVariable(), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), TupleVariable()]
create_graph_input L_queries_ L['queries']
wrap_to_fake L['queries'] (1, 6) [<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>] [None, RelaxedUnspecConstraint(warn_only=True)]
bind_symint s0 L['queries'].size()[1]
create_graph_input s0 L['queries'].size()[1]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable()]
TRACE BINARY_OP 13 [ConstantVariable(), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), TupleVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:236 in embed_query_box (KGReasoning.embed_query_box)
                    embedding_list.append(embedding)
TRACE LOAD_FAST embedding_list [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), ListVariable()]
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:237 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding_list.append(offset_embedding)
TRACE LOAD_FAST offset_embedding_list [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(NoneType)]
TRACE JUMP_BACKWARD 774 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:234 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure)):
TRACE FOR_ITER 930 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:235 in embed_query_box (KGReasoning.embed_query_box)
                    embedding, offset_embedding, idx = self.embed_query_box(queries, query_structure[i], idx)
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NNModuleVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:235 in embed_query_box (KGReasoning.embed_query_box)
                embedding, offset_embedding, idx = self.embed_query_box(queries, query_structure[i], idx)
                                                   ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_4 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_4 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_5 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_5 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), TupleVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:236 in embed_query_box (KGReasoning.embed_query_box)
                    embedding_list.append(embedding)
TRACE LOAD_FAST embedding_list [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_METHOD append [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), ListVariable()]
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:237 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding_list.append(offset_embedding)
TRACE LOAD_FAST offset_embedding_list [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_METHOD append [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(NoneType)]
TRACE JUMP_BACKWARD 774 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:234 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure)):
TRACE FOR_ITER 930 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:235 in embed_query_box (KGReasoning.embed_query_box)
                    embedding, offset_embedding, idx = self.embed_query_box(queries, query_structure[i], idx)
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NNModuleVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:235 in embed_query_box (KGReasoning.embed_query_box)
                embedding, offset_embedding, idx = self.embed_query_box(queries, query_structure[i], idx)
                                                   ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_6 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_6 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_7 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_7 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_8 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_8 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_4 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_5 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), TupleVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:236 in embed_query_box (KGReasoning.embed_query_box)
                    embedding_list.append(embedding)
TRACE LOAD_FAST embedding_list [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3)]
TRACE LOAD_METHOD append [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), ListVariable()]
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:237 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding_list.append(offset_embedding)
TRACE LOAD_FAST offset_embedding_list [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3)]
TRACE LOAD_METHOD append [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3), ConstantVariable(NoneType)]
TRACE JUMP_BACKWARD 774 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:234 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure)):
TRACE FOR_ITER 930 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int), ConstantVariable(int)], index=3)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:238 in embed_query_box (KGReasoning.embed_query_box)
                embedding = self.center_net(torch.stack(embedding_list))
TRACE LOAD_FAST self []
TRACE LOAD_METHOD center_net [NNModuleVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, NNModuleVariable()]
TRACE LOAD_ATTR stack [NullVariable, NNModuleVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding_list [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>), ListVariable()]
TRACE CALL 1 [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>), ListVariable()]
TRACE FX call stack from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:238 in embed_query_box (KGReasoning.embed_query_box)
            embedding = self.center_net(torch.stack(embedding_list))
                                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^
TRACE PRECALL 1 [NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, NNModuleVariable(), TensorVariable()]
TRACE inlined call _call_impl from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:238 in embed_query_box (KGReasoning.embed_query_box)
            embedding = self.center_net(torch.stack(embedding_list))
                        ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object _call_impl at 0x60bf410, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1513>
1513           0 RESUME                   0

1514           2 LOAD_GLOBAL              0 (torch)
              14 LOAD_ATTR                1 (_C)
              24 LOAD_METHOD              2 (_get_tracing_state)
              46 PRECALL                  0
              50 CALL                     0
              60 POP_JUMP_FORWARD_IF_FALSE     7 (to 76)
              62 LOAD_FAST                0 (self)
              64 LOAD_ATTR                3 (_slow_forward)
              74 JUMP_FORWARD             6 (to 88)
         >>   76 LOAD_FAST                0 (self)
              78 LOAD_ATTR                4 (forward)
         >>   88 STORE_FAST               3 (forward_call)

1517          90 LOAD_FAST                0 (self)
              92 LOAD_ATTR                5 (_backward_hooks)
             102 POP_JUMP_FORWARD_IF_TRUE    57 (to 218)
             104 LOAD_FAST                0 (self)
             106 LOAD_ATTR                6 (_backward_pre_hooks)
             116 POP_JUMP_FORWARD_IF_TRUE    50 (to 218)
             118 LOAD_FAST                0 (self)
             120 LOAD_ATTR                7 (_forward_hooks)
             130 POP_JUMP_FORWARD_IF_TRUE    43 (to 218)
             132 LOAD_FAST                0 (self)
             134 LOAD_ATTR                8 (_forward_pre_hooks)
             144 POP_JUMP_FORWARD_IF_TRUE    36 (to 218)

1518         146 LOAD_GLOBAL             18 (_global_backward_pre_hooks)

1517         158 POP_JUMP_FORWARD_IF_TRUE    29 (to 218)

1518         160 LOAD_GLOBAL             20 (_global_backward_hooks)

1517         172 POP_JUMP_FORWARD_IF_TRUE    22 (to 218)

1519         174 LOAD_GLOBAL             22 (_global_forward_hooks)

1517         186 POP_JUMP_FORWARD_IF_TRUE    15 (to 218)

1519         188 LOAD_GLOBAL             24 (_global_forward_pre_hooks)

1517         200 POP_JUMP_FORWARD_IF_TRUE     8 (to 218)

1520         202 PUSH_NULL
             204 LOAD_FAST                3 (forward_call)
             206 LOAD_FAST                1 (args)
             208 BUILD_MAP                0
             210 LOAD_FAST                2 (kwargs)
             212 DICT_MERGE               1
             214 CALL_FUNCTION_EX         1
             216 RETURN_VALUE

1522     >>  218 NOP

1523         220 LOAD_CONST               0 (None)
             222 STORE_FAST               4 (result)

1524         224 LOAD_GLOBAL             27 (NULL + set)
             236 PRECALL                  0
             240 CALL                     0
             250 STORE_FAST               5 (called_always_called_hooks)

1526         252 BUILD_LIST               0
             254 BUILD_LIST               0
             256 STORE_FAST               7 (non_full_backward_hooks)
             258 STORE_FAST               6 (full_backward_hooks)

1527         260 BUILD_LIST               0
             262 STORE_FAST               8 (backward_pre_hooks)

1528         264 LOAD_FAST                0 (self)
             266 LOAD_ATTR                6 (_backward_pre_hooks)
             276 POP_JUMP_FORWARD_IF_TRUE     7 (to 292)
             278 LOAD_GLOBAL             18 (_global_backward_pre_hooks)
             290 POP_JUMP_FORWARD_IF_FALSE    20 (to 332)

1529     >>  292 LOAD_FAST                0 (self)
             294 LOAD_METHOD             14 (_get_backward_pre_hooks)
             316 PRECALL                  0
             320 CALL                     0
             330 STORE_FAST               8 (backward_pre_hooks)

1531     >>  332 LOAD_FAST                0 (self)
             334 LOAD_ATTR                5 (_backward_hooks)
             344 POP_JUMP_FORWARD_IF_TRUE     7 (to 360)
             346 LOAD_GLOBAL             20 (_global_backward_hooks)
             358 POP_JUMP_FORWARD_IF_FALSE    23 (to 406)

1532     >>  360 LOAD_FAST                0 (self)
             362 LOAD_METHOD             15 (_get_backward_hooks)
             384 PRECALL                  0
             388 CALL                     0
             398 UNPACK_SEQUENCE          2
             402 STORE_FAST               6 (full_backward_hooks)
             404 STORE_FAST               7 (non_full_backward_hooks)

1534     >>  406 LOAD_GLOBAL             24 (_global_forward_pre_hooks)
             418 POP_JUMP_FORWARD_IF_TRUE     7 (to 434)
             420 LOAD_FAST                0 (self)
             422 LOAD_ATTR                8 (_forward_pre_hooks)
             432 POP_JUMP_FORWARD_IF_FALSE   189 (to 812)

1535     >>  434 BUILD_LIST               0

1536         436 LOAD_GLOBAL             24 (_global_forward_pre_hooks)
             448 LOAD_METHOD             16 (items)
             470 PRECALL                  0
             474 CALL                     0

1535         484 LIST_EXTEND              1

1537         486 LOAD_FAST                0 (self)
             488 LOAD_ATTR                8 (_forward_pre_hooks)
             498 LOAD_METHOD             16 (items)
             520 PRECALL                  0
             524 CALL                     0

1535         534 LIST_EXTEND              1
             536 LIST_TO_TUPLE
             538 GET_ITER
         >>  540 FOR_ITER               135 (to 812)
             542 UNPACK_SEQUENCE          2
             546 STORE_FAST               9 (hook_id)
             548 STORE_FAST              10 (hook)

1539         550 LOAD_FAST                9 (hook_id)
             552 LOAD_FAST                0 (self)
             554 LOAD_ATTR               17 (_forward_pre_hooks_with_kwargs)
             564 CONTAINS_OP              0
             566 POP_JUMP_FORWARD_IF_FALSE    81 (to 730)

1540         568 PUSH_NULL
             570 LOAD_FAST               10 (hook)
             572 LOAD_FAST                0 (self)
             574 LOAD_FAST                1 (args)
             576 LOAD_FAST                2 (kwargs)
             578 PRECALL                  3
             582 CALL                     3
             592 STORE_FAST              11 (args_kwargs_result)

1541         594 LOAD_FAST               11 (args_kwargs_result)
             596 POP_JUMP_FORWARD_IF_NONE    65 (to 728)

1542         598 LOAD_GLOBAL             37 (NULL + isinstance)
             610 LOAD_FAST               11 (args_kwargs_result)
             612 LOAD_GLOBAL             38 (tuple)
             624 PRECALL                  2
             628 CALL                     2
             638 POP_JUMP_FORWARD_IF_FALSE    25 (to 690)
             640 LOAD_GLOBAL             41 (NULL + len)
             652 LOAD_FAST               11 (args_kwargs_result)
             654 PRECALL                  1
             658 CALL                     1
             668 LOAD_CONST               1 (2)
             670 COMPARE_OP               2 (==)
             676 POP_JUMP_FORWARD_IF_FALSE     6 (to 690)

1543         678 LOAD_FAST               11 (args_kwargs_result)
             680 UNPACK_SEQUENCE          2
             684 STORE_FAST               1 (args)
             686 STORE_FAST               2 (kwargs)
             688 JUMP_BACKWARD           75 (to 540)

1545     >>  690 LOAD_GLOBAL             43 (NULL + RuntimeError)

1546         702 LOAD_CONST               2 ('forward pre-hook must return None or a tuple of (new_args, new_kwargs), but got ')

1547         704 LOAD_FAST               11 (args_kwargs_result)

1546         706 FORMAT_VALUE             0
             708 LOAD_CONST               3 ('.')
             710 BUILD_STRING             3

1545         712 PRECALL                  1
             716 CALL                     1
             726 RAISE_VARARGS            1

1541     >>  728 JUMP_BACKWARD           95 (to 540)

1550     >>  730 PUSH_NULL
             732 LOAD_FAST               10 (hook)
             734 LOAD_FAST                0 (self)
             736 LOAD_FAST                1 (args)
             738 PRECALL                  2
             742 CALL                     2
             752 STORE_FAST              12 (args_result)

1551         754 LOAD_FAST               12 (args_result)
             756 POP_JUMP_FORWARD_IF_NONE    26 (to 810)

1552         758 LOAD_GLOBAL             37 (NULL + isinstance)
             770 LOAD_FAST               12 (args_result)
             772 LOAD_GLOBAL             38 (tuple)
             784 PRECALL                  2
             788 CALL                     2
             798 POP_JUMP_FORWARD_IF_TRUE     3 (to 806)

1553         800 LOAD_FAST               12 (args_result)
             802 BUILD_TUPLE              1
             804 STORE_FAST              12 (args_result)

1554     >>  806 LOAD_FAST               12 (args_result)
             808 STORE_FAST               1 (args)
         >>  810 JUMP_BACKWARD          136 (to 540)

1556     >>  812 LOAD_CONST               0 (None)
             814 STORE_FAST              13 (bw_hook)

1557         816 LOAD_FAST                6 (full_backward_hooks)
             818 POP_JUMP_FORWARD_IF_TRUE     2 (to 824)
             820 LOAD_FAST                8 (backward_pre_hooks)
             822 POP_JUMP_FORWARD_IF_FALSE    43 (to 910)

1558     >>  824 LOAD_GLOBAL             45 (NULL + hooks)
             836 LOAD_ATTR               23 (BackwardHook)
             846 LOAD_FAST                0 (self)
             848 LOAD_FAST                6 (full_backward_hooks)
             850 LOAD_FAST                8 (backward_pre_hooks)
             852 PRECALL                  3
             856 CALL                     3
             866 STORE_FAST              13 (bw_hook)

1559         868 LOAD_FAST               13 (bw_hook)
             870 LOAD_METHOD             24 (setup_input_hook)
             892 LOAD_FAST                1 (args)
             894 PRECALL                  1
             898 CALL                     1
             908 STORE_FAST               1 (args)

1561     >>  910 PUSH_NULL
             912 LOAD_FAST                3 (forward_call)
             914 LOAD_FAST                1 (args)
             916 BUILD_MAP                0
             918 LOAD_FAST                2 (kwargs)
             920 DICT_MERGE               1
             922 CALL_FUNCTION_EX         1
             924 STORE_FAST               4 (result)

1562         926 LOAD_GLOBAL             22 (_global_forward_hooks)
             938 POP_JUMP_FORWARD_IF_TRUE     7 (to 954)
             940 LOAD_FAST                0 (self)
             942 LOAD_ATTR                7 (_forward_hooks)
             952 POP_JUMP_FORWARD_IF_FALSE   139 (to 1232)

1563     >>  954 BUILD_LIST               0

1564         956 LOAD_GLOBAL             22 (_global_forward_hooks)
             968 LOAD_METHOD             16 (items)
             990 PRECALL                  0
             994 CALL                     0

1563        1004 LIST_EXTEND              1

1565        1006 LOAD_FAST                0 (self)
            1008 LOAD_ATTR                7 (_forward_hooks)
            1018 LOAD_METHOD             16 (items)
            1040 PRECALL                  0
            1044 CALL                     0

1563        1054 LIST_EXTEND              1
            1056 LIST_TO_TUPLE
            1058 GET_ITER
         >> 1060 FOR_ITER                85 (to 1232)
            1062 UNPACK_SEQUENCE          2
            1066 STORE_FAST               9 (hook_id)
            1068 STORE_FAST              10 (hook)

1568        1070 LOAD_FAST                9 (hook_id)
            1072 LOAD_FAST                0 (self)
            1074 LOAD_ATTR               25 (_forward_hooks_always_called)
            1084 CONTAINS_OP              0
            1086 POP_JUMP_FORWARD_IF_TRUE     9 (to 1106)
            1088 LOAD_FAST                9 (hook_id)
            1090 LOAD_GLOBAL             52 (_global_forward_hooks_always_called)
            1102 CONTAINS_OP              0
            1104 POP_JUMP_FORWARD_IF_FALSE    21 (to 1148)

1569     >> 1106 LOAD_FAST                5 (called_always_called_hooks)
            1108 LOAD_METHOD             27 (add)
            1130 LOAD_FAST                9 (hook_id)
            1132 PRECALL                  1
            1136 CALL                     1
            1146 POP_TOP

1571     >> 1148 LOAD_FAST                9 (hook_id)
            1150 LOAD_FAST                0 (self)
            1152 LOAD_ATTR               28 (_forward_hooks_with_kwargs)
            1162 CONTAINS_OP              0
            1164 POP_JUMP_FORWARD_IF_FALSE    15 (to 1196)

1572        1166 PUSH_NULL
            1168 LOAD_FAST               10 (hook)
            1170 LOAD_FAST                0 (self)
            1172 LOAD_FAST                1 (args)
            1174 LOAD_FAST                2 (kwargs)
            1176 LOAD_FAST                4 (result)
            1178 PRECALL                  4
            1182 CALL                     4
            1192 STORE_FAST              14 (hook_result)
            1194 JUMP_FORWARD            13 (to 1222)

1574     >> 1196 PUSH_NULL
            1198 LOAD_FAST               10 (hook)
            1200 LOAD_FAST                0 (self)
            1202 LOAD_FAST                1 (args)
            1204 LOAD_FAST                4 (result)
            1206 PRECALL                  3
            1210 CALL                     3
            1220 STORE_FAST              14 (hook_result)

1576     >> 1222 LOAD_FAST               14 (hook_result)
            1224 POP_JUMP_FORWARD_IF_NONE     2 (to 1230)

1577        1226 LOAD_FAST               14 (hook_result)
            1228 STORE_FAST               4 (result)
         >> 1230 JUMP_BACKWARD           86 (to 1060)

1579     >> 1232 LOAD_FAST               13 (bw_hook)
            1234 POP_JUMP_FORWARD_IF_FALSE    90 (to 1416)

1580        1236 LOAD_GLOBAL             37 (NULL + isinstance)
            1248 LOAD_FAST                4 (result)
            1250 LOAD_GLOBAL              0 (torch)
            1262 LOAD_ATTR               29 (Tensor)
            1272 LOAD_GLOBAL             38 (tuple)
            1284 BUILD_TUPLE              2
            1286 PRECALL                  2
            1290 CALL                     2
            1300 POP_JUMP_FORWARD_IF_TRUE    36 (to 1374)

1581        1302 LOAD_GLOBAL             61 (NULL + warnings)
            1314 LOAD_ATTR               31 (warn)
            1324 LOAD_CONST               4 ('For backward hooks to be called, module output should be a Tensor or a tuple of Tensors but received ')

1583        1326 LOAD_GLOBAL             65 (NULL + type)
            1338 LOAD_FAST                4 (result)
            1340 PRECALL                  1
            1344 CALL                     1

1581        1354 FORMAT_VALUE             0
            1356 BUILD_STRING             2
            1358 PRECALL                  1
            1362 CALL                     1
            1372 POP_TOP

1584     >> 1374 LOAD_FAST               13 (bw_hook)
            1376 LOAD_METHOD             33 (setup_output_hook)
            1398 LOAD_FAST                4 (result)
            1400 PRECALL                  1
            1404 CALL                     1
            1414 STORE_FAST               4 (result)

1587     >> 1416 LOAD_FAST                7 (non_full_backward_hooks)
            1418 POP_JUMP_FORWARD_IF_FALSE   199 (to 1818)

1588        1420 LOAD_FAST                4 (result)
            1422 STORE_FAST              15 (var)

1589        1424 LOAD_GLOBAL             37 (NULL + isinstance)
            1436 LOAD_FAST               15 (var)
            1438 LOAD_GLOBAL              0 (torch)
            1450 LOAD_ATTR               29 (Tensor)
            1460 PRECALL                  2
            1464 CALL                     2
            1474 POP_JUMP_FORWARD_IF_TRUE    99 (to 1674)

1590     >> 1476 LOAD_GLOBAL             37 (NULL + isinstance)
            1488 LOAD_FAST               15 (var)
            1490 LOAD_GLOBAL             68 (dict)
            1502 PRECALL                  2
            1506 CALL                     2
            1516 POP_JUMP_FORWARD_IF_FALSE    44 (to 1606)

1591        1518 LOAD_GLOBAL             71 (NULL + next)
            1530 LOAD_CONST               5 (<code object <genexpr> at 0x7facf67909c0, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1591>)
            1532 MAKE_FUNCTION            0
            1534 LOAD_FAST               15 (var)
            1536 LOAD_METHOD             36 (values)
            1558 PRECALL                  0
            1562 CALL                     0
            1572 GET_ITER
            1574 PRECALL                  0
            1578 CALL                     0
            1588 PRECALL                  1
            1592 CALL                     1
            1602 STORE_FAST              15 (var)
            1604 JUMP_FORWARD             8 (to 1622)

1593     >> 1606 LOAD_FAST               15 (var)
            1608 LOAD_CONST               6 (0)
            1610 BINARY_SUBSCR
            1620 STORE_FAST              15 (var)

1589     >> 1622 LOAD_GLOBAL             37 (NULL + isinstance)
            1634 LOAD_FAST               15 (var)
            1636 LOAD_GLOBAL              0 (torch)
            1648 LOAD_ATTR               29 (Tensor)
            1658 PRECALL                  2
            1662 CALL                     2
            1672 POP_JUMP_BACKWARD_IF_FALSE    99 (to 1476)

1594     >> 1674 LOAD_FAST               15 (var)
            1676 LOAD_ATTR               37 (grad_fn)
            1686 STORE_FAST              16 (grad_fn)

1595        1688 LOAD_FAST               16 (grad_fn)
            1690 POP_JUMP_FORWARD_IF_NONE    63 (to 1818)

1596        1692 LOAD_FAST                7 (non_full_backward_hooks)
            1694 GET_ITER
         >> 1696 FOR_ITER                37 (to 1772)
            1698 STORE_FAST              10 (hook)

1597        1700 LOAD_FAST               16 (grad_fn)
            1702 LOAD_METHOD             38 (register_hook)
            1724 LOAD_GLOBAL             79 (NULL + _WrappedHook)
            1736 LOAD_FAST               10 (hook)
            1738 LOAD_FAST                0 (self)
            1740 PRECALL                  2
            1744 CALL                     2
            1754 PRECALL                  1
            1758 CALL                     1
            1768 POP_TOP
            1770 JUMP_BACKWARD           38 (to 1696)

1598     >> 1772 LOAD_FAST                0 (self)
            1774 LOAD_METHOD             40 (_maybe_warn_non_full_backward_hook)
            1796 LOAD_FAST                1 (args)
            1798 LOAD_FAST                4 (result)
            1800 LOAD_FAST               16 (grad_fn)
            1802 PRECALL                  3
            1806 CALL                     3
            1816 POP_TOP

1600     >> 1818 LOAD_FAST                4 (result)
            1820 RETURN_VALUE
         >> 1822 PUSH_EXC_INFO

1602        1824 LOAD_GLOBAL             82 (Exception)
            1836 CHECK_EXC_MATCH
            1838 EXTENDED_ARG             1
            1840 POP_JUMP_FORWARD_IF_FALSE   270 (to 2382)
            1842 POP_TOP

1606        1844 LOAD_GLOBAL             22 (_global_forward_hooks)
            1856 LOAD_METHOD             16 (items)
            1878 PRECALL                  0
            1882 CALL                     0
            1892 GET_ITER
         >> 1894 FOR_ITER                96 (to 2088)
            1896 UNPACK_SEQUENCE          2
            1900 STORE_FAST               9 (hook_id)
            1902 STORE_FAST              10 (hook)

1607        1904 LOAD_FAST                9 (hook_id)
            1906 LOAD_GLOBAL             52 (_global_forward_hooks_always_called)
            1918 CONTAINS_OP              0
            1920 POP_JUMP_FORWARD_IF_FALSE    82 (to 2086)
            1922 LOAD_FAST                9 (hook_id)
            1924 LOAD_FAST                5 (called_always_called_hooks)
            1926 CONTAINS_OP              1
            1928 POP_JUMP_FORWARD_IF_FALSE    78 (to 2086)

1608        1930 NOP

1609        1932 PUSH_NULL
            1934 LOAD_FAST               10 (hook)
            1936 LOAD_FAST                0 (self)
            1938 LOAD_FAST                1 (args)
            1940 LOAD_FAST                4 (result)
            1942 PRECALL                  3
            1946 CALL                     3
            1956 STORE_FAST              14 (hook_result)

1610        1958 LOAD_FAST               14 (hook_result)
            1960 POP_JUMP_FORWARD_IF_NONE     2 (to 1966)

1611        1962 LOAD_FAST               14 (hook_result)
            1964 STORE_FAST               4 (result)
         >> 1966 JUMP_BACKWARD           37 (to 1894)
         >> 1968 PUSH_EXC_INFO

1612        1970 LOAD_GLOBAL             82 (Exception)
            1982 CHECK_EXC_MATCH
            1984 POP_JUMP_FORWARD_IF_FALSE    46 (to 2078)
            1986 STORE_FAST              17 (e)

1613        1988 LOAD_GLOBAL             61 (NULL + warnings)
            2000 LOAD_ATTR               31 (warn)
            2010 LOAD_CONST               7 ('global module forward hook with ``always_call=True`` raised an exception that was silenced as another error was raised in forward: ')

1614        2012 LOAD_GLOBAL             85 (NULL + str)
            2024 LOAD_FAST               17 (e)
            2026 PRECALL                  1
            2030 CALL                     1

1613        2040 FORMAT_VALUE             0
            2042 BUILD_STRING             2
            2044 PRECALL                  1
            2048 CALL                     1
            2058 POP_TOP

1615        2060 POP_EXCEPT
            2062 LOAD_CONST               0 (None)
            2064 STORE_FAST              17 (e)
            2066 DELETE_FAST             17 (e)
            2068 JUMP_BACKWARD           88 (to 1894)
         >> 2070 LOAD_CONST               0 (None)
            2072 STORE_FAST              17 (e)
            2074 DELETE_FAST             17 (e)
            2076 RERAISE                  1

1612     >> 2078 RERAISE                  0
         >> 2080 COPY                     3
            2082 POP_EXCEPT
            2084 RERAISE                  1
         >> 2086 JUMP_BACKWARD           97 (to 1894)

1617     >> 2088 LOAD_FAST                0 (self)
            2090 LOAD_ATTR                7 (_forward_hooks)
            2100 LOAD_METHOD             16 (items)
            2122 PRECALL                  0
            2126 CALL                     0
            2136 GET_ITER
         >> 2138 FOR_ITER               120 (to 2380)
            2140 UNPACK_SEQUENCE          2
            2144 STORE_FAST               9 (hook_id)
            2146 STORE_FAST              10 (hook)

1618        2148 LOAD_FAST                9 (hook_id)
            2150 LOAD_FAST                0 (self)
            2152 LOAD_ATTR               25 (_forward_hooks_always_called)
            2162 CONTAINS_OP              0
            2164 POP_JUMP_FORWARD_IF_FALSE   106 (to 2378)
            2166 LOAD_FAST                9 (hook_id)
            2168 LOAD_FAST                5 (called_always_called_hooks)
            2170 CONTAINS_OP              1
            2172 POP_JUMP_FORWARD_IF_FALSE   102 (to 2378)

1619        2174 NOP

1620        2176 LOAD_FAST                9 (hook_id)
            2178 LOAD_FAST                0 (self)
            2180 LOAD_ATTR               28 (_forward_hooks_with_kwargs)
            2190 CONTAINS_OP              0
            2192 POP_JUMP_FORWARD_IF_FALSE    15 (to 2224)

1621        2194 PUSH_NULL
            2196 LOAD_FAST               10 (hook)
            2198 LOAD_FAST                0 (self)
            2200 LOAD_FAST                1 (args)
            2202 LOAD_FAST                2 (kwargs)
            2204 LOAD_FAST                4 (result)
            2206 PRECALL                  4
            2210 CALL                     4
            2220 STORE_FAST              14 (hook_result)
            2222 JUMP_FORWARD            13 (to 2250)

1623     >> 2224 PUSH_NULL
            2226 LOAD_FAST               10 (hook)
            2228 LOAD_FAST                0 (self)
            2230 LOAD_FAST                1 (args)
            2232 LOAD_FAST                4 (result)
            2234 PRECALL                  3
            2238 CALL                     3
            2248 STORE_FAST              14 (hook_result)

1624     >> 2250 LOAD_FAST               14 (hook_result)
            2252 POP_JUMP_FORWARD_IF_NONE     2 (to 2258)

1625        2254 LOAD_FAST               14 (hook_result)
            2256 STORE_FAST               4 (result)
         >> 2258 JUMP_BACKWARD           61 (to 2138)
         >> 2260 PUSH_EXC_INFO

1626        2262 LOAD_GLOBAL             82 (Exception)
            2274 CHECK_EXC_MATCH
            2276 POP_JUMP_FORWARD_IF_FALSE    46 (to 2370)
            2278 STORE_FAST              17 (e)

1627        2280 LOAD_GLOBAL             61 (NULL + warnings)
            2292 LOAD_ATTR               31 (warn)
            2302 LOAD_CONST               8 ('module forward hook with ``always_call=True`` raised an exception that was silenced as another error was raised in forward: ')

1628        2304 LOAD_GLOBAL             85 (NULL + str)
            2316 LOAD_FAST               17 (e)
            2318 PRECALL                  1
            2322 CALL                     1

1627        2332 FORMAT_VALUE             0
            2334 BUILD_STRING             2
            2336 PRECALL                  1
            2340 CALL                     1
            2350 POP_TOP

1629        2352 POP_EXCEPT
            2354 LOAD_CONST               0 (None)
            2356 STORE_FAST              17 (e)
            2358 DELETE_FAST             17 (e)
            2360 JUMP_BACKWARD          112 (to 2138)
         >> 2362 LOAD_CONST               0 (None)
            2364 STORE_FAST              17 (e)
            2366 DELETE_FAST             17 (e)
            2368 RERAISE                  1

1626     >> 2370 RERAISE                  0
         >> 2372 COPY                     3
            2374 POP_EXCEPT
            2376 RERAISE                  1
         >> 2378 JUMP_BACKWARD          121 (to 2138)

1631     >> 2380 RAISE_VARARGS            0

1602     >> 2382 RERAISE                  0
         >> 2384 COPY                     3
            2386 POP_EXCEPT
            2388 RERAISE                  1
ExceptionTable:
  220 to 1818 -> 1822 [0]
  1822 to 1928 -> 2384 [1] lasti
  1932 to 1964 -> 1968 [2]
  1966 to 1966 -> 2384 [1] lasti
  1968 to 1986 -> 2080 [3] lasti
  1988 to 2058 -> 2070 [3] lasti
  2060 to 2068 -> 2384 [1] lasti
  2070 to 2078 -> 2080 [3] lasti
  2080 to 2172 -> 2384 [1] lasti
  2176 to 2256 -> 2260 [2]
  2258 to 2258 -> 2384 [1] lasti
  2260 to 2278 -> 2372 [3] lasti
  2280 to 2350 -> 2362 [3] lasti
  2352 to 2360 -> 2384 [1] lasti
  2362 to 2370 -> 2372 [3] lasti
  2372 to 2382 -> 2384 [1] lasti
, inlined according skipfiles.MOD_INLINELIST
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1513 in _call_impl (Module._call_impl) (inline depth: 1)
        def _call_impl(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1514 in _call_impl (Module._call_impl) (inline depth: 1)
            forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR _C [TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_METHOD _get_tracing_state [TorchVariable(<module 'torch._C' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/_C.cpython-311-x86_64-linux-gnu.so'>)]
TRACE PRECALL 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method _get_tracing_state of PyCapsule object at 0x7fad61054bd0>)]
TRACE CALL 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method _get_tracing_state of PyCapsule object at 0x7fad61054bd0>)]
TRACE POP_JUMP_FORWARD_IF_FALSE 76 [ConstantVariable(NoneType)]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR forward [NNModuleVariable()]
TRACE STORE_FAST forward_call [UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable())]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _backward_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _backward_pre_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _forward_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _forward_pre_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1518 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_backward_pre_hooks or _global_backward_hooks
TRACE LOAD_GLOBAL _global_backward_pre_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1518 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_backward_pre_hooks or _global_backward_hooks
TRACE LOAD_GLOBAL _global_backward_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1519 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_forward_hooks or _global_forward_pre_hooks):
TRACE LOAD_GLOBAL _global_forward_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1519 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_forward_hooks or _global_forward_pre_hooks):
TRACE LOAD_GLOBAL _global_forward_pre_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1520 in _call_impl (Module._call_impl) (inline depth: 1)
                return forward_call(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST forward_call [NullVariable]
TRACE LOAD_FAST args [NullVariable, UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable())]
TRACE BUILD_MAP 0 [NullVariable, UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable()), TupleVariable()]
TRACE LOAD_FAST kwargs [NullVariable, UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable()), TupleVariable(), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable()), TupleVariable(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable()), TupleVariable(), ConstDictVariable()]
TRACE inlined call forward from /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1520 in _call_impl (Module._call_impl) (inline depth: 1)
            return forward_call(*args, **kwargs)
                   ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object forward at 0x7facb06ca420, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 56>
 56           0 RESUME                   0

 57           2 LOAD_GLOBAL              1 (NULL + F)
             14 LOAD_ATTR                1 (relu)
             24 LOAD_FAST                0 (self)
             26 LOAD_METHOD              2 (layer1)
             48 LOAD_FAST                1 (embeddings)
             50 PRECALL                  1
             54 CALL                     1
             64 PRECALL                  1
             68 CALL                     1
             78 STORE_FAST               2 (layer1_act)

 58          80 LOAD_GLOBAL              1 (NULL + F)
             92 LOAD_ATTR                3 (softmax)
            102 LOAD_FAST                0 (self)
            104 LOAD_METHOD              4 (layer2)
            126 LOAD_FAST                2 (layer1_act)
            128 PRECALL                  1
            132 CALL                     1
            142 LOAD_CONST               1 (0)
            144 KW_NAMES                 2
            146 PRECALL                  2
            150 CALL                     2
            160 STORE_FAST               3 (attention)

 59         162 LOAD_GLOBAL             11 (NULL + torch)
            174 LOAD_ATTR                6 (sum)
            184 LOAD_FAST                3 (attention)
            186 LOAD_FAST                1 (embeddings)
            188 BINARY_OP                5 (*)
            192 LOAD_CONST               1 (0)
            194 KW_NAMES                 2
            196 PRECALL                  2
            200 CALL                     2
            210 STORE_FAST               4 (embedding)

 61         212 LOAD_FAST                4 (embedding)
            214 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:56 in forward (CenterIntersection.forward) (inline depth: 2)
        def forward(self, embeddings):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:57 in forward (CenterIntersection.forward) (inline depth: 2)
            layer1_act = F.relu(self.layer1(embeddings)) # (num_conj, dim)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_METHOD layer1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NNModuleVariable()]
TRACE LOAD_FAST embeddings [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable()]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE FX call l__self___center_net_layer1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:57 in forward (CenterIntersection.forward) (inline depth: 2)
        layer1_act = F.relu(self.layer1(embeddings)) # (num_conj, dim)
                            ~~~~~~~~~~~^^^^^^^^^^^^
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:57 in forward (CenterIntersection.forward) (inline depth: 2)
        layer1_act = F.relu(self.layer1(embeddings)) # (num_conj, dim)
                     ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST layer1_act [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:58 in forward (CenterIntersection.forward) (inline depth: 2)
            attention = F.softmax(self.layer2(layer1_act), dim=0) # (num_conj, dim)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR softmax [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>)]
TRACE LOAD_METHOD layer2 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), NNModuleVariable()]
TRACE LOAD_FAST layer1_act [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), NullVariable, NNModuleVariable()]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE FX call l__self___center_net_layer2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:58 in forward (CenterIntersection.forward) (inline depth: 2)
        attention = F.softmax(self.layer2(layer1_act), dim=0) # (num_conj, dim)
                              ~~~~~~~~~~~^^^^^^^^^^^^
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), TensorVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), TensorVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), TensorVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), TensorVariable(), ConstantVariable(int)]
TRACE FX call softmax from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:58 in forward (CenterIntersection.forward) (inline depth: 2)
        attention = F.softmax(self.layer2(layer1_act), dim=0) # (num_conj, dim)
                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST attention [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:59 in forward (CenterIntersection.forward) (inline depth: 2)
            embedding = torch.sum(attention * embeddings, dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR sum [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST attention [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable()]
TRACE BINARY_OP 5 [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:59 in forward (CenterIntersection.forward) (inline depth: 2)
        embedding = torch.sum(attention * embeddings, dim=0)
                              ~~~~~~~~~~^~~~~~~~~~~~
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE FX call sum_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:59 in forward (CenterIntersection.forward) (inline depth: 2)
        embedding = torch.sum(attention * embeddings, dim=0)
                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:61 in forward (CenterIntersection.forward) (inline depth: 2)
            return embedding
TRACE LOAD_FAST embedding []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward at 0x7facb06ca420, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 56>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object _call_impl at 0x60bf410, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1513>
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:239 in embed_query_box (KGReasoning.embed_query_box)
                offset_embedding = self.offset_net(torch.stack(offset_embedding_list))
TRACE LOAD_FAST self []
TRACE LOAD_METHOD offset_net [NNModuleVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, NNModuleVariable()]
TRACE LOAD_ATTR stack [NullVariable, NNModuleVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST offset_embedding_list [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>), ListVariable()]
TRACE CALL 1 [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>), ListVariable()]
TRACE FX call stack_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:239 in embed_query_box (KGReasoning.embed_query_box)
            offset_embedding = self.offset_net(torch.stack(offset_embedding_list))
                                               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE PRECALL 1 [NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, NNModuleVariable(), TensorVariable()]
TRACE inlined call _call_impl from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:239 in embed_query_box (KGReasoning.embed_query_box)
            offset_embedding = self.offset_net(torch.stack(offset_embedding_list))
                               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object _call_impl at 0x60bf410, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1513>
1513           0 RESUME                   0

1514           2 LOAD_GLOBAL              0 (torch)
              14 LOAD_ATTR                1 (_C)
              24 LOAD_METHOD              2 (_get_tracing_state)
              46 PRECALL                  0
              50 CALL                     0
              60 POP_JUMP_FORWARD_IF_FALSE     7 (to 76)
              62 LOAD_FAST                0 (self)
              64 LOAD_ATTR                3 (_slow_forward)
              74 JUMP_FORWARD             6 (to 88)
         >>   76 LOAD_FAST                0 (self)
              78 LOAD_ATTR                4 (forward)
         >>   88 STORE_FAST               3 (forward_call)

1517          90 LOAD_FAST                0 (self)
              92 LOAD_ATTR                5 (_backward_hooks)
             102 POP_JUMP_FORWARD_IF_TRUE    57 (to 218)
             104 LOAD_FAST                0 (self)
             106 LOAD_ATTR                6 (_backward_pre_hooks)
             116 POP_JUMP_FORWARD_IF_TRUE    50 (to 218)
             118 LOAD_FAST                0 (self)
             120 LOAD_ATTR                7 (_forward_hooks)
             130 POP_JUMP_FORWARD_IF_TRUE    43 (to 218)
             132 LOAD_FAST                0 (self)
             134 LOAD_ATTR                8 (_forward_pre_hooks)
             144 POP_JUMP_FORWARD_IF_TRUE    36 (to 218)

1518         146 LOAD_GLOBAL             18 (_global_backward_pre_hooks)

1517         158 POP_JUMP_FORWARD_IF_TRUE    29 (to 218)

1518         160 LOAD_GLOBAL             20 (_global_backward_hooks)

1517         172 POP_JUMP_FORWARD_IF_TRUE    22 (to 218)

1519         174 LOAD_GLOBAL             22 (_global_forward_hooks)

1517         186 POP_JUMP_FORWARD_IF_TRUE    15 (to 218)

1519         188 LOAD_GLOBAL             24 (_global_forward_pre_hooks)

1517         200 POP_JUMP_FORWARD_IF_TRUE     8 (to 218)

1520         202 PUSH_NULL
             204 LOAD_FAST                3 (forward_call)
             206 LOAD_FAST                1 (args)
             208 BUILD_MAP                0
             210 LOAD_FAST                2 (kwargs)
             212 DICT_MERGE               1
             214 CALL_FUNCTION_EX         1
             216 RETURN_VALUE

1522     >>  218 NOP

1523         220 LOAD_CONST               0 (None)
             222 STORE_FAST               4 (result)

1524         224 LOAD_GLOBAL             27 (NULL + set)
             236 PRECALL                  0
             240 CALL                     0
             250 STORE_FAST               5 (called_always_called_hooks)

1526         252 BUILD_LIST               0
             254 BUILD_LIST               0
             256 STORE_FAST               7 (non_full_backward_hooks)
             258 STORE_FAST               6 (full_backward_hooks)

1527         260 BUILD_LIST               0
             262 STORE_FAST               8 (backward_pre_hooks)

1528         264 LOAD_FAST                0 (self)
             266 LOAD_ATTR                6 (_backward_pre_hooks)
             276 POP_JUMP_FORWARD_IF_TRUE     7 (to 292)
             278 LOAD_GLOBAL             18 (_global_backward_pre_hooks)
             290 POP_JUMP_FORWARD_IF_FALSE    20 (to 332)

1529     >>  292 LOAD_FAST                0 (self)
             294 LOAD_METHOD             14 (_get_backward_pre_hooks)
             316 PRECALL                  0
             320 CALL                     0
             330 STORE_FAST               8 (backward_pre_hooks)

1531     >>  332 LOAD_FAST                0 (self)
             334 LOAD_ATTR                5 (_backward_hooks)
             344 POP_JUMP_FORWARD_IF_TRUE     7 (to 360)
             346 LOAD_GLOBAL             20 (_global_backward_hooks)
             358 POP_JUMP_FORWARD_IF_FALSE    23 (to 406)

1532     >>  360 LOAD_FAST                0 (self)
             362 LOAD_METHOD             15 (_get_backward_hooks)
             384 PRECALL                  0
             388 CALL                     0
             398 UNPACK_SEQUENCE          2
             402 STORE_FAST               6 (full_backward_hooks)
             404 STORE_FAST               7 (non_full_backward_hooks)

1534     >>  406 LOAD_GLOBAL             24 (_global_forward_pre_hooks)
             418 POP_JUMP_FORWARD_IF_TRUE     7 (to 434)
             420 LOAD_FAST                0 (self)
             422 LOAD_ATTR                8 (_forward_pre_hooks)
             432 POP_JUMP_FORWARD_IF_FALSE   189 (to 812)

1535     >>  434 BUILD_LIST               0

1536         436 LOAD_GLOBAL             24 (_global_forward_pre_hooks)
             448 LOAD_METHOD             16 (items)
             470 PRECALL                  0
             474 CALL                     0

1535         484 LIST_EXTEND              1

1537         486 LOAD_FAST                0 (self)
             488 LOAD_ATTR                8 (_forward_pre_hooks)
             498 LOAD_METHOD             16 (items)
             520 PRECALL                  0
             524 CALL                     0

1535         534 LIST_EXTEND              1
             536 LIST_TO_TUPLE
             538 GET_ITER
         >>  540 FOR_ITER               135 (to 812)
             542 UNPACK_SEQUENCE          2
             546 STORE_FAST               9 (hook_id)
             548 STORE_FAST              10 (hook)

1539         550 LOAD_FAST                9 (hook_id)
             552 LOAD_FAST                0 (self)
             554 LOAD_ATTR               17 (_forward_pre_hooks_with_kwargs)
             564 CONTAINS_OP              0
             566 POP_JUMP_FORWARD_IF_FALSE    81 (to 730)

1540         568 PUSH_NULL
             570 LOAD_FAST               10 (hook)
             572 LOAD_FAST                0 (self)
             574 LOAD_FAST                1 (args)
             576 LOAD_FAST                2 (kwargs)
             578 PRECALL                  3
             582 CALL                     3
             592 STORE_FAST              11 (args_kwargs_result)

1541         594 LOAD_FAST               11 (args_kwargs_result)
             596 POP_JUMP_FORWARD_IF_NONE    65 (to 728)

1542         598 LOAD_GLOBAL             37 (NULL + isinstance)
             610 LOAD_FAST               11 (args_kwargs_result)
             612 LOAD_GLOBAL             38 (tuple)
             624 PRECALL                  2
             628 CALL                     2
             638 POP_JUMP_FORWARD_IF_FALSE    25 (to 690)
             640 LOAD_GLOBAL             41 (NULL + len)
             652 LOAD_FAST               11 (args_kwargs_result)
             654 PRECALL                  1
             658 CALL                     1
             668 LOAD_CONST               1 (2)
             670 COMPARE_OP               2 (==)
             676 POP_JUMP_FORWARD_IF_FALSE     6 (to 690)

1543         678 LOAD_FAST               11 (args_kwargs_result)
             680 UNPACK_SEQUENCE          2
             684 STORE_FAST               1 (args)
             686 STORE_FAST               2 (kwargs)
             688 JUMP_BACKWARD           75 (to 540)

1545     >>  690 LOAD_GLOBAL             43 (NULL + RuntimeError)

1546         702 LOAD_CONST               2 ('forward pre-hook must return None or a tuple of (new_args, new_kwargs), but got ')

1547         704 LOAD_FAST               11 (args_kwargs_result)

1546         706 FORMAT_VALUE             0
             708 LOAD_CONST               3 ('.')
             710 BUILD_STRING             3

1545         712 PRECALL                  1
             716 CALL                     1
             726 RAISE_VARARGS            1

1541     >>  728 JUMP_BACKWARD           95 (to 540)

1550     >>  730 PUSH_NULL
             732 LOAD_FAST               10 (hook)
             734 LOAD_FAST                0 (self)
             736 LOAD_FAST                1 (args)
             738 PRECALL                  2
             742 CALL                     2
             752 STORE_FAST              12 (args_result)

1551         754 LOAD_FAST               12 (args_result)
             756 POP_JUMP_FORWARD_IF_NONE    26 (to 810)

1552         758 LOAD_GLOBAL             37 (NULL + isinstance)
             770 LOAD_FAST               12 (args_result)
             772 LOAD_GLOBAL             38 (tuple)
             784 PRECALL                  2
             788 CALL                     2
             798 POP_JUMP_FORWARD_IF_TRUE     3 (to 806)

1553         800 LOAD_FAST               12 (args_result)
             802 BUILD_TUPLE              1
             804 STORE_FAST              12 (args_result)

1554     >>  806 LOAD_FAST               12 (args_result)
             808 STORE_FAST               1 (args)
         >>  810 JUMP_BACKWARD          136 (to 540)

1556     >>  812 LOAD_CONST               0 (None)
             814 STORE_FAST              13 (bw_hook)

1557         816 LOAD_FAST                6 (full_backward_hooks)
             818 POP_JUMP_FORWARD_IF_TRUE     2 (to 824)
             820 LOAD_FAST                8 (backward_pre_hooks)
             822 POP_JUMP_FORWARD_IF_FALSE    43 (to 910)

1558     >>  824 LOAD_GLOBAL             45 (NULL + hooks)
             836 LOAD_ATTR               23 (BackwardHook)
             846 LOAD_FAST                0 (self)
             848 LOAD_FAST                6 (full_backward_hooks)
             850 LOAD_FAST                8 (backward_pre_hooks)
             852 PRECALL                  3
             856 CALL                     3
             866 STORE_FAST              13 (bw_hook)

1559         868 LOAD_FAST               13 (bw_hook)
             870 LOAD_METHOD             24 (setup_input_hook)
             892 LOAD_FAST                1 (args)
             894 PRECALL                  1
             898 CALL                     1
             908 STORE_FAST               1 (args)

1561     >>  910 PUSH_NULL
             912 LOAD_FAST                3 (forward_call)
             914 LOAD_FAST                1 (args)
             916 BUILD_MAP                0
             918 LOAD_FAST                2 (kwargs)
             920 DICT_MERGE               1
             922 CALL_FUNCTION_EX         1
             924 STORE_FAST               4 (result)

1562         926 LOAD_GLOBAL             22 (_global_forward_hooks)
             938 POP_JUMP_FORWARD_IF_TRUE     7 (to 954)
             940 LOAD_FAST                0 (self)
             942 LOAD_ATTR                7 (_forward_hooks)
             952 POP_JUMP_FORWARD_IF_FALSE   139 (to 1232)

1563     >>  954 BUILD_LIST               0

1564         956 LOAD_GLOBAL             22 (_global_forward_hooks)
             968 LOAD_METHOD             16 (items)
             990 PRECALL                  0
             994 CALL                     0

1563        1004 LIST_EXTEND              1

1565        1006 LOAD_FAST                0 (self)
            1008 LOAD_ATTR                7 (_forward_hooks)
            1018 LOAD_METHOD             16 (items)
            1040 PRECALL                  0
            1044 CALL                     0

1563        1054 LIST_EXTEND              1
            1056 LIST_TO_TUPLE
            1058 GET_ITER
         >> 1060 FOR_ITER                85 (to 1232)
            1062 UNPACK_SEQUENCE          2
            1066 STORE_FAST               9 (hook_id)
            1068 STORE_FAST              10 (hook)

1568        1070 LOAD_FAST                9 (hook_id)
            1072 LOAD_FAST                0 (self)
            1074 LOAD_ATTR               25 (_forward_hooks_always_called)
            1084 CONTAINS_OP              0
            1086 POP_JUMP_FORWARD_IF_TRUE     9 (to 1106)
            1088 LOAD_FAST                9 (hook_id)
            1090 LOAD_GLOBAL             52 (_global_forward_hooks_always_called)
            1102 CONTAINS_OP              0
            1104 POP_JUMP_FORWARD_IF_FALSE    21 (to 1148)

1569     >> 1106 LOAD_FAST                5 (called_always_called_hooks)
            1108 LOAD_METHOD             27 (add)
            1130 LOAD_FAST                9 (hook_id)
            1132 PRECALL                  1
            1136 CALL                     1
            1146 POP_TOP

1571     >> 1148 LOAD_FAST                9 (hook_id)
            1150 LOAD_FAST                0 (self)
            1152 LOAD_ATTR               28 (_forward_hooks_with_kwargs)
            1162 CONTAINS_OP              0
            1164 POP_JUMP_FORWARD_IF_FALSE    15 (to 1196)

1572        1166 PUSH_NULL
            1168 LOAD_FAST               10 (hook)
            1170 LOAD_FAST                0 (self)
            1172 LOAD_FAST                1 (args)
            1174 LOAD_FAST                2 (kwargs)
            1176 LOAD_FAST                4 (result)
            1178 PRECALL                  4
            1182 CALL                     4
            1192 STORE_FAST              14 (hook_result)
            1194 JUMP_FORWARD            13 (to 1222)

1574     >> 1196 PUSH_NULL
            1198 LOAD_FAST               10 (hook)
            1200 LOAD_FAST                0 (self)
            1202 LOAD_FAST                1 (args)
            1204 LOAD_FAST                4 (result)
            1206 PRECALL                  3
            1210 CALL                     3
            1220 STORE_FAST              14 (hook_result)

1576     >> 1222 LOAD_FAST               14 (hook_result)
            1224 POP_JUMP_FORWARD_IF_NONE     2 (to 1230)

1577        1226 LOAD_FAST               14 (hook_result)
            1228 STORE_FAST               4 (result)
         >> 1230 JUMP_BACKWARD           86 (to 1060)

1579     >> 1232 LOAD_FAST               13 (bw_hook)
            1234 POP_JUMP_FORWARD_IF_FALSE    90 (to 1416)

1580        1236 LOAD_GLOBAL             37 (NULL + isinstance)
            1248 LOAD_FAST                4 (result)
            1250 LOAD_GLOBAL              0 (torch)
            1262 LOAD_ATTR               29 (Tensor)
            1272 LOAD_GLOBAL             38 (tuple)
            1284 BUILD_TUPLE              2
            1286 PRECALL                  2
            1290 CALL                     2
            1300 POP_JUMP_FORWARD_IF_TRUE    36 (to 1374)

1581        1302 LOAD_GLOBAL             61 (NULL + warnings)
            1314 LOAD_ATTR               31 (warn)
            1324 LOAD_CONST               4 ('For backward hooks to be called, module output should be a Tensor or a tuple of Tensors but received ')

1583        1326 LOAD_GLOBAL             65 (NULL + type)
            1338 LOAD_FAST                4 (result)
            1340 PRECALL                  1
            1344 CALL                     1

1581        1354 FORMAT_VALUE             0
            1356 BUILD_STRING             2
            1358 PRECALL                  1
            1362 CALL                     1
            1372 POP_TOP

1584     >> 1374 LOAD_FAST               13 (bw_hook)
            1376 LOAD_METHOD             33 (setup_output_hook)
            1398 LOAD_FAST                4 (result)
            1400 PRECALL                  1
            1404 CALL                     1
            1414 STORE_FAST               4 (result)

1587     >> 1416 LOAD_FAST                7 (non_full_backward_hooks)
            1418 POP_JUMP_FORWARD_IF_FALSE   199 (to 1818)

1588        1420 LOAD_FAST                4 (result)
            1422 STORE_FAST              15 (var)

1589        1424 LOAD_GLOBAL             37 (NULL + isinstance)
            1436 LOAD_FAST               15 (var)
            1438 LOAD_GLOBAL              0 (torch)
            1450 LOAD_ATTR               29 (Tensor)
            1460 PRECALL                  2
            1464 CALL                     2
            1474 POP_JUMP_FORWARD_IF_TRUE    99 (to 1674)

1590     >> 1476 LOAD_GLOBAL             37 (NULL + isinstance)
            1488 LOAD_FAST               15 (var)
            1490 LOAD_GLOBAL             68 (dict)
            1502 PRECALL                  2
            1506 CALL                     2
            1516 POP_JUMP_FORWARD_IF_FALSE    44 (to 1606)

1591        1518 LOAD_GLOBAL             71 (NULL + next)
            1530 LOAD_CONST               5 (<code object <genexpr> at 0x7facf67909c0, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1591>)
            1532 MAKE_FUNCTION            0
            1534 LOAD_FAST               15 (var)
            1536 LOAD_METHOD             36 (values)
            1558 PRECALL                  0
            1562 CALL                     0
            1572 GET_ITER
            1574 PRECALL                  0
            1578 CALL                     0
            1588 PRECALL                  1
            1592 CALL                     1
            1602 STORE_FAST              15 (var)
            1604 JUMP_FORWARD             8 (to 1622)

1593     >> 1606 LOAD_FAST               15 (var)
            1608 LOAD_CONST               6 (0)
            1610 BINARY_SUBSCR
            1620 STORE_FAST              15 (var)

1589     >> 1622 LOAD_GLOBAL             37 (NULL + isinstance)
            1634 LOAD_FAST               15 (var)
            1636 LOAD_GLOBAL              0 (torch)
            1648 LOAD_ATTR               29 (Tensor)
            1658 PRECALL                  2
            1662 CALL                     2
            1672 POP_JUMP_BACKWARD_IF_FALSE    99 (to 1476)

1594     >> 1674 LOAD_FAST               15 (var)
            1676 LOAD_ATTR               37 (grad_fn)
            1686 STORE_FAST              16 (grad_fn)

1595        1688 LOAD_FAST               16 (grad_fn)
            1690 POP_JUMP_FORWARD_IF_NONE    63 (to 1818)

1596        1692 LOAD_FAST                7 (non_full_backward_hooks)
            1694 GET_ITER
         >> 1696 FOR_ITER                37 (to 1772)
            1698 STORE_FAST              10 (hook)

1597        1700 LOAD_FAST               16 (grad_fn)
            1702 LOAD_METHOD             38 (register_hook)
            1724 LOAD_GLOBAL             79 (NULL + _WrappedHook)
            1736 LOAD_FAST               10 (hook)
            1738 LOAD_FAST                0 (self)
            1740 PRECALL                  2
            1744 CALL                     2
            1754 PRECALL                  1
            1758 CALL                     1
            1768 POP_TOP
            1770 JUMP_BACKWARD           38 (to 1696)

1598     >> 1772 LOAD_FAST                0 (self)
            1774 LOAD_METHOD             40 (_maybe_warn_non_full_backward_hook)
            1796 LOAD_FAST                1 (args)
            1798 LOAD_FAST                4 (result)
            1800 LOAD_FAST               16 (grad_fn)
            1802 PRECALL                  3
            1806 CALL                     3
            1816 POP_TOP

1600     >> 1818 LOAD_FAST                4 (result)
            1820 RETURN_VALUE
         >> 1822 PUSH_EXC_INFO

1602        1824 LOAD_GLOBAL             82 (Exception)
            1836 CHECK_EXC_MATCH
            1838 EXTENDED_ARG             1
            1840 POP_JUMP_FORWARD_IF_FALSE   270 (to 2382)
            1842 POP_TOP

1606        1844 LOAD_GLOBAL             22 (_global_forward_hooks)
            1856 LOAD_METHOD             16 (items)
            1878 PRECALL                  0
            1882 CALL                     0
            1892 GET_ITER
         >> 1894 FOR_ITER                96 (to 2088)
            1896 UNPACK_SEQUENCE          2
            1900 STORE_FAST               9 (hook_id)
            1902 STORE_FAST              10 (hook)

1607        1904 LOAD_FAST                9 (hook_id)
            1906 LOAD_GLOBAL             52 (_global_forward_hooks_always_called)
            1918 CONTAINS_OP              0
            1920 POP_JUMP_FORWARD_IF_FALSE    82 (to 2086)
            1922 LOAD_FAST                9 (hook_id)
            1924 LOAD_FAST                5 (called_always_called_hooks)
            1926 CONTAINS_OP              1
            1928 POP_JUMP_FORWARD_IF_FALSE    78 (to 2086)

1608        1930 NOP

1609        1932 PUSH_NULL
            1934 LOAD_FAST               10 (hook)
            1936 LOAD_FAST                0 (self)
            1938 LOAD_FAST                1 (args)
            1940 LOAD_FAST                4 (result)
            1942 PRECALL                  3
            1946 CALL                     3
            1956 STORE_FAST              14 (hook_result)

1610        1958 LOAD_FAST               14 (hook_result)
            1960 POP_JUMP_FORWARD_IF_NONE     2 (to 1966)

1611        1962 LOAD_FAST               14 (hook_result)
            1964 STORE_FAST               4 (result)
         >> 1966 JUMP_BACKWARD           37 (to 1894)
         >> 1968 PUSH_EXC_INFO

1612        1970 LOAD_GLOBAL             82 (Exception)
            1982 CHECK_EXC_MATCH
            1984 POP_JUMP_FORWARD_IF_FALSE    46 (to 2078)
            1986 STORE_FAST              17 (e)

1613        1988 LOAD_GLOBAL             61 (NULL + warnings)
            2000 LOAD_ATTR               31 (warn)
            2010 LOAD_CONST               7 ('global module forward hook with ``always_call=True`` raised an exception that was silenced as another error was raised in forward: ')

1614        2012 LOAD_GLOBAL             85 (NULL + str)
            2024 LOAD_FAST               17 (e)
            2026 PRECALL                  1
            2030 CALL                     1

1613        2040 FORMAT_VALUE             0
            2042 BUILD_STRING             2
            2044 PRECALL                  1
            2048 CALL                     1
            2058 POP_TOP

1615        2060 POP_EXCEPT
            2062 LOAD_CONST               0 (None)
            2064 STORE_FAST              17 (e)
            2066 DELETE_FAST             17 (e)
            2068 JUMP_BACKWARD           88 (to 1894)
         >> 2070 LOAD_CONST               0 (None)
            2072 STORE_FAST              17 (e)
            2074 DELETE_FAST             17 (e)
            2076 RERAISE                  1

1612     >> 2078 RERAISE                  0
         >> 2080 COPY                     3
            2082 POP_EXCEPT
            2084 RERAISE                  1
         >> 2086 JUMP_BACKWARD           97 (to 1894)

1617     >> 2088 LOAD_FAST                0 (self)
            2090 LOAD_ATTR                7 (_forward_hooks)
            2100 LOAD_METHOD             16 (items)
            2122 PRECALL                  0
            2126 CALL                     0
            2136 GET_ITER
         >> 2138 FOR_ITER               120 (to 2380)
            2140 UNPACK_SEQUENCE          2
            2144 STORE_FAST               9 (hook_id)
            2146 STORE_FAST              10 (hook)

1618        2148 LOAD_FAST                9 (hook_id)
            2150 LOAD_FAST                0 (self)
            2152 LOAD_ATTR               25 (_forward_hooks_always_called)
            2162 CONTAINS_OP              0
            2164 POP_JUMP_FORWARD_IF_FALSE   106 (to 2378)
            2166 LOAD_FAST                9 (hook_id)
            2168 LOAD_FAST                5 (called_always_called_hooks)
            2170 CONTAINS_OP              1
            2172 POP_JUMP_FORWARD_IF_FALSE   102 (to 2378)

1619        2174 NOP

1620        2176 LOAD_FAST                9 (hook_id)
            2178 LOAD_FAST                0 (self)
            2180 LOAD_ATTR               28 (_forward_hooks_with_kwargs)
            2190 CONTAINS_OP              0
            2192 POP_JUMP_FORWARD_IF_FALSE    15 (to 2224)

1621        2194 PUSH_NULL
            2196 LOAD_FAST               10 (hook)
            2198 LOAD_FAST                0 (self)
            2200 LOAD_FAST                1 (args)
            2202 LOAD_FAST                2 (kwargs)
            2204 LOAD_FAST                4 (result)
            2206 PRECALL                  4
            2210 CALL                     4
            2220 STORE_FAST              14 (hook_result)
            2222 JUMP_FORWARD            13 (to 2250)

1623     >> 2224 PUSH_NULL
            2226 LOAD_FAST               10 (hook)
            2228 LOAD_FAST                0 (self)
            2230 LOAD_FAST                1 (args)
            2232 LOAD_FAST                4 (result)
            2234 PRECALL                  3
            2238 CALL                     3
            2248 STORE_FAST              14 (hook_result)

1624     >> 2250 LOAD_FAST               14 (hook_result)
            2252 POP_JUMP_FORWARD_IF_NONE     2 (to 2258)

1625        2254 LOAD_FAST               14 (hook_result)
            2256 STORE_FAST               4 (result)
         >> 2258 JUMP_BACKWARD           61 (to 2138)
         >> 2260 PUSH_EXC_INFO

1626        2262 LOAD_GLOBAL             82 (Exception)
            2274 CHECK_EXC_MATCH
            2276 POP_JUMP_FORWARD_IF_FALSE    46 (to 2370)
            2278 STORE_FAST              17 (e)

1627        2280 LOAD_GLOBAL             61 (NULL + warnings)
            2292 LOAD_ATTR               31 (warn)
            2302 LOAD_CONST               8 ('module forward hook with ``always_call=True`` raised an exception that was silenced as another error was raised in forward: ')

1628        2304 LOAD_GLOBAL             85 (NULL + str)
            2316 LOAD_FAST               17 (e)
            2318 PRECALL                  1
            2322 CALL                     1

1627        2332 FORMAT_VALUE             0
            2334 BUILD_STRING             2
            2336 PRECALL                  1
            2340 CALL                     1
            2350 POP_TOP

1629        2352 POP_EXCEPT
            2354 LOAD_CONST               0 (None)
            2356 STORE_FAST              17 (e)
            2358 DELETE_FAST             17 (e)
            2360 JUMP_BACKWARD          112 (to 2138)
         >> 2362 LOAD_CONST               0 (None)
            2364 STORE_FAST              17 (e)
            2366 DELETE_FAST             17 (e)
            2368 RERAISE                  1

1626     >> 2370 RERAISE                  0
         >> 2372 COPY                     3
            2374 POP_EXCEPT
            2376 RERAISE                  1
         >> 2378 JUMP_BACKWARD          121 (to 2138)

1631     >> 2380 RAISE_VARARGS            0

1602     >> 2382 RERAISE                  0
         >> 2384 COPY                     3
            2386 POP_EXCEPT
            2388 RERAISE                  1
ExceptionTable:
  220 to 1818 -> 1822 [0]
  1822 to 1928 -> 2384 [1] lasti
  1932 to 1964 -> 1968 [2]
  1966 to 1966 -> 2384 [1] lasti
  1968 to 1986 -> 2080 [3] lasti
  1988 to 2058 -> 2070 [3] lasti
  2060 to 2068 -> 2384 [1] lasti
  2070 to 2078 -> 2080 [3] lasti
  2080 to 2172 -> 2384 [1] lasti
  2176 to 2256 -> 2260 [2]
  2258 to 2258 -> 2384 [1] lasti
  2260 to 2278 -> 2372 [3] lasti
  2280 to 2350 -> 2362 [3] lasti
  2352 to 2360 -> 2384 [1] lasti
  2362 to 2370 -> 2372 [3] lasti
  2372 to 2382 -> 2384 [1] lasti
, inlined according skipfiles.MOD_INLINELIST
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1513 in _call_impl (Module._call_impl) (inline depth: 1)
        def _call_impl(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1514 in _call_impl (Module._call_impl) (inline depth: 1)
            forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR _C [TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_METHOD _get_tracing_state [TorchVariable(<module 'torch._C' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/_C.cpython-311-x86_64-linux-gnu.so'>)]
TRACE PRECALL 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method _get_tracing_state of PyCapsule object at 0x7fad61054bd0>)]
TRACE CALL 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method _get_tracing_state of PyCapsule object at 0x7fad61054bd0>)]
TRACE POP_JUMP_FORWARD_IF_FALSE 76 [ConstantVariable(NoneType)]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR forward [NNModuleVariable()]
TRACE STORE_FAST forward_call [UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable())]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _backward_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _backward_pre_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _forward_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _forward_pre_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1518 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_backward_pre_hooks or _global_backward_hooks
TRACE LOAD_GLOBAL _global_backward_pre_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1518 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_backward_pre_hooks or _global_backward_hooks
TRACE LOAD_GLOBAL _global_backward_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1519 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_forward_hooks or _global_forward_pre_hooks):
TRACE LOAD_GLOBAL _global_forward_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1519 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_forward_hooks or _global_forward_pre_hooks):
TRACE LOAD_GLOBAL _global_forward_pre_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1520 in _call_impl (Module._call_impl) (inline depth: 1)
                return forward_call(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST forward_call [NullVariable]
TRACE LOAD_FAST args [NullVariable, UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable())]
TRACE BUILD_MAP 0 [NullVariable, UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable()), TupleVariable()]
TRACE LOAD_FAST kwargs [NullVariable, UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable()), TupleVariable(), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable()), TupleVariable(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable()), TupleVariable(), ConstDictVariable()]
TRACE inlined call forward from /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1520 in _call_impl (Module._call_impl) (inline depth: 1)
            return forward_call(*args, **kwargs)
                   ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object forward at 0x7facb0a9d8b0, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 37>
 37           0 RESUME                   0

 38           2 LOAD_GLOBAL              1 (NULL + F)
             14 LOAD_ATTR                1 (relu)
             24 LOAD_FAST                0 (self)
             26 LOAD_METHOD              2 (layer1)
             48 LOAD_FAST                1 (embeddings)
             50 PRECALL                  1
             54 CALL                     1
             64 PRECALL                  1
             68 CALL                     1
             78 STORE_FAST               2 (layer1_act)

 39          80 LOAD_GLOBAL              7 (NULL + torch)
             92 LOAD_ATTR                4 (mean)
            102 LOAD_FAST                2 (layer1_act)
            104 LOAD_CONST               1 (0)
            106 KW_NAMES                 2
            108 PRECALL                  2
            112 CALL                     2
            122 STORE_FAST               3 (layer1_mean)

 40         124 LOAD_GLOBAL              7 (NULL + torch)
            136 LOAD_ATTR                5 (sigmoid)
            146 LOAD_FAST                0 (self)
            148 LOAD_METHOD              6 (layer2)
            170 LOAD_FAST                3 (layer1_mean)
            172 PRECALL                  1
            176 CALL                     1
            186 PRECALL                  1
            190 CALL                     1
            200 STORE_FAST               4 (gate)

 41         202 LOAD_GLOBAL              7 (NULL + torch)
            214 LOAD_ATTR                7 (min)
            224 LOAD_FAST                1 (embeddings)
            226 LOAD_CONST               1 (0)
            228 KW_NAMES                 2
            230 PRECALL                  2
            234 CALL                     2
            244 UNPACK_SEQUENCE          2
            248 STORE_FAST               5 (offset)
            250 STORE_FAST               6 (_)

 43         252 LOAD_FAST                5 (offset)
            254 LOAD_FAST                4 (gate)
            256 BINARY_OP                5 (*)
            260 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:37 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        def forward(self, embeddings):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:38 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
            layer1_act = F.relu(self.layer1(embeddings))
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_METHOD layer1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NNModuleVariable()]
TRACE LOAD_FAST embeddings [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable()]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE FX call l__self___offset_net_layer1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:38 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        layer1_act = F.relu(self.layer1(embeddings))
                            ~~~~~~~~~~~^^^^^^^^^^^^
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:38 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        layer1_act = F.relu(self.layer1(embeddings))
                     ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST layer1_act [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:39 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
            layer1_mean = torch.mean(layer1_act, dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR mean [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST layer1_act [NullVariable, TorchInGraphFunctionVariable(<built-in method mean of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method mean of type object at 0x7fad600718a0>), TensorVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method mean of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method mean of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method mean of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE FX call mean from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:39 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        layer1_mean = torch.mean(layer1_act, dim=0)
                      ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST layer1_mean [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:40 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
            gate = torch.sigmoid(self.layer2(layer1_mean))
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR sigmoid [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>)]
TRACE LOAD_METHOD layer2 [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_FAST layer1_mean [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), NullVariable, NNModuleVariable()]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE FX call l__self___offset_net_layer2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:40 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        gate = torch.sigmoid(self.layer2(layer1_mean))
                             ~~~~~~~~~~~^^^^^^^^^^^^^
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call sigmoid from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:40 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        gate = torch.sigmoid(self.layer2(layer1_mean))
               ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST gate [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:41 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
            offset, _ = torch.min(embeddings, dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:41 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        offset, _ = torch.min(embeddings, dim=0)
                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 2 [NamedTupleVariable()]
TRACE STORE_FAST offset [TensorVariable(), TensorVariable()]
TRACE STORE_FAST _ [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:43 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
            return offset * gate
TRACE LOAD_FAST offset []
TRACE LOAD_FAST gate [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:43 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        return offset * gate
               ~~~~~~~^~~~~~
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward at 0x7facb0a9d8b0, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 37>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object _call_impl at 0x60bf410, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1513>
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing embed_query_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 241 in embed_query_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_21 =====
 <eval_with_key>.381 class GraphModule(torch.nn.Module):
    def forward(self, s0 : torch.SymInt, L_queries_ : torch.Tensor):
        l_queries_ = L_queries_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_queries_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_queries_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_queries_[(slice(None, None, None), 1)]
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  embedding_2 = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        getitem_3 = l_queries_[(slice(None, None, None), 2)]
        embedding_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem_3);  getitem_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like_1 = torch.zeros_like(embedding_3)
        offset_embedding_3 = zeros_like_1.cuda();  zeros_like_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        getitem_4 = l_queries_[(slice(None, None, None), 3)]
        r_embedding_1 = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_4);  getitem_4 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        getitem_5 = l_queries_[(slice(None, None, None), 3)]
        r_offset_embedding_1 = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_5);  getitem_5 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding_3 += r_embedding_1;  embedding_5 = embedding_3;  embedding_3 = r_embedding_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding_3 += r_offset_embedding_1;  offset_embedding_5 = offset_embedding_3;  offset_embedding_3 = r_offset_embedding_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        getitem_6 = l_queries_[(slice(None, None, None), 4)]
        embedding_6 = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem_6);  l__self___entity_embedding = getitem_6 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like_2 = torch.zeros_like(embedding_6)
        offset_embedding_6 = zeros_like_2.cuda();  zeros_like_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        getitem_7 = l_queries_[(slice(None, None, None), 5)]
        r_embedding_2 = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_7);  l__self___relation_embedding = getitem_7 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        getitem_8 = l_queries_[(slice(None, None, None), 5)];  l_queries_ = None
        r_offset_embedding_2 = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_8);  l__self___offset_embedding = getitem_8 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding_6 += r_embedding_2;  embedding_8 = embedding_6;  embedding_6 = r_embedding_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding_6 += r_offset_embedding_2;  offset_embedding_8 = offset_embedding_6;  offset_embedding_6 = r_offset_embedding_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:238, code: embedding = self.center_net(torch.stack(embedding_list))
        stack = torch.stack([embedding_2, embedding_5, embedding_8]);  embedding_2 = embedding_5 = embedding_8 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:57, code: layer1_act = F.relu(self.layer1(embeddings)) # (num_conj, dim)
        l__self___center_net_layer1 = self.L__self___center_net_layer1(stack)
        layer1_act = torch.nn.functional.relu(l__self___center_net_layer1);  l__self___center_net_layer1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:58, code: attention = F.softmax(self.layer2(layer1_act), dim=0) # (num_conj, dim)
        l__self___center_net_layer2 = self.L__self___center_net_layer2(layer1_act);  layer1_act = None
        attention = torch.nn.functional.softmax(l__self___center_net_layer2, dim = 0);  l__self___center_net_layer2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:59, code: embedding = torch.sum(attention * embeddings, dim=0)
        mul = attention * stack;  attention = stack = None
        embedding_10 = torch.sum(mul, dim = 0);  mul = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:239, code: offset_embedding = self.offset_net(torch.stack(offset_embedding_list))
        stack_1 = torch.stack([offset_embedding_2, offset_embedding_5, offset_embedding_8]);  offset_embedding_2 = offset_embedding_5 = offset_embedding_8 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:38, code: layer1_act = F.relu(self.layer1(embeddings))
        l__self___offset_net_layer1 = self.L__self___offset_net_layer1(stack_1)
        layer1_act_1 = torch.nn.functional.relu(l__self___offset_net_layer1);  l__self___offset_net_layer1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:39, code: layer1_mean = torch.mean(layer1_act, dim=0)
        layer1_mean = torch.mean(layer1_act_1, dim = 0);  layer1_act_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:40, code: gate = torch.sigmoid(self.layer2(layer1_mean))
        l__self___offset_net_layer2 = self.L__self___offset_net_layer2(layer1_mean);  layer1_mean = None
        gate = torch.sigmoid(l__self___offset_net_layer2);  l__self___offset_net_layer2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:41, code: offset, _ = torch.min(embeddings, dim=0)
        min_1 = torch.min(stack_1, dim = 0);  stack_1 = None
        offset = min_1[0];  min_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:43, code: return offset * gate
        offset_embedding_9 = offset * gate;  offset = gate = None
        return (embedding_10, offset_embedding_9)
        

TRACED GRAPH
 __compiled_fn_21 <eval_with_key>.381 opcode         name                          target                                                           args                                                             kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ---------------------------------------------------------------  ------------------------------
placeholder    s0                            s0                                                               ()                                                               {}
placeholder    l_queries_                    L_queries_                                                       ()                                                               {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                                               {}
call_function  getitem                       <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 0))                       {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                                    {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                                     {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                                    {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                                               {}
call_function  getitem_1                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 1))                       {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)                                  {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                                               {}
call_function  getitem_2                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 1))                       {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                                    {'dim': 0, 'index': getitem_2}
call_function  embedding_2                   <built-in function iadd>                                         (embedding, r_embedding)                                         {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)                           {}
call_function  getitem_3                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 2))                       {}
call_function  embedding_3                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                                    {'dim': 0, 'index': getitem_3}
call_function  zeros_like_1                  <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding_3,)                                                   {}
call_method    offset_embedding_3            cuda                                                             (zeros_like_1,)                                                  {}
call_function  getitem_4                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 3))                       {}
call_function  r_embedding_1                 <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)                                  {'dim': 0, 'index': getitem_4}
call_function  getitem_5                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 3))                       {}
call_function  r_offset_embedding_1          <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                                    {'dim': 0, 'index': getitem_5}
call_function  embedding_5                   <built-in function iadd>                                         (embedding_3, r_embedding_1)                                     {}
call_function  offset_embedding_5            <built-in function iadd>                                         (offset_embedding_3, r_offset_embedding_1)                       {}
call_function  getitem_6                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 4))                       {}
call_function  embedding_6                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                                    {'dim': 0, 'index': getitem_6}
call_function  zeros_like_2                  <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding_6,)                                                   {}
call_method    offset_embedding_6            cuda                                                             (zeros_like_2,)                                                  {}
call_function  getitem_7                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 5))                       {}
call_function  r_embedding_2                 <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)                                  {'dim': 0, 'index': getitem_7}
call_function  getitem_8                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 5))                       {}
call_function  r_offset_embedding_2          <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                                    {'dim': 0, 'index': getitem_8}
call_function  embedding_8                   <built-in function iadd>                                         (embedding_6, r_embedding_2)                                     {}
call_function  offset_embedding_8            <built-in function iadd>                                         (offset_embedding_6, r_offset_embedding_2)                       {}
call_function  stack                         <built-in method stack of type object at 0x7fad600718a0>         ([embedding_2, embedding_5, embedding_8],)                       {}
call_module    l__self___center_net_layer1   L__self___center_net_layer1                                      (stack,)                                                         {}
call_function  layer1_act                    <function relu at 0x7facb1c64220>                                (l__self___center_net_layer1,)                                   {}
call_module    l__self___center_net_layer2   L__self___center_net_layer2                                      (layer1_act,)                                                    {}
call_function  attention                     <function softmax at 0x7facb1c64a40>                             (l__self___center_net_layer2,)                                   {'dim': 0}
call_function  mul                           <built-in function mul>                                          (attention, stack)                                               {}
call_function  embedding_10                  <built-in method sum of type object at 0x7fad600718a0>           (mul,)                                                           {'dim': 0}
call_function  stack_1                       <built-in method stack of type object at 0x7fad600718a0>         ([offset_embedding_2, offset_embedding_5, offset_embedding_8],)  {}
call_module    l__self___offset_net_layer1   L__self___offset_net_layer1                                      (stack_1,)                                                       {}
call_function  layer1_act_1                  <function relu at 0x7facb1c64220>                                (l__self___offset_net_layer1,)                                   {}
call_function  layer1_mean                   <built-in method mean of type object at 0x7fad600718a0>          (layer1_act_1,)                                                  {'dim': 0}
call_module    l__self___offset_net_layer2   L__self___offset_net_layer2                                      (layer1_mean,)                                                   {}
call_function  gate                          <built-in method sigmoid of type object at 0x7fad600718a0>       (l__self___offset_net_layer2,)                                   {}
call_function  min_1                         <built-in method min of type object at 0x7fad600718a0>           (stack_1,)                                                       {'dim': 0}
call_function  offset                        <built-in function getitem>                                      (min_1, 0)                                                       {}
call_function  offset_embedding_9            <built-in function mul>                                          (offset, gate)                                                   {}
output         output                        output                                                           ((embedding_10, offset_embedding_9),)                            {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_21 =====
l_queries_: (1, s0)
l_queries_ (concrete): (1, 6)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
embedding_2: (1, 400)
offset_embedding_2: (1, 400)
getitem_3: (1,)
embedding_3: (1, 400)
zeros_like_1: (1, 400)
offset_embedding_3: (1, 400)
getitem_4: (1,)
r_embedding_1: (1, 400)
getitem_5: (1,)
r_offset_embedding_1: (1, 400)
embedding_5: (1, 400)
offset_embedding_5: (1, 400)
getitem_6: (1,)
embedding_6: (1, 400)
zeros_like_2: (1, 400)
offset_embedding_6: (1, 400)
getitem_7: (1,)
r_embedding_2: (1, 400)
getitem_8: (1,)
r_offset_embedding_2: (1, 400)
embedding_8: (1, 400)
offset_embedding_8: (1, 400)
stack: (3, 1, 400)
l__self___center_net_layer1: (3, 1, 400)
layer1_act: (3, 1, 400)
l__self___center_net_layer2: (3, 1, 400)
attention: (3, 1, 400)
mul: (3, 1, 400)
embedding_10: (1, 400)
stack_1: (3, 1, 400)
l__self___offset_net_layer1: (3, 1, 400)
layer1_act_1: (3, 1, 400)
layer1_mean: (1, 400)
l__self___offset_net_layer2: (1, 400)
gate: (1, 400)
offset: (1, 400)
offset_embedding_9: (1, 400)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing embed_query_box /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [LazyVariableTracker()]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [TupleVariable()]
TRACE COMPARE_OP == [TupleVariable(), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:221 in embed_query_box (KGReasoning.embed_query_box)
                    embedding, offset_embedding, idx = self.embed_query_box(queries, query_structure[0], idx)
TRACE LOAD_FAST self []
TRACE LOAD_METHOD embed_query_box [LazyVariableTracker()]
TRACE LOAD_FAST queries [NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_CONST 0 [NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST idx [NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable(), LazyVariableTracker()]
TRACE CALL 3 [NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable(), LazyVariableTracker()]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:221 in embed_query_box (KGReasoning.embed_query_box)
                embedding, offset_embedding, idx = self.embed_query_box(queries, query_structure[0], idx)
                                                   ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:210 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    all_relation_flag = False
TRACE LOAD_CONST False [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1)]
TRACE STORE_FAST all_relation_flag [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:211 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    break
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1)]
TRACE JUMP_FORWARD 44 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:232 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding_list = []
TRACE BUILD_LIST 0 []
TRACE STORE_FAST embedding_list [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:233 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                offset_embedding_list = []
TRACE BUILD_LIST 0 []
TRACE STORE_FAST offset_embedding_list [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:234 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure)):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 930 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:235 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding, offset_embedding, idx = self.embed_query_box(queries, query_structure[i], idx)
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NNModuleVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable(), LazyVariableTracker()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable(), LazyVariableTracker()]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:235 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding, offset_embedding, idx = self.embed_query_box(queries, query_structure[i], idx)
                                                   ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), SliceVariable(), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), TupleVariable()]
create_graph_input L_queries_ L['queries']
wrap_to_fake L['queries'] (1, 5) [<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>] [None, RelaxedUnspecConstraint(warn_only=True)]
bind_symint s0 L['queries'].size()[1]
create_graph_input s0 L['queries'].size()[1]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable()]
TRACE BINARY_OP 13 [ConstantVariable(), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 3)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 3)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TupleVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:236 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding_list.append(embedding)
TRACE LOAD_FAST embedding_list [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ListVariable()]
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:237 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding_list.append(offset_embedding)
TRACE LOAD_FAST offset_embedding_list [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(NoneType)]
TRACE JUMP_BACKWARD 774 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:234 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure)):
TRACE FOR_ITER 930 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:235 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding, offset_embedding, idx = self.embed_query_box(queries, query_structure[i], idx)
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NNModuleVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:235 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding, offset_embedding, idx = self.embed_query_box(queries, query_structure[i], idx)
                                                   ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_4 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_4 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_5 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_5 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 3)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 3)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 2)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TupleVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:236 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding_list.append(embedding)
TRACE LOAD_FAST embedding_list [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_METHOD append [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ListVariable()]
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:237 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding_list.append(offset_embedding)
TRACE LOAD_FAST offset_embedding_list [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_METHOD append [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(NoneType)]
TRACE JUMP_BACKWARD 774 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:234 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure)):
TRACE FOR_ITER 930 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:238 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = self.center_net(torch.stack(embedding_list))
TRACE LOAD_FAST self []
TRACE LOAD_METHOD center_net [NNModuleVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, NNModuleVariable()]
TRACE LOAD_ATTR stack [NullVariable, NNModuleVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding_list [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>), ListVariable()]
TRACE CALL 1 [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>), ListVariable()]
TRACE FX call stack from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:238 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            embedding = self.center_net(torch.stack(embedding_list))
                                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^
TRACE PRECALL 1 [NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, NNModuleVariable(), TensorVariable()]
TRACE inlined call _call_impl from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:238 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            embedding = self.center_net(torch.stack(embedding_list))
                        ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object _call_impl at 0x60bf410, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1513>
1513           0 RESUME                   0

1514           2 LOAD_GLOBAL              0 (torch)
              14 LOAD_ATTR                1 (_C)
              24 LOAD_METHOD              2 (_get_tracing_state)
              46 PRECALL                  0
              50 CALL                     0
              60 POP_JUMP_FORWARD_IF_FALSE     7 (to 76)
              62 LOAD_FAST                0 (self)
              64 LOAD_ATTR                3 (_slow_forward)
              74 JUMP_FORWARD             6 (to 88)
         >>   76 LOAD_FAST                0 (self)
              78 LOAD_ATTR                4 (forward)
         >>   88 STORE_FAST               3 (forward_call)

1517          90 LOAD_FAST                0 (self)
              92 LOAD_ATTR                5 (_backward_hooks)
             102 POP_JUMP_FORWARD_IF_TRUE    57 (to 218)
             104 LOAD_FAST                0 (self)
             106 LOAD_ATTR                6 (_backward_pre_hooks)
             116 POP_JUMP_FORWARD_IF_TRUE    50 (to 218)
             118 LOAD_FAST                0 (self)
             120 LOAD_ATTR                7 (_forward_hooks)
             130 POP_JUMP_FORWARD_IF_TRUE    43 (to 218)
             132 LOAD_FAST                0 (self)
             134 LOAD_ATTR                8 (_forward_pre_hooks)
             144 POP_JUMP_FORWARD_IF_TRUE    36 (to 218)

1518         146 LOAD_GLOBAL             18 (_global_backward_pre_hooks)

1517         158 POP_JUMP_FORWARD_IF_TRUE    29 (to 218)

1518         160 LOAD_GLOBAL             20 (_global_backward_hooks)

1517         172 POP_JUMP_FORWARD_IF_TRUE    22 (to 218)

1519         174 LOAD_GLOBAL             22 (_global_forward_hooks)

1517         186 POP_JUMP_FORWARD_IF_TRUE    15 (to 218)

1519         188 LOAD_GLOBAL             24 (_global_forward_pre_hooks)

1517         200 POP_JUMP_FORWARD_IF_TRUE     8 (to 218)

1520         202 PUSH_NULL
             204 LOAD_FAST                3 (forward_call)
             206 LOAD_FAST                1 (args)
             208 BUILD_MAP                0
             210 LOAD_FAST                2 (kwargs)
             212 DICT_MERGE               1
             214 CALL_FUNCTION_EX         1
             216 RETURN_VALUE

1522     >>  218 NOP

1523         220 LOAD_CONST               0 (None)
             222 STORE_FAST               4 (result)

1524         224 LOAD_GLOBAL             27 (NULL + set)
             236 PRECALL                  0
             240 CALL                     0
             250 STORE_FAST               5 (called_always_called_hooks)

1526         252 BUILD_LIST               0
             254 BUILD_LIST               0
             256 STORE_FAST               7 (non_full_backward_hooks)
             258 STORE_FAST               6 (full_backward_hooks)

1527         260 BUILD_LIST               0
             262 STORE_FAST               8 (backward_pre_hooks)

1528         264 LOAD_FAST                0 (self)
             266 LOAD_ATTR                6 (_backward_pre_hooks)
             276 POP_JUMP_FORWARD_IF_TRUE     7 (to 292)
             278 LOAD_GLOBAL             18 (_global_backward_pre_hooks)
             290 POP_JUMP_FORWARD_IF_FALSE    20 (to 332)

1529     >>  292 LOAD_FAST                0 (self)
             294 LOAD_METHOD             14 (_get_backward_pre_hooks)
             316 PRECALL                  0
             320 CALL                     0
             330 STORE_FAST               8 (backward_pre_hooks)

1531     >>  332 LOAD_FAST                0 (self)
             334 LOAD_ATTR                5 (_backward_hooks)
             344 POP_JUMP_FORWARD_IF_TRUE     7 (to 360)
             346 LOAD_GLOBAL             20 (_global_backward_hooks)
             358 POP_JUMP_FORWARD_IF_FALSE    23 (to 406)

1532     >>  360 LOAD_FAST                0 (self)
             362 LOAD_METHOD             15 (_get_backward_hooks)
             384 PRECALL                  0
             388 CALL                     0
             398 UNPACK_SEQUENCE          2
             402 STORE_FAST               6 (full_backward_hooks)
             404 STORE_FAST               7 (non_full_backward_hooks)

1534     >>  406 LOAD_GLOBAL             24 (_global_forward_pre_hooks)
             418 POP_JUMP_FORWARD_IF_TRUE     7 (to 434)
             420 LOAD_FAST                0 (self)
             422 LOAD_ATTR                8 (_forward_pre_hooks)
             432 POP_JUMP_FORWARD_IF_FALSE   189 (to 812)

1535     >>  434 BUILD_LIST               0

1536         436 LOAD_GLOBAL             24 (_global_forward_pre_hooks)
             448 LOAD_METHOD             16 (items)
             470 PRECALL                  0
             474 CALL                     0

1535         484 LIST_EXTEND              1

1537         486 LOAD_FAST                0 (self)
             488 LOAD_ATTR                8 (_forward_pre_hooks)
             498 LOAD_METHOD             16 (items)
             520 PRECALL                  0
             524 CALL                     0

1535         534 LIST_EXTEND              1
             536 LIST_TO_TUPLE
             538 GET_ITER
         >>  540 FOR_ITER               135 (to 812)
             542 UNPACK_SEQUENCE          2
             546 STORE_FAST               9 (hook_id)
             548 STORE_FAST              10 (hook)

1539         550 LOAD_FAST                9 (hook_id)
             552 LOAD_FAST                0 (self)
             554 LOAD_ATTR               17 (_forward_pre_hooks_with_kwargs)
             564 CONTAINS_OP              0
             566 POP_JUMP_FORWARD_IF_FALSE    81 (to 730)

1540         568 PUSH_NULL
             570 LOAD_FAST               10 (hook)
             572 LOAD_FAST                0 (self)
             574 LOAD_FAST                1 (args)
             576 LOAD_FAST                2 (kwargs)
             578 PRECALL                  3
             582 CALL                     3
             592 STORE_FAST              11 (args_kwargs_result)

1541         594 LOAD_FAST               11 (args_kwargs_result)
             596 POP_JUMP_FORWARD_IF_NONE    65 (to 728)

1542         598 LOAD_GLOBAL             37 (NULL + isinstance)
             610 LOAD_FAST               11 (args_kwargs_result)
             612 LOAD_GLOBAL             38 (tuple)
             624 PRECALL                  2
             628 CALL                     2
             638 POP_JUMP_FORWARD_IF_FALSE    25 (to 690)
             640 LOAD_GLOBAL             41 (NULL + len)
             652 LOAD_FAST               11 (args_kwargs_result)
             654 PRECALL                  1
             658 CALL                     1
             668 LOAD_CONST               1 (2)
             670 COMPARE_OP               2 (==)
             676 POP_JUMP_FORWARD_IF_FALSE     6 (to 690)

1543         678 LOAD_FAST               11 (args_kwargs_result)
             680 UNPACK_SEQUENCE          2
             684 STORE_FAST               1 (args)
             686 STORE_FAST               2 (kwargs)
             688 JUMP_BACKWARD           75 (to 540)

1545     >>  690 LOAD_GLOBAL             43 (NULL + RuntimeError)

1546         702 LOAD_CONST               2 ('forward pre-hook must return None or a tuple of (new_args, new_kwargs), but got ')

1547         704 LOAD_FAST               11 (args_kwargs_result)

1546         706 FORMAT_VALUE             0
             708 LOAD_CONST               3 ('.')
             710 BUILD_STRING             3

1545         712 PRECALL                  1
             716 CALL                     1
             726 RAISE_VARARGS            1

1541     >>  728 JUMP_BACKWARD           95 (to 540)

1550     >>  730 PUSH_NULL
             732 LOAD_FAST               10 (hook)
             734 LOAD_FAST                0 (self)
             736 LOAD_FAST                1 (args)
             738 PRECALL                  2
             742 CALL                     2
             752 STORE_FAST              12 (args_result)

1551         754 LOAD_FAST               12 (args_result)
             756 POP_JUMP_FORWARD_IF_NONE    26 (to 810)

1552         758 LOAD_GLOBAL             37 (NULL + isinstance)
             770 LOAD_FAST               12 (args_result)
             772 LOAD_GLOBAL             38 (tuple)
             784 PRECALL                  2
             788 CALL                     2
             798 POP_JUMP_FORWARD_IF_TRUE     3 (to 806)

1553         800 LOAD_FAST               12 (args_result)
             802 BUILD_TUPLE              1
             804 STORE_FAST              12 (args_result)

1554     >>  806 LOAD_FAST               12 (args_result)
             808 STORE_FAST               1 (args)
         >>  810 JUMP_BACKWARD          136 (to 540)

1556     >>  812 LOAD_CONST               0 (None)
             814 STORE_FAST              13 (bw_hook)

1557         816 LOAD_FAST                6 (full_backward_hooks)
             818 POP_JUMP_FORWARD_IF_TRUE     2 (to 824)
             820 LOAD_FAST                8 (backward_pre_hooks)
             822 POP_JUMP_FORWARD_IF_FALSE    43 (to 910)

1558     >>  824 LOAD_GLOBAL             45 (NULL + hooks)
             836 LOAD_ATTR               23 (BackwardHook)
             846 LOAD_FAST                0 (self)
             848 LOAD_FAST                6 (full_backward_hooks)
             850 LOAD_FAST                8 (backward_pre_hooks)
             852 PRECALL                  3
             856 CALL                     3
             866 STORE_FAST              13 (bw_hook)

1559         868 LOAD_FAST               13 (bw_hook)
             870 LOAD_METHOD             24 (setup_input_hook)
             892 LOAD_FAST                1 (args)
             894 PRECALL                  1
             898 CALL                     1
             908 STORE_FAST               1 (args)

1561     >>  910 PUSH_NULL
             912 LOAD_FAST                3 (forward_call)
             914 LOAD_FAST                1 (args)
             916 BUILD_MAP                0
             918 LOAD_FAST                2 (kwargs)
             920 DICT_MERGE               1
             922 CALL_FUNCTION_EX         1
             924 STORE_FAST               4 (result)

1562         926 LOAD_GLOBAL             22 (_global_forward_hooks)
             938 POP_JUMP_FORWARD_IF_TRUE     7 (to 954)
             940 LOAD_FAST                0 (self)
             942 LOAD_ATTR                7 (_forward_hooks)
             952 POP_JUMP_FORWARD_IF_FALSE   139 (to 1232)

1563     >>  954 BUILD_LIST               0

1564         956 LOAD_GLOBAL             22 (_global_forward_hooks)
             968 LOAD_METHOD             16 (items)
             990 PRECALL                  0
             994 CALL                     0

1563        1004 LIST_EXTEND              1

1565        1006 LOAD_FAST                0 (self)
            1008 LOAD_ATTR                7 (_forward_hooks)
            1018 LOAD_METHOD             16 (items)
            1040 PRECALL                  0
            1044 CALL                     0

1563        1054 LIST_EXTEND              1
            1056 LIST_TO_TUPLE
            1058 GET_ITER
         >> 1060 FOR_ITER                85 (to 1232)
            1062 UNPACK_SEQUENCE          2
            1066 STORE_FAST               9 (hook_id)
            1068 STORE_FAST              10 (hook)

1568        1070 LOAD_FAST                9 (hook_id)
            1072 LOAD_FAST                0 (self)
            1074 LOAD_ATTR               25 (_forward_hooks_always_called)
            1084 CONTAINS_OP              0
            1086 POP_JUMP_FORWARD_IF_TRUE     9 (to 1106)
            1088 LOAD_FAST                9 (hook_id)
            1090 LOAD_GLOBAL             52 (_global_forward_hooks_always_called)
            1102 CONTAINS_OP              0
            1104 POP_JUMP_FORWARD_IF_FALSE    21 (to 1148)

1569     >> 1106 LOAD_FAST                5 (called_always_called_hooks)
            1108 LOAD_METHOD             27 (add)
            1130 LOAD_FAST                9 (hook_id)
            1132 PRECALL                  1
            1136 CALL                     1
            1146 POP_TOP

1571     >> 1148 LOAD_FAST                9 (hook_id)
            1150 LOAD_FAST                0 (self)
            1152 LOAD_ATTR               28 (_forward_hooks_with_kwargs)
            1162 CONTAINS_OP              0
            1164 POP_JUMP_FORWARD_IF_FALSE    15 (to 1196)

1572        1166 PUSH_NULL
            1168 LOAD_FAST               10 (hook)
            1170 LOAD_FAST                0 (self)
            1172 LOAD_FAST                1 (args)
            1174 LOAD_FAST                2 (kwargs)
            1176 LOAD_FAST                4 (result)
            1178 PRECALL                  4
            1182 CALL                     4
            1192 STORE_FAST              14 (hook_result)
            1194 JUMP_FORWARD            13 (to 1222)

1574     >> 1196 PUSH_NULL
            1198 LOAD_FAST               10 (hook)
            1200 LOAD_FAST                0 (self)
            1202 LOAD_FAST                1 (args)
            1204 LOAD_FAST                4 (result)
            1206 PRECALL                  3
            1210 CALL                     3
            1220 STORE_FAST              14 (hook_result)

1576     >> 1222 LOAD_FAST               14 (hook_result)
            1224 POP_JUMP_FORWARD_IF_NONE     2 (to 1230)

1577        1226 LOAD_FAST               14 (hook_result)
            1228 STORE_FAST               4 (result)
         >> 1230 JUMP_BACKWARD           86 (to 1060)

1579     >> 1232 LOAD_FAST               13 (bw_hook)
            1234 POP_JUMP_FORWARD_IF_FALSE    90 (to 1416)

1580        1236 LOAD_GLOBAL             37 (NULL + isinstance)
            1248 LOAD_FAST                4 (result)
            1250 LOAD_GLOBAL              0 (torch)
            1262 LOAD_ATTR               29 (Tensor)
            1272 LOAD_GLOBAL             38 (tuple)
            1284 BUILD_TUPLE              2
            1286 PRECALL                  2
            1290 CALL                     2
            1300 POP_JUMP_FORWARD_IF_TRUE    36 (to 1374)

1581        1302 LOAD_GLOBAL             61 (NULL + warnings)
            1314 LOAD_ATTR               31 (warn)
            1324 LOAD_CONST               4 ('For backward hooks to be called, module output should be a Tensor or a tuple of Tensors but received ')

1583        1326 LOAD_GLOBAL             65 (NULL + type)
            1338 LOAD_FAST                4 (result)
            1340 PRECALL                  1
            1344 CALL                     1

1581        1354 FORMAT_VALUE             0
            1356 BUILD_STRING             2
            1358 PRECALL                  1
            1362 CALL                     1
            1372 POP_TOP

1584     >> 1374 LOAD_FAST               13 (bw_hook)
            1376 LOAD_METHOD             33 (setup_output_hook)
            1398 LOAD_FAST                4 (result)
            1400 PRECALL                  1
            1404 CALL                     1
            1414 STORE_FAST               4 (result)

1587     >> 1416 LOAD_FAST                7 (non_full_backward_hooks)
            1418 POP_JUMP_FORWARD_IF_FALSE   199 (to 1818)

1588        1420 LOAD_FAST                4 (result)
            1422 STORE_FAST              15 (var)

1589        1424 LOAD_GLOBAL             37 (NULL + isinstance)
            1436 LOAD_FAST               15 (var)
            1438 LOAD_GLOBAL              0 (torch)
            1450 LOAD_ATTR               29 (Tensor)
            1460 PRECALL                  2
            1464 CALL                     2
            1474 POP_JUMP_FORWARD_IF_TRUE    99 (to 1674)

1590     >> 1476 LOAD_GLOBAL             37 (NULL + isinstance)
            1488 LOAD_FAST               15 (var)
            1490 LOAD_GLOBAL             68 (dict)
            1502 PRECALL                  2
            1506 CALL                     2
            1516 POP_JUMP_FORWARD_IF_FALSE    44 (to 1606)

1591        1518 LOAD_GLOBAL             71 (NULL + next)
            1530 LOAD_CONST               5 (<code object <genexpr> at 0x7facf67909c0, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1591>)
            1532 MAKE_FUNCTION            0
            1534 LOAD_FAST               15 (var)
            1536 LOAD_METHOD             36 (values)
            1558 PRECALL                  0
            1562 CALL                     0
            1572 GET_ITER
            1574 PRECALL                  0
            1578 CALL                     0
            1588 PRECALL                  1
            1592 CALL                     1
            1602 STORE_FAST              15 (var)
            1604 JUMP_FORWARD             8 (to 1622)

1593     >> 1606 LOAD_FAST               15 (var)
            1608 LOAD_CONST               6 (0)
            1610 BINARY_SUBSCR
            1620 STORE_FAST              15 (var)

1589     >> 1622 LOAD_GLOBAL             37 (NULL + isinstance)
            1634 LOAD_FAST               15 (var)
            1636 LOAD_GLOBAL              0 (torch)
            1648 LOAD_ATTR               29 (Tensor)
            1658 PRECALL                  2
            1662 CALL                     2
            1672 POP_JUMP_BACKWARD_IF_FALSE    99 (to 1476)

1594     >> 1674 LOAD_FAST               15 (var)
            1676 LOAD_ATTR               37 (grad_fn)
            1686 STORE_FAST              16 (grad_fn)

1595        1688 LOAD_FAST               16 (grad_fn)
            1690 POP_JUMP_FORWARD_IF_NONE    63 (to 1818)

1596        1692 LOAD_FAST                7 (non_full_backward_hooks)
            1694 GET_ITER
         >> 1696 FOR_ITER                37 (to 1772)
            1698 STORE_FAST              10 (hook)

1597        1700 LOAD_FAST               16 (grad_fn)
            1702 LOAD_METHOD             38 (register_hook)
            1724 LOAD_GLOBAL             79 (NULL + _WrappedHook)
            1736 LOAD_FAST               10 (hook)
            1738 LOAD_FAST                0 (self)
            1740 PRECALL                  2
            1744 CALL                     2
            1754 PRECALL                  1
            1758 CALL                     1
            1768 POP_TOP
            1770 JUMP_BACKWARD           38 (to 1696)

1598     >> 1772 LOAD_FAST                0 (self)
            1774 LOAD_METHOD             40 (_maybe_warn_non_full_backward_hook)
            1796 LOAD_FAST                1 (args)
            1798 LOAD_FAST                4 (result)
            1800 LOAD_FAST               16 (grad_fn)
            1802 PRECALL                  3
            1806 CALL                     3
            1816 POP_TOP

1600     >> 1818 LOAD_FAST                4 (result)
            1820 RETURN_VALUE
         >> 1822 PUSH_EXC_INFO

1602        1824 LOAD_GLOBAL             82 (Exception)
            1836 CHECK_EXC_MATCH
            1838 EXTENDED_ARG             1
            1840 POP_JUMP_FORWARD_IF_FALSE   270 (to 2382)
            1842 POP_TOP

1606        1844 LOAD_GLOBAL             22 (_global_forward_hooks)
            1856 LOAD_METHOD             16 (items)
            1878 PRECALL                  0
            1882 CALL                     0
            1892 GET_ITER
         >> 1894 FOR_ITER                96 (to 2088)
            1896 UNPACK_SEQUENCE          2
            1900 STORE_FAST               9 (hook_id)
            1902 STORE_FAST              10 (hook)

1607        1904 LOAD_FAST                9 (hook_id)
            1906 LOAD_GLOBAL             52 (_global_forward_hooks_always_called)
            1918 CONTAINS_OP              0
            1920 POP_JUMP_FORWARD_IF_FALSE    82 (to 2086)
            1922 LOAD_FAST                9 (hook_id)
            1924 LOAD_FAST                5 (called_always_called_hooks)
            1926 CONTAINS_OP              1
            1928 POP_JUMP_FORWARD_IF_FALSE    78 (to 2086)

1608        1930 NOP

1609        1932 PUSH_NULL
            1934 LOAD_FAST               10 (hook)
            1936 LOAD_FAST                0 (self)
            1938 LOAD_FAST                1 (args)
            1940 LOAD_FAST                4 (result)
            1942 PRECALL                  3
            1946 CALL                     3
            1956 STORE_FAST              14 (hook_result)

1610        1958 LOAD_FAST               14 (hook_result)
            1960 POP_JUMP_FORWARD_IF_NONE     2 (to 1966)

1611        1962 LOAD_FAST               14 (hook_result)
            1964 STORE_FAST               4 (result)
         >> 1966 JUMP_BACKWARD           37 (to 1894)
         >> 1968 PUSH_EXC_INFO

1612        1970 LOAD_GLOBAL             82 (Exception)
            1982 CHECK_EXC_MATCH
            1984 POP_JUMP_FORWARD_IF_FALSE    46 (to 2078)
            1986 STORE_FAST              17 (e)

1613        1988 LOAD_GLOBAL             61 (NULL + warnings)
            2000 LOAD_ATTR               31 (warn)
            2010 LOAD_CONST               7 ('global module forward hook with ``always_call=True`` raised an exception that was silenced as another error was raised in forward: ')

1614        2012 LOAD_GLOBAL             85 (NULL + str)
            2024 LOAD_FAST               17 (e)
            2026 PRECALL                  1
            2030 CALL                     1

1613        2040 FORMAT_VALUE             0
            2042 BUILD_STRING             2
            2044 PRECALL                  1
            2048 CALL                     1
            2058 POP_TOP

1615        2060 POP_EXCEPT
            2062 LOAD_CONST               0 (None)
            2064 STORE_FAST              17 (e)
            2066 DELETE_FAST             17 (e)
            2068 JUMP_BACKWARD           88 (to 1894)
         >> 2070 LOAD_CONST               0 (None)
            2072 STORE_FAST              17 (e)
            2074 DELETE_FAST             17 (e)
            2076 RERAISE                  1

1612     >> 2078 RERAISE                  0
         >> 2080 COPY                     3
            2082 POP_EXCEPT
            2084 RERAISE                  1
         >> 2086 JUMP_BACKWARD           97 (to 1894)

1617     >> 2088 LOAD_FAST                0 (self)
            2090 LOAD_ATTR                7 (_forward_hooks)
            2100 LOAD_METHOD             16 (items)
            2122 PRECALL                  0
            2126 CALL                     0
            2136 GET_ITER
         >> 2138 FOR_ITER               120 (to 2380)
            2140 UNPACK_SEQUENCE          2
            2144 STORE_FAST               9 (hook_id)
            2146 STORE_FAST              10 (hook)

1618        2148 LOAD_FAST                9 (hook_id)
            2150 LOAD_FAST                0 (self)
            2152 LOAD_ATTR               25 (_forward_hooks_always_called)
            2162 CONTAINS_OP              0
            2164 POP_JUMP_FORWARD_IF_FALSE   106 (to 2378)
            2166 LOAD_FAST                9 (hook_id)
            2168 LOAD_FAST                5 (called_always_called_hooks)
            2170 CONTAINS_OP              1
            2172 POP_JUMP_FORWARD_IF_FALSE   102 (to 2378)

1619        2174 NOP

1620        2176 LOAD_FAST                9 (hook_id)
            2178 LOAD_FAST                0 (self)
            2180 LOAD_ATTR               28 (_forward_hooks_with_kwargs)
            2190 CONTAINS_OP              0
            2192 POP_JUMP_FORWARD_IF_FALSE    15 (to 2224)

1621        2194 PUSH_NULL
            2196 LOAD_FAST               10 (hook)
            2198 LOAD_FAST                0 (self)
            2200 LOAD_FAST                1 (args)
            2202 LOAD_FAST                2 (kwargs)
            2204 LOAD_FAST                4 (result)
            2206 PRECALL                  4
            2210 CALL                     4
            2220 STORE_FAST              14 (hook_result)
            2222 JUMP_FORWARD            13 (to 2250)

1623     >> 2224 PUSH_NULL
            2226 LOAD_FAST               10 (hook)
            2228 LOAD_FAST                0 (self)
            2230 LOAD_FAST                1 (args)
            2232 LOAD_FAST                4 (result)
            2234 PRECALL                  3
            2238 CALL                     3
            2248 STORE_FAST              14 (hook_result)

1624     >> 2250 LOAD_FAST               14 (hook_result)
            2252 POP_JUMP_FORWARD_IF_NONE     2 (to 2258)

1625        2254 LOAD_FAST               14 (hook_result)
            2256 STORE_FAST               4 (result)
         >> 2258 JUMP_BACKWARD           61 (to 2138)
         >> 2260 PUSH_EXC_INFO

1626        2262 LOAD_GLOBAL             82 (Exception)
            2274 CHECK_EXC_MATCH
            2276 POP_JUMP_FORWARD_IF_FALSE    46 (to 2370)
            2278 STORE_FAST              17 (e)

1627        2280 LOAD_GLOBAL             61 (NULL + warnings)
            2292 LOAD_ATTR               31 (warn)
            2302 LOAD_CONST               8 ('module forward hook with ``always_call=True`` raised an exception that was silenced as another error was raised in forward: ')

1628        2304 LOAD_GLOBAL             85 (NULL + str)
            2316 LOAD_FAST               17 (e)
            2318 PRECALL                  1
            2322 CALL                     1

1627        2332 FORMAT_VALUE             0
            2334 BUILD_STRING             2
            2336 PRECALL                  1
            2340 CALL                     1
            2350 POP_TOP

1629        2352 POP_EXCEPT
            2354 LOAD_CONST               0 (None)
            2356 STORE_FAST              17 (e)
            2358 DELETE_FAST             17 (e)
            2360 JUMP_BACKWARD          112 (to 2138)
         >> 2362 LOAD_CONST               0 (None)
            2364 STORE_FAST              17 (e)
            2366 DELETE_FAST             17 (e)
            2368 RERAISE                  1

1626     >> 2370 RERAISE                  0
         >> 2372 COPY                     3
            2374 POP_EXCEPT
            2376 RERAISE                  1
         >> 2378 JUMP_BACKWARD          121 (to 2138)

1631     >> 2380 RAISE_VARARGS            0

1602     >> 2382 RERAISE                  0
         >> 2384 COPY                     3
            2386 POP_EXCEPT
            2388 RERAISE                  1
ExceptionTable:
  220 to 1818 -> 1822 [0]
  1822 to 1928 -> 2384 [1] lasti
  1932 to 1964 -> 1968 [2]
  1966 to 1966 -> 2384 [1] lasti
  1968 to 1986 -> 2080 [3] lasti
  1988 to 2058 -> 2070 [3] lasti
  2060 to 2068 -> 2384 [1] lasti
  2070 to 2078 -> 2080 [3] lasti
  2080 to 2172 -> 2384 [1] lasti
  2176 to 2256 -> 2260 [2]
  2258 to 2258 -> 2384 [1] lasti
  2260 to 2278 -> 2372 [3] lasti
  2280 to 2350 -> 2362 [3] lasti
  2352 to 2360 -> 2384 [1] lasti
  2362 to 2370 -> 2372 [3] lasti
  2372 to 2382 -> 2384 [1] lasti
, inlined according skipfiles.MOD_INLINELIST
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1513 in _call_impl (Module._call_impl) (inline depth: 2)
        def _call_impl(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1514 in _call_impl (Module._call_impl) (inline depth: 2)
            forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR _C [TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_METHOD _get_tracing_state [TorchVariable(<module 'torch._C' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/_C.cpython-311-x86_64-linux-gnu.so'>)]
TRACE PRECALL 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method _get_tracing_state of PyCapsule object at 0x7fad61054bd0>)]
TRACE CALL 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method _get_tracing_state of PyCapsule object at 0x7fad61054bd0>)]
TRACE POP_JUMP_FORWARD_IF_FALSE 76 [ConstantVariable(NoneType)]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR forward [NNModuleVariable()]
TRACE STORE_FAST forward_call [UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable())]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 2)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _backward_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _backward_pre_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _forward_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _forward_pre_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1518 in _call_impl (Module._call_impl) (inline depth: 2)
                    or _global_backward_pre_hooks or _global_backward_hooks
TRACE LOAD_GLOBAL _global_backward_pre_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 2)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1518 in _call_impl (Module._call_impl) (inline depth: 2)
                    or _global_backward_pre_hooks or _global_backward_hooks
TRACE LOAD_GLOBAL _global_backward_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 2)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1519 in _call_impl (Module._call_impl) (inline depth: 2)
                    or _global_forward_hooks or _global_forward_pre_hooks):
TRACE LOAD_GLOBAL _global_forward_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 2)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1519 in _call_impl (Module._call_impl) (inline depth: 2)
                    or _global_forward_hooks or _global_forward_pre_hooks):
TRACE LOAD_GLOBAL _global_forward_pre_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 2)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1520 in _call_impl (Module._call_impl) (inline depth: 2)
                return forward_call(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST forward_call [NullVariable]
TRACE LOAD_FAST args [NullVariable, UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable())]
TRACE BUILD_MAP 0 [NullVariable, UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable()), TupleVariable()]
TRACE LOAD_FAST kwargs [NullVariable, UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable()), TupleVariable(), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable()), TupleVariable(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable()), TupleVariable(), ConstDictVariable()]
TRACE inlined call forward from /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1520 in _call_impl (Module._call_impl) (inline depth: 2)
            return forward_call(*args, **kwargs)
                   ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object forward at 0x7facb06ca420, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 56>
 56           0 RESUME                   0

 57           2 LOAD_GLOBAL              1 (NULL + F)
             14 LOAD_ATTR                1 (relu)
             24 LOAD_FAST                0 (self)
             26 LOAD_METHOD              2 (layer1)
             48 LOAD_FAST                1 (embeddings)
             50 PRECALL                  1
             54 CALL                     1
             64 PRECALL                  1
             68 CALL                     1
             78 STORE_FAST               2 (layer1_act)

 58          80 LOAD_GLOBAL              1 (NULL + F)
             92 LOAD_ATTR                3 (softmax)
            102 LOAD_FAST                0 (self)
            104 LOAD_METHOD              4 (layer2)
            126 LOAD_FAST                2 (layer1_act)
            128 PRECALL                  1
            132 CALL                     1
            142 LOAD_CONST               1 (0)
            144 KW_NAMES                 2
            146 PRECALL                  2
            150 CALL                     2
            160 STORE_FAST               3 (attention)

 59         162 LOAD_GLOBAL             11 (NULL + torch)
            174 LOAD_ATTR                6 (sum)
            184 LOAD_FAST                3 (attention)
            186 LOAD_FAST                1 (embeddings)
            188 BINARY_OP                5 (*)
            192 LOAD_CONST               1 (0)
            194 KW_NAMES                 2
            196 PRECALL                  2
            200 CALL                     2
            210 STORE_FAST               4 (embedding)

 61         212 LOAD_FAST                4 (embedding)
            214 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:56 in forward (CenterIntersection.forward) (inline depth: 3)
        def forward(self, embeddings):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:57 in forward (CenterIntersection.forward) (inline depth: 3)
            layer1_act = F.relu(self.layer1(embeddings)) # (num_conj, dim)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_METHOD layer1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NNModuleVariable()]
TRACE LOAD_FAST embeddings [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable()]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE FX call l__self___center_net_layer1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:57 in forward (CenterIntersection.forward) (inline depth: 3)
        layer1_act = F.relu(self.layer1(embeddings)) # (num_conj, dim)
                            ~~~~~~~~~~~^^^^^^^^^^^^
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:57 in forward (CenterIntersection.forward) (inline depth: 3)
        layer1_act = F.relu(self.layer1(embeddings)) # (num_conj, dim)
                     ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST layer1_act [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:58 in forward (CenterIntersection.forward) (inline depth: 3)
            attention = F.softmax(self.layer2(layer1_act), dim=0) # (num_conj, dim)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR softmax [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>)]
TRACE LOAD_METHOD layer2 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), NNModuleVariable()]
TRACE LOAD_FAST layer1_act [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), NullVariable, NNModuleVariable()]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE FX call l__self___center_net_layer2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:58 in forward (CenterIntersection.forward) (inline depth: 3)
        attention = F.softmax(self.layer2(layer1_act), dim=0) # (num_conj, dim)
                              ~~~~~~~~~~~^^^^^^^^^^^^
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), TensorVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), TensorVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), TensorVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), TensorVariable(), ConstantVariable(int)]
TRACE FX call softmax from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:58 in forward (CenterIntersection.forward) (inline depth: 3)
        attention = F.softmax(self.layer2(layer1_act), dim=0) # (num_conj, dim)
                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST attention [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:59 in forward (CenterIntersection.forward) (inline depth: 3)
            embedding = torch.sum(attention * embeddings, dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR sum [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST attention [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable()]
TRACE BINARY_OP 5 [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:59 in forward (CenterIntersection.forward) (inline depth: 3)
        embedding = torch.sum(attention * embeddings, dim=0)
                              ~~~~~~~~~~^~~~~~~~~~~~
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE FX call sum_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:59 in forward (CenterIntersection.forward) (inline depth: 3)
        embedding = torch.sum(attention * embeddings, dim=0)
                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:61 in forward (CenterIntersection.forward) (inline depth: 3)
            return embedding
TRACE LOAD_FAST embedding []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward at 0x7facb06ca420, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 56>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object _call_impl at 0x60bf410, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1513>
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:239 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                offset_embedding = self.offset_net(torch.stack(offset_embedding_list))
TRACE LOAD_FAST self []
TRACE LOAD_METHOD offset_net [NNModuleVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, NNModuleVariable()]
TRACE LOAD_ATTR stack [NullVariable, NNModuleVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST offset_embedding_list [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>), ListVariable()]
TRACE CALL 1 [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>), ListVariable()]
TRACE FX call stack_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:239 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            offset_embedding = self.offset_net(torch.stack(offset_embedding_list))
                                               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE PRECALL 1 [NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, NNModuleVariable(), TensorVariable()]
TRACE inlined call _call_impl from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:239 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            offset_embedding = self.offset_net(torch.stack(offset_embedding_list))
                               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object _call_impl at 0x60bf410, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1513>
1513           0 RESUME                   0

1514           2 LOAD_GLOBAL              0 (torch)
              14 LOAD_ATTR                1 (_C)
              24 LOAD_METHOD              2 (_get_tracing_state)
              46 PRECALL                  0
              50 CALL                     0
              60 POP_JUMP_FORWARD_IF_FALSE     7 (to 76)
              62 LOAD_FAST                0 (self)
              64 LOAD_ATTR                3 (_slow_forward)
              74 JUMP_FORWARD             6 (to 88)
         >>   76 LOAD_FAST                0 (self)
              78 LOAD_ATTR                4 (forward)
         >>   88 STORE_FAST               3 (forward_call)

1517          90 LOAD_FAST                0 (self)
              92 LOAD_ATTR                5 (_backward_hooks)
             102 POP_JUMP_FORWARD_IF_TRUE    57 (to 218)
             104 LOAD_FAST                0 (self)
             106 LOAD_ATTR                6 (_backward_pre_hooks)
             116 POP_JUMP_FORWARD_IF_TRUE    50 (to 218)
             118 LOAD_FAST                0 (self)
             120 LOAD_ATTR                7 (_forward_hooks)
             130 POP_JUMP_FORWARD_IF_TRUE    43 (to 218)
             132 LOAD_FAST                0 (self)
             134 LOAD_ATTR                8 (_forward_pre_hooks)
             144 POP_JUMP_FORWARD_IF_TRUE    36 (to 218)

1518         146 LOAD_GLOBAL             18 (_global_backward_pre_hooks)

1517         158 POP_JUMP_FORWARD_IF_TRUE    29 (to 218)

1518         160 LOAD_GLOBAL             20 (_global_backward_hooks)

1517         172 POP_JUMP_FORWARD_IF_TRUE    22 (to 218)

1519         174 LOAD_GLOBAL             22 (_global_forward_hooks)

1517         186 POP_JUMP_FORWARD_IF_TRUE    15 (to 218)

1519         188 LOAD_GLOBAL             24 (_global_forward_pre_hooks)

1517         200 POP_JUMP_FORWARD_IF_TRUE     8 (to 218)

1520         202 PUSH_NULL
             204 LOAD_FAST                3 (forward_call)
             206 LOAD_FAST                1 (args)
             208 BUILD_MAP                0
             210 LOAD_FAST                2 (kwargs)
             212 DICT_MERGE               1
             214 CALL_FUNCTION_EX         1
             216 RETURN_VALUE

1522     >>  218 NOP

1523         220 LOAD_CONST               0 (None)
             222 STORE_FAST               4 (result)

1524         224 LOAD_GLOBAL             27 (NULL + set)
             236 PRECALL                  0
             240 CALL                     0
             250 STORE_FAST               5 (called_always_called_hooks)

1526         252 BUILD_LIST               0
             254 BUILD_LIST               0
             256 STORE_FAST               7 (non_full_backward_hooks)
             258 STORE_FAST               6 (full_backward_hooks)

1527         260 BUILD_LIST               0
             262 STORE_FAST               8 (backward_pre_hooks)

1528         264 LOAD_FAST                0 (self)
             266 LOAD_ATTR                6 (_backward_pre_hooks)
             276 POP_JUMP_FORWARD_IF_TRUE     7 (to 292)
             278 LOAD_GLOBAL             18 (_global_backward_pre_hooks)
             290 POP_JUMP_FORWARD_IF_FALSE    20 (to 332)

1529     >>  292 LOAD_FAST                0 (self)
             294 LOAD_METHOD             14 (_get_backward_pre_hooks)
             316 PRECALL                  0
             320 CALL                     0
             330 STORE_FAST               8 (backward_pre_hooks)

1531     >>  332 LOAD_FAST                0 (self)
             334 LOAD_ATTR                5 (_backward_hooks)
             344 POP_JUMP_FORWARD_IF_TRUE     7 (to 360)
             346 LOAD_GLOBAL             20 (_global_backward_hooks)
             358 POP_JUMP_FORWARD_IF_FALSE    23 (to 406)

1532     >>  360 LOAD_FAST                0 (self)
             362 LOAD_METHOD             15 (_get_backward_hooks)
             384 PRECALL                  0
             388 CALL                     0
             398 UNPACK_SEQUENCE          2
             402 STORE_FAST               6 (full_backward_hooks)
             404 STORE_FAST               7 (non_full_backward_hooks)

1534     >>  406 LOAD_GLOBAL             24 (_global_forward_pre_hooks)
             418 POP_JUMP_FORWARD_IF_TRUE     7 (to 434)
             420 LOAD_FAST                0 (self)
             422 LOAD_ATTR                8 (_forward_pre_hooks)
             432 POP_JUMP_FORWARD_IF_FALSE   189 (to 812)

1535     >>  434 BUILD_LIST               0

1536         436 LOAD_GLOBAL             24 (_global_forward_pre_hooks)
             448 LOAD_METHOD             16 (items)
             470 PRECALL                  0
             474 CALL                     0

1535         484 LIST_EXTEND              1

1537         486 LOAD_FAST                0 (self)
             488 LOAD_ATTR                8 (_forward_pre_hooks)
             498 LOAD_METHOD             16 (items)
             520 PRECALL                  0
             524 CALL                     0

1535         534 LIST_EXTEND              1
             536 LIST_TO_TUPLE
             538 GET_ITER
         >>  540 FOR_ITER               135 (to 812)
             542 UNPACK_SEQUENCE          2
             546 STORE_FAST               9 (hook_id)
             548 STORE_FAST              10 (hook)

1539         550 LOAD_FAST                9 (hook_id)
             552 LOAD_FAST                0 (self)
             554 LOAD_ATTR               17 (_forward_pre_hooks_with_kwargs)
             564 CONTAINS_OP              0
             566 POP_JUMP_FORWARD_IF_FALSE    81 (to 730)

1540         568 PUSH_NULL
             570 LOAD_FAST               10 (hook)
             572 LOAD_FAST                0 (self)
             574 LOAD_FAST                1 (args)
             576 LOAD_FAST                2 (kwargs)
             578 PRECALL                  3
             582 CALL                     3
             592 STORE_FAST              11 (args_kwargs_result)

1541         594 LOAD_FAST               11 (args_kwargs_result)
             596 POP_JUMP_FORWARD_IF_NONE    65 (to 728)

1542         598 LOAD_GLOBAL             37 (NULL + isinstance)
             610 LOAD_FAST               11 (args_kwargs_result)
             612 LOAD_GLOBAL             38 (tuple)
             624 PRECALL                  2
             628 CALL                     2
             638 POP_JUMP_FORWARD_IF_FALSE    25 (to 690)
             640 LOAD_GLOBAL             41 (NULL + len)
             652 LOAD_FAST               11 (args_kwargs_result)
             654 PRECALL                  1
             658 CALL                     1
             668 LOAD_CONST               1 (2)
             670 COMPARE_OP               2 (==)
             676 POP_JUMP_FORWARD_IF_FALSE     6 (to 690)

1543         678 LOAD_FAST               11 (args_kwargs_result)
             680 UNPACK_SEQUENCE          2
             684 STORE_FAST               1 (args)
             686 STORE_FAST               2 (kwargs)
             688 JUMP_BACKWARD           75 (to 540)

1545     >>  690 LOAD_GLOBAL             43 (NULL + RuntimeError)

1546         702 LOAD_CONST               2 ('forward pre-hook must return None or a tuple of (new_args, new_kwargs), but got ')

1547         704 LOAD_FAST               11 (args_kwargs_result)

1546         706 FORMAT_VALUE             0
             708 LOAD_CONST               3 ('.')
             710 BUILD_STRING             3

1545         712 PRECALL                  1
             716 CALL                     1
             726 RAISE_VARARGS            1

1541     >>  728 JUMP_BACKWARD           95 (to 540)

1550     >>  730 PUSH_NULL
             732 LOAD_FAST               10 (hook)
             734 LOAD_FAST                0 (self)
             736 LOAD_FAST                1 (args)
             738 PRECALL                  2
             742 CALL                     2
             752 STORE_FAST              12 (args_result)

1551         754 LOAD_FAST               12 (args_result)
             756 POP_JUMP_FORWARD_IF_NONE    26 (to 810)

1552         758 LOAD_GLOBAL             37 (NULL + isinstance)
             770 LOAD_FAST               12 (args_result)
             772 LOAD_GLOBAL             38 (tuple)
             784 PRECALL                  2
             788 CALL                     2
             798 POP_JUMP_FORWARD_IF_TRUE     3 (to 806)

1553         800 LOAD_FAST               12 (args_result)
             802 BUILD_TUPLE              1
             804 STORE_FAST              12 (args_result)

1554     >>  806 LOAD_FAST               12 (args_result)
             808 STORE_FAST               1 (args)
         >>  810 JUMP_BACKWARD          136 (to 540)

1556     >>  812 LOAD_CONST               0 (None)
             814 STORE_FAST              13 (bw_hook)

1557         816 LOAD_FAST                6 (full_backward_hooks)
             818 POP_JUMP_FORWARD_IF_TRUE     2 (to 824)
             820 LOAD_FAST                8 (backward_pre_hooks)
             822 POP_JUMP_FORWARD_IF_FALSE    43 (to 910)

1558     >>  824 LOAD_GLOBAL             45 (NULL + hooks)
             836 LOAD_ATTR               23 (BackwardHook)
             846 LOAD_FAST                0 (self)
             848 LOAD_FAST                6 (full_backward_hooks)
             850 LOAD_FAST                8 (backward_pre_hooks)
             852 PRECALL                  3
             856 CALL                     3
             866 STORE_FAST              13 (bw_hook)

1559         868 LOAD_FAST               13 (bw_hook)
             870 LOAD_METHOD             24 (setup_input_hook)
             892 LOAD_FAST                1 (args)
             894 PRECALL                  1
             898 CALL                     1
             908 STORE_FAST               1 (args)

1561     >>  910 PUSH_NULL
             912 LOAD_FAST                3 (forward_call)
             914 LOAD_FAST                1 (args)
             916 BUILD_MAP                0
             918 LOAD_FAST                2 (kwargs)
             920 DICT_MERGE               1
             922 CALL_FUNCTION_EX         1
             924 STORE_FAST               4 (result)

1562         926 LOAD_GLOBAL             22 (_global_forward_hooks)
             938 POP_JUMP_FORWARD_IF_TRUE     7 (to 954)
             940 LOAD_FAST                0 (self)
             942 LOAD_ATTR                7 (_forward_hooks)
             952 POP_JUMP_FORWARD_IF_FALSE   139 (to 1232)

1563     >>  954 BUILD_LIST               0

1564         956 LOAD_GLOBAL             22 (_global_forward_hooks)
             968 LOAD_METHOD             16 (items)
             990 PRECALL                  0
             994 CALL                     0

1563        1004 LIST_EXTEND              1

1565        1006 LOAD_FAST                0 (self)
            1008 LOAD_ATTR                7 (_forward_hooks)
            1018 LOAD_METHOD             16 (items)
            1040 PRECALL                  0
            1044 CALL                     0

1563        1054 LIST_EXTEND              1
            1056 LIST_TO_TUPLE
            1058 GET_ITER
         >> 1060 FOR_ITER                85 (to 1232)
            1062 UNPACK_SEQUENCE          2
            1066 STORE_FAST               9 (hook_id)
            1068 STORE_FAST              10 (hook)

1568        1070 LOAD_FAST                9 (hook_id)
            1072 LOAD_FAST                0 (self)
            1074 LOAD_ATTR               25 (_forward_hooks_always_called)
            1084 CONTAINS_OP              0
            1086 POP_JUMP_FORWARD_IF_TRUE     9 (to 1106)
            1088 LOAD_FAST                9 (hook_id)
            1090 LOAD_GLOBAL             52 (_global_forward_hooks_always_called)
            1102 CONTAINS_OP              0
            1104 POP_JUMP_FORWARD_IF_FALSE    21 (to 1148)

1569     >> 1106 LOAD_FAST                5 (called_always_called_hooks)
            1108 LOAD_METHOD             27 (add)
            1130 LOAD_FAST                9 (hook_id)
            1132 PRECALL                  1
            1136 CALL                     1
            1146 POP_TOP

1571     >> 1148 LOAD_FAST                9 (hook_id)
            1150 LOAD_FAST                0 (self)
            1152 LOAD_ATTR               28 (_forward_hooks_with_kwargs)
            1162 CONTAINS_OP              0
            1164 POP_JUMP_FORWARD_IF_FALSE    15 (to 1196)

1572        1166 PUSH_NULL
            1168 LOAD_FAST               10 (hook)
            1170 LOAD_FAST                0 (self)
            1172 LOAD_FAST                1 (args)
            1174 LOAD_FAST                2 (kwargs)
            1176 LOAD_FAST                4 (result)
            1178 PRECALL                  4
            1182 CALL                     4
            1192 STORE_FAST              14 (hook_result)
            1194 JUMP_FORWARD            13 (to 1222)

1574     >> 1196 PUSH_NULL
            1198 LOAD_FAST               10 (hook)
            1200 LOAD_FAST                0 (self)
            1202 LOAD_FAST                1 (args)
            1204 LOAD_FAST                4 (result)
            1206 PRECALL                  3
            1210 CALL                     3
            1220 STORE_FAST              14 (hook_result)

1576     >> 1222 LOAD_FAST               14 (hook_result)
            1224 POP_JUMP_FORWARD_IF_NONE     2 (to 1230)

1577        1226 LOAD_FAST               14 (hook_result)
            1228 STORE_FAST               4 (result)
         >> 1230 JUMP_BACKWARD           86 (to 1060)

1579     >> 1232 LOAD_FAST               13 (bw_hook)
            1234 POP_JUMP_FORWARD_IF_FALSE    90 (to 1416)

1580        1236 LOAD_GLOBAL             37 (NULL + isinstance)
            1248 LOAD_FAST                4 (result)
            1250 LOAD_GLOBAL              0 (torch)
            1262 LOAD_ATTR               29 (Tensor)
            1272 LOAD_GLOBAL             38 (tuple)
            1284 BUILD_TUPLE              2
            1286 PRECALL                  2
            1290 CALL                     2
            1300 POP_JUMP_FORWARD_IF_TRUE    36 (to 1374)

1581        1302 LOAD_GLOBAL             61 (NULL + warnings)
            1314 LOAD_ATTR               31 (warn)
            1324 LOAD_CONST               4 ('For backward hooks to be called, module output should be a Tensor or a tuple of Tensors but received ')

1583        1326 LOAD_GLOBAL             65 (NULL + type)
            1338 LOAD_FAST                4 (result)
            1340 PRECALL                  1
            1344 CALL                     1

1581        1354 FORMAT_VALUE             0
            1356 BUILD_STRING             2
            1358 PRECALL                  1
            1362 CALL                     1
            1372 POP_TOP

1584     >> 1374 LOAD_FAST               13 (bw_hook)
            1376 LOAD_METHOD             33 (setup_output_hook)
            1398 LOAD_FAST                4 (result)
            1400 PRECALL                  1
            1404 CALL                     1
            1414 STORE_FAST               4 (result)

1587     >> 1416 LOAD_FAST                7 (non_full_backward_hooks)
            1418 POP_JUMP_FORWARD_IF_FALSE   199 (to 1818)

1588        1420 LOAD_FAST                4 (result)
            1422 STORE_FAST              15 (var)

1589        1424 LOAD_GLOBAL             37 (NULL + isinstance)
            1436 LOAD_FAST               15 (var)
            1438 LOAD_GLOBAL              0 (torch)
            1450 LOAD_ATTR               29 (Tensor)
            1460 PRECALL                  2
            1464 CALL                     2
            1474 POP_JUMP_FORWARD_IF_TRUE    99 (to 1674)

1590     >> 1476 LOAD_GLOBAL             37 (NULL + isinstance)
            1488 LOAD_FAST               15 (var)
            1490 LOAD_GLOBAL             68 (dict)
            1502 PRECALL                  2
            1506 CALL                     2
            1516 POP_JUMP_FORWARD_IF_FALSE    44 (to 1606)

1591        1518 LOAD_GLOBAL             71 (NULL + next)
            1530 LOAD_CONST               5 (<code object <genexpr> at 0x7facf67909c0, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1591>)
            1532 MAKE_FUNCTION            0
            1534 LOAD_FAST               15 (var)
            1536 LOAD_METHOD             36 (values)
            1558 PRECALL                  0
            1562 CALL                     0
            1572 GET_ITER
            1574 PRECALL                  0
            1578 CALL                     0
            1588 PRECALL                  1
            1592 CALL                     1
            1602 STORE_FAST              15 (var)
            1604 JUMP_FORWARD             8 (to 1622)

1593     >> 1606 LOAD_FAST               15 (var)
            1608 LOAD_CONST               6 (0)
            1610 BINARY_SUBSCR
            1620 STORE_FAST              15 (var)

1589     >> 1622 LOAD_GLOBAL             37 (NULL + isinstance)
            1634 LOAD_FAST               15 (var)
            1636 LOAD_GLOBAL              0 (torch)
            1648 LOAD_ATTR               29 (Tensor)
            1658 PRECALL                  2
            1662 CALL                     2
            1672 POP_JUMP_BACKWARD_IF_FALSE    99 (to 1476)

1594     >> 1674 LOAD_FAST               15 (var)
            1676 LOAD_ATTR               37 (grad_fn)
            1686 STORE_FAST              16 (grad_fn)

1595        1688 LOAD_FAST               16 (grad_fn)
            1690 POP_JUMP_FORWARD_IF_NONE    63 (to 1818)

1596        1692 LOAD_FAST                7 (non_full_backward_hooks)
            1694 GET_ITER
         >> 1696 FOR_ITER                37 (to 1772)
            1698 STORE_FAST              10 (hook)

1597        1700 LOAD_FAST               16 (grad_fn)
            1702 LOAD_METHOD             38 (register_hook)
            1724 LOAD_GLOBAL             79 (NULL + _WrappedHook)
            1736 LOAD_FAST               10 (hook)
            1738 LOAD_FAST                0 (self)
            1740 PRECALL                  2
            1744 CALL                     2
            1754 PRECALL                  1
            1758 CALL                     1
            1768 POP_TOP
            1770 JUMP_BACKWARD           38 (to 1696)

1598     >> 1772 LOAD_FAST                0 (self)
            1774 LOAD_METHOD             40 (_maybe_warn_non_full_backward_hook)
            1796 LOAD_FAST                1 (args)
            1798 LOAD_FAST                4 (result)
            1800 LOAD_FAST               16 (grad_fn)
            1802 PRECALL                  3
            1806 CALL                     3
            1816 POP_TOP

1600     >> 1818 LOAD_FAST                4 (result)
            1820 RETURN_VALUE
         >> 1822 PUSH_EXC_INFO

1602        1824 LOAD_GLOBAL             82 (Exception)
            1836 CHECK_EXC_MATCH
            1838 EXTENDED_ARG             1
            1840 POP_JUMP_FORWARD_IF_FALSE   270 (to 2382)
            1842 POP_TOP

1606        1844 LOAD_GLOBAL             22 (_global_forward_hooks)
            1856 LOAD_METHOD             16 (items)
            1878 PRECALL                  0
            1882 CALL                     0
            1892 GET_ITER
         >> 1894 FOR_ITER                96 (to 2088)
            1896 UNPACK_SEQUENCE          2
            1900 STORE_FAST               9 (hook_id)
            1902 STORE_FAST              10 (hook)

1607        1904 LOAD_FAST                9 (hook_id)
            1906 LOAD_GLOBAL             52 (_global_forward_hooks_always_called)
            1918 CONTAINS_OP              0
            1920 POP_JUMP_FORWARD_IF_FALSE    82 (to 2086)
            1922 LOAD_FAST                9 (hook_id)
            1924 LOAD_FAST                5 (called_always_called_hooks)
            1926 CONTAINS_OP              1
            1928 POP_JUMP_FORWARD_IF_FALSE    78 (to 2086)

1608        1930 NOP

1609        1932 PUSH_NULL
            1934 LOAD_FAST               10 (hook)
            1936 LOAD_FAST                0 (self)
            1938 LOAD_FAST                1 (args)
            1940 LOAD_FAST                4 (result)
            1942 PRECALL                  3
            1946 CALL                     3
            1956 STORE_FAST              14 (hook_result)

1610        1958 LOAD_FAST               14 (hook_result)
            1960 POP_JUMP_FORWARD_IF_NONE     2 (to 1966)

1611        1962 LOAD_FAST               14 (hook_result)
            1964 STORE_FAST               4 (result)
         >> 1966 JUMP_BACKWARD           37 (to 1894)
         >> 1968 PUSH_EXC_INFO

1612        1970 LOAD_GLOBAL             82 (Exception)
            1982 CHECK_EXC_MATCH
            1984 POP_JUMP_FORWARD_IF_FALSE    46 (to 2078)
            1986 STORE_FAST              17 (e)

1613        1988 LOAD_GLOBAL             61 (NULL + warnings)
            2000 LOAD_ATTR               31 (warn)
            2010 LOAD_CONST               7 ('global module forward hook with ``always_call=True`` raised an exception that was silenced as another error was raised in forward: ')

1614        2012 LOAD_GLOBAL             85 (NULL + str)
            2024 LOAD_FAST               17 (e)
            2026 PRECALL                  1
            2030 CALL                     1

1613        2040 FORMAT_VALUE             0
            2042 BUILD_STRING             2
            2044 PRECALL                  1
            2048 CALL                     1
            2058 POP_TOP

1615        2060 POP_EXCEPT
            2062 LOAD_CONST               0 (None)
            2064 STORE_FAST              17 (e)
            2066 DELETE_FAST             17 (e)
            2068 JUMP_BACKWARD           88 (to 1894)
         >> 2070 LOAD_CONST               0 (None)
            2072 STORE_FAST              17 (e)
            2074 DELETE_FAST             17 (e)
            2076 RERAISE                  1

1612     >> 2078 RERAISE                  0
         >> 2080 COPY                     3
            2082 POP_EXCEPT
            2084 RERAISE                  1
         >> 2086 JUMP_BACKWARD           97 (to 1894)

1617     >> 2088 LOAD_FAST                0 (self)
            2090 LOAD_ATTR                7 (_forward_hooks)
            2100 LOAD_METHOD             16 (items)
            2122 PRECALL                  0
            2126 CALL                     0
            2136 GET_ITER
         >> 2138 FOR_ITER               120 (to 2380)
            2140 UNPACK_SEQUENCE          2
            2144 STORE_FAST               9 (hook_id)
            2146 STORE_FAST              10 (hook)

1618        2148 LOAD_FAST                9 (hook_id)
            2150 LOAD_FAST                0 (self)
            2152 LOAD_ATTR               25 (_forward_hooks_always_called)
            2162 CONTAINS_OP              0
            2164 POP_JUMP_FORWARD_IF_FALSE   106 (to 2378)
            2166 LOAD_FAST                9 (hook_id)
            2168 LOAD_FAST                5 (called_always_called_hooks)
            2170 CONTAINS_OP              1
            2172 POP_JUMP_FORWARD_IF_FALSE   102 (to 2378)

1619        2174 NOP

1620        2176 LOAD_FAST                9 (hook_id)
            2178 LOAD_FAST                0 (self)
            2180 LOAD_ATTR               28 (_forward_hooks_with_kwargs)
            2190 CONTAINS_OP              0
            2192 POP_JUMP_FORWARD_IF_FALSE    15 (to 2224)

1621        2194 PUSH_NULL
            2196 LOAD_FAST               10 (hook)
            2198 LOAD_FAST                0 (self)
            2200 LOAD_FAST                1 (args)
            2202 LOAD_FAST                2 (kwargs)
            2204 LOAD_FAST                4 (result)
            2206 PRECALL                  4
            2210 CALL                     4
            2220 STORE_FAST              14 (hook_result)
            2222 JUMP_FORWARD            13 (to 2250)

1623     >> 2224 PUSH_NULL
            2226 LOAD_FAST               10 (hook)
            2228 LOAD_FAST                0 (self)
            2230 LOAD_FAST                1 (args)
            2232 LOAD_FAST                4 (result)
            2234 PRECALL                  3
            2238 CALL                     3
            2248 STORE_FAST              14 (hook_result)

1624     >> 2250 LOAD_FAST               14 (hook_result)
            2252 POP_JUMP_FORWARD_IF_NONE     2 (to 2258)

1625        2254 LOAD_FAST               14 (hook_result)
            2256 STORE_FAST               4 (result)
         >> 2258 JUMP_BACKWARD           61 (to 2138)
         >> 2260 PUSH_EXC_INFO

1626        2262 LOAD_GLOBAL             82 (Exception)
            2274 CHECK_EXC_MATCH
            2276 POP_JUMP_FORWARD_IF_FALSE    46 (to 2370)
            2278 STORE_FAST              17 (e)

1627        2280 LOAD_GLOBAL             61 (NULL + warnings)
            2292 LOAD_ATTR               31 (warn)
            2302 LOAD_CONST               8 ('module forward hook with ``always_call=True`` raised an exception that was silenced as another error was raised in forward: ')

1628        2304 LOAD_GLOBAL             85 (NULL + str)
            2316 LOAD_FAST               17 (e)
            2318 PRECALL                  1
            2322 CALL                     1

1627        2332 FORMAT_VALUE             0
            2334 BUILD_STRING             2
            2336 PRECALL                  1
            2340 CALL                     1
            2350 POP_TOP

1629        2352 POP_EXCEPT
            2354 LOAD_CONST               0 (None)
            2356 STORE_FAST              17 (e)
            2358 DELETE_FAST             17 (e)
            2360 JUMP_BACKWARD          112 (to 2138)
         >> 2362 LOAD_CONST               0 (None)
            2364 STORE_FAST              17 (e)
            2366 DELETE_FAST             17 (e)
            2368 RERAISE                  1

1626     >> 2370 RERAISE                  0
         >> 2372 COPY                     3
            2374 POP_EXCEPT
            2376 RERAISE                  1
         >> 2378 JUMP_BACKWARD          121 (to 2138)

1631     >> 2380 RAISE_VARARGS            0

1602     >> 2382 RERAISE                  0
         >> 2384 COPY                     3
            2386 POP_EXCEPT
            2388 RERAISE                  1
ExceptionTable:
  220 to 1818 -> 1822 [0]
  1822 to 1928 -> 2384 [1] lasti
  1932 to 1964 -> 1968 [2]
  1966 to 1966 -> 2384 [1] lasti
  1968 to 1986 -> 2080 [3] lasti
  1988 to 2058 -> 2070 [3] lasti
  2060 to 2068 -> 2384 [1] lasti
  2070 to 2078 -> 2080 [3] lasti
  2080 to 2172 -> 2384 [1] lasti
  2176 to 2256 -> 2260 [2]
  2258 to 2258 -> 2384 [1] lasti
  2260 to 2278 -> 2372 [3] lasti
  2280 to 2350 -> 2362 [3] lasti
  2352 to 2360 -> 2384 [1] lasti
  2362 to 2370 -> 2372 [3] lasti
  2372 to 2382 -> 2384 [1] lasti
, inlined according skipfiles.MOD_INLINELIST
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1513 in _call_impl (Module._call_impl) (inline depth: 2)
        def _call_impl(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1514 in _call_impl (Module._call_impl) (inline depth: 2)
            forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR _C [TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_METHOD _get_tracing_state [TorchVariable(<module 'torch._C' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/_C.cpython-311-x86_64-linux-gnu.so'>)]
TRACE PRECALL 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method _get_tracing_state of PyCapsule object at 0x7fad61054bd0>)]
TRACE CALL 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method _get_tracing_state of PyCapsule object at 0x7fad61054bd0>)]
TRACE POP_JUMP_FORWARD_IF_FALSE 76 [ConstantVariable(NoneType)]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR forward [NNModuleVariable()]
TRACE STORE_FAST forward_call [UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable())]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 2)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _backward_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _backward_pre_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _forward_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _forward_pre_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1518 in _call_impl (Module._call_impl) (inline depth: 2)
                    or _global_backward_pre_hooks or _global_backward_hooks
TRACE LOAD_GLOBAL _global_backward_pre_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 2)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1518 in _call_impl (Module._call_impl) (inline depth: 2)
                    or _global_backward_pre_hooks or _global_backward_hooks
TRACE LOAD_GLOBAL _global_backward_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 2)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1519 in _call_impl (Module._call_impl) (inline depth: 2)
                    or _global_forward_hooks or _global_forward_pre_hooks):
TRACE LOAD_GLOBAL _global_forward_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 2)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1519 in _call_impl (Module._call_impl) (inline depth: 2)
                    or _global_forward_hooks or _global_forward_pre_hooks):
TRACE LOAD_GLOBAL _global_forward_pre_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 2)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1520 in _call_impl (Module._call_impl) (inline depth: 2)
                return forward_call(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST forward_call [NullVariable]
TRACE LOAD_FAST args [NullVariable, UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable())]
TRACE BUILD_MAP 0 [NullVariable, UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable()), TupleVariable()]
TRACE LOAD_FAST kwargs [NullVariable, UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable()), TupleVariable(), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable()), TupleVariable(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable()), TupleVariable(), ConstDictVariable()]
TRACE inlined call forward from /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1520 in _call_impl (Module._call_impl) (inline depth: 2)
            return forward_call(*args, **kwargs)
                   ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object forward at 0x7facb0a9d8b0, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 37>
 37           0 RESUME                   0

 38           2 LOAD_GLOBAL              1 (NULL + F)
             14 LOAD_ATTR                1 (relu)
             24 LOAD_FAST                0 (self)
             26 LOAD_METHOD              2 (layer1)
             48 LOAD_FAST                1 (embeddings)
             50 PRECALL                  1
             54 CALL                     1
             64 PRECALL                  1
             68 CALL                     1
             78 STORE_FAST               2 (layer1_act)

 39          80 LOAD_GLOBAL              7 (NULL + torch)
             92 LOAD_ATTR                4 (mean)
            102 LOAD_FAST                2 (layer1_act)
            104 LOAD_CONST               1 (0)
            106 KW_NAMES                 2
            108 PRECALL                  2
            112 CALL                     2
            122 STORE_FAST               3 (layer1_mean)

 40         124 LOAD_GLOBAL              7 (NULL + torch)
            136 LOAD_ATTR                5 (sigmoid)
            146 LOAD_FAST                0 (self)
            148 LOAD_METHOD              6 (layer2)
            170 LOAD_FAST                3 (layer1_mean)
            172 PRECALL                  1
            176 CALL                     1
            186 PRECALL                  1
            190 CALL                     1
            200 STORE_FAST               4 (gate)

 41         202 LOAD_GLOBAL              7 (NULL + torch)
            214 LOAD_ATTR                7 (min)
            224 LOAD_FAST                1 (embeddings)
            226 LOAD_CONST               1 (0)
            228 KW_NAMES                 2
            230 PRECALL                  2
            234 CALL                     2
            244 UNPACK_SEQUENCE          2
            248 STORE_FAST               5 (offset)
            250 STORE_FAST               6 (_)

 43         252 LOAD_FAST                5 (offset)
            254 LOAD_FAST                4 (gate)
            256 BINARY_OP                5 (*)
            260 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:37 in forward (BoxOffsetIntersection.forward) (inline depth: 3)
        def forward(self, embeddings):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:38 in forward (BoxOffsetIntersection.forward) (inline depth: 3)
            layer1_act = F.relu(self.layer1(embeddings))
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_METHOD layer1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NNModuleVariable()]
TRACE LOAD_FAST embeddings [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable()]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE FX call l__self___offset_net_layer1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:38 in forward (BoxOffsetIntersection.forward) (inline depth: 3)
        layer1_act = F.relu(self.layer1(embeddings))
                            ~~~~~~~~~~~^^^^^^^^^^^^
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:38 in forward (BoxOffsetIntersection.forward) (inline depth: 3)
        layer1_act = F.relu(self.layer1(embeddings))
                     ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST layer1_act [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:39 in forward (BoxOffsetIntersection.forward) (inline depth: 3)
            layer1_mean = torch.mean(layer1_act, dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR mean [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST layer1_act [NullVariable, TorchInGraphFunctionVariable(<built-in method mean of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method mean of type object at 0x7fad600718a0>), TensorVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method mean of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method mean of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method mean of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE FX call mean from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:39 in forward (BoxOffsetIntersection.forward) (inline depth: 3)
        layer1_mean = torch.mean(layer1_act, dim=0)
                      ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST layer1_mean [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:40 in forward (BoxOffsetIntersection.forward) (inline depth: 3)
            gate = torch.sigmoid(self.layer2(layer1_mean))
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR sigmoid [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>)]
TRACE LOAD_METHOD layer2 [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_FAST layer1_mean [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), NullVariable, NNModuleVariable()]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE FX call l__self___offset_net_layer2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:40 in forward (BoxOffsetIntersection.forward) (inline depth: 3)
        gate = torch.sigmoid(self.layer2(layer1_mean))
                             ~~~~~~~~~~~^^^^^^^^^^^^^
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call sigmoid from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:40 in forward (BoxOffsetIntersection.forward) (inline depth: 3)
        gate = torch.sigmoid(self.layer2(layer1_mean))
               ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST gate [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:41 in forward (BoxOffsetIntersection.forward) (inline depth: 3)
            offset, _ = torch.min(embeddings, dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:41 in forward (BoxOffsetIntersection.forward) (inline depth: 3)
        offset, _ = torch.min(embeddings, dim=0)
                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 2 [NamedTupleVariable()]
TRACE STORE_FAST offset [TensorVariable(), TensorVariable()]
TRACE STORE_FAST _ [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:43 in forward (BoxOffsetIntersection.forward) (inline depth: 3)
            return offset * gate
TRACE LOAD_FAST offset []
TRACE LOAD_FAST gate [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:43 in forward (BoxOffsetIntersection.forward) (inline depth: 3)
        return offset * gate
               ~~~~~~~^~~~~~
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward at 0x7facb0a9d8b0, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 37>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object _call_impl at 0x60bf410, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1513>
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [TupleVariable()]
TRACE STORE_FAST embedding [ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_8 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_6 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_9 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_7 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_4 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 1)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 1)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_5 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing embed_query_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 241 in embed_query_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_22 =====
 <eval_with_key>.427 class GraphModule(torch.nn.Module):
    def forward(self, s0 : torch.SymInt, L_queries_ : torch.Tensor):
        l_queries_ = L_queries_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_queries_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_queries_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_queries_[(slice(None, None, None), 1)]
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  embedding_2 = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_2 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        getitem_3 = l_queries_[(slice(None, None, None), 2)]
        embedding_3 = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem_3);  l__self___entity_embedding = getitem_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like_1 = torch.zeros_like(embedding_3)
        offset_embedding_3 = zeros_like_1.cuda();  zeros_like_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        getitem_4 = l_queries_[(slice(None, None, None), 3)]
        r_embedding_1 = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_4);  getitem_4 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        getitem_5 = l_queries_[(slice(None, None, None), 3)]
        r_offset_embedding_1 = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_5);  getitem_5 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding_3 += r_embedding_1;  embedding_5 = embedding_3;  embedding_3 = r_embedding_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding_3 += r_offset_embedding_1;  offset_embedding_5 = offset_embedding_3;  offset_embedding_3 = r_offset_embedding_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:238, code: embedding = self.center_net(torch.stack(embedding_list))
        stack = torch.stack([embedding_2, embedding_5]);  embedding_2 = embedding_5 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:57, code: layer1_act = F.relu(self.layer1(embeddings)) # (num_conj, dim)
        l__self___center_net_layer1 = self.L__self___center_net_layer1(stack)
        layer1_act = torch.nn.functional.relu(l__self___center_net_layer1);  l__self___center_net_layer1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:58, code: attention = F.softmax(self.layer2(layer1_act), dim=0) # (num_conj, dim)
        l__self___center_net_layer2 = self.L__self___center_net_layer2(layer1_act);  layer1_act = None
        attention = torch.nn.functional.softmax(l__self___center_net_layer2, dim = 0);  l__self___center_net_layer2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:59, code: embedding = torch.sum(attention * embeddings, dim=0)
        mul = attention * stack;  attention = stack = None
        embedding_8 = torch.sum(mul, dim = 0);  mul = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:239, code: offset_embedding = self.offset_net(torch.stack(offset_embedding_list))
        stack_1 = torch.stack([offset_embedding_2, offset_embedding_5]);  offset_embedding_2 = offset_embedding_5 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:38, code: layer1_act = F.relu(self.layer1(embeddings))
        l__self___offset_net_layer1 = self.L__self___offset_net_layer1(stack_1)
        layer1_act_1 = torch.nn.functional.relu(l__self___offset_net_layer1);  l__self___offset_net_layer1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:39, code: layer1_mean = torch.mean(layer1_act, dim=0)
        layer1_mean = torch.mean(layer1_act_1, dim = 0);  layer1_act_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:40, code: gate = torch.sigmoid(self.layer2(layer1_mean))
        l__self___offset_net_layer2 = self.L__self___offset_net_layer2(layer1_mean);  layer1_mean = None
        gate = torch.sigmoid(l__self___offset_net_layer2);  l__self___offset_net_layer2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:41, code: offset, _ = torch.min(embeddings, dim=0)
        min_1 = torch.min(stack_1, dim = 0);  stack_1 = None
        offset = min_1[0];  min_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:43, code: return offset * gate
        offset_embedding_7 = offset * gate;  offset = gate = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        getitem_8 = l_queries_[(slice(None, None, None), 4)]
        r_embedding_2 = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_8);  l__self___relation_embedding = getitem_8 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        getitem_9 = l_queries_[(slice(None, None, None), 4)];  l_queries_ = None
        r_offset_embedding_2 = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_9);  l__self___offset_embedding = getitem_9 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding_8 += r_embedding_2;  embedding_9 = embedding_8;  embedding_8 = r_embedding_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding_7 += r_offset_embedding_2;  offset_embedding_8 = offset_embedding_7;  offset_embedding_7 = r_offset_embedding_2 = None
        return (embedding_9, offset_embedding_8)
        

TRACED GRAPH
 __compiled_fn_22 <eval_with_key>.427 opcode         name                          target                                                           args                                         kwargs
-------------  ----------------------------  ---------------------------------------------------------------  -------------------------------------------  ------------------------------
placeholder    s0                            s0                                                               ()                                           {}
placeholder    l_queries_                    L_queries_                                                       ()                                           {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                           {}
call_function  getitem                       <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 0))   {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                 {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                           {}
call_function  getitem_1                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 1))   {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)              {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                           {}
call_function  getitem_2                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 1))   {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                {'dim': 0, 'index': getitem_2}
call_function  embedding_2                   <built-in function iadd>                                         (embedding, r_embedding)                     {}
call_function  offset_embedding_2            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)       {}
call_function  getitem_3                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 2))   {}
call_function  embedding_3                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                {'dim': 0, 'index': getitem_3}
call_function  zeros_like_1                  <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding_3,)                               {}
call_method    offset_embedding_3            cuda                                                             (zeros_like_1,)                              {}
call_function  getitem_4                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 3))   {}
call_function  r_embedding_1                 <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)              {'dim': 0, 'index': getitem_4}
call_function  getitem_5                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 3))   {}
call_function  r_offset_embedding_1          <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                {'dim': 0, 'index': getitem_5}
call_function  embedding_5                   <built-in function iadd>                                         (embedding_3, r_embedding_1)                 {}
call_function  offset_embedding_5            <built-in function iadd>                                         (offset_embedding_3, r_offset_embedding_1)   {}
call_function  stack                         <built-in method stack of type object at 0x7fad600718a0>         ([embedding_2, embedding_5],)                {}
call_module    l__self___center_net_layer1   L__self___center_net_layer1                                      (stack,)                                     {}
call_function  layer1_act                    <function relu at 0x7facb1c64220>                                (l__self___center_net_layer1,)               {}
call_module    l__self___center_net_layer2   L__self___center_net_layer2                                      (layer1_act,)                                {}
call_function  attention                     <function softmax at 0x7facb1c64a40>                             (l__self___center_net_layer2,)               {'dim': 0}
call_function  mul                           <built-in function mul>                                          (attention, stack)                           {}
call_function  embedding_8                   <built-in method sum of type object at 0x7fad600718a0>           (mul,)                                       {'dim': 0}
call_function  stack_1                       <built-in method stack of type object at 0x7fad600718a0>         ([offset_embedding_2, offset_embedding_5],)  {}
call_module    l__self___offset_net_layer1   L__self___offset_net_layer1                                      (stack_1,)                                   {}
call_function  layer1_act_1                  <function relu at 0x7facb1c64220>                                (l__self___offset_net_layer1,)               {}
call_function  layer1_mean                   <built-in method mean of type object at 0x7fad600718a0>          (layer1_act_1,)                              {'dim': 0}
call_module    l__self___offset_net_layer2   L__self___offset_net_layer2                                      (layer1_mean,)                               {}
call_function  gate                          <built-in method sigmoid of type object at 0x7fad600718a0>       (l__self___offset_net_layer2,)               {}
call_function  min_1                         <built-in method min of type object at 0x7fad600718a0>           (stack_1,)                                   {'dim': 0}
call_function  offset                        <built-in function getitem>                                      (min_1, 0)                                   {}
call_function  offset_embedding_7            <built-in function mul>                                          (offset, gate)                               {}
call_function  getitem_8                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 4))   {}
call_function  r_embedding_2                 <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)              {'dim': 0, 'index': getitem_8}
call_function  getitem_9                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 4))   {}
call_function  r_offset_embedding_2          <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                {'dim': 0, 'index': getitem_9}
call_function  embedding_9                   <built-in function iadd>                                         (embedding_8, r_embedding_2)                 {}
call_function  offset_embedding_8            <built-in function iadd>                                         (offset_embedding_7, r_offset_embedding_2)   {}
output         output                        output                                                           ((embedding_9, offset_embedding_8),)         {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_22 =====
l_queries_: (1, s0)
l_queries_ (concrete): (1, 5)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
embedding_2: (1, 400)
offset_embedding_2: (1, 400)
getitem_3: (1,)
embedding_3: (1, 400)
zeros_like_1: (1, 400)
offset_embedding_3: (1, 400)
getitem_4: (1,)
r_embedding_1: (1, 400)
getitem_5: (1,)
r_offset_embedding_1: (1, 400)
embedding_5: (1, 400)
offset_embedding_5: (1, 400)
stack: (2, 1, 400)
l__self___center_net_layer1: (2, 1, 400)
layer1_act: (2, 1, 400)
l__self___center_net_layer2: (2, 1, 400)
attention: (2, 1, 400)
mul: (2, 1, 400)
embedding_8: (1, 400)
stack_1: (2, 1, 400)
l__self___offset_net_layer1: (2, 1, 400)
layer1_act_1: (2, 1, 400)
layer1_mean: (1, 400)
l__self___offset_net_layer2: (1, 400)
gate: (1, 400)
offset: (1, 400)
offset_embedding_7: (1, 400)
getitem_8: (1,)
r_embedding_2: (1, 400)
getitem_9: (1,)
r_offset_embedding_2: (1, 400)
embedding_9: (1, 400)
offset_embedding_8: (1, 400)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing embed_query_box /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [LazyVariableTracker()]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:210 in embed_query_box (KGReasoning.embed_query_box)
                    all_relation_flag = False
TRACE LOAD_CONST False [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1)]
TRACE STORE_FAST all_relation_flag [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:211 in embed_query_box (KGReasoning.embed_query_box)
                    break
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(str), TupleVariable()], index=1)]
TRACE JUMP_FORWARD 44 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:232 in embed_query_box (KGReasoning.embed_query_box)
                embedding_list = []
TRACE BUILD_LIST 0 []
TRACE STORE_FAST embedding_list [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:233 in embed_query_box (KGReasoning.embed_query_box)
                offset_embedding_list = []
TRACE BUILD_LIST 0 []
TRACE STORE_FAST offset_embedding_list [ListVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:234 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure)):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 930 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:235 in embed_query_box (KGReasoning.embed_query_box)
                    embedding, offset_embedding, idx = self.embed_query_box(queries, query_structure[i], idx)
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), LazyVariableTracker()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker()]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable(), LazyVariableTracker()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), LazyVariableTracker(), TupleVariable(), LazyVariableTracker()]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:235 in embed_query_box (KGReasoning.embed_query_box)
                embedding, offset_embedding, idx = self.embed_query_box(queries, query_structure[i], idx)
                                                   ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=1)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=2), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=2)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=2), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=2), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=2), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=2)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str), ConstantVariable(str)], index=2)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), SliceVariable(), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), TupleVariable()]
create_graph_input L_queries_ L['queries']
wrap_to_fake L['queries'] (1, 5) [<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>] [None, RelaxedUnspecConstraint(warn_only=True)]
bind_symint s0 L['queries'].size()[1]
create_graph_input s0 L['queries'].size()[1]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable()]
TRACE BINARY_OP 13 [ConstantVariable(), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_4 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_4 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable(), TensorVariable()]
TRACE FX call iadd_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable(), TensorVariable()]
TRACE FX call iadd_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), TupleVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:236 in embed_query_box (KGReasoning.embed_query_box)
                    embedding_list.append(embedding)
TRACE LOAD_FAST embedding_list [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ListVariable()]
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:237 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding_list.append(offset_embedding)
TRACE LOAD_FAST offset_embedding_list [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE LOAD_METHOD append [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1), ConstantVariable(NoneType)]
TRACE JUMP_BACKWARD 774 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:234 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure)):
TRACE FOR_ITER 930 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=1)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:235 in embed_query_box (KGReasoning.embed_query_box)
                    embedding, offset_embedding, idx = self.embed_query_box(queries, query_structure[i], idx)
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_METHOD embed_query_box [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NNModuleVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable())]
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable()]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, UserMethodVariable(<function KGReasoning.embed_query_box at 0x7facb05731a0>, NNModuleVariable()), TensorVariable(), TupleVariable(), ConstantVariable(int)]
TRACE inlined call embed_query_box from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:235 in embed_query_box (KGReasoning.embed_query_box)
                embedding, offset_embedding, idx = self.embed_query_box(queries, query_structure[i], idx)
                                                   ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
202           0 RESUME                   0

207           2 LOAD_CONST               1 (True)
              4 STORE_FAST               4 (all_relation_flag)

208           6 LOAD_FAST                2 (query_structure)
              8 LOAD_CONST               2 (-1)
             10 BINARY_SUBSCR
             20 GET_ITER
        >>   22 FOR_ITER                10 (to 44)
             24 STORE_FAST               5 (ele)

209          26 LOAD_FAST                5 (ele)
             28 LOAD_CONST               3 (('r', 'n'))
             30 CONTAINS_OP              1
             32 POP_JUMP_FORWARD_IF_FALSE     4 (to 42)

210          34 LOAD_CONST               4 (False)
             36 STORE_FAST               4 (all_relation_flag)

211          38 POP_TOP
             40 JUMP_FORWARD             1 (to 44)

209     >>   42 JUMP_BACKWARD           11 (to 22)

212     >>   44 LOAD_FAST                4 (all_relation_flag)
             46 EXTENDED_ARG             1
             48 POP_JUMP_FORWARD_IF_FALSE   331 (to 712)

213          50 LOAD_FAST                2 (query_structure)
             52 LOAD_CONST               5 (0)
             54 BINARY_SUBSCR
             64 LOAD_CONST               6 ('e')
             66 COMPARE_OP               2 (==)
             72 POP_JUMP_FORWARD_IF_FALSE   110 (to 294)

214          74 LOAD_GLOBAL              1 (NULL + torch)
             86 LOAD_ATTR                1 (index_select)
             96 LOAD_FAST                0 (self)
             98 LOAD_ATTR                2 (entity_embedding)
            108 LOAD_CONST               5 (0)
            110 LOAD_FAST                1 (queries)
            112 LOAD_CONST               7 (None)
            114 LOAD_CONST               7 (None)
            116 BUILD_SLICE              2
            118 LOAD_FAST                3 (idx)
            120 BUILD_TUPLE              2
            122 BINARY_SUBSCR
            132 KW_NAMES                 8
            134 PRECALL                  3
            138 CALL                     3
            148 STORE_FAST               6 (embedding)

215         150 LOAD_FAST                0 (self)
            152 LOAD_ATTR                3 (use_cuda)
            162 POP_JUMP_FORWARD_IF_FALSE    39 (to 242)

216         164 LOAD_GLOBAL              1 (NULL + torch)
            176 LOAD_ATTR                4 (zeros_like)
            186 LOAD_FAST                6 (embedding)
            188 PRECALL                  1
            192 CALL                     1
            202 LOAD_METHOD              5 (cuda)
            224 PRECALL                  0
            228 CALL                     0
            238 STORE_FAST               7 (offset_embedding)
            240 JUMP_FORWARD            20 (to 282)

218     >>  242 LOAD_GLOBAL              1 (NULL + torch)
            254 LOAD_ATTR                4 (zeros_like)
            264 LOAD_FAST                6 (embedding)
            266 PRECALL                  1
            270 CALL                     1
            280 STORE_FAST               7 (offset_embedding)

219     >>  282 LOAD_FAST                3 (idx)
            284 LOAD_CONST               9 (1)
            286 BINARY_OP               13 (+=)
            290 STORE_FAST               3 (idx)
            292 JUMP_FORWARD            33 (to 360)

221     >>  294 LOAD_FAST                0 (self)
            296 LOAD_METHOD              6 (embed_query_box)
            318 LOAD_FAST                1 (queries)
            320 LOAD_FAST                2 (query_structure)
            322 LOAD_CONST               5 (0)
            324 BINARY_SUBSCR
            334 LOAD_FAST                3 (idx)
            336 PRECALL                  3
            340 CALL                     3
            350 UNPACK_SEQUENCE          3
            354 STORE_FAST               6 (embedding)
            356 STORE_FAST               7 (offset_embedding)
            358 STORE_FAST               3 (idx)

222     >>  360 LOAD_GLOBAL             15 (NULL + range)
            372 LOAD_GLOBAL             17 (NULL + len)
            384 LOAD_FAST                2 (query_structure)
            386 LOAD_CONST               2 (-1)
            388 BINARY_SUBSCR
            398 PRECALL                  1
            402 CALL                     1
            412 PRECALL                  1
            416 CALL                     1
            426 GET_ITER
        >>  428 FOR_ITER               140 (to 710)
            430 STORE_FAST               8 (i)

223         432 LOAD_FAST                2 (query_structure)
            434 LOAD_CONST               2 (-1)
            436 BINARY_SUBSCR
            446 LOAD_FAST                8 (i)
            448 BINARY_SUBSCR
            458 LOAD_CONST              10 ('n')
            460 COMPARE_OP               2 (==)
            466 POP_JUMP_FORWARD_IF_FALSE    10 (to 488)

224         468 LOAD_ASSERTION_ERROR
            470 LOAD_CONST              11 ('box cannot handle queries with negation')
            472 PRECALL                  0
            476 CALL                     0
            486 RAISE_VARARGS            1

226     >>  488 LOAD_GLOBAL              1 (NULL + torch)
            500 LOAD_ATTR                1 (index_select)
            510 LOAD_FAST                0 (self)
            512 LOAD_ATTR                9 (relation_embedding)
            522 LOAD_CONST               5 (0)
            524 LOAD_FAST                1 (queries)
            526 LOAD_CONST               7 (None)
            528 LOAD_CONST               7 (None)
            530 BUILD_SLICE              2
            532 LOAD_FAST                3 (idx)
            534 BUILD_TUPLE              2
            536 BINARY_SUBSCR
            546 KW_NAMES                 8
            548 PRECALL                  3
            552 CALL                     3
            562 STORE_FAST               9 (r_embedding)

227         564 LOAD_GLOBAL              1 (NULL + torch)
            576 LOAD_ATTR                1 (index_select)
            586 LOAD_FAST                0 (self)
            588 LOAD_ATTR               10 (offset_embedding)
            598 LOAD_CONST               5 (0)
            600 LOAD_FAST                1 (queries)
            602 LOAD_CONST               7 (None)
            604 LOAD_CONST               7 (None)
            606 BUILD_SLICE              2
            608 LOAD_FAST                3 (idx)
            610 BUILD_TUPLE              2
            612 BINARY_SUBSCR
            622 KW_NAMES                 8
            624 PRECALL                  3
            628 CALL                     3
            638 STORE_FAST              10 (r_offset_embedding)

228         640 LOAD_FAST                6 (embedding)
            642 LOAD_FAST                9 (r_embedding)
            644 BINARY_OP               13 (+=)
            648 STORE_FAST               6 (embedding)

229         650 LOAD_FAST                7 (offset_embedding)
            652 LOAD_FAST                0 (self)
            654 LOAD_METHOD             11 (func)
            676 LOAD_FAST               10 (r_offset_embedding)
            678 PRECALL                  1
            682 CALL                     1
            692 BINARY_OP               13 (+=)
            696 STORE_FAST               7 (offset_embedding)

230         698 LOAD_FAST                3 (idx)
            700 LOAD_CONST               9 (1)
            702 BINARY_OP               13 (+=)
            706 STORE_FAST               3 (idx)
            708 JUMP_BACKWARD          141 (to 428)

222     >>  710 JUMP_FORWARD           188 (to 1088)

232     >>  712 BUILD_LIST               0
            714 STORE_FAST              11 (embedding_list)

233         716 BUILD_LIST               0
            718 STORE_FAST              12 (offset_embedding_list)

234         720 LOAD_GLOBAL             15 (NULL + range)
            732 LOAD_GLOBAL             17 (NULL + len)
            744 LOAD_FAST                2 (query_structure)
            746 PRECALL                  1
            750 CALL                     1
            760 PRECALL                  1
            764 CALL                     1
            774 GET_ITER
        >>  776 FOR_ITER                77 (to 932)
            778 STORE_FAST               8 (i)

235         780 LOAD_FAST                0 (self)
            782 LOAD_METHOD              6 (embed_query_box)
            804 LOAD_FAST                1 (queries)
            806 LOAD_FAST                2 (query_structure)
            808 LOAD_FAST                8 (i)
            810 BINARY_SUBSCR
            820 LOAD_FAST                3 (idx)
            822 PRECALL                  3
            826 CALL                     3
            836 UNPACK_SEQUENCE          3
            840 STORE_FAST               6 (embedding)
            842 STORE_FAST               7 (offset_embedding)
            844 STORE_FAST               3 (idx)

236         846 LOAD_FAST               11 (embedding_list)
            848 LOAD_METHOD             12 (append)
            870 LOAD_FAST                6 (embedding)
            872 PRECALL                  1
            876 CALL                     1
            886 POP_TOP

237         888 LOAD_FAST               12 (offset_embedding_list)
            890 LOAD_METHOD             12 (append)
            912 LOAD_FAST                7 (offset_embedding)
            914 PRECALL                  1
            918 CALL                     1
            928 POP_TOP
            930 JUMP_BACKWARD           78 (to 776)

238     >>  932 LOAD_FAST                0 (self)
            934 LOAD_METHOD             13 (center_net)
            956 LOAD_GLOBAL              1 (NULL + torch)
            968 LOAD_ATTR               14 (stack)
            978 LOAD_FAST               11 (embedding_list)
            980 PRECALL                  1
            984 CALL                     1
            994 PRECALL                  1
            998 CALL                     1
           1008 STORE_FAST               6 (embedding)

239        1010 LOAD_FAST                0 (self)
           1012 LOAD_METHOD             15 (offset_net)
           1034 LOAD_GLOBAL              1 (NULL + torch)
           1046 LOAD_ATTR               14 (stack)
           1056 LOAD_FAST               12 (offset_embedding_list)
           1058 PRECALL                  1
           1062 CALL                     1
           1072 PRECALL                  1
           1076 CALL                     1
           1086 STORE_FAST               7 (offset_embedding)

241     >> 1088 LOAD_FAST                6 (embedding)
           1090 LOAD_FAST                7 (offset_embedding)
           1092 LOAD_FAST                3 (idx)
           1094 BUILD_TUPLE              3
           1096 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_5 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_5 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable(int)]
TRACE BINARY_OP 13 [ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_6 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_6 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_7 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_7 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_4 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 2)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 2)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_5 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box) (inline depth: 1)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
DONE INLINING <code object embed_query_box at 0x60ae630, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 202>
TRACE UNPACK_SEQUENCE 3 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), TupleVariable()]
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int), TensorVariable(), TensorVariable()]
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int), TensorVariable()]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:236 in embed_query_box (KGReasoning.embed_query_box)
                    embedding_list.append(embedding)
TRACE LOAD_FAST embedding_list [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_METHOD append [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ListVariable()]
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(NoneType)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:237 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding_list.append(offset_embedding)
TRACE LOAD_FAST offset_embedding_list [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE LOAD_METHOD append [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ListVariable()]
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append)]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), NullVariable, GetAttrVariable(ListVariable(), append), TensorVariable()]
TRACE POP_TOP None [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2), ConstantVariable(NoneType)]
TRACE JUMP_BACKWARD 774 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:234 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure)):
TRACE FOR_ITER 930 [ListIteratorVariable([ConstantVariable(int), ConstantVariable(int)], index=2)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:238 in embed_query_box (KGReasoning.embed_query_box)
                embedding = self.center_net(torch.stack(embedding_list))
TRACE LOAD_FAST self []
TRACE LOAD_METHOD center_net [NNModuleVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, NNModuleVariable()]
TRACE LOAD_ATTR stack [NullVariable, NNModuleVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding_list [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>), ListVariable()]
TRACE CALL 1 [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>), ListVariable()]
TRACE FX call stack from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:238 in embed_query_box (KGReasoning.embed_query_box)
            embedding = self.center_net(torch.stack(embedding_list))
                                        ~~~~~~~~~~~^^^^^^^^^^^^^^^^
TRACE PRECALL 1 [NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, NNModuleVariable(), TensorVariable()]
TRACE inlined call _call_impl from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:238 in embed_query_box (KGReasoning.embed_query_box)
            embedding = self.center_net(torch.stack(embedding_list))
                        ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object _call_impl at 0x60bf410, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1513>
1513           0 RESUME                   0

1514           2 LOAD_GLOBAL              0 (torch)
              14 LOAD_ATTR                1 (_C)
              24 LOAD_METHOD              2 (_get_tracing_state)
              46 PRECALL                  0
              50 CALL                     0
              60 POP_JUMP_FORWARD_IF_FALSE     7 (to 76)
              62 LOAD_FAST                0 (self)
              64 LOAD_ATTR                3 (_slow_forward)
              74 JUMP_FORWARD             6 (to 88)
         >>   76 LOAD_FAST                0 (self)
              78 LOAD_ATTR                4 (forward)
         >>   88 STORE_FAST               3 (forward_call)

1517          90 LOAD_FAST                0 (self)
              92 LOAD_ATTR                5 (_backward_hooks)
             102 POP_JUMP_FORWARD_IF_TRUE    57 (to 218)
             104 LOAD_FAST                0 (self)
             106 LOAD_ATTR                6 (_backward_pre_hooks)
             116 POP_JUMP_FORWARD_IF_TRUE    50 (to 218)
             118 LOAD_FAST                0 (self)
             120 LOAD_ATTR                7 (_forward_hooks)
             130 POP_JUMP_FORWARD_IF_TRUE    43 (to 218)
             132 LOAD_FAST                0 (self)
             134 LOAD_ATTR                8 (_forward_pre_hooks)
             144 POP_JUMP_FORWARD_IF_TRUE    36 (to 218)

1518         146 LOAD_GLOBAL             18 (_global_backward_pre_hooks)

1517         158 POP_JUMP_FORWARD_IF_TRUE    29 (to 218)

1518         160 LOAD_GLOBAL             20 (_global_backward_hooks)

1517         172 POP_JUMP_FORWARD_IF_TRUE    22 (to 218)

1519         174 LOAD_GLOBAL             22 (_global_forward_hooks)

1517         186 POP_JUMP_FORWARD_IF_TRUE    15 (to 218)

1519         188 LOAD_GLOBAL             24 (_global_forward_pre_hooks)

1517         200 POP_JUMP_FORWARD_IF_TRUE     8 (to 218)

1520         202 PUSH_NULL
             204 LOAD_FAST                3 (forward_call)
             206 LOAD_FAST                1 (args)
             208 BUILD_MAP                0
             210 LOAD_FAST                2 (kwargs)
             212 DICT_MERGE               1
             214 CALL_FUNCTION_EX         1
             216 RETURN_VALUE

1522     >>  218 NOP

1523         220 LOAD_CONST               0 (None)
             222 STORE_FAST               4 (result)

1524         224 LOAD_GLOBAL             27 (NULL + set)
             236 PRECALL                  0
             240 CALL                     0
             250 STORE_FAST               5 (called_always_called_hooks)

1526         252 BUILD_LIST               0
             254 BUILD_LIST               0
             256 STORE_FAST               7 (non_full_backward_hooks)
             258 STORE_FAST               6 (full_backward_hooks)

1527         260 BUILD_LIST               0
             262 STORE_FAST               8 (backward_pre_hooks)

1528         264 LOAD_FAST                0 (self)
             266 LOAD_ATTR                6 (_backward_pre_hooks)
             276 POP_JUMP_FORWARD_IF_TRUE     7 (to 292)
             278 LOAD_GLOBAL             18 (_global_backward_pre_hooks)
             290 POP_JUMP_FORWARD_IF_FALSE    20 (to 332)

1529     >>  292 LOAD_FAST                0 (self)
             294 LOAD_METHOD             14 (_get_backward_pre_hooks)
             316 PRECALL                  0
             320 CALL                     0
             330 STORE_FAST               8 (backward_pre_hooks)

1531     >>  332 LOAD_FAST                0 (self)
             334 LOAD_ATTR                5 (_backward_hooks)
             344 POP_JUMP_FORWARD_IF_TRUE     7 (to 360)
             346 LOAD_GLOBAL             20 (_global_backward_hooks)
             358 POP_JUMP_FORWARD_IF_FALSE    23 (to 406)

1532     >>  360 LOAD_FAST                0 (self)
             362 LOAD_METHOD             15 (_get_backward_hooks)
             384 PRECALL                  0
             388 CALL                     0
             398 UNPACK_SEQUENCE          2
             402 STORE_FAST               6 (full_backward_hooks)
             404 STORE_FAST               7 (non_full_backward_hooks)

1534     >>  406 LOAD_GLOBAL             24 (_global_forward_pre_hooks)
             418 POP_JUMP_FORWARD_IF_TRUE     7 (to 434)
             420 LOAD_FAST                0 (self)
             422 LOAD_ATTR                8 (_forward_pre_hooks)
             432 POP_JUMP_FORWARD_IF_FALSE   189 (to 812)

1535     >>  434 BUILD_LIST               0

1536         436 LOAD_GLOBAL             24 (_global_forward_pre_hooks)
             448 LOAD_METHOD             16 (items)
             470 PRECALL                  0
             474 CALL                     0

1535         484 LIST_EXTEND              1

1537         486 LOAD_FAST                0 (self)
             488 LOAD_ATTR                8 (_forward_pre_hooks)
             498 LOAD_METHOD             16 (items)
             520 PRECALL                  0
             524 CALL                     0

1535         534 LIST_EXTEND              1
             536 LIST_TO_TUPLE
             538 GET_ITER
         >>  540 FOR_ITER               135 (to 812)
             542 UNPACK_SEQUENCE          2
             546 STORE_FAST               9 (hook_id)
             548 STORE_FAST              10 (hook)

1539         550 LOAD_FAST                9 (hook_id)
             552 LOAD_FAST                0 (self)
             554 LOAD_ATTR               17 (_forward_pre_hooks_with_kwargs)
             564 CONTAINS_OP              0
             566 POP_JUMP_FORWARD_IF_FALSE    81 (to 730)

1540         568 PUSH_NULL
             570 LOAD_FAST               10 (hook)
             572 LOAD_FAST                0 (self)
             574 LOAD_FAST                1 (args)
             576 LOAD_FAST                2 (kwargs)
             578 PRECALL                  3
             582 CALL                     3
             592 STORE_FAST              11 (args_kwargs_result)

1541         594 LOAD_FAST               11 (args_kwargs_result)
             596 POP_JUMP_FORWARD_IF_NONE    65 (to 728)

1542         598 LOAD_GLOBAL             37 (NULL + isinstance)
             610 LOAD_FAST               11 (args_kwargs_result)
             612 LOAD_GLOBAL             38 (tuple)
             624 PRECALL                  2
             628 CALL                     2
             638 POP_JUMP_FORWARD_IF_FALSE    25 (to 690)
             640 LOAD_GLOBAL             41 (NULL + len)
             652 LOAD_FAST               11 (args_kwargs_result)
             654 PRECALL                  1
             658 CALL                     1
             668 LOAD_CONST               1 (2)
             670 COMPARE_OP               2 (==)
             676 POP_JUMP_FORWARD_IF_FALSE     6 (to 690)

1543         678 LOAD_FAST               11 (args_kwargs_result)
             680 UNPACK_SEQUENCE          2
             684 STORE_FAST               1 (args)
             686 STORE_FAST               2 (kwargs)
             688 JUMP_BACKWARD           75 (to 540)

1545     >>  690 LOAD_GLOBAL             43 (NULL + RuntimeError)

1546         702 LOAD_CONST               2 ('forward pre-hook must return None or a tuple of (new_args, new_kwargs), but got ')

1547         704 LOAD_FAST               11 (args_kwargs_result)

1546         706 FORMAT_VALUE             0
             708 LOAD_CONST               3 ('.')
             710 BUILD_STRING             3

1545         712 PRECALL                  1
             716 CALL                     1
             726 RAISE_VARARGS            1

1541     >>  728 JUMP_BACKWARD           95 (to 540)

1550     >>  730 PUSH_NULL
             732 LOAD_FAST               10 (hook)
             734 LOAD_FAST                0 (self)
             736 LOAD_FAST                1 (args)
             738 PRECALL                  2
             742 CALL                     2
             752 STORE_FAST              12 (args_result)

1551         754 LOAD_FAST               12 (args_result)
             756 POP_JUMP_FORWARD_IF_NONE    26 (to 810)

1552         758 LOAD_GLOBAL             37 (NULL + isinstance)
             770 LOAD_FAST               12 (args_result)
             772 LOAD_GLOBAL             38 (tuple)
             784 PRECALL                  2
             788 CALL                     2
             798 POP_JUMP_FORWARD_IF_TRUE     3 (to 806)

1553         800 LOAD_FAST               12 (args_result)
             802 BUILD_TUPLE              1
             804 STORE_FAST              12 (args_result)

1554     >>  806 LOAD_FAST               12 (args_result)
             808 STORE_FAST               1 (args)
         >>  810 JUMP_BACKWARD          136 (to 540)

1556     >>  812 LOAD_CONST               0 (None)
             814 STORE_FAST              13 (bw_hook)

1557         816 LOAD_FAST                6 (full_backward_hooks)
             818 POP_JUMP_FORWARD_IF_TRUE     2 (to 824)
             820 LOAD_FAST                8 (backward_pre_hooks)
             822 POP_JUMP_FORWARD_IF_FALSE    43 (to 910)

1558     >>  824 LOAD_GLOBAL             45 (NULL + hooks)
             836 LOAD_ATTR               23 (BackwardHook)
             846 LOAD_FAST                0 (self)
             848 LOAD_FAST                6 (full_backward_hooks)
             850 LOAD_FAST                8 (backward_pre_hooks)
             852 PRECALL                  3
             856 CALL                     3
             866 STORE_FAST              13 (bw_hook)

1559         868 LOAD_FAST               13 (bw_hook)
             870 LOAD_METHOD             24 (setup_input_hook)
             892 LOAD_FAST                1 (args)
             894 PRECALL                  1
             898 CALL                     1
             908 STORE_FAST               1 (args)

1561     >>  910 PUSH_NULL
             912 LOAD_FAST                3 (forward_call)
             914 LOAD_FAST                1 (args)
             916 BUILD_MAP                0
             918 LOAD_FAST                2 (kwargs)
             920 DICT_MERGE               1
             922 CALL_FUNCTION_EX         1
             924 STORE_FAST               4 (result)

1562         926 LOAD_GLOBAL             22 (_global_forward_hooks)
             938 POP_JUMP_FORWARD_IF_TRUE     7 (to 954)
             940 LOAD_FAST                0 (self)
             942 LOAD_ATTR                7 (_forward_hooks)
             952 POP_JUMP_FORWARD_IF_FALSE   139 (to 1232)

1563     >>  954 BUILD_LIST               0

1564         956 LOAD_GLOBAL             22 (_global_forward_hooks)
             968 LOAD_METHOD             16 (items)
             990 PRECALL                  0
             994 CALL                     0

1563        1004 LIST_EXTEND              1

1565        1006 LOAD_FAST                0 (self)
            1008 LOAD_ATTR                7 (_forward_hooks)
            1018 LOAD_METHOD             16 (items)
            1040 PRECALL                  0
            1044 CALL                     0

1563        1054 LIST_EXTEND              1
            1056 LIST_TO_TUPLE
            1058 GET_ITER
         >> 1060 FOR_ITER                85 (to 1232)
            1062 UNPACK_SEQUENCE          2
            1066 STORE_FAST               9 (hook_id)
            1068 STORE_FAST              10 (hook)

1568        1070 LOAD_FAST                9 (hook_id)
            1072 LOAD_FAST                0 (self)
            1074 LOAD_ATTR               25 (_forward_hooks_always_called)
            1084 CONTAINS_OP              0
            1086 POP_JUMP_FORWARD_IF_TRUE     9 (to 1106)
            1088 LOAD_FAST                9 (hook_id)
            1090 LOAD_GLOBAL             52 (_global_forward_hooks_always_called)
            1102 CONTAINS_OP              0
            1104 POP_JUMP_FORWARD_IF_FALSE    21 (to 1148)

1569     >> 1106 LOAD_FAST                5 (called_always_called_hooks)
            1108 LOAD_METHOD             27 (add)
            1130 LOAD_FAST                9 (hook_id)
            1132 PRECALL                  1
            1136 CALL                     1
            1146 POP_TOP

1571     >> 1148 LOAD_FAST                9 (hook_id)
            1150 LOAD_FAST                0 (self)
            1152 LOAD_ATTR               28 (_forward_hooks_with_kwargs)
            1162 CONTAINS_OP              0
            1164 POP_JUMP_FORWARD_IF_FALSE    15 (to 1196)

1572        1166 PUSH_NULL
            1168 LOAD_FAST               10 (hook)
            1170 LOAD_FAST                0 (self)
            1172 LOAD_FAST                1 (args)
            1174 LOAD_FAST                2 (kwargs)
            1176 LOAD_FAST                4 (result)
            1178 PRECALL                  4
            1182 CALL                     4
            1192 STORE_FAST              14 (hook_result)
            1194 JUMP_FORWARD            13 (to 1222)

1574     >> 1196 PUSH_NULL
            1198 LOAD_FAST               10 (hook)
            1200 LOAD_FAST                0 (self)
            1202 LOAD_FAST                1 (args)
            1204 LOAD_FAST                4 (result)
            1206 PRECALL                  3
            1210 CALL                     3
            1220 STORE_FAST              14 (hook_result)

1576     >> 1222 LOAD_FAST               14 (hook_result)
            1224 POP_JUMP_FORWARD_IF_NONE     2 (to 1230)

1577        1226 LOAD_FAST               14 (hook_result)
            1228 STORE_FAST               4 (result)
         >> 1230 JUMP_BACKWARD           86 (to 1060)

1579     >> 1232 LOAD_FAST               13 (bw_hook)
            1234 POP_JUMP_FORWARD_IF_FALSE    90 (to 1416)

1580        1236 LOAD_GLOBAL             37 (NULL + isinstance)
            1248 LOAD_FAST                4 (result)
            1250 LOAD_GLOBAL              0 (torch)
            1262 LOAD_ATTR               29 (Tensor)
            1272 LOAD_GLOBAL             38 (tuple)
            1284 BUILD_TUPLE              2
            1286 PRECALL                  2
            1290 CALL                     2
            1300 POP_JUMP_FORWARD_IF_TRUE    36 (to 1374)

1581        1302 LOAD_GLOBAL             61 (NULL + warnings)
            1314 LOAD_ATTR               31 (warn)
            1324 LOAD_CONST               4 ('For backward hooks to be called, module output should be a Tensor or a tuple of Tensors but received ')

1583        1326 LOAD_GLOBAL             65 (NULL + type)
            1338 LOAD_FAST                4 (result)
            1340 PRECALL                  1
            1344 CALL                     1

1581        1354 FORMAT_VALUE             0
            1356 BUILD_STRING             2
            1358 PRECALL                  1
            1362 CALL                     1
            1372 POP_TOP

1584     >> 1374 LOAD_FAST               13 (bw_hook)
            1376 LOAD_METHOD             33 (setup_output_hook)
            1398 LOAD_FAST                4 (result)
            1400 PRECALL                  1
            1404 CALL                     1
            1414 STORE_FAST               4 (result)

1587     >> 1416 LOAD_FAST                7 (non_full_backward_hooks)
            1418 POP_JUMP_FORWARD_IF_FALSE   199 (to 1818)

1588        1420 LOAD_FAST                4 (result)
            1422 STORE_FAST              15 (var)

1589        1424 LOAD_GLOBAL             37 (NULL + isinstance)
            1436 LOAD_FAST               15 (var)
            1438 LOAD_GLOBAL              0 (torch)
            1450 LOAD_ATTR               29 (Tensor)
            1460 PRECALL                  2
            1464 CALL                     2
            1474 POP_JUMP_FORWARD_IF_TRUE    99 (to 1674)

1590     >> 1476 LOAD_GLOBAL             37 (NULL + isinstance)
            1488 LOAD_FAST               15 (var)
            1490 LOAD_GLOBAL             68 (dict)
            1502 PRECALL                  2
            1506 CALL                     2
            1516 POP_JUMP_FORWARD_IF_FALSE    44 (to 1606)

1591        1518 LOAD_GLOBAL             71 (NULL + next)
            1530 LOAD_CONST               5 (<code object <genexpr> at 0x7facf67909c0, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1591>)
            1532 MAKE_FUNCTION            0
            1534 LOAD_FAST               15 (var)
            1536 LOAD_METHOD             36 (values)
            1558 PRECALL                  0
            1562 CALL                     0
            1572 GET_ITER
            1574 PRECALL                  0
            1578 CALL                     0
            1588 PRECALL                  1
            1592 CALL                     1
            1602 STORE_FAST              15 (var)
            1604 JUMP_FORWARD             8 (to 1622)

1593     >> 1606 LOAD_FAST               15 (var)
            1608 LOAD_CONST               6 (0)
            1610 BINARY_SUBSCR
            1620 STORE_FAST              15 (var)

1589     >> 1622 LOAD_GLOBAL             37 (NULL + isinstance)
            1634 LOAD_FAST               15 (var)
            1636 LOAD_GLOBAL              0 (torch)
            1648 LOAD_ATTR               29 (Tensor)
            1658 PRECALL                  2
            1662 CALL                     2
            1672 POP_JUMP_BACKWARD_IF_FALSE    99 (to 1476)

1594     >> 1674 LOAD_FAST               15 (var)
            1676 LOAD_ATTR               37 (grad_fn)
            1686 STORE_FAST              16 (grad_fn)

1595        1688 LOAD_FAST               16 (grad_fn)
            1690 POP_JUMP_FORWARD_IF_NONE    63 (to 1818)

1596        1692 LOAD_FAST                7 (non_full_backward_hooks)
            1694 GET_ITER
         >> 1696 FOR_ITER                37 (to 1772)
            1698 STORE_FAST              10 (hook)

1597        1700 LOAD_FAST               16 (grad_fn)
            1702 LOAD_METHOD             38 (register_hook)
            1724 LOAD_GLOBAL             79 (NULL + _WrappedHook)
            1736 LOAD_FAST               10 (hook)
            1738 LOAD_FAST                0 (self)
            1740 PRECALL                  2
            1744 CALL                     2
            1754 PRECALL                  1
            1758 CALL                     1
            1768 POP_TOP
            1770 JUMP_BACKWARD           38 (to 1696)

1598     >> 1772 LOAD_FAST                0 (self)
            1774 LOAD_METHOD             40 (_maybe_warn_non_full_backward_hook)
            1796 LOAD_FAST                1 (args)
            1798 LOAD_FAST                4 (result)
            1800 LOAD_FAST               16 (grad_fn)
            1802 PRECALL                  3
            1806 CALL                     3
            1816 POP_TOP

1600     >> 1818 LOAD_FAST                4 (result)
            1820 RETURN_VALUE
         >> 1822 PUSH_EXC_INFO

1602        1824 LOAD_GLOBAL             82 (Exception)
            1836 CHECK_EXC_MATCH
            1838 EXTENDED_ARG             1
            1840 POP_JUMP_FORWARD_IF_FALSE   270 (to 2382)
            1842 POP_TOP

1606        1844 LOAD_GLOBAL             22 (_global_forward_hooks)
            1856 LOAD_METHOD             16 (items)
            1878 PRECALL                  0
            1882 CALL                     0
            1892 GET_ITER
         >> 1894 FOR_ITER                96 (to 2088)
            1896 UNPACK_SEQUENCE          2
            1900 STORE_FAST               9 (hook_id)
            1902 STORE_FAST              10 (hook)

1607        1904 LOAD_FAST                9 (hook_id)
            1906 LOAD_GLOBAL             52 (_global_forward_hooks_always_called)
            1918 CONTAINS_OP              0
            1920 POP_JUMP_FORWARD_IF_FALSE    82 (to 2086)
            1922 LOAD_FAST                9 (hook_id)
            1924 LOAD_FAST                5 (called_always_called_hooks)
            1926 CONTAINS_OP              1
            1928 POP_JUMP_FORWARD_IF_FALSE    78 (to 2086)

1608        1930 NOP

1609        1932 PUSH_NULL
            1934 LOAD_FAST               10 (hook)
            1936 LOAD_FAST                0 (self)
            1938 LOAD_FAST                1 (args)
            1940 LOAD_FAST                4 (result)
            1942 PRECALL                  3
            1946 CALL                     3
            1956 STORE_FAST              14 (hook_result)

1610        1958 LOAD_FAST               14 (hook_result)
            1960 POP_JUMP_FORWARD_IF_NONE     2 (to 1966)

1611        1962 LOAD_FAST               14 (hook_result)
            1964 STORE_FAST               4 (result)
         >> 1966 JUMP_BACKWARD           37 (to 1894)
         >> 1968 PUSH_EXC_INFO

1612        1970 LOAD_GLOBAL             82 (Exception)
            1982 CHECK_EXC_MATCH
            1984 POP_JUMP_FORWARD_IF_FALSE    46 (to 2078)
            1986 STORE_FAST              17 (e)

1613        1988 LOAD_GLOBAL             61 (NULL + warnings)
            2000 LOAD_ATTR               31 (warn)
            2010 LOAD_CONST               7 ('global module forward hook with ``always_call=True`` raised an exception that was silenced as another error was raised in forward: ')

1614        2012 LOAD_GLOBAL             85 (NULL + str)
            2024 LOAD_FAST               17 (e)
            2026 PRECALL                  1
            2030 CALL                     1

1613        2040 FORMAT_VALUE             0
            2042 BUILD_STRING             2
            2044 PRECALL                  1
            2048 CALL                     1
            2058 POP_TOP

1615        2060 POP_EXCEPT
            2062 LOAD_CONST               0 (None)
            2064 STORE_FAST              17 (e)
            2066 DELETE_FAST             17 (e)
            2068 JUMP_BACKWARD           88 (to 1894)
         >> 2070 LOAD_CONST               0 (None)
            2072 STORE_FAST              17 (e)
            2074 DELETE_FAST             17 (e)
            2076 RERAISE                  1

1612     >> 2078 RERAISE                  0
         >> 2080 COPY                     3
            2082 POP_EXCEPT
            2084 RERAISE                  1
         >> 2086 JUMP_BACKWARD           97 (to 1894)

1617     >> 2088 LOAD_FAST                0 (self)
            2090 LOAD_ATTR                7 (_forward_hooks)
            2100 LOAD_METHOD             16 (items)
            2122 PRECALL                  0
            2126 CALL                     0
            2136 GET_ITER
         >> 2138 FOR_ITER               120 (to 2380)
            2140 UNPACK_SEQUENCE          2
            2144 STORE_FAST               9 (hook_id)
            2146 STORE_FAST              10 (hook)

1618        2148 LOAD_FAST                9 (hook_id)
            2150 LOAD_FAST                0 (self)
            2152 LOAD_ATTR               25 (_forward_hooks_always_called)
            2162 CONTAINS_OP              0
            2164 POP_JUMP_FORWARD_IF_FALSE   106 (to 2378)
            2166 LOAD_FAST                9 (hook_id)
            2168 LOAD_FAST                5 (called_always_called_hooks)
            2170 CONTAINS_OP              1
            2172 POP_JUMP_FORWARD_IF_FALSE   102 (to 2378)

1619        2174 NOP

1620        2176 LOAD_FAST                9 (hook_id)
            2178 LOAD_FAST                0 (self)
            2180 LOAD_ATTR               28 (_forward_hooks_with_kwargs)
            2190 CONTAINS_OP              0
            2192 POP_JUMP_FORWARD_IF_FALSE    15 (to 2224)

1621        2194 PUSH_NULL
            2196 LOAD_FAST               10 (hook)
            2198 LOAD_FAST                0 (self)
            2200 LOAD_FAST                1 (args)
            2202 LOAD_FAST                2 (kwargs)
            2204 LOAD_FAST                4 (result)
            2206 PRECALL                  4
            2210 CALL                     4
            2220 STORE_FAST              14 (hook_result)
            2222 JUMP_FORWARD            13 (to 2250)

1623     >> 2224 PUSH_NULL
            2226 LOAD_FAST               10 (hook)
            2228 LOAD_FAST                0 (self)
            2230 LOAD_FAST                1 (args)
            2232 LOAD_FAST                4 (result)
            2234 PRECALL                  3
            2238 CALL                     3
            2248 STORE_FAST              14 (hook_result)

1624     >> 2250 LOAD_FAST               14 (hook_result)
            2252 POP_JUMP_FORWARD_IF_NONE     2 (to 2258)

1625        2254 LOAD_FAST               14 (hook_result)
            2256 STORE_FAST               4 (result)
         >> 2258 JUMP_BACKWARD           61 (to 2138)
         >> 2260 PUSH_EXC_INFO

1626        2262 LOAD_GLOBAL             82 (Exception)
            2274 CHECK_EXC_MATCH
            2276 POP_JUMP_FORWARD_IF_FALSE    46 (to 2370)
            2278 STORE_FAST              17 (e)

1627        2280 LOAD_GLOBAL             61 (NULL + warnings)
            2292 LOAD_ATTR               31 (warn)
            2302 LOAD_CONST               8 ('module forward hook with ``always_call=True`` raised an exception that was silenced as another error was raised in forward: ')

1628        2304 LOAD_GLOBAL             85 (NULL + str)
            2316 LOAD_FAST               17 (e)
            2318 PRECALL                  1
            2322 CALL                     1

1627        2332 FORMAT_VALUE             0
            2334 BUILD_STRING             2
            2336 PRECALL                  1
            2340 CALL                     1
            2350 POP_TOP

1629        2352 POP_EXCEPT
            2354 LOAD_CONST               0 (None)
            2356 STORE_FAST              17 (e)
            2358 DELETE_FAST             17 (e)
            2360 JUMP_BACKWARD          112 (to 2138)
         >> 2362 LOAD_CONST               0 (None)
            2364 STORE_FAST              17 (e)
            2366 DELETE_FAST             17 (e)
            2368 RERAISE                  1

1626     >> 2370 RERAISE                  0
         >> 2372 COPY                     3
            2374 POP_EXCEPT
            2376 RERAISE                  1
         >> 2378 JUMP_BACKWARD          121 (to 2138)

1631     >> 2380 RAISE_VARARGS            0

1602     >> 2382 RERAISE                  0
         >> 2384 COPY                     3
            2386 POP_EXCEPT
            2388 RERAISE                  1
ExceptionTable:
  220 to 1818 -> 1822 [0]
  1822 to 1928 -> 2384 [1] lasti
  1932 to 1964 -> 1968 [2]
  1966 to 1966 -> 2384 [1] lasti
  1968 to 1986 -> 2080 [3] lasti
  1988 to 2058 -> 2070 [3] lasti
  2060 to 2068 -> 2384 [1] lasti
  2070 to 2078 -> 2080 [3] lasti
  2080 to 2172 -> 2384 [1] lasti
  2176 to 2256 -> 2260 [2]
  2258 to 2258 -> 2384 [1] lasti
  2260 to 2278 -> 2372 [3] lasti
  2280 to 2350 -> 2362 [3] lasti
  2352 to 2360 -> 2384 [1] lasti
  2362 to 2370 -> 2372 [3] lasti
  2372 to 2382 -> 2384 [1] lasti
, inlined according skipfiles.MOD_INLINELIST
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1513 in _call_impl (Module._call_impl) (inline depth: 1)
        def _call_impl(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1514 in _call_impl (Module._call_impl) (inline depth: 1)
            forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR _C [TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_METHOD _get_tracing_state [TorchVariable(<module 'torch._C' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/_C.cpython-311-x86_64-linux-gnu.so'>)]
TRACE PRECALL 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method _get_tracing_state of PyCapsule object at 0x7fad61054bd0>)]
TRACE CALL 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method _get_tracing_state of PyCapsule object at 0x7fad61054bd0>)]
TRACE POP_JUMP_FORWARD_IF_FALSE 76 [ConstantVariable(NoneType)]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR forward [NNModuleVariable()]
TRACE STORE_FAST forward_call [UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable())]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _backward_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _backward_pre_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _forward_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _forward_pre_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1518 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_backward_pre_hooks or _global_backward_hooks
TRACE LOAD_GLOBAL _global_backward_pre_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1518 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_backward_pre_hooks or _global_backward_hooks
TRACE LOAD_GLOBAL _global_backward_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1519 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_forward_hooks or _global_forward_pre_hooks):
TRACE LOAD_GLOBAL _global_forward_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1519 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_forward_hooks or _global_forward_pre_hooks):
TRACE LOAD_GLOBAL _global_forward_pre_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1520 in _call_impl (Module._call_impl) (inline depth: 1)
                return forward_call(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST forward_call [NullVariable]
TRACE LOAD_FAST args [NullVariable, UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable())]
TRACE BUILD_MAP 0 [NullVariable, UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable()), TupleVariable()]
TRACE LOAD_FAST kwargs [NullVariable, UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable()), TupleVariable(), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable()), TupleVariable(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, UserMethodVariable(<function CenterIntersection.forward at 0x7facb0572c00>, NNModuleVariable()), TupleVariable(), ConstDictVariable()]
TRACE inlined call forward from /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1520 in _call_impl (Module._call_impl) (inline depth: 1)
            return forward_call(*args, **kwargs)
                   ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object forward at 0x7facb06ca420, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 56>
 56           0 RESUME                   0

 57           2 LOAD_GLOBAL              1 (NULL + F)
             14 LOAD_ATTR                1 (relu)
             24 LOAD_FAST                0 (self)
             26 LOAD_METHOD              2 (layer1)
             48 LOAD_FAST                1 (embeddings)
             50 PRECALL                  1
             54 CALL                     1
             64 PRECALL                  1
             68 CALL                     1
             78 STORE_FAST               2 (layer1_act)

 58          80 LOAD_GLOBAL              1 (NULL + F)
             92 LOAD_ATTR                3 (softmax)
            102 LOAD_FAST                0 (self)
            104 LOAD_METHOD              4 (layer2)
            126 LOAD_FAST                2 (layer1_act)
            128 PRECALL                  1
            132 CALL                     1
            142 LOAD_CONST               1 (0)
            144 KW_NAMES                 2
            146 PRECALL                  2
            150 CALL                     2
            160 STORE_FAST               3 (attention)

 59         162 LOAD_GLOBAL             11 (NULL + torch)
            174 LOAD_ATTR                6 (sum)
            184 LOAD_FAST                3 (attention)
            186 LOAD_FAST                1 (embeddings)
            188 BINARY_OP                5 (*)
            192 LOAD_CONST               1 (0)
            194 KW_NAMES                 2
            196 PRECALL                  2
            200 CALL                     2
            210 STORE_FAST               4 (embedding)

 61         212 LOAD_FAST                4 (embedding)
            214 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:56 in forward (CenterIntersection.forward) (inline depth: 2)
        def forward(self, embeddings):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:57 in forward (CenterIntersection.forward) (inline depth: 2)
            layer1_act = F.relu(self.layer1(embeddings)) # (num_conj, dim)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_METHOD layer1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NNModuleVariable()]
TRACE LOAD_FAST embeddings [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable()]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE FX call l__self___center_net_layer1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:57 in forward (CenterIntersection.forward) (inline depth: 2)
        layer1_act = F.relu(self.layer1(embeddings)) # (num_conj, dim)
                            ~~~~~~~~~~~^^^^^^^^^^^^
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:57 in forward (CenterIntersection.forward) (inline depth: 2)
        layer1_act = F.relu(self.layer1(embeddings)) # (num_conj, dim)
                     ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST layer1_act [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:58 in forward (CenterIntersection.forward) (inline depth: 2)
            attention = F.softmax(self.layer2(layer1_act), dim=0) # (num_conj, dim)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR softmax [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>)]
TRACE LOAD_METHOD layer2 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), NNModuleVariable()]
TRACE LOAD_FAST layer1_act [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), NullVariable, NNModuleVariable()]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE FX call l__self___center_net_layer2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:58 in forward (CenterIntersection.forward) (inline depth: 2)
        attention = F.softmax(self.layer2(layer1_act), dim=0) # (num_conj, dim)
                              ~~~~~~~~~~~^^^^^^^^^^^^
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), TensorVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), TensorVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), TensorVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<function softmax at 0x7facb1c64a40>), TensorVariable(), ConstantVariable(int)]
TRACE FX call softmax from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:58 in forward (CenterIntersection.forward) (inline depth: 2)
        attention = F.softmax(self.layer2(layer1_act), dim=0) # (num_conj, dim)
                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST attention [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:59 in forward (CenterIntersection.forward) (inline depth: 2)
            embedding = torch.sum(attention * embeddings, dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR sum [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST attention [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable()]
TRACE BINARY_OP 5 [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:59 in forward (CenterIntersection.forward) (inline depth: 2)
        embedding = torch.sum(attention * embeddings, dim=0)
                              ~~~~~~~~~~^~~~~~~~~~~~
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method sum of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE FX call sum_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:59 in forward (CenterIntersection.forward) (inline depth: 2)
        embedding = torch.sum(attention * embeddings, dim=0)
                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:61 in forward (CenterIntersection.forward) (inline depth: 2)
            return embedding
TRACE LOAD_FAST embedding []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward at 0x7facb06ca420, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 56>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object _call_impl at 0x60bf410, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1513>
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:239 in embed_query_box (KGReasoning.embed_query_box)
                offset_embedding = self.offset_net(torch.stack(offset_embedding_list))
TRACE LOAD_FAST self []
TRACE LOAD_METHOD offset_net [NNModuleVariable()]
TRACE LOAD_GLOBAL torch [NullVariable, NNModuleVariable()]
TRACE LOAD_ATTR stack [NullVariable, NNModuleVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST offset_embedding_list [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>), ListVariable()]
TRACE CALL 1 [NullVariable, NNModuleVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method stack of type object at 0x7fad600718a0>), ListVariable()]
TRACE FX call stack_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:239 in embed_query_box (KGReasoning.embed_query_box)
            offset_embedding = self.offset_net(torch.stack(offset_embedding_list))
                                               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TRACE PRECALL 1 [NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, NNModuleVariable(), TensorVariable()]
TRACE inlined call _call_impl from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:239 in embed_query_box (KGReasoning.embed_query_box)
            offset_embedding = self.offset_net(torch.stack(offset_embedding_list))
                               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INLINING <code object _call_impl at 0x60bf410, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1513>
1513           0 RESUME                   0

1514           2 LOAD_GLOBAL              0 (torch)
              14 LOAD_ATTR                1 (_C)
              24 LOAD_METHOD              2 (_get_tracing_state)
              46 PRECALL                  0
              50 CALL                     0
              60 POP_JUMP_FORWARD_IF_FALSE     7 (to 76)
              62 LOAD_FAST                0 (self)
              64 LOAD_ATTR                3 (_slow_forward)
              74 JUMP_FORWARD             6 (to 88)
         >>   76 LOAD_FAST                0 (self)
              78 LOAD_ATTR                4 (forward)
         >>   88 STORE_FAST               3 (forward_call)

1517          90 LOAD_FAST                0 (self)
              92 LOAD_ATTR                5 (_backward_hooks)
             102 POP_JUMP_FORWARD_IF_TRUE    57 (to 218)
             104 LOAD_FAST                0 (self)
             106 LOAD_ATTR                6 (_backward_pre_hooks)
             116 POP_JUMP_FORWARD_IF_TRUE    50 (to 218)
             118 LOAD_FAST                0 (self)
             120 LOAD_ATTR                7 (_forward_hooks)
             130 POP_JUMP_FORWARD_IF_TRUE    43 (to 218)
             132 LOAD_FAST                0 (self)
             134 LOAD_ATTR                8 (_forward_pre_hooks)
             144 POP_JUMP_FORWARD_IF_TRUE    36 (to 218)

1518         146 LOAD_GLOBAL             18 (_global_backward_pre_hooks)

1517         158 POP_JUMP_FORWARD_IF_TRUE    29 (to 218)

1518         160 LOAD_GLOBAL             20 (_global_backward_hooks)

1517         172 POP_JUMP_FORWARD_IF_TRUE    22 (to 218)

1519         174 LOAD_GLOBAL             22 (_global_forward_hooks)

1517         186 POP_JUMP_FORWARD_IF_TRUE    15 (to 218)

1519         188 LOAD_GLOBAL             24 (_global_forward_pre_hooks)

1517         200 POP_JUMP_FORWARD_IF_TRUE     8 (to 218)

1520         202 PUSH_NULL
             204 LOAD_FAST                3 (forward_call)
             206 LOAD_FAST                1 (args)
             208 BUILD_MAP                0
             210 LOAD_FAST                2 (kwargs)
             212 DICT_MERGE               1
             214 CALL_FUNCTION_EX         1
             216 RETURN_VALUE

1522     >>  218 NOP

1523         220 LOAD_CONST               0 (None)
             222 STORE_FAST               4 (result)

1524         224 LOAD_GLOBAL             27 (NULL + set)
             236 PRECALL                  0
             240 CALL                     0
             250 STORE_FAST               5 (called_always_called_hooks)

1526         252 BUILD_LIST               0
             254 BUILD_LIST               0
             256 STORE_FAST               7 (non_full_backward_hooks)
             258 STORE_FAST               6 (full_backward_hooks)

1527         260 BUILD_LIST               0
             262 STORE_FAST               8 (backward_pre_hooks)

1528         264 LOAD_FAST                0 (self)
             266 LOAD_ATTR                6 (_backward_pre_hooks)
             276 POP_JUMP_FORWARD_IF_TRUE     7 (to 292)
             278 LOAD_GLOBAL             18 (_global_backward_pre_hooks)
             290 POP_JUMP_FORWARD_IF_FALSE    20 (to 332)

1529     >>  292 LOAD_FAST                0 (self)
             294 LOAD_METHOD             14 (_get_backward_pre_hooks)
             316 PRECALL                  0
             320 CALL                     0
             330 STORE_FAST               8 (backward_pre_hooks)

1531     >>  332 LOAD_FAST                0 (self)
             334 LOAD_ATTR                5 (_backward_hooks)
             344 POP_JUMP_FORWARD_IF_TRUE     7 (to 360)
             346 LOAD_GLOBAL             20 (_global_backward_hooks)
             358 POP_JUMP_FORWARD_IF_FALSE    23 (to 406)

1532     >>  360 LOAD_FAST                0 (self)
             362 LOAD_METHOD             15 (_get_backward_hooks)
             384 PRECALL                  0
             388 CALL                     0
             398 UNPACK_SEQUENCE          2
             402 STORE_FAST               6 (full_backward_hooks)
             404 STORE_FAST               7 (non_full_backward_hooks)

1534     >>  406 LOAD_GLOBAL             24 (_global_forward_pre_hooks)
             418 POP_JUMP_FORWARD_IF_TRUE     7 (to 434)
             420 LOAD_FAST                0 (self)
             422 LOAD_ATTR                8 (_forward_pre_hooks)
             432 POP_JUMP_FORWARD_IF_FALSE   189 (to 812)

1535     >>  434 BUILD_LIST               0

1536         436 LOAD_GLOBAL             24 (_global_forward_pre_hooks)
             448 LOAD_METHOD             16 (items)
             470 PRECALL                  0
             474 CALL                     0

1535         484 LIST_EXTEND              1

1537         486 LOAD_FAST                0 (self)
             488 LOAD_ATTR                8 (_forward_pre_hooks)
             498 LOAD_METHOD             16 (items)
             520 PRECALL                  0
             524 CALL                     0

1535         534 LIST_EXTEND              1
             536 LIST_TO_TUPLE
             538 GET_ITER
         >>  540 FOR_ITER               135 (to 812)
             542 UNPACK_SEQUENCE          2
             546 STORE_FAST               9 (hook_id)
             548 STORE_FAST              10 (hook)

1539         550 LOAD_FAST                9 (hook_id)
             552 LOAD_FAST                0 (self)
             554 LOAD_ATTR               17 (_forward_pre_hooks_with_kwargs)
             564 CONTAINS_OP              0
             566 POP_JUMP_FORWARD_IF_FALSE    81 (to 730)

1540         568 PUSH_NULL
             570 LOAD_FAST               10 (hook)
             572 LOAD_FAST                0 (self)
             574 LOAD_FAST                1 (args)
             576 LOAD_FAST                2 (kwargs)
             578 PRECALL                  3
             582 CALL                     3
             592 STORE_FAST              11 (args_kwargs_result)

1541         594 LOAD_FAST               11 (args_kwargs_result)
             596 POP_JUMP_FORWARD_IF_NONE    65 (to 728)

1542         598 LOAD_GLOBAL             37 (NULL + isinstance)
             610 LOAD_FAST               11 (args_kwargs_result)
             612 LOAD_GLOBAL             38 (tuple)
             624 PRECALL                  2
             628 CALL                     2
             638 POP_JUMP_FORWARD_IF_FALSE    25 (to 690)
             640 LOAD_GLOBAL             41 (NULL + len)
             652 LOAD_FAST               11 (args_kwargs_result)
             654 PRECALL                  1
             658 CALL                     1
             668 LOAD_CONST               1 (2)
             670 COMPARE_OP               2 (==)
             676 POP_JUMP_FORWARD_IF_FALSE     6 (to 690)

1543         678 LOAD_FAST               11 (args_kwargs_result)
             680 UNPACK_SEQUENCE          2
             684 STORE_FAST               1 (args)
             686 STORE_FAST               2 (kwargs)
             688 JUMP_BACKWARD           75 (to 540)

1545     >>  690 LOAD_GLOBAL             43 (NULL + RuntimeError)

1546         702 LOAD_CONST               2 ('forward pre-hook must return None or a tuple of (new_args, new_kwargs), but got ')

1547         704 LOAD_FAST               11 (args_kwargs_result)

1546         706 FORMAT_VALUE             0
             708 LOAD_CONST               3 ('.')
             710 BUILD_STRING             3

1545         712 PRECALL                  1
             716 CALL                     1
             726 RAISE_VARARGS            1

1541     >>  728 JUMP_BACKWARD           95 (to 540)

1550     >>  730 PUSH_NULL
             732 LOAD_FAST               10 (hook)
             734 LOAD_FAST                0 (self)
             736 LOAD_FAST                1 (args)
             738 PRECALL                  2
             742 CALL                     2
             752 STORE_FAST              12 (args_result)

1551         754 LOAD_FAST               12 (args_result)
             756 POP_JUMP_FORWARD_IF_NONE    26 (to 810)

1552         758 LOAD_GLOBAL             37 (NULL + isinstance)
             770 LOAD_FAST               12 (args_result)
             772 LOAD_GLOBAL             38 (tuple)
             784 PRECALL                  2
             788 CALL                     2
             798 POP_JUMP_FORWARD_IF_TRUE     3 (to 806)

1553         800 LOAD_FAST               12 (args_result)
             802 BUILD_TUPLE              1
             804 STORE_FAST              12 (args_result)

1554     >>  806 LOAD_FAST               12 (args_result)
             808 STORE_FAST               1 (args)
         >>  810 JUMP_BACKWARD          136 (to 540)

1556     >>  812 LOAD_CONST               0 (None)
             814 STORE_FAST              13 (bw_hook)

1557         816 LOAD_FAST                6 (full_backward_hooks)
             818 POP_JUMP_FORWARD_IF_TRUE     2 (to 824)
             820 LOAD_FAST                8 (backward_pre_hooks)
             822 POP_JUMP_FORWARD_IF_FALSE    43 (to 910)

1558     >>  824 LOAD_GLOBAL             45 (NULL + hooks)
             836 LOAD_ATTR               23 (BackwardHook)
             846 LOAD_FAST                0 (self)
             848 LOAD_FAST                6 (full_backward_hooks)
             850 LOAD_FAST                8 (backward_pre_hooks)
             852 PRECALL                  3
             856 CALL                     3
             866 STORE_FAST              13 (bw_hook)

1559         868 LOAD_FAST               13 (bw_hook)
             870 LOAD_METHOD             24 (setup_input_hook)
             892 LOAD_FAST                1 (args)
             894 PRECALL                  1
             898 CALL                     1
             908 STORE_FAST               1 (args)

1561     >>  910 PUSH_NULL
             912 LOAD_FAST                3 (forward_call)
             914 LOAD_FAST                1 (args)
             916 BUILD_MAP                0
             918 LOAD_FAST                2 (kwargs)
             920 DICT_MERGE               1
             922 CALL_FUNCTION_EX         1
             924 STORE_FAST               4 (result)

1562         926 LOAD_GLOBAL             22 (_global_forward_hooks)
             938 POP_JUMP_FORWARD_IF_TRUE     7 (to 954)
             940 LOAD_FAST                0 (self)
             942 LOAD_ATTR                7 (_forward_hooks)
             952 POP_JUMP_FORWARD_IF_FALSE   139 (to 1232)

1563     >>  954 BUILD_LIST               0

1564         956 LOAD_GLOBAL             22 (_global_forward_hooks)
             968 LOAD_METHOD             16 (items)
             990 PRECALL                  0
             994 CALL                     0

1563        1004 LIST_EXTEND              1

1565        1006 LOAD_FAST                0 (self)
            1008 LOAD_ATTR                7 (_forward_hooks)
            1018 LOAD_METHOD             16 (items)
            1040 PRECALL                  0
            1044 CALL                     0

1563        1054 LIST_EXTEND              1
            1056 LIST_TO_TUPLE
            1058 GET_ITER
         >> 1060 FOR_ITER                85 (to 1232)
            1062 UNPACK_SEQUENCE          2
            1066 STORE_FAST               9 (hook_id)
            1068 STORE_FAST              10 (hook)

1568        1070 LOAD_FAST                9 (hook_id)
            1072 LOAD_FAST                0 (self)
            1074 LOAD_ATTR               25 (_forward_hooks_always_called)
            1084 CONTAINS_OP              0
            1086 POP_JUMP_FORWARD_IF_TRUE     9 (to 1106)
            1088 LOAD_FAST                9 (hook_id)
            1090 LOAD_GLOBAL             52 (_global_forward_hooks_always_called)
            1102 CONTAINS_OP              0
            1104 POP_JUMP_FORWARD_IF_FALSE    21 (to 1148)

1569     >> 1106 LOAD_FAST                5 (called_always_called_hooks)
            1108 LOAD_METHOD             27 (add)
            1130 LOAD_FAST                9 (hook_id)
            1132 PRECALL                  1
            1136 CALL                     1
            1146 POP_TOP

1571     >> 1148 LOAD_FAST                9 (hook_id)
            1150 LOAD_FAST                0 (self)
            1152 LOAD_ATTR               28 (_forward_hooks_with_kwargs)
            1162 CONTAINS_OP              0
            1164 POP_JUMP_FORWARD_IF_FALSE    15 (to 1196)

1572        1166 PUSH_NULL
            1168 LOAD_FAST               10 (hook)
            1170 LOAD_FAST                0 (self)
            1172 LOAD_FAST                1 (args)
            1174 LOAD_FAST                2 (kwargs)
            1176 LOAD_FAST                4 (result)
            1178 PRECALL                  4
            1182 CALL                     4
            1192 STORE_FAST              14 (hook_result)
            1194 JUMP_FORWARD            13 (to 1222)

1574     >> 1196 PUSH_NULL
            1198 LOAD_FAST               10 (hook)
            1200 LOAD_FAST                0 (self)
            1202 LOAD_FAST                1 (args)
            1204 LOAD_FAST                4 (result)
            1206 PRECALL                  3
            1210 CALL                     3
            1220 STORE_FAST              14 (hook_result)

1576     >> 1222 LOAD_FAST               14 (hook_result)
            1224 POP_JUMP_FORWARD_IF_NONE     2 (to 1230)

1577        1226 LOAD_FAST               14 (hook_result)
            1228 STORE_FAST               4 (result)
         >> 1230 JUMP_BACKWARD           86 (to 1060)

1579     >> 1232 LOAD_FAST               13 (bw_hook)
            1234 POP_JUMP_FORWARD_IF_FALSE    90 (to 1416)

1580        1236 LOAD_GLOBAL             37 (NULL + isinstance)
            1248 LOAD_FAST                4 (result)
            1250 LOAD_GLOBAL              0 (torch)
            1262 LOAD_ATTR               29 (Tensor)
            1272 LOAD_GLOBAL             38 (tuple)
            1284 BUILD_TUPLE              2
            1286 PRECALL                  2
            1290 CALL                     2
            1300 POP_JUMP_FORWARD_IF_TRUE    36 (to 1374)

1581        1302 LOAD_GLOBAL             61 (NULL + warnings)
            1314 LOAD_ATTR               31 (warn)
            1324 LOAD_CONST               4 ('For backward hooks to be called, module output should be a Tensor or a tuple of Tensors but received ')

1583        1326 LOAD_GLOBAL             65 (NULL + type)
            1338 LOAD_FAST                4 (result)
            1340 PRECALL                  1
            1344 CALL                     1

1581        1354 FORMAT_VALUE             0
            1356 BUILD_STRING             2
            1358 PRECALL                  1
            1362 CALL                     1
            1372 POP_TOP

1584     >> 1374 LOAD_FAST               13 (bw_hook)
            1376 LOAD_METHOD             33 (setup_output_hook)
            1398 LOAD_FAST                4 (result)
            1400 PRECALL                  1
            1404 CALL                     1
            1414 STORE_FAST               4 (result)

1587     >> 1416 LOAD_FAST                7 (non_full_backward_hooks)
            1418 POP_JUMP_FORWARD_IF_FALSE   199 (to 1818)

1588        1420 LOAD_FAST                4 (result)
            1422 STORE_FAST              15 (var)

1589        1424 LOAD_GLOBAL             37 (NULL + isinstance)
            1436 LOAD_FAST               15 (var)
            1438 LOAD_GLOBAL              0 (torch)
            1450 LOAD_ATTR               29 (Tensor)
            1460 PRECALL                  2
            1464 CALL                     2
            1474 POP_JUMP_FORWARD_IF_TRUE    99 (to 1674)

1590     >> 1476 LOAD_GLOBAL             37 (NULL + isinstance)
            1488 LOAD_FAST               15 (var)
            1490 LOAD_GLOBAL             68 (dict)
            1502 PRECALL                  2
            1506 CALL                     2
            1516 POP_JUMP_FORWARD_IF_FALSE    44 (to 1606)

1591        1518 LOAD_GLOBAL             71 (NULL + next)
            1530 LOAD_CONST               5 (<code object <genexpr> at 0x7facf67909c0, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1591>)
            1532 MAKE_FUNCTION            0
            1534 LOAD_FAST               15 (var)
            1536 LOAD_METHOD             36 (values)
            1558 PRECALL                  0
            1562 CALL                     0
            1572 GET_ITER
            1574 PRECALL                  0
            1578 CALL                     0
            1588 PRECALL                  1
            1592 CALL                     1
            1602 STORE_FAST              15 (var)
            1604 JUMP_FORWARD             8 (to 1622)

1593     >> 1606 LOAD_FAST               15 (var)
            1608 LOAD_CONST               6 (0)
            1610 BINARY_SUBSCR
            1620 STORE_FAST              15 (var)

1589     >> 1622 LOAD_GLOBAL             37 (NULL + isinstance)
            1634 LOAD_FAST               15 (var)
            1636 LOAD_GLOBAL              0 (torch)
            1648 LOAD_ATTR               29 (Tensor)
            1658 PRECALL                  2
            1662 CALL                     2
            1672 POP_JUMP_BACKWARD_IF_FALSE    99 (to 1476)

1594     >> 1674 LOAD_FAST               15 (var)
            1676 LOAD_ATTR               37 (grad_fn)
            1686 STORE_FAST              16 (grad_fn)

1595        1688 LOAD_FAST               16 (grad_fn)
            1690 POP_JUMP_FORWARD_IF_NONE    63 (to 1818)

1596        1692 LOAD_FAST                7 (non_full_backward_hooks)
            1694 GET_ITER
         >> 1696 FOR_ITER                37 (to 1772)
            1698 STORE_FAST              10 (hook)

1597        1700 LOAD_FAST               16 (grad_fn)
            1702 LOAD_METHOD             38 (register_hook)
            1724 LOAD_GLOBAL             79 (NULL + _WrappedHook)
            1736 LOAD_FAST               10 (hook)
            1738 LOAD_FAST                0 (self)
            1740 PRECALL                  2
            1744 CALL                     2
            1754 PRECALL                  1
            1758 CALL                     1
            1768 POP_TOP
            1770 JUMP_BACKWARD           38 (to 1696)

1598     >> 1772 LOAD_FAST                0 (self)
            1774 LOAD_METHOD             40 (_maybe_warn_non_full_backward_hook)
            1796 LOAD_FAST                1 (args)
            1798 LOAD_FAST                4 (result)
            1800 LOAD_FAST               16 (grad_fn)
            1802 PRECALL                  3
            1806 CALL                     3
            1816 POP_TOP

1600     >> 1818 LOAD_FAST                4 (result)
            1820 RETURN_VALUE
         >> 1822 PUSH_EXC_INFO

1602        1824 LOAD_GLOBAL             82 (Exception)
            1836 CHECK_EXC_MATCH
            1838 EXTENDED_ARG             1
            1840 POP_JUMP_FORWARD_IF_FALSE   270 (to 2382)
            1842 POP_TOP

1606        1844 LOAD_GLOBAL             22 (_global_forward_hooks)
            1856 LOAD_METHOD             16 (items)
            1878 PRECALL                  0
            1882 CALL                     0
            1892 GET_ITER
         >> 1894 FOR_ITER                96 (to 2088)
            1896 UNPACK_SEQUENCE          2
            1900 STORE_FAST               9 (hook_id)
            1902 STORE_FAST              10 (hook)

1607        1904 LOAD_FAST                9 (hook_id)
            1906 LOAD_GLOBAL             52 (_global_forward_hooks_always_called)
            1918 CONTAINS_OP              0
            1920 POP_JUMP_FORWARD_IF_FALSE    82 (to 2086)
            1922 LOAD_FAST                9 (hook_id)
            1924 LOAD_FAST                5 (called_always_called_hooks)
            1926 CONTAINS_OP              1
            1928 POP_JUMP_FORWARD_IF_FALSE    78 (to 2086)

1608        1930 NOP

1609        1932 PUSH_NULL
            1934 LOAD_FAST               10 (hook)
            1936 LOAD_FAST                0 (self)
            1938 LOAD_FAST                1 (args)
            1940 LOAD_FAST                4 (result)
            1942 PRECALL                  3
            1946 CALL                     3
            1956 STORE_FAST              14 (hook_result)

1610        1958 LOAD_FAST               14 (hook_result)
            1960 POP_JUMP_FORWARD_IF_NONE     2 (to 1966)

1611        1962 LOAD_FAST               14 (hook_result)
            1964 STORE_FAST               4 (result)
         >> 1966 JUMP_BACKWARD           37 (to 1894)
         >> 1968 PUSH_EXC_INFO

1612        1970 LOAD_GLOBAL             82 (Exception)
            1982 CHECK_EXC_MATCH
            1984 POP_JUMP_FORWARD_IF_FALSE    46 (to 2078)
            1986 STORE_FAST              17 (e)

1613        1988 LOAD_GLOBAL             61 (NULL + warnings)
            2000 LOAD_ATTR               31 (warn)
            2010 LOAD_CONST               7 ('global module forward hook with ``always_call=True`` raised an exception that was silenced as another error was raised in forward: ')

1614        2012 LOAD_GLOBAL             85 (NULL + str)
            2024 LOAD_FAST               17 (e)
            2026 PRECALL                  1
            2030 CALL                     1

1613        2040 FORMAT_VALUE             0
            2042 BUILD_STRING             2
            2044 PRECALL                  1
            2048 CALL                     1
            2058 POP_TOP

1615        2060 POP_EXCEPT
            2062 LOAD_CONST               0 (None)
            2064 STORE_FAST              17 (e)
            2066 DELETE_FAST             17 (e)
            2068 JUMP_BACKWARD           88 (to 1894)
         >> 2070 LOAD_CONST               0 (None)
            2072 STORE_FAST              17 (e)
            2074 DELETE_FAST             17 (e)
            2076 RERAISE                  1

1612     >> 2078 RERAISE                  0
         >> 2080 COPY                     3
            2082 POP_EXCEPT
            2084 RERAISE                  1
         >> 2086 JUMP_BACKWARD           97 (to 1894)

1617     >> 2088 LOAD_FAST                0 (self)
            2090 LOAD_ATTR                7 (_forward_hooks)
            2100 LOAD_METHOD             16 (items)
            2122 PRECALL                  0
            2126 CALL                     0
            2136 GET_ITER
         >> 2138 FOR_ITER               120 (to 2380)
            2140 UNPACK_SEQUENCE          2
            2144 STORE_FAST               9 (hook_id)
            2146 STORE_FAST              10 (hook)

1618        2148 LOAD_FAST                9 (hook_id)
            2150 LOAD_FAST                0 (self)
            2152 LOAD_ATTR               25 (_forward_hooks_always_called)
            2162 CONTAINS_OP              0
            2164 POP_JUMP_FORWARD_IF_FALSE   106 (to 2378)
            2166 LOAD_FAST                9 (hook_id)
            2168 LOAD_FAST                5 (called_always_called_hooks)
            2170 CONTAINS_OP              1
            2172 POP_JUMP_FORWARD_IF_FALSE   102 (to 2378)

1619        2174 NOP

1620        2176 LOAD_FAST                9 (hook_id)
            2178 LOAD_FAST                0 (self)
            2180 LOAD_ATTR               28 (_forward_hooks_with_kwargs)
            2190 CONTAINS_OP              0
            2192 POP_JUMP_FORWARD_IF_FALSE    15 (to 2224)

1621        2194 PUSH_NULL
            2196 LOAD_FAST               10 (hook)
            2198 LOAD_FAST                0 (self)
            2200 LOAD_FAST                1 (args)
            2202 LOAD_FAST                2 (kwargs)
            2204 LOAD_FAST                4 (result)
            2206 PRECALL                  4
            2210 CALL                     4
            2220 STORE_FAST              14 (hook_result)
            2222 JUMP_FORWARD            13 (to 2250)

1623     >> 2224 PUSH_NULL
            2226 LOAD_FAST               10 (hook)
            2228 LOAD_FAST                0 (self)
            2230 LOAD_FAST                1 (args)
            2232 LOAD_FAST                4 (result)
            2234 PRECALL                  3
            2238 CALL                     3
            2248 STORE_FAST              14 (hook_result)

1624     >> 2250 LOAD_FAST               14 (hook_result)
            2252 POP_JUMP_FORWARD_IF_NONE     2 (to 2258)

1625        2254 LOAD_FAST               14 (hook_result)
            2256 STORE_FAST               4 (result)
         >> 2258 JUMP_BACKWARD           61 (to 2138)
         >> 2260 PUSH_EXC_INFO

1626        2262 LOAD_GLOBAL             82 (Exception)
            2274 CHECK_EXC_MATCH
            2276 POP_JUMP_FORWARD_IF_FALSE    46 (to 2370)
            2278 STORE_FAST              17 (e)

1627        2280 LOAD_GLOBAL             61 (NULL + warnings)
            2292 LOAD_ATTR               31 (warn)
            2302 LOAD_CONST               8 ('module forward hook with ``always_call=True`` raised an exception that was silenced as another error was raised in forward: ')

1628        2304 LOAD_GLOBAL             85 (NULL + str)
            2316 LOAD_FAST               17 (e)
            2318 PRECALL                  1
            2322 CALL                     1

1627        2332 FORMAT_VALUE             0
            2334 BUILD_STRING             2
            2336 PRECALL                  1
            2340 CALL                     1
            2350 POP_TOP

1629        2352 POP_EXCEPT
            2354 LOAD_CONST               0 (None)
            2356 STORE_FAST              17 (e)
            2358 DELETE_FAST             17 (e)
            2360 JUMP_BACKWARD          112 (to 2138)
         >> 2362 LOAD_CONST               0 (None)
            2364 STORE_FAST              17 (e)
            2366 DELETE_FAST             17 (e)
            2368 RERAISE                  1

1626     >> 2370 RERAISE                  0
         >> 2372 COPY                     3
            2374 POP_EXCEPT
            2376 RERAISE                  1
         >> 2378 JUMP_BACKWARD          121 (to 2138)

1631     >> 2380 RAISE_VARARGS            0

1602     >> 2382 RERAISE                  0
         >> 2384 COPY                     3
            2386 POP_EXCEPT
            2388 RERAISE                  1
ExceptionTable:
  220 to 1818 -> 1822 [0]
  1822 to 1928 -> 2384 [1] lasti
  1932 to 1964 -> 1968 [2]
  1966 to 1966 -> 2384 [1] lasti
  1968 to 1986 -> 2080 [3] lasti
  1988 to 2058 -> 2070 [3] lasti
  2060 to 2068 -> 2384 [1] lasti
  2070 to 2078 -> 2080 [3] lasti
  2080 to 2172 -> 2384 [1] lasti
  2176 to 2256 -> 2260 [2]
  2258 to 2258 -> 2384 [1] lasti
  2260 to 2278 -> 2372 [3] lasti
  2280 to 2350 -> 2362 [3] lasti
  2352 to 2360 -> 2384 [1] lasti
  2362 to 2370 -> 2372 [3] lasti
  2372 to 2382 -> 2384 [1] lasti
, inlined according skipfiles.MOD_INLINELIST
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1513 in _call_impl (Module._call_impl) (inline depth: 1)
        def _call_impl(self, *args, **kwargs):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1514 in _call_impl (Module._call_impl) (inline depth: 1)
            forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR _C [TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_METHOD _get_tracing_state [TorchVariable(<module 'torch._C' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/_C.cpython-311-x86_64-linux-gnu.so'>)]
TRACE PRECALL 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method _get_tracing_state of PyCapsule object at 0x7fad61054bd0>)]
TRACE CALL 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method _get_tracing_state of PyCapsule object at 0x7fad61054bd0>)]
TRACE POP_JUMP_FORWARD_IF_FALSE 76 [ConstantVariable(NoneType)]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR forward [NNModuleVariable()]
TRACE STORE_FAST forward_call [UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable())]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _backward_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _backward_pre_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _forward_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE LOAD_FAST self []
TRACE LOAD_ATTR _forward_pre_hooks [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1518 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_backward_pre_hooks or _global_backward_hooks
TRACE LOAD_GLOBAL _global_backward_pre_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1518 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_backward_pre_hooks or _global_backward_hooks
TRACE LOAD_GLOBAL _global_backward_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1519 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_forward_hooks or _global_forward_pre_hooks):
TRACE LOAD_GLOBAL _global_forward_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1519 in _call_impl (Module._call_impl) (inline depth: 1)
                    or _global_forward_hooks or _global_forward_pre_hooks):
TRACE LOAD_GLOBAL _global_forward_pre_hooks []
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1517 in _call_impl (Module._call_impl) (inline depth: 1)
            if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
TRACE POP_JUMP_FORWARD_IF_TRUE 218 [ConstDictVariable()]
TRACE starts_line /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1520 in _call_impl (Module._call_impl) (inline depth: 1)
                return forward_call(*args, **kwargs)
TRACE PUSH_NULL None []
TRACE LOAD_FAST forward_call [NullVariable]
TRACE LOAD_FAST args [NullVariable, UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable())]
TRACE BUILD_MAP 0 [NullVariable, UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable()), TupleVariable()]
TRACE LOAD_FAST kwargs [NullVariable, UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable()), TupleVariable(), ConstDictVariable()]
TRACE DICT_MERGE 1 [NullVariable, UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable()), TupleVariable(), ConstDictVariable(), ConstDictVariable()]
TRACE CALL_FUNCTION_EX 1 [NullVariable, UserMethodVariable(<function BoxOffsetIntersection.forward at 0x7facb0572ac0>, NNModuleVariable()), TupleVariable(), ConstDictVariable()]
TRACE inlined call forward from /home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py:1520 in _call_impl (Module._call_impl) (inline depth: 1)
            return forward_call(*args, **kwargs)
                   ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INLINING <code object forward at 0x7facb0a9d8b0, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 37>
 37           0 RESUME                   0

 38           2 LOAD_GLOBAL              1 (NULL + F)
             14 LOAD_ATTR                1 (relu)
             24 LOAD_FAST                0 (self)
             26 LOAD_METHOD              2 (layer1)
             48 LOAD_FAST                1 (embeddings)
             50 PRECALL                  1
             54 CALL                     1
             64 PRECALL                  1
             68 CALL                     1
             78 STORE_FAST               2 (layer1_act)

 39          80 LOAD_GLOBAL              7 (NULL + torch)
             92 LOAD_ATTR                4 (mean)
            102 LOAD_FAST                2 (layer1_act)
            104 LOAD_CONST               1 (0)
            106 KW_NAMES                 2
            108 PRECALL                  2
            112 CALL                     2
            122 STORE_FAST               3 (layer1_mean)

 40         124 LOAD_GLOBAL              7 (NULL + torch)
            136 LOAD_ATTR                5 (sigmoid)
            146 LOAD_FAST                0 (self)
            148 LOAD_METHOD              6 (layer2)
            170 LOAD_FAST                3 (layer1_mean)
            172 PRECALL                  1
            176 CALL                     1
            186 PRECALL                  1
            190 CALL                     1
            200 STORE_FAST               4 (gate)

 41         202 LOAD_GLOBAL              7 (NULL + torch)
            214 LOAD_ATTR                7 (min)
            224 LOAD_FAST                1 (embeddings)
            226 LOAD_CONST               1 (0)
            228 KW_NAMES                 2
            230 PRECALL                  2
            234 CALL                     2
            244 UNPACK_SEQUENCE          2
            248 STORE_FAST               5 (offset)
            250 STORE_FAST               6 (_)

 43         252 LOAD_FAST                5 (offset)
            254 LOAD_FAST                4 (gate)
            256 BINARY_OP                5 (*)
            260 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:37 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        def forward(self, embeddings):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:38 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
            layer1_act = F.relu(self.layer1(embeddings))
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_METHOD layer1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NNModuleVariable()]
TRACE LOAD_FAST embeddings [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable()]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE FX call l__self___offset_net_layer1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:38 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        layer1_act = F.relu(self.layer1(embeddings))
                            ~~~~~~~~~~~^^^^^^^^^^^^
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:38 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        layer1_act = F.relu(self.layer1(embeddings))
                     ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST layer1_act [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:39 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
            layer1_mean = torch.mean(layer1_act, dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR mean [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST layer1_act [NullVariable, TorchInGraphFunctionVariable(<built-in method mean of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method mean of type object at 0x7fad600718a0>), TensorVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method mean of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method mean of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method mean of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE FX call mean from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:39 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        layer1_mean = torch.mean(layer1_act, dim=0)
                      ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST layer1_mean [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:40 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
            gate = torch.sigmoid(self.layer2(layer1_mean))
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR sigmoid [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>)]
TRACE LOAD_METHOD layer2 [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), NNModuleVariable()]
TRACE LOAD_FAST layer1_mean [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), NullVariable, NNModuleVariable()]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), NullVariable, NNModuleVariable(), TensorVariable()]
TRACE FX call l__self___offset_net_layer2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:40 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        gate = torch.sigmoid(self.layer2(layer1_mean))
                             ~~~~~~~~~~~^^^^^^^^^^^^^
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method sigmoid of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call sigmoid from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:40 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        gate = torch.sigmoid(self.layer2(layer1_mean))
               ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST gate [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:41 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
            offset, _ = torch.min(embeddings, dim=0)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embeddings [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:41 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        offset, _ = torch.min(embeddings, dim=0)
                    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^
TRACE UNPACK_SEQUENCE 2 [NamedTupleVariable()]
TRACE STORE_FAST offset [TensorVariable(), TensorVariable()]
TRACE STORE_FAST _ [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:43 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
            return offset * gate
TRACE LOAD_FAST offset []
TRACE LOAD_FAST gate [TensorVariable()]
TRACE BINARY_OP 5 [TensorVariable(), TensorVariable()]
TRACE FX call mul_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:43 in forward (BoxOffsetIntersection.forward) (inline depth: 2)
        return offset * gate
               ~~~~~~~^~~~~~
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object forward at 0x7facb0a9d8b0, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 37>
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object _call_impl at 0x60bf410, file "/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1513>
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing embed_query_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 241 in embed_query_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_23 =====
 <eval_with_key>.477 class GraphModule(torch.nn.Module):
    def forward(self, s0 : torch.SymInt, L_queries_ : torch.Tensor):
        l_queries_ = L_queries_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_queries_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_queries_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_queries_[(slice(None, None, None), 1)]
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  embedding_1 = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_1 = offset_embedding;  offset_embedding = r_offset_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        getitem_3 = l_queries_[(slice(None, None, None), 2)]
        r_embedding_1 = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_3);  getitem_3 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        getitem_4 = l_queries_[(slice(None, None, None), 2)]
        r_offset_embedding_1 = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_4);  getitem_4 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding_1 += r_embedding_1;  embedding_3 = embedding_1;  embedding_1 = r_embedding_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding_1 += r_offset_embedding_1;  offset_embedding_3 = offset_embedding_1;  offset_embedding_1 = r_offset_embedding_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        getitem_5 = l_queries_[(slice(None, None, None), 3)]
        embedding_4 = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem_5);  l__self___entity_embedding = getitem_5 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like_1 = torch.zeros_like(embedding_4)
        offset_embedding_4 = zeros_like_1.cuda();  zeros_like_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        getitem_6 = l_queries_[(slice(None, None, None), 4)]
        r_embedding_2 = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_6);  l__self___relation_embedding = getitem_6 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        getitem_7 = l_queries_[(slice(None, None, None), 4)];  l_queries_ = None
        r_offset_embedding_2 = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_7);  l__self___offset_embedding = getitem_7 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding_4 += r_embedding_2;  embedding_6 = embedding_4;  embedding_4 = r_embedding_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding_4 += r_offset_embedding_2;  offset_embedding_6 = offset_embedding_4;  offset_embedding_4 = r_offset_embedding_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:238, code: embedding = self.center_net(torch.stack(embedding_list))
        stack = torch.stack([embedding_3, embedding_6]);  embedding_3 = embedding_6 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:57, code: layer1_act = F.relu(self.layer1(embeddings)) # (num_conj, dim)
        l__self___center_net_layer1 = self.L__self___center_net_layer1(stack)
        layer1_act = torch.nn.functional.relu(l__self___center_net_layer1);  l__self___center_net_layer1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:58, code: attention = F.softmax(self.layer2(layer1_act), dim=0) # (num_conj, dim)
        l__self___center_net_layer2 = self.L__self___center_net_layer2(layer1_act);  layer1_act = None
        attention = torch.nn.functional.softmax(l__self___center_net_layer2, dim = 0);  l__self___center_net_layer2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:59, code: embedding = torch.sum(attention * embeddings, dim=0)
        mul = attention * stack;  attention = stack = None
        embedding_8 = torch.sum(mul, dim = 0);  mul = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:239, code: offset_embedding = self.offset_net(torch.stack(offset_embedding_list))
        stack_1 = torch.stack([offset_embedding_3, offset_embedding_6]);  offset_embedding_3 = offset_embedding_6 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:38, code: layer1_act = F.relu(self.layer1(embeddings))
        l__self___offset_net_layer1 = self.L__self___offset_net_layer1(stack_1)
        layer1_act_1 = torch.nn.functional.relu(l__self___offset_net_layer1);  l__self___offset_net_layer1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:39, code: layer1_mean = torch.mean(layer1_act, dim=0)
        layer1_mean = torch.mean(layer1_act_1, dim = 0);  layer1_act_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:40, code: gate = torch.sigmoid(self.layer2(layer1_mean))
        l__self___offset_net_layer2 = self.L__self___offset_net_layer2(layer1_mean);  layer1_mean = None
        gate = torch.sigmoid(l__self___offset_net_layer2);  l__self___offset_net_layer2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:41, code: offset, _ = torch.min(embeddings, dim=0)
        min_1 = torch.min(stack_1, dim = 0);  stack_1 = None
        offset = min_1[0];  min_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:43, code: return offset * gate
        offset_embedding_7 = offset * gate;  offset = gate = None
        return (embedding_8, offset_embedding_7)
        

TRACED GRAPH
 __compiled_fn_23 <eval_with_key>.477 opcode         name                          target                                                           args                                         kwargs
-------------  ----------------------------  ---------------------------------------------------------------  -------------------------------------------  ------------------------------
placeholder    s0                            s0                                                               ()                                           {}
placeholder    l_queries_                    L_queries_                                                       ()                                           {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                           {}
call_function  getitem                       <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 0))   {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                 {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                                {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                           {}
call_function  getitem_1                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 1))   {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)              {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                           {}
call_function  getitem_2                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 1))   {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                {'dim': 0, 'index': getitem_2}
call_function  embedding_1                   <built-in function iadd>                                         (embedding, r_embedding)                     {}
call_function  offset_embedding_1            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)       {}
call_function  getitem_3                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 2))   {}
call_function  r_embedding_1                 <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)              {'dim': 0, 'index': getitem_3}
call_function  getitem_4                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 2))   {}
call_function  r_offset_embedding_1          <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                {'dim': 0, 'index': getitem_4}
call_function  embedding_3                   <built-in function iadd>                                         (embedding_1, r_embedding_1)                 {}
call_function  offset_embedding_3            <built-in function iadd>                                         (offset_embedding_1, r_offset_embedding_1)   {}
call_function  getitem_5                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 3))   {}
call_function  embedding_4                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)                {'dim': 0, 'index': getitem_5}
call_function  zeros_like_1                  <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding_4,)                               {}
call_method    offset_embedding_4            cuda                                                             (zeros_like_1,)                              {}
call_function  getitem_6                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 4))   {}
call_function  r_embedding_2                 <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)              {'dim': 0, 'index': getitem_6}
call_function  getitem_7                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 4))   {}
call_function  r_offset_embedding_2          <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)                {'dim': 0, 'index': getitem_7}
call_function  embedding_6                   <built-in function iadd>                                         (embedding_4, r_embedding_2)                 {}
call_function  offset_embedding_6            <built-in function iadd>                                         (offset_embedding_4, r_offset_embedding_2)   {}
call_function  stack                         <built-in method stack of type object at 0x7fad600718a0>         ([embedding_3, embedding_6],)                {}
call_module    l__self___center_net_layer1   L__self___center_net_layer1                                      (stack,)                                     {}
call_function  layer1_act                    <function relu at 0x7facb1c64220>                                (l__self___center_net_layer1,)               {}
call_module    l__self___center_net_layer2   L__self___center_net_layer2                                      (layer1_act,)                                {}
call_function  attention                     <function softmax at 0x7facb1c64a40>                             (l__self___center_net_layer2,)               {'dim': 0}
call_function  mul                           <built-in function mul>                                          (attention, stack)                           {}
call_function  embedding_8                   <built-in method sum of type object at 0x7fad600718a0>           (mul,)                                       {'dim': 0}
call_function  stack_1                       <built-in method stack of type object at 0x7fad600718a0>         ([offset_embedding_3, offset_embedding_6],)  {}
call_module    l__self___offset_net_layer1   L__self___offset_net_layer1                                      (stack_1,)                                   {}
call_function  layer1_act_1                  <function relu at 0x7facb1c64220>                                (l__self___offset_net_layer1,)               {}
call_function  layer1_mean                   <built-in method mean of type object at 0x7fad600718a0>          (layer1_act_1,)                              {'dim': 0}
call_module    l__self___offset_net_layer2   L__self___offset_net_layer2                                      (layer1_mean,)                               {}
call_function  gate                          <built-in method sigmoid of type object at 0x7fad600718a0>       (l__self___offset_net_layer2,)               {}
call_function  min_1                         <built-in method min of type object at 0x7fad600718a0>           (stack_1,)                                   {'dim': 0}
call_function  offset                        <built-in function getitem>                                      (min_1, 0)                                   {}
call_function  offset_embedding_7            <built-in function mul>                                          (offset, gate)                               {}
output         output                        output                                                           ((embedding_8, offset_embedding_7),)         {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_23 =====
l_queries_: (1, s0)
l_queries_ (concrete): (1, 5)
l__self___entity_embedding: (14505, 400)
getitem: (1,)
embedding: (1, 400)
zeros_like: (1, 400)
offset_embedding: (1, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (1,)
r_embedding: (1, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (1,)
r_offset_embedding: (1, 400)
embedding_1: (1, 400)
offset_embedding_1: (1, 400)
getitem_3: (1,)
r_embedding_1: (1, 400)
getitem_4: (1,)
r_offset_embedding_1: (1, 400)
embedding_3: (1, 400)
offset_embedding_3: (1, 400)
getitem_5: (1,)
embedding_4: (1, 400)
zeros_like_1: (1, 400)
offset_embedding_4: (1, 400)
getitem_6: (1,)
r_embedding_2: (1, 400)
getitem_7: (1,)
r_offset_embedding_2: (1, 400)
embedding_6: (1, 400)
offset_embedding_6: (1, 400)
stack: (2, 1, 400)
l__self___center_net_layer1: (2, 1, 400)
layer1_act: (2, 1, 400)
l__self___center_net_layer2: (2, 1, 400)
attention: (2, 1, 400)
mul: (2, 1, 400)
embedding_8: (1, 400)
stack_1: (2, 1, 400)
l__self___offset_net_layer1: (2, 1, 400)
layer1_act_1: (2, 1, 400)
layer1_mean: (1, 400)
l__self___offset_net_layer2: (1, 400)
gate: (1, 400)
offset: (1, 400)
offset_embedding_7: (1, 400)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing transform_union_query /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:395
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:395 in transform_union_query (KGReasoning.transform_union_query)
        def transform_union_query(self, queries, query_structure):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:400 in transform_union_query (KGReasoning.transform_union_query)
            if self.query_name_dict[query_structure] == '2u-DNF':
TRACE LOAD_FAST self []
TRACE LOAD_ATTR query_name_dict [LazyVariableTracker()]
TRACE LOAD_FAST query_structure [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), LazyVariableTracker()]
TRACE LOAD_CONST 2u-DNF [ConstantVariable()]
TRACE COMPARE_OP == [ConstantVariable(), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 66 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:401 in transform_union_query (KGReasoning.transform_union_query)
                queries = queries[:, :-1] # remove union -1
TRACE LOAD_FAST queries []
TRACE LOAD_CONST None [LazyVariableTracker()]
TRACE LOAD_CONST None [LazyVariableTracker(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [LazyVariableTracker(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_CONST None [LazyVariableTracker(), SliceVariable()]
TRACE LOAD_CONST -1 [LazyVariableTracker(), SliceVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [LazyVariableTracker(), SliceVariable(), ConstantVariable(NoneType), ConstantVariable(int)]
TRACE BUILD_TUPLE 2 [LazyVariableTracker(), SliceVariable(), SliceVariable()]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), TupleVariable()]
create_graph_input L_queries_ L['queries']
wrap_to_fake L['queries'] (1, 5) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:401 in transform_union_query (KGReasoning.transform_union_query)
            queries = queries[:, :-1] # remove union -1
                      ~~~~~~~^^^^^^^^
TRACE STORE_FAST queries [TensorVariable()]
TRACE JUMP_FORWARD 332 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:404 in transform_union_query (KGReasoning.transform_union_query)
            queries = torch.reshape(queries, [queries.shape[0]*2, -1])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR reshape [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_ATTR shape [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>), TensorVariable(), SizeVariable()]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>), TensorVariable(), SizeVariable(), ConstantVariable(int)]
TRACE LOAD_CONST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE BINARY_OP 5 [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE LOAD_CONST -1 [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>), TensorVariable(), ListVariable()]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>), TensorVariable(), ListVariable()]
TRACE FX call reshape from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:404 in transform_union_query (KGReasoning.transform_union_query)
        queries = torch.reshape(queries, [queries.shape[0]*2, -1])
                  ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST queries [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:405 in transform_union_query (KGReasoning.transform_union_query)
            return queries
TRACE LOAD_FAST queries []
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing transform_union_query (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 405 in transform_union_query>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_24 =====
 <eval_with_key>.519 class GraphModule(torch.nn.Module):
    def forward(self, L_queries_ : torch.Tensor):
        l_queries_ = L_queries_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:401, code: queries = queries[:, :-1] # remove union -1
        queries = l_queries_[(slice(None, None, None), slice(None, -1, None))];  l_queries_ = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:404, code: queries = torch.reshape(queries, [queries.shape[0]*2, -1])
        queries_1 = torch.reshape(queries, [2, -1]);  queries = None
        return (queries_1,)
        

TRACED GRAPH
 __compiled_fn_24 <eval_with_key>.519 opcode         name        target                                                      args                                                            kwargs
-------------  ----------  ----------------------------------------------------------  --------------------------------------------------------------  --------
placeholder    l_queries_  L_queries_                                                  ()                                                              {}
call_function  queries     <built-in function getitem>                                 (l_queries_, (slice(None, None, None), slice(None, -1, None)))  {}
call_function  queries_1   <built-in method reshape of type object at 0x7fad600718a0>  (queries, [2, -1])                                              {}
output         output      output                                                      ((queries_1,),)                                                 {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_24 =====
l_queries_: (1, 5)
queries: (1, 4)
queries_1: (2, 2)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing transform_union_structure /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:407
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:407 in transform_union_structure (KGReasoning.transform_union_structure)
        def transform_union_structure(self, query_structure):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:408 in transform_union_structure (KGReasoning.transform_union_structure)
            if self.query_name_dict[query_structure] == '2u-DNF':
TRACE LOAD_FAST self []
TRACE LOAD_ATTR query_name_dict [LazyVariableTracker()]
TRACE LOAD_FAST query_structure [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), LazyVariableTracker()]
TRACE LOAD_CONST 2u-DNF [ConstantVariable()]
TRACE COMPARE_OP == [ConstantVariable(), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 40 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:409 in transform_union_structure (KGReasoning.transform_union_structure)
                return ('e', ('r',))
TRACE LOAD_CONST ('e', ('r',)) []
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo start tracing embed_query_box /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:202 in embed_query_box (KGReasoning.embed_query_box)
        def embed_query_box(self, queries, query_structure, idx):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:207 in embed_query_box (KGReasoning.embed_query_box)
            all_relation_flag = True
TRACE LOAD_CONST True []
TRACE STORE_FAST all_relation_flag [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST -1 [LazyVariableTracker()]
TRACE BINARY_SUBSCR None [LazyVariableTracker(), ConstantVariable(int)]
TRACE GET_ITER None [TupleVariable()]
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=0)]
TRACE STORE_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:209 in embed_query_box (KGReasoning.embed_query_box)
                if ele not in ['r', 'n']:
TRACE LOAD_FAST ele [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE LOAD_CONST ('r', 'n') [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str)]
TRACE CONTAINS_OP 1 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(str), TupleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 42 [ListIteratorVariable([ConstantVariable(str)], index=1), ConstantVariable(bool)]
TRACE JUMP_BACKWARD 22 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:208 in embed_query_box (KGReasoning.embed_query_box)
            for ele in query_structure[-1]: # whether the current query tree has merged to one branch and only need to do relation traversal, e.g., path queries or conjunctive queries after the intersection
TRACE FOR_ITER 44 [ListIteratorVariable([ConstantVariable(str)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:212 in embed_query_box (KGReasoning.embed_query_box)
            if all_relation_flag:
TRACE LOAD_FAST all_relation_flag []
TRACE POP_JUMP_FORWARD_IF_FALSE 710 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:213 in embed_query_box (KGReasoning.embed_query_box)
                if query_structure[0] == 'e':
TRACE LOAD_FAST query_structure []
TRACE LOAD_CONST 0 [TupleVariable()]
TRACE BINARY_SUBSCR None [TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST e [ConstantVariable(str)]
TRACE COMPARE_OP == [ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 292 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box)
                    embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR index_select [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR entity_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), LazyVariableTracker()]
wrap_to_fake L['self'].entity_embedding (14505, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), SliceVariable()]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), SliceVariable(), LazyVariableTracker()]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), LazyVariableTracker(), TupleVariable()]
create_graph_input L_queries_ L['queries']
automatic dynamic L['queries'] size(0) 2 != 1
wrap_to_fake L['queries'] (2, 2) [<DimDynamic.DYNAMIC: 0>, <DimDynamic.DYNAMIC: 0>] [RelaxedUnspecConstraint(warn_only=True), RelaxedUnspecConstraint(warn_only=True)]
bind_symint s0 L['queries'].size()[0]
create_graph_input s0 L['queries'].size()[0]
bind_symint s1 L['queries'].size()[1]
create_graph_input s1 L['queries'].size()[1]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                                                                                   ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214 in embed_query_box (KGReasoning.embed_query_box)
                embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
                            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:215 in embed_query_box (KGReasoning.embed_query_box)
                    if self.use_cuda:
TRACE LOAD_FAST self []
TRACE LOAD_ATTR use_cuda [NNModuleVariable()]
TRACE POP_JUMP_FORWARD_IF_FALSE 240 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box)
                        offset_embedding = torch.zeros_like(embedding).cuda()
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR zeros_like [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>)]
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method zeros_like of type object at 0x7fad600718a0>), TensorVariable()]
TRACE FX call zeros_like from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~^^^^^^^^^^^
TRACE LOAD_METHOD cuda [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), cuda)]
TRACE FX call cuda from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding = torch.zeros_like(embedding).cuda()
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST offset_embedding [TensorVariable()]
TRACE JUMP_FORWARD 280 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:219 in embed_query_box (KGReasoning.embed_query_box)
                    idx += 1
TRACE LOAD_FAST idx []
TRACE LOAD_CONST 1 [ConstantVariable()]
TRACE BINARY_OP 13 [ConstantVariable(), ConstantVariable(int)]
TRACE STORE_FAST idx [ConstantVariable(int)]
TRACE JUMP_FORWARD 358 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure[-1])):
TRACE LOAD_GLOBAL range []
TRACE LOAD_GLOBAL len [NullVariable, BuiltinVariable(range)]
TRACE LOAD_FAST query_structure [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len)]
TRACE LOAD_CONST -1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE BINARY_SUBSCR None [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable(), ConstantVariable(int)]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), NullVariable, BuiltinVariable(len), TupleVariable()]
TRACE PRECALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE CALL 1 [NullVariable, BuiltinVariable(range), ConstantVariable(int)]
TRACE GET_ITER None [RangeVariable()]
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=0)]
TRACE STORE_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:223 in embed_query_box (KGReasoning.embed_query_box)
                    if query_structure[-1][i] == 'n':
TRACE LOAD_FAST query_structure [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST -1 [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_FAST i [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable()]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), TupleVariable(), ConstantVariable(int)]
TRACE LOAD_CONST n [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str)]
TRACE COMPARE_OP == [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(str), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 486 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                        r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR relation_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].relation_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                                                                           ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226 in embed_query_box (KGReasoning.embed_query_box)
                    r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
                                  ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                        r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
TRACE LOAD_GLOBAL torch [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_ATTR index_select [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), NNModuleVariable()]
wrap_to_fake L['self'].offset_embedding (474, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
TRACE LOAD_CONST 0 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_FAST queries [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE LOAD_CONST None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable()]
TRACE BUILD_TUPLE 2 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BINARY_SUBSCR None [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                                                                                ~~~~~~~^^^^^^^^
TRACE KW_NAMES ('dim', 'index') [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE PRECALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE CALL 3 [ListIteratorVariable([ConstantVariable(int)], index=1), NullVariable, TorchInGraphFunctionVariable(<built-in method index_select of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), TensorVariable()]
TRACE FX call index_select_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227 in embed_query_box (KGReasoning.embed_query_box)
                    r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
                                         ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box)
                        embedding += r_embedding
TRACE LOAD_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST r_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228 in embed_query_box (KGReasoning.embed_query_box)
                    embedding += r_embedding
                    ^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                        offset_embedding += self.func(r_offset_embedding)
TRACE LOAD_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_FAST self [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE LOAD_METHOD func [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NNModuleVariable()]
TRACE LOAD_FAST r_offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable()]
TRACE PRECALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE CALL 1 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), NullVariable, UserFunctionVariable(), TensorVariable()]
TRACE inlined call Identity from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding += self.func(r_offset_embedding)
                                        ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
 23           0 RESUME                   0

 24           2 LOAD_FAST                0 (x)
              4 RETURN_VALUE
, inlined by default
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity) (inline depth: 1)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity) (inline depth: 1)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [TensorVariable()]
DONE INLINING <code object Identity at 0x7facb08e1a70, file "/home/linhongyu/KG/KG-Compilation/KGReasoning/models.py", line 23>
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable(), TensorVariable()]
TRACE FX call iadd_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229 in embed_query_box (KGReasoning.embed_query_box)
                    offset_embedding += self.func(r_offset_embedding)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST offset_embedding [ListIteratorVariable([ConstantVariable(int)], index=1), TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:230 in embed_query_box (KGReasoning.embed_query_box)
                    idx += 1
TRACE LOAD_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE LOAD_CONST 1 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE BINARY_OP 13 [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int), ConstantVariable(int)]
TRACE STORE_FAST idx [ListIteratorVariable([ConstantVariable(int)], index=1), ConstantVariable(int)]
TRACE JUMP_BACKWARD 426 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:222 in embed_query_box (KGReasoning.embed_query_box)
                for i in range(len(query_structure[-1])):
TRACE FOR_ITER 708 [ListIteratorVariable([ConstantVariable(int)], index=1)]
TRACE JUMP_FORWARD 1086 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:241 in embed_query_box (KGReasoning.embed_query_box)
            return embedding, offset_embedding, idx
TRACE LOAD_FAST embedding []
TRACE LOAD_FAST offset_embedding [TensorVariable()]
TRACE LOAD_FAST idx [TensorVariable(), TensorVariable()]
TRACE BUILD_TUPLE 3 [TensorVariable(), TensorVariable(), ConstantVariable(int)]
TRACE RETURN_VALUE None [TupleVariable()]
Step 1: torchdynamo done tracing embed_query_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 241 in embed_query_box>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_25 =====
 <eval_with_key>.527 class GraphModule(torch.nn.Module):
    def forward(self, s0 : torch.SymInt, s1 : torch.SymInt, L_queries_ : torch.Tensor):
        l_queries_ = L_queries_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:214, code: embedding = torch.index_select(self.entity_embedding, dim=0, index=queries[:, idx])
        l__self___entity_embedding = self.L__self___entity_embedding
        getitem = l_queries_[(slice(None, None, None), 0)]
        embedding = torch.index_select(l__self___entity_embedding, dim = 0, index = getitem);  l__self___entity_embedding = getitem = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:216, code: offset_embedding = torch.zeros_like(embedding).cuda()
        zeros_like = torch.zeros_like(embedding)
        offset_embedding = zeros_like.cuda();  zeros_like = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:226, code: r_embedding = torch.index_select(self.relation_embedding, dim=0, index=queries[:, idx])
        l__self___relation_embedding = self.L__self___relation_embedding
        getitem_1 = l_queries_[(slice(None, None, None), 1)]
        r_embedding = torch.index_select(l__self___relation_embedding, dim = 0, index = getitem_1);  l__self___relation_embedding = getitem_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:227, code: r_offset_embedding = torch.index_select(self.offset_embedding, dim=0, index=queries[:, idx])
        l__self___offset_embedding = self.L__self___offset_embedding
        getitem_2 = l_queries_[(slice(None, None, None), 1)];  l_queries_ = None
        r_offset_embedding = torch.index_select(l__self___offset_embedding, dim = 0, index = getitem_2);  l__self___offset_embedding = getitem_2 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:228, code: embedding += r_embedding
        embedding += r_embedding;  embedding_1 = embedding;  embedding = r_embedding = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:229, code: offset_embedding += self.func(r_offset_embedding)
        offset_embedding += r_offset_embedding;  offset_embedding_1 = offset_embedding;  offset_embedding = r_offset_embedding = None
        return (embedding_1, offset_embedding_1)
        

TRACED GRAPH
 __compiled_fn_25 <eval_with_key>.527 opcode         name                          target                                                           args                                        kwargs
-------------  ----------------------------  ---------------------------------------------------------------  ------------------------------------------  ------------------------------
placeholder    s0                            s0                                                               ()                                          {}
placeholder    s1                            s1                                                               ()                                          {}
placeholder    l_queries_                    L_queries_                                                       ()                                          {}
get_attr       l__self___entity_embedding    L__self___entity_embedding                                       ()                                          {}
call_function  getitem                       <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 0))  {}
call_function  embedding                     <built-in method index_select of type object at 0x7fad600718a0>  (l__self___entity_embedding,)               {'dim': 0, 'index': getitem}
call_function  zeros_like                    <built-in method zeros_like of type object at 0x7fad600718a0>    (embedding,)                                {}
call_method    offset_embedding              cuda                                                             (zeros_like,)                               {}
get_attr       l__self___relation_embedding  L__self___relation_embedding                                     ()                                          {}
call_function  getitem_1                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 1))  {}
call_function  r_embedding                   <built-in method index_select of type object at 0x7fad600718a0>  (l__self___relation_embedding,)             {'dim': 0, 'index': getitem_1}
get_attr       l__self___offset_embedding    L__self___offset_embedding                                       ()                                          {}
call_function  getitem_2                     <built-in function getitem>                                      (l_queries_, (slice(None, None, None), 1))  {}
call_function  r_offset_embedding            <built-in method index_select of type object at 0x7fad600718a0>  (l__self___offset_embedding,)               {'dim': 0, 'index': getitem_2}
call_function  embedding_1                   <built-in function iadd>                                         (embedding, r_embedding)                    {}
call_function  offset_embedding_1            <built-in function iadd>                                         (offset_embedding, r_offset_embedding)      {}
output         output                        output                                                           ((embedding_1, offset_embedding_1),)        {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_25 =====
l_queries_: (s0, s1)
l_queries_ (concrete): (2, 2)
l__self___entity_embedding: (14505, 400)
getitem: (s0,)
getitem (concrete): (2,)
embedding: (s0, 400)
embedding (concrete): (2, 400)
zeros_like: (s0, 400)
zeros_like (concrete): (2, 400)
offset_embedding: (s0, 400)
offset_embedding (concrete): (2, 400)
l__self___relation_embedding: (474, 400)
getitem_1: (s0,)
getitem_1 (concrete): (2,)
r_embedding: (s0, 400)
r_embedding (concrete): (2, 400)
l__self___offset_embedding: (474, 400)
getitem_2: (s0,)
getitem_2 (concrete): (2,)
r_offset_embedding: (s0, 400)
r_offset_embedding (concrete): (2, 400)
embedding_1: (s0, 400)
embedding_1 (concrete): (2, 400)
offset_embedding_1: (s0, 400)
offset_embedding_1 (concrete): (2, 400)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing cal_logit_box /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:413
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:413 in cal_logit_box (KGReasoning.cal_logit_box)
        def cal_logit_box(self, entity_embedding, query_center_embedding, query_offset_embedding):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box)
            delta = (entity_embedding - query_center_embedding).abs()
TRACE LOAD_FAST entity_embedding []
TRACE LOAD_FAST query_center_embedding [LazyVariableTracker()]
TRACE BINARY_OP 10 [LazyVariableTracker(), LazyVariableTracker()]
create_graph_input L_entity_embedding_ L['entity_embedding']
automatic dynamic L['entity_embedding'] dim 4 != [1, 14505, 400]
wrap_to_fake L['entity_embedding'] (1, 1, 14505, 400) [<DimDynamic.DYNAMIC: 0>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.DYNAMIC: 0>] [RelaxedUnspecConstraint(warn_only=True), RelaxedUnspecConstraint(warn_only=True), RelaxedUnspecConstraint(warn_only=True), RelaxedUnspecConstraint(warn_only=True)]
bind_symint s0 L['entity_embedding'].size()[2]
create_graph_input s0 L['entity_embedding'].size()[2]
bind_symint s1 L['entity_embedding'].size()[3]
create_graph_input s1 L['entity_embedding'].size()[3]
create_graph_input L_query_center_embedding_ L['query_center_embedding']
automatic dynamic L['query_center_embedding'] dim 4 != [1, 1, 400]
wrap_to_fake L['query_center_embedding'] (1, 2, 1, 400) [<DimDynamic.DYNAMIC: 0>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.DYNAMIC: 0>] [RelaxedUnspecConstraint(warn_only=True), RelaxedUnspecConstraint(warn_only=True), RelaxedUnspecConstraint(warn_only=True), RelaxedUnspecConstraint(warn_only=True)]
bind_symint s2 L['query_center_embedding'].size()[1]
create_graph_input s2 L['query_center_embedding'].size()[1]
bind_symint s3 L['query_center_embedding'].size()[3]
create_graph_input s3 L['query_center_embedding'].size()[3]
TRACE FX call sub from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box)
        delta = (entity_embedding - query_center_embedding).abs()
                 ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_METHOD abs [TensorVariable()]
TRACE PRECALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE CALL 0 [NullVariable, GetAttrVariable(TensorVariable(), abs)]
TRACE FX call abs_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414 in cal_logit_box (KGReasoning.cal_logit_box)
        delta = (entity_embedding - query_center_embedding).abs()
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
TRACE STORE_FAST delta [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box)
            distance_out = F.relu(delta - query_offset_embedding)
TRACE LOAD_GLOBAL F []
TRACE LOAD_ATTR relu [NullVariable, TorchVariable(<module 'torch.nn.functional' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/nn/functional.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE BINARY_OP 10 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable(), LazyVariableTracker()]
create_graph_input L_query_offset_embedding_ L['query_offset_embedding']
automatic dynamic L['query_offset_embedding'] dim 4 != [1, 1, 400]
wrap_to_fake L['query_offset_embedding'] (1, 2, 1, 400) [<DimDynamic.DYNAMIC: 0>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.DYNAMIC: 0>, <DimDynamic.DYNAMIC: 0>] [RelaxedUnspecConstraint(warn_only=True), RelaxedUnspecConstraint(warn_only=True), RelaxedUnspecConstraint(warn_only=True), RelaxedUnspecConstraint(warn_only=True)]
bind_symint s4 L['query_offset_embedding'].size()[1]
create_graph_input s4 L['query_offset_embedding'].size()[1]
bind_symint s5 L['query_offset_embedding'].size()[3]
create_graph_input s5 L['query_offset_embedding'].size()[3]
TRACE FX call sub_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box)
        distance_out = F.relu(delta - query_offset_embedding)
                              ~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
TRACE PRECALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE CALL 1 [NullVariable, TorchInGraphFunctionVariable(<function relu at 0x7facb1c64220>), TensorVariable()]
TRACE FX call relu from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415 in cal_logit_box (KGReasoning.cal_logit_box)
        distance_out = F.relu(delta - query_offset_embedding)
                       ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_out [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box)
            distance_in = torch.min(delta, query_offset_embedding)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR min [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST delta [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST query_offset_embedding [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable()]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method min of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE FX call min_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416 in cal_logit_box (KGReasoning.cal_logit_box)
        distance_in = torch.min(delta, query_offset_embedding)
                      ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST distance_in [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box)
            logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
TRACE LOAD_FAST self []
TRACE LOAD_ATTR gamma [LazyVariableTracker()]
wrap_to_fake L['self'].gamma (1,) [<DimDynamic.STATIC: 2>] [None]
TRACE LOAD_GLOBAL torch [TensorVariable()]
TRACE LOAD_ATTR norm [TensorVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_out [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                             ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE LOAD_FAST self [TensorVariable()]
TRACE LOAD_ATTR cen [TensorVariable(), NNModuleVariable()]
TRACE LOAD_GLOBAL torch [TensorVariable(), ConstantVariable(float)]
TRACE LOAD_ATTR norm [TensorVariable(), ConstantVariable(float), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST distance_in [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>)]
TRACE LOAD_CONST 1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable()]
TRACE LOAD_CONST -1 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int)]
TRACE KW_NAMES ('p', 'dim') [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE CALL 3 [TensorVariable(), ConstantVariable(float), NullVariable, TorchInGraphFunctionVariable(<function norm at 0x7facb1a74d60>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE FX call norm_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                                ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BINARY_OP 5 [TensorVariable(), ConstantVariable(float), TensorVariable()]
TRACE FX call mul from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                                                                     ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE BINARY_OP 10 [TensorVariable(), TensorVariable()]
TRACE FX call sub_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417 in cal_logit_box (KGReasoning.cal_logit_box)
        logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TRACE STORE_FAST logit [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:418 in cal_logit_box (KGReasoning.cal_logit_box)
            return logit
TRACE LOAD_FAST logit []
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing cal_logit_box (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 418 in cal_logit_box>], graph_break=False)
REMOVE UNUSED GRAPHARG L['query_center_embedding'].size()[3]
REMOVE UNUSED GRAPHARG L['query_offset_embedding'].size()[1]
REMOVE UNUSED GRAPHARG L['query_offset_embedding'].size()[3]
TRACED GRAPH
 ===== __compiled_fn_26 =====
 <eval_with_key>.538 class GraphModule(torch.nn.Module):
    def forward(self, s0 : torch.SymInt, s1 : torch.SymInt, L_entity_embedding_ : torch.Tensor, s2 : torch.SymInt, L_query_center_embedding_ : torch.Tensor, L_query_offset_embedding_ : torch.Tensor):
        l_entity_embedding_ = L_entity_embedding_
        l_query_center_embedding_ = L_query_center_embedding_
        l_query_offset_embedding_ = L_query_offset_embedding_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:414, code: delta = (entity_embedding - query_center_embedding).abs()
        sub = l_entity_embedding_ - l_query_center_embedding_;  l_entity_embedding_ = l_query_center_embedding_ = None
        delta = sub.abs();  sub = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:415, code: distance_out = F.relu(delta - query_offset_embedding)
        sub_1 = delta - l_query_offset_embedding_
        distance_out = torch.nn.functional.relu(sub_1);  sub_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:416, code: distance_in = torch.min(delta, query_offset_embedding)
        distance_in = torch.min(delta, l_query_offset_embedding_);  delta = l_query_offset_embedding_ = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:417, code: logit = self.gamma - torch.norm(distance_out, p=1, dim=-1) - self.cen * torch.norm(distance_in, p=1, dim=-1)
        l__self___gamma = self.L__self___gamma
        norm = torch.functional.norm(distance_out, p = 1, dim = -1);  distance_out = None
        sub_2 = l__self___gamma - norm;  l__self___gamma = norm = None
        norm_1 = torch.functional.norm(distance_in, p = 1, dim = -1);  distance_in = None
        mul = 0.02 * norm_1;  norm_1 = None
        logit = sub_2 - mul;  sub_2 = mul = None
        return (logit,)
        

TRACED GRAPH
 __compiled_fn_26 <eval_with_key>.538 opcode         name                       target                                                  args                                              kwargs
-------------  -------------------------  ------------------------------------------------------  ------------------------------------------------  -------------------
placeholder    s0                         s0                                                      ()                                                {}
placeholder    s1                         s1                                                      ()                                                {}
placeholder    l_entity_embedding_        L_entity_embedding_                                     ()                                                {}
placeholder    s2                         s2                                                      ()                                                {}
placeholder    l_query_center_embedding_  L_query_center_embedding_                               ()                                                {}
placeholder    l_query_offset_embedding_  L_query_offset_embedding_                               ()                                                {}
call_function  sub                        <built-in function sub>                                 (l_entity_embedding_, l_query_center_embedding_)  {}
call_method    delta                      abs                                                     (sub,)                                            {}
call_function  sub_1                      <built-in function sub>                                 (delta, l_query_offset_embedding_)                {}
call_function  distance_out               <function relu at 0x7facb1c64220>                       (sub_1,)                                          {}
call_function  distance_in                <built-in method min of type object at 0x7fad600718a0>  (delta, l_query_offset_embedding_)                {}
get_attr       l__self___gamma            L__self___gamma                                         ()                                                {}
call_function  norm                       <function norm at 0x7facb1a74d60>                       (distance_out,)                                   {'p': 1, 'dim': -1}
call_function  sub_2                      <built-in function sub>                                 (l__self___gamma, norm)                           {}
call_function  norm_1                     <function norm at 0x7facb1a74d60>                       (distance_in,)                                    {'p': 1, 'dim': -1}
call_function  mul                        <built-in function mul>                                 (0.02, norm_1)                                    {}
call_function  logit                      <built-in function sub>                                 (sub_2, mul)                                      {}
output         output                     output                                                  ((logit,),)                                       {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_26 =====
l_entity_embedding_: (1, 1, s0, s1)
l_entity_embedding_ (concrete): (1, 1, 14505, 400)
l_query_center_embedding_: (1, s2, 1, s1)
l_query_center_embedding_ (concrete): (1, 2, 1, 400)
l_query_offset_embedding_: (1, s2, 1, s1)
l_query_offset_embedding_ (concrete): (1, 2, 1, 400)
sub: (1, s2, s0, s1)
sub (concrete): (1, 2, 14505, 400)
delta: (1, s2, s0, s1)
delta (concrete): (1, 2, 14505, 400)
sub_1: (1, s2, s0, s1)
sub_1 (concrete): (1, 2, 14505, 400)
distance_out: (1, s2, s0, s1)
distance_out (concrete): (1, 2, 14505, 400)
distance_in: (1, s2, s0, s1)
distance_in (concrete): (1, 2, 14505, 400)
l__self___gamma: (1,)
norm: (1, s2, s0)
norm (concrete): (1, 2, 14505)
sub_2: (1, s2, s0)
sub_2 (concrete): (1, 2, 14505)
norm_1: (1, s2, s0)
norm_1 (concrete): (1, 2, 14505)
mul: (1, s2, s0)
mul (concrete): (1, 2, 14505)
logit: (1, s2, s0)
logit (concrete): (1, 2, 14505)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing transform_union_query /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:395
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:395 in transform_union_query (KGReasoning.transform_union_query)
        def transform_union_query(self, queries, query_structure):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:400 in transform_union_query (KGReasoning.transform_union_query)
            if self.query_name_dict[query_structure] == '2u-DNF':
TRACE LOAD_FAST self []
TRACE LOAD_ATTR query_name_dict [LazyVariableTracker()]
TRACE LOAD_FAST query_structure [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), LazyVariableTracker()]
TRACE LOAD_CONST 2u-DNF [ConstantVariable()]
TRACE COMPARE_OP == [ConstantVariable(), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 66 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:402 in transform_union_query (KGReasoning.transform_union_query)
            elif self.query_name_dict[query_structure] == 'up-DNF':
TRACE LOAD_FAST self []
TRACE LOAD_ATTR query_name_dict [NNModuleVariable()]
TRACE LOAD_FAST query_structure [ConstDictVariable()]
TRACE BINARY_SUBSCR None [ConstDictVariable(), TupleVariable()]
TRACE LOAD_CONST up-DNF [ConstantVariable()]
TRACE COMPARE_OP == [ConstantVariable(), ConstantVariable(str)]
TRACE POP_JUMP_FORWARD_IF_FALSE 332 [ConstantVariable(bool)]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:403 in transform_union_query (KGReasoning.transform_union_query)
                queries = torch.cat([torch.cat([queries[:, :2], queries[:, 5:6]], dim=1), torch.cat([queries[:, 2:4], queries[:, 5:6]], dim=1)], dim=1)
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR cat [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_GLOBAL torch [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_ATTR cat [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), LazyVariableTracker()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), LazyVariableTracker(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), LazyVariableTracker(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), LazyVariableTracker(), SliceVariable()]
TRACE LOAD_CONST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), LazyVariableTracker(), SliceVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), LazyVariableTracker(), SliceVariable(), ConstantVariable(NoneType), ConstantVariable(int)]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), LazyVariableTracker(), SliceVariable(), SliceVariable()]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), LazyVariableTracker(), TupleVariable()]
create_graph_input L_queries_ L['queries']
automatic dynamic L['queries'] size(1) 6 != 5
wrap_to_fake L['queries'] (1, 6) [<DimDynamic.STATIC: 2>, <DimDynamic.DYNAMIC: 0>] [None, RelaxedUnspecConstraint(warn_only=True)]
bind_symint s0 L['queries'].size()[1]
create_graph_input s0 L['queries'].size()[1]
TRACE FX call getitem from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:403 in transform_union_query (KGReasoning.transform_union_query)
            queries = torch.cat([torch.cat([queries[:, :2], queries[:, 5:6]], dim=1), torch.cat([queries[:, 2:4], queries[:, 5:6]], dim=1)], dim=1)
                                            ~~~~~~~^^^^^^^
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_CONST 5 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable(), SliceVariable()]
TRACE LOAD_CONST 6 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable(), SliceVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable(), SliceVariable(), SliceVariable()]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable(), TupleVariable()]
TRACE FX call getitem_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:403 in transform_union_query (KGReasoning.transform_union_query)
            queries = torch.cat([torch.cat([queries[:, :2], queries[:, 5:6]], dim=1), torch.cat([queries[:, 2:4], queries[:, 5:6]], dim=1)], dim=1)
                                                            ~~~~~~~^^^^^^^^
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:403 in transform_union_query (KGReasoning.transform_union_query)
            queries = torch.cat([torch.cat([queries[:, :2], queries[:, 5:6]], dim=1), torch.cat([queries[:, 2:4], queries[:, 5:6]], dim=1)], dim=1)
                                 ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE LOAD_GLOBAL torch [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_ATTR cat [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>)]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_CONST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), SliceVariable()]
TRACE LOAD_CONST 4 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), SliceVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), SliceVariable(), SliceVariable()]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TupleVariable()]
TRACE FX call getitem_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:403 in transform_union_query (KGReasoning.transform_union_query)
            queries = torch.cat([torch.cat([queries[:, :2], queries[:, 5:6]], dim=1), torch.cat([queries[:, 2:4], queries[:, 5:6]], dim=1)], dim=1)
                                                                                                 ~~~~~~~^^^^^^^^
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST None [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable(), ConstantVariable(NoneType)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable(), ConstantVariable(NoneType), ConstantVariable(NoneType)]
TRACE LOAD_CONST 5 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable(), SliceVariable()]
TRACE LOAD_CONST 6 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable(), SliceVariable(), ConstantVariable(int)]
TRACE BUILD_SLICE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable(), SliceVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE BUILD_TUPLE 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable(), SliceVariable(), SliceVariable()]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable(), TupleVariable()]
TRACE FX call getitem_3 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:403 in transform_union_query (KGReasoning.transform_union_query)
            queries = torch.cat([torch.cat([queries[:, :2], queries[:, 5:6]], dim=1), torch.cat([queries[:, 2:4], queries[:, 5:6]], dim=1)], dim=1)
                                                                                                                  ~~~~~~~^^^^^^^^
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_1 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:403 in transform_union_query (KGReasoning.transform_union_query)
            queries = torch.cat([torch.cat([queries[:, :2], queries[:, 5:6]], dim=1), torch.cat([queries[:, 2:4], queries[:, 5:6]], dim=1)], dim=1)
                                                                                      ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 1 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable()]
TRACE KW_NAMES ('dim',) [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method cat of type object at 0x7fad600718a0>), ListVariable(), ConstantVariable(int)]
TRACE FX call cat_2 from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:403 in transform_union_query (KGReasoning.transform_union_query)
            queries = torch.cat([torch.cat([queries[:, :2], queries[:, 5:6]], dim=1), torch.cat([queries[:, 2:4], queries[:, 5:6]], dim=1)], dim=1)
                      ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST queries [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:404 in transform_union_query (KGReasoning.transform_union_query)
            queries = torch.reshape(queries, [queries.shape[0]*2, -1])
TRACE LOAD_GLOBAL torch []
TRACE LOAD_ATTR reshape [NullVariable, TorchVariable(<module 'torch' from '/home/linhongyu/anaconda3/envs/smore/lib/python3.11/site-packages/torch/__init__.py'>)]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>)]
TRACE LOAD_FAST queries [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>), TensorVariable()]
TRACE LOAD_ATTR shape [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>), TensorVariable(), TensorVariable()]
TRACE LOAD_CONST 0 [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>), TensorVariable(), SizeVariable()]
TRACE BINARY_SUBSCR None [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>), TensorVariable(), SizeVariable(), ConstantVariable(int)]
TRACE LOAD_CONST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE BINARY_OP 5 [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE LOAD_CONST -1 [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int)]
TRACE BUILD_LIST 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>), TensorVariable(), ConstantVariable(int), ConstantVariable(int)]
TRACE PRECALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>), TensorVariable(), ListVariable()]
TRACE CALL 2 [NullVariable, TorchInGraphFunctionVariable(<built-in method reshape of type object at 0x7fad600718a0>), TensorVariable(), ListVariable()]
TRACE FX call reshape from /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:404 in transform_union_query (KGReasoning.transform_union_query)
        queries = torch.reshape(queries, [queries.shape[0]*2, -1])
                  ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TRACE STORE_FAST queries [TensorVariable()]
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:405 in transform_union_query (KGReasoning.transform_union_query)
            return queries
TRACE LOAD_FAST queries []
TRACE RETURN_VALUE None [TensorVariable()]
Step 1: torchdynamo done tracing transform_union_query (RETURN_VALUE)
RETURN_VALUE triggered compile
COMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py, line 405 in transform_union_query>], graph_break=False)
TRACED GRAPH
 ===== __compiled_fn_27 =====
 <eval_with_key>.551 class GraphModule(torch.nn.Module):
    def forward(self, s0 : torch.SymInt, L_queries_ : torch.Tensor):
        l_queries_ = L_queries_
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:403, code: queries = torch.cat([torch.cat([queries[:, :2], queries[:, 5:6]], dim=1), torch.cat([queries[:, 2:4], queries[:, 5:6]], dim=1)], dim=1)
        getitem = l_queries_[(slice(None, None, None), slice(None, 2, None))]
        getitem_1 = l_queries_[(slice(None, None, None), slice(5, 6, None))]
        cat = torch.cat([getitem, getitem_1], dim = 1);  getitem = getitem_1 = None
        getitem_2 = l_queries_[(slice(None, None, None), slice(2, 4, None))]
        getitem_3 = l_queries_[(slice(None, None, None), slice(5, 6, None))];  l_queries_ = None
        cat_1 = torch.cat([getitem_2, getitem_3], dim = 1);  getitem_2 = getitem_3 = None
        queries = torch.cat([cat, cat_1], dim = 1);  cat = cat_1 = None
        
        # File: /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:404, code: queries = torch.reshape(queries, [queries.shape[0]*2, -1])
        queries_1 = torch.reshape(queries, [2, -1]);  queries = None
        return (queries_1,)
        

TRACED GRAPH
 __compiled_fn_27 <eval_with_key>.551 opcode         name        target                                                      args                                                           kwargs
-------------  ----------  ----------------------------------------------------------  -------------------------------------------------------------  ----------
placeholder    s0          s0                                                          ()                                                             {}
placeholder    l_queries_  L_queries_                                                  ()                                                             {}
call_function  getitem     <built-in function getitem>                                 (l_queries_, (slice(None, None, None), slice(None, 2, None)))  {}
call_function  getitem_1   <built-in function getitem>                                 (l_queries_, (slice(None, None, None), slice(5, 6, None)))     {}
call_function  cat         <built-in method cat of type object at 0x7fad600718a0>      ([getitem, getitem_1],)                                        {'dim': 1}
call_function  getitem_2   <built-in function getitem>                                 (l_queries_, (slice(None, None, None), slice(2, 4, None)))     {}
call_function  getitem_3   <built-in function getitem>                                 (l_queries_, (slice(None, None, None), slice(5, 6, None)))     {}
call_function  cat_1       <built-in method cat of type object at 0x7fad600718a0>      ([getitem_2, getitem_3],)                                      {'dim': 1}
call_function  queries     <built-in method cat of type object at 0x7fad600718a0>      ([cat, cat_1],)                                                {'dim': 1}
call_function  queries_1   <built-in method reshape of type object at 0x7fad600718a0>  (queries, [2, -1])                                             {}
output         output      output                                                      ((queries_1,),)                                                {}

TRACED GRAPH TENSOR SIZES
===== __compiled_fn_27 =====
l_queries_: (1, s0)
l_queries_ (concrete): (1, 6)
getitem: (1, 2)
getitem_1: (1, 1)
cat: (1, 3)
getitem_2: (1, 2)
getitem_3: (1, 1)
cat_1: (1, 3)
queries: (1, 6)
queries_1: (2, 3)

Step 2: calling compiler function inductor
Step 2: done compiler function inductor
Step 1: torchdynamo start tracing Identity /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:23 in Identity (Identity)
    def Identity(x):
TRACE RESUME 0 []
TRACE starts_line /home/linhongyu/KG/KG-Compilation/KGReasoning/models.py:24 in Identity (Identity)
        return x
TRACE LOAD_FAST x []
TRACE RETURN_VALUE None [LazyVariableTracker()]
create_graph_input L_x_ L['x']
wrap_to_fake L['x'] (2, 400) [<DimDynamic.STATIC: 2>, <DimDynamic.STATIC: 2>] [None, None]
